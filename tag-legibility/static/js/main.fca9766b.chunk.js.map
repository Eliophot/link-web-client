{"version":3,"sources":["servers/helpers/withoutSelectedServer.tsx","utils/helpers/files.ts","common/img/ShlinkLogo.tsx","servers/helpers/withSelectedServer.tsx","common/NotFound.tsx","servers/ServersListGroup.tsx","utils/helpers/hooks.ts","common/services/provideServices.ts","common/ScrollToTop.tsx","common/ErrorHandler.tsx","common/services/ImageDownloader.ts","servers/data/index.ts","utils/services/provideServices.ts","utils/services/LocalStorage.ts","utils/services/ColorGenerator.ts","utils/utils.ts","common/ShlinkVersions.tsx","common/ShlinkVersionsContainer.tsx","common/MainHeader.tsx","common/Home.tsx","common/MenuLayout.tsx","common/AsideMenu.tsx","utils/SimpleCard.tsx","utils/helpers/features.ts","utils/theme/index.ts","utils/helpers/query.ts","utils/Message.tsx","utils/SearchField.tsx","utils/helpers/ordering.ts","api/services/ShlinkApiClient.ts","api/services/ShlinkApiClientBuilder.ts","api/services/provideServices.ts","tags/helpers/Tag.tsx","utils/DropdownBtn.tsx","utils/helpers/date.ts","utils/dates/types/index.ts","utils/DateInput.tsx","utils/dates/DateRangeRow.tsx","utils/dates/DateIntervalDropdownItems.tsx","utils/dates/DateRangeSelector.tsx","short-urls/helpers/hooks.ts","short-urls/ShortUrlsFilteringBar.tsx","utils/OrderingDropdown.tsx","mercure/helpers/boundToMercureHub.tsx","mercure/helpers/index.ts","mercure/helpers/Topics.ts","utils/table/TableOrderIcon.tsx","visits/VisitsStats.tsx","utils/helpers/redux.ts","settings/reducers/settings.ts","utils/helpers/numbers.ts","utils/helpers/pagination.ts","short-urls/Paginator.tsx","short-urls/data/index.ts","short-urls/ShortUrlsList.tsx","utils/CopyToClipboardIcon.tsx","utils/Time.tsx","short-urls/helpers/ShortUrlDetailLink.tsx","short-urls/helpers/ShortUrlVisitsCount.tsx","short-urls/helpers/ShortUrlsRow.tsx","utils/DropdownBtnMenu.tsx","short-urls/helpers/ShortUrlsRowMenu.tsx","short-urls/CreateShortUrl.tsx","utils/Result.tsx","api/utils/index.ts","api/ShlinkApiError.tsx","short-urls/helpers/DeleteShortUrlModal.tsx","short-urls/helpers/CreateShortUrlResult.tsx","short-urls/helpers/index.ts","visits/reducers/visitCreation.ts","short-urls/reducers/shortUrlDeletion.ts","short-urls/reducers/shortUrlCreation.ts","short-urls/reducers/shortUrlEdition.ts","short-urls/reducers/shortUrlsList.ts","short-urls/ShortUrlsTable.tsx","short-urls/helpers/qr-codes/QrFormatDropdown.tsx","short-urls/helpers/qr-codes/QrErrorCorrectionDropdown.tsx","short-urls/helpers/QrCodeModal.tsx","utils/helpers/qrCodes.ts","utils/BooleanControl.tsx","utils/Checkbox.tsx","short-urls/UseExistingIfFoundInfoIcon.tsx","utils/InfoTooltip.tsx","short-urls/helpers/ShortUrlFormCheckboxGroup.tsx","short-urls/ShortUrlForm.tsx","short-urls/EditShortUrl.tsx","short-urls/reducers/shortUrlDetail.ts","short-urls/services/provideServices.ts","utils/FormGroupContainer.tsx","servers/helpers/ServerForm.tsx","servers/helpers/DuplicatedServersModal.tsx","servers/CreateServer.tsx","servers/ServersDropdown.tsx","servers/DeleteServerModal.tsx","servers/DeleteServerButton.tsx","servers/EditServer.tsx","servers/helpers/ImportServersBtn.tsx","servers/reducers/selectedServer.ts","servers/reducers/servers.ts","servers/reducers/remoteServers.ts","servers/helpers/ForServerVersion.tsx","servers/helpers/ServerError.tsx","servers/Overview.tsx","servers/ManageServers.tsx","servers/ManageServersRow.tsx","servers/ManageServersRowDropdown.tsx","servers/services/ServersImporter.ts","servers/services/ServersExporter.ts","servers/services/provideServices.ts","visits/VisitsHeader.tsx","visits/ShortUrlVisitsHeader.tsx","utils/helpers/visits.ts","utils/ToggleSwitch.tsx","utils/helpers/charts.ts","visits/charts/LineChartCard.tsx","common/SimplePaginator.tsx","visits/VisitsTable.tsx","visits/helpers/MapModal.tsx","visits/helpers/OpenMapModalBtn.tsx","visits/types/helpers.ts","visits/services/VisitsParser.ts","visits/helpers/VisitsFilterDropdown.tsx","visits/charts/DoughnutChartLegend.tsx","visits/charts/DoughnutChart.tsx","visits/charts/ChartCard.tsx","visits/charts/DoughnutChartCard.tsx","utils/PaginationDropdown.tsx","visits/charts/HorizontalBarChart.tsx","visits/charts/SortableBarChartCard.tsx","visits/ShortUrlVisits.tsx","visits/reducers/common.ts","visits/reducers/shortUrlVisits.ts","visits/TagVisitsHeader.tsx","visits/TagVisits.tsx","visits/reducers/tagVisits.ts","visits/OrphanVisitsHeader.tsx","visits/OrphanVisits.tsx","visits/reducers/orphanVisits.ts","visits/reducers/visitsOverview.ts","visits/services/VisitsExporter.ts","visits/services/provideServices.ts","tags/helpers/TagBullet.tsx","tags/helpers/TagsSelector.tsx","tags/TagCard.tsx","tags/helpers/DeleteTagConfirmModal.tsx","tags/helpers/EditTagModal.tsx","tags/data/TagsListChildrenProps.ts","tags/TagsModeDropdown.tsx","tags/TagsList.tsx","tags/reducers/tagDelete.ts","tags/reducers/tagEdit.ts","tags/reducers/tagsList.ts","tags/TagsCards.tsx","tags/TagsTable.tsx","tags/TagsTableRow.tsx","tags/services/provideServices.ts","mercure/reducers/mercureInfo.ts","mercure/services/provideServices.ts","settings/RealTimeUpdatesSettings.tsx","settings/Settings.tsx","settings/ShortUrlCreationSettings.tsx","settings/UserInterfaceSettings.tsx","utils/dates/DateIntervalSelector.tsx","settings/VisitsSettings.tsx","settings/TagsSettings.tsx","settings/ShortUrlsListSettings.tsx","settings/services/provideServices.ts","utils/helpers/uri.ts","domains/reducers/domainRedirects.ts","domains/reducers/domainsList.ts","domains/DomainSelector.tsx","domains/helpers/EditDomainRedirectsModal.tsx","domains/helpers/DomainStatusIcon.tsx","domains/DomainRow.tsx","domains/ManageDomains.tsx","domains/services/provideServices.ts","app/reducers/appUpdates.ts","common/AppUpdateBanner.tsx","utils/helpers/sw.ts","app/App.tsx","app/services/provideServices.ts","container/index.ts","reducers/index.ts","container/store.ts","settings/helpers/index.ts","serviceWorkerRegistration.ts","utils/helpers/leaflet.ts","index.tsx","common/NoMenuLayout.tsx","utils/helpers/version.ts"],"names":["withoutSelectedServer","WrappedComponent","props","useEffect","resetSelectedServer","saveUrl","url","filename","document","link","createElement","setAttribute","style","visibility","body","appendChild","click","removeChild","saveCsv","window","csv","blob","Blob","type","URL","createObjectURL","ShlinkLogo","color","MAIN_COLOR","className","viewBox","version","xmlns","fill","d","withSelectedServer","ServerError","selectServer","selectedServer","match","params","serverId","isNotFoundServer","loading","NotFound","to","children","ServerListItem","id","name","ListGroupItem","tag","Link","icon","chevronIcon","ServersListGroup","servers","embedded","length","ListGroup","classNames","map","useStateFlagTimeout","setTimeout","clearTimeout","initialValue","delay","useState","flag","setFlag","timeout","useRef","undefined","callback","current","useToggle","useSwipeable","showSidebar","hideSidebar","swipeMenuIfNoModalExists","e","event","composedPath","some","classList","contains","querySelector","useReactSwipeable","delta","onSwipedLeft","onSwipedRight","useQueryState","paramName","initialState","value","setValue","location","history","query","parseQuery","search","pushState","pathname","stringifyQuery","useEffectExceptFirstTime","deps","isFirstLoad","provideServices","bottle","connect","withRouter","constant","global","console","axios","service","ImageDownloader","serviceFactory","ScrollToTop","decorator","MainHeader","Home","MenuLayout","AsideMenu","ShlinkVersionsContainer","ErrorHandler","scrollTo","error","state","hasError","this","outline","onClick","reload","Component","imgUrl","get","responseType","data","hasServerData","server","apiKey","isServerWithId","hasOwnProperty","isReachableServer","getServerId","serverWithIdToServerData","omit","localStorage","LocalStorage","ColorGenerator","buildPath","path","key","item","getItem","JSON","parse","set","setItem","stringify","floor","Math","random","sqrt","round","letters","normalizeKey","toLowerCase","trim","perceivedLightness","r","g","b","storage","colors","lights","getColorForKey","normalizedKey","setColorForKey","rangeOf","join","isColorLightForKey","colorHex","substring","rgb","hex","parseInt","hexColorToRgbArray","size","mappingFn","startAt","range","hasValue","isNil","isEmpty","handleEventPreventingDefault","handler","pipe","preventDefault","nonEmptyValueOrNull","capitalize","charAt","toUpperCase","slice","normalizeVersion","versionToSemVer","versionToPrintable","VersionLink","project","href","ShlinkVersions","clientVersion","normalizedClientVersion","printableVersion","classes","ServersDropdown","isOpen","toggleOpen","close","settingsPath","toggleClass","Navbar","dark","fixed","expand","NavbarBrand","NavbarToggler","arrowIcon","Collapse","navbar","Nav","NavItem","NavLink","active","cogsIcon","serversList","values","hasServers","autoConnectServer","find","autoConnect","push","Card","Row","noGutters","faPlus","faExternalLinkAlt","TagsList","ShortUrlsList","CreateShortUrl","ShortUrlVisits","TagVisits","OrphanVisits","Overview","EditShortUrl","ManageDomains","sidebarVisible","toggleSidebar","addOrphanVisitsRoute","supportsOrphanVisits","addManageDomainsRoute","supportsDomainRedirects","burgerClasses","swipeableProps","burgerIcon","showOnMobile","exact","from","component","render","AsideMenuItem","rest","activeClassName","DeleteServerButton","hasId","addManageDomainsLink","asideClass","suffix","fixedWidth","overviewIcon","isActive","_","listIcon","createIcon","flip","tagsIcon","domainsIcon","editIcon","textClassName","SimpleCard","title","bodyClassName","serverMatchesVersions","versions","versionMatch","supportsQrCodeSizeInQuery","minVersion","supportsShortUrlTitle","supportsQrCodeMargin","supportsTagsInPatch","supportsBotVisits","supportsCrawlableVisits","supportsQrErrorCorrection","supportsForwardQuery","supportsDefaultDomainRedirectsEdition","MAIN_COLOR_ALPHA","HIGHLIGHTED_COLOR","HIGHLIGHTED_COLOR_ALPHA","PRIMARY_LIGHT_COLOR","PRIMARY_DARK_COLOR","changeThemeInMarkup","theme","html","getElementsByTagName","isDarkThemeEnabled","getAttribute","qs","ignoreQueryPrefix","arrayFormat","getClassForType","default","getTextClassForType","Message","fullWidth","preloader","spin","timer","determineOrderDir","currentField","newField","currentOrderDir","ASC","DESC","sortList","list","field","dir","sort","a","greaterThan","smallerThan","orderToString","order","stringToOrder","split","buildShlinkBaseUrl","rejectNilProps","reject","normalizeOrderByInParams","orderBy","ShlinkApiClient","baseUrl","listShortUrls","performRequest","then","shortUrls","createShortUrl","options","filteredOptions","resp","getShortUrlVisits","shortCode","visits","getTagVisits","getOrphanVisits","getVisitsOverview","getShortUrl","domain","deleteShortUrl","updateShortUrlTags","tags","updateShortUrl","listTags","withStats","stats","deleteTags","editTag","oldName","newName","health","mercureInfo","listDomains","domains","editDomainRedirects","domainRedirects","method","headers","paramsSerializer","apiClients","buildShlinkApiClient","getStateOrSelectedServer","getState","isGetState","prop","Error","clientKey","SearchField","onChange","large","noBorder","searchTerm","setSearchTerm","resetTimer","searchTermChanged","newSearchTerm","placeholder","target","searchIcon","hidden","Tag","text","clearable","colorGenerator","onClose","backgroundColor","cursor","DropdownBtn","disabled","dropdownClassName","right","minWidth","toggle","toggleClasses","Dropdown","DropdownToggle","caret","DropdownMenu","isDateObject","date","formatDateFromFormat","theFormat","format","formatISO","formatIsoDate","formatInternational","formatDate","parseISO","stdParseISO","isBetween","start","end","isWithinInterval","isBeforeOrEqual","dateToCompare","isEqual","isBefore","dateRangeIsEmpty","dateRange","filter","Boolean","rangeIsInterval","INTERVAL_TO_STRING_MAP","today","yesterday","last7Days","last30Days","last90Days","last180Days","last365Days","all","DATE_INTERVALS","Object","keys","rangeOrIntervalToString","startDate","endDate","dateRangeToString","startOfDaysAgo","daysAgo","startOfDay","subDays","Date","endingToday","endOfDay","intervalToDateRange","dateInterval","dateToMatchingInterval","theDate","cond","T","DateInput","isClearable","selected","showCalendarIcon","ref","dateFormat","calendarIcon","input","focus","DateRangeRow","onStartDateChange","onEndDateChange","placeholderText","maxDate","minDate","DateIntervalDropdownItems","allText","DropdownItem","divider","interval","DateRangeSelector","onDatesChange","initialDateRange","defaultText","updatable","initialIntervalIsRange","activeInterval","setActiveInterval","activeDateRange","setActiveDateRange","updateDateRange","updateInterval","isDateInterval","header","useShortUrlsQuery","useMemo","extra","mergedQuery","normalizedQuery","evolvedQuery","queryString","dateOrNull","ShortUrlsFilteringBar","toFirstPage","selectedTags","setDates","setSearch","removeTag","selectedTag","tagsList","OrderingDropdown","items","isButton","handleItemClick","fieldKey","newOrderDir","UncontrolledDropdown","toPairs","fieldValue","sortAscIcon","sortDescIcon","boundToMercureHub","getTopicsForProps","pendingUpdates","Set","createNewVisits","loadMercureInfo","closeEventSource","topics","onMessage","onTokenExpired","mercureHubUrl","token","onEventSourceMessage","onEventSourceError","status","subscriptions","topic","hubUrl","searchParams","append","es","EventSource","Authorization","onmessage","onerror","forEach","bindToMercureTopic","visit","add","setInterval","clear","clearInterval","Topics","TableOrderIcon","currentOrder","caretUpIcon","caretDownIcon","orphanVisits","shortUrlVisits","selectedBar","buildReducer","action","actionHandler","currentState","buildActionCreator","SET_SETTINGS","DEFAULT_SHORT_URLS_ORDERING","realTimeUpdates","enabled","shortUrlCreation","validateUrls","ui","defaultInterval","shortUrlsList","defaultOrdering","mergeDeepRight","dissoc","toggleRealTimeUpdates","setRealTimeUpdatesInterval","setShortUrlCreationSettings","settings","setShortUrlsListSettings","setUiSettings","setVisitsSettings","setTagsSettings","ceil","formatter","Intl","NumberFormat","prettify","number","Number","ELLIPSIS","progressivePagination","currentPage","pageCount","pages","max","min","unshift","pageIsEllipsis","pageNumber","prettifyPageNumber","keyForPage","index","Paginator","paginator","currentQueryString","pagesCount","urlForPage","Pagination","listClassName","PaginationItem","PaginationLink","previous","next","SHORT_URLS_ORDERABLE_FIELDS","dateCreated","longUrl","ShortUrlsTable","actualOrderBy","setActualOrderBy","pagination","handleOrderBy","addTag","newTag","page","orderByColumn","renderOrderIcon","onTagClick","CopyToClipboardIcon","onCopy","copyIcon","Time","relative","dateObject","dateTime","getUnixTime","formatDistance","buildUrl","ShortUrlDetailLink","shortUrl","ShortUrlVisitsCount","visitsCount","maxVisits","meta","visitsLink","prettifiedMaxVisits","tooltipRef","el","infoIcon","UncontrolledTooltip","placement","ShortUrlsRow","ShortUrlsRowMenu","copiedToClipboard","setCopiedToClipboard","setActive","isFirstRun","data-th","DropdownBtnMenu","ButtonDropdown","menuIcon","DeleteShortUrlModal","QrCodeModal","isQrModalOpen","toggleQrCode","isDeleteModalOpen","toggleDelete","pieChartIcon","qrIcon","deleteIcon","ShortUrlForm","CreateShortUrlResult","shortUrlCreationResult","resetCreateShortUrl","basicMode","shortUrlCreationSettings","customSlug","shortCodeLength","validSince","validUntil","findIfExists","validateUrl","forwardQuery","getInitialState","saving","mode","onSave","canBeClosed","Result","small","parseApiError","response","isInvalidDeletionError","ShlinkApiError","errorData","fallbackMessage","detail","invalidElements","shortUrlDeletion","resetDeleteShortUrl","inputValue","setInputValue","handleDeleteUrl","catch","identity","Modal","centered","onSubmit","ModalHeader","ModalBody","ModalFooter","result","showCopyTooltip","setShowCopyTooltip","closeIcon","Tooltip","shortUrlMatches","CREATE_VISITS","createdVisits","DELETE_SHORT_URL_START","DELETE_SHORT_URL_ERROR","SHORT_URL_DELETED","RESET_DELETE_SHORT_URL","dispatch","CREATE_SHORT_URL_START","CREATE_SHORT_URL_ERROR","CREATE_SHORT_URL","RESET_CREATE_SHORT_URL","EDIT_SHORT_URL_START","EDIT_SHORT_URL_ERROR","SHORT_URL_EDITED","editShortUrl","sendTagsSeparately","Promise","LIST_SHORT_URLS_START","LIST_SHORT_URLS_ERROR","LIST_SHORT_URLS","assocPath","totalItems","currentShortUrl","lastVisit","last","assoc","ITEMS_IN_OVERVIEW_PAGE","editedShortUrl","actionableFieldClasses","orderableColumnsClasses","tableClasses","supportsTitle","colSpan","QrFormatDropdown","setFormat","QrErrorCorrectionDropdown","errorCorrection","setErrorCorrection","imageDownloader","ForServerVersion","setSize","margin","setMargin","capabilities","useSizeInPath","marginIsSupported","errorCorrectionIsSupported","willRenderThreeControls","qrCodeUrl","buildQrCodeUrl","totalSize","modalSize","step","src","alt","Button","block","saveImage","downloadIcon","BooleanControl","checked","inline","uuid","typeClasses","display","htmlFor","Checkbox","InfoModal","UseExistingIfFoundInfoIcon","isModalOpen","toggleModal","InfoTooltip","ShortUrlFormCheckboxGroup","infoTooltip","normalizeTag","replace","toDate","dynamicColClasses","TagsSelector","DomainSelector","shortUrlData","setShortUrlData","isEdit","isBasicMode","hadTitleOriginally","resolveNewTitle","hasNewTitle","matcher","submit","renderOptionalInput","fromGroupProps","Input","renderDateInput","basicComponents","bsSize","required","showCustomizeCard","limitAccessCardClasses","showCrawlableControl","showForwardQueryControl","showBehaviorCard","extraChecksCardClasses","crawlable","goBack","shortUrlDetail","getShortUrlDetail","shortUrlEdition","savingError","savingErrorData","savingSucceeded","isSuccessful","isNotSuccessful","faArrowLeft","GET_SHORT_URL_DETAIL_START","GET_SHORT_URL_DETAIL_ERROR","GET_SHORT_URL_DETAIL","FormGroupContainer","labelClassName","forId","FormGroup","ServerForm","initialValues","setName","setUrl","setApiKey","handleSubmit","DuplicatedServersModal","duplicatedServers","onDiscard","hasMultipleServers","ImportResult","CreateServer","ImportServersBtn","createServer","serversImported","setServersImported","errorImporting","setErrorImporting","isConfirmModalOpen","toggleConfirmModal","serverData","setServerData","save","NoMenuLayout","tooltipPlacement","onImport","onImportError","nav","inNavbar","serverIcon","plusIcon","DeleteServerModal","deleteServer","redirectHome","showModal","hideModal","EditServer","editServer","serversFiltering","importServersFromFile","createServers","fileRef","serversToCreate","setServersToCreate","setDuplicatedServers","create","createAllServers","createNonDuplicatedServers","complement","onFile","files","existingServers","hasDuplicatedServers","importIcon","accept","SELECT_SERVER","RESET_SELECTED_SERVER","toSemVer","getServerVersion","memoizeWith","_serverId","serverNotFound","serverNotReachable","EDIT_SERVER","DELETE_SERVER","CREATE_SERVERS","SET_AUTO_CONNECT","newServers","fromPairs","evaluatedServerId","serversListToMap","reduce","acc","setAutoConnect","responseToServersList","Array","isArray","fetchServers","homepage","remoteList","maxVersion","loadVisitsOverview","visitsOverview","loadingTags","loadingVisits","orphanVisitsCount","useHistory","itemsPerPage","CardTitle","CardText","CardHeader","CardBody","encodeURIComponent","ManageServers","serversExporter","ManageServersRow","allServers","setServersList","hasAutoConnect","exportServers","exportIcon","width","ManageServersRowDropdown","checkIcon","isMenuOpen","toggleMenu","serverUrl","isAutoConnect","autoConnectIcon","toggleOffIcon","toggleOnIcon","connectIcon","validateServer","validateServers","every","ServersImporter","csvJson","fileReaderFactory","file","reader","resolve","addEventListener","content","toString","toObject","readAsText","ServersExporter","csvjson","toCSV","FileReader","VisitsHeader","ShortUrlVisitsHeader","shortLink","longLink","visitsStatsTitle","DEFAULT","BROWSERS_WHITELIST","extractDomain","includes","fillTheGaps","labels","zipObj","ToggleSwitch","pointerOnHover","native","firstElement","renderChartLabel","dataset","formattedValue","label","renderPieChartLabel","STEPS_MAP","monthly","weekly","daily","hourly","STEP_TO_DURATION_MAP","hours","days","weeks","months","STEP_TO_DIFF_FUNC_MAP","differenceInHours","differenceInDays","differenceInWeeks","differenceInMonths","STEP_TO_DATE_FORMAT","firstWeekDay","startOfISOWeek","lastWeekDay","endOfISOWeek","groupVisitsByStep","countBy","generateLabelsAndGroupedVisits","groupedVisitsWithGaps","skipNoElements","diffFunc","newerDate","oldestDate","duration","num","generateLabels","generateDataset","tension","borderColor","selectedLabel","chartElementAtEvent","datasetsByPoint","setSelectedVisits","chart","LineChartCard","highlightedVisits","highlightedLabel","oldestVisitDate","now","always","determineInitialStep","setStep","skipNoVisits","toggleSkipNoVisits","visitsToDatasetGroups","reverse","groupedVisits","groupedHighlighted","generateChartDatasets","mainDataset","maintainAspectRatio","plugins","legend","tooltip","intersect","axis","callbacks","scales","y","beginAtZero","ticks","precision","x","onHover","renderLineChart","datasets","getElementAtEvent","entries","menuText","SimplePaginator","setCurrentPage","searchVisits","browser","os","referer","country","city","visitedUrl","visitMatchesSearch","calculateVisits","allVisits","sortedVisits","sortVisits","total","visitsGroups","splitEvery","VisitsTable","selectedVisits","matchMedia","isOrphanVisits","headerCellsClass","matchMobile","matches","isMobileDevice","setIsMobileDevice","setOrder","resultSet","setPage","supportsBots","fullSizeColSpan","listener","removeEventListener","flat","botIcon","isSelected","v","potentialBot","OpenStreetMapTile","TileLayer","attribution","calculateMapProps","locations","bounds","zoom","center","latLong","MapModal","contentClassName","MapContainer","cityName","count","Marker","position","Popup","OpenMapModalBtn","modalTitle","activeCities","mapIsOpened","openMap","closeMap","dropdownIsOpened","toggleDropdown","openDropdown","locationsToShow","setLocationsToShow","buttonRef","openMapWithLocations","filtered","mapIcon","isOrphanVisit","groupNewVisitsByType","groupBy","newVisit","regularVisits","highlightedVisitsToStats","property","toApiParams","excludeBots","visitHasProperty","propertyName","optionalNumericToNumber","numeric","parseFloat","updateLocationsStatsForVisit","updateCountriesStatsForVisit","updateCitiesStatsForVisit","processStatsFromVisits","osStats","updateOsStatsForVisit","browsersStats","updateBrowsersStatsForVisit","browsers","referrersStats","updateReferrersStatsForVisit","referrers","countries","cities","citiesForMapStats","latitude","longitude","currentCity","updateCitiesForMapForVisit","citiesForMap","visitedUrlsStats","isNormalizedOrphanVisit","updateVisitedUrlsForVisit","visitedUrls","normalizeVisits","userAgent","visitLocation","common","bowser","parseUserAgent","countryName","VisitsFilterDropdown","botsSupported","orphanVisitsType","propsForOrphanVisitsTypeItem","DoughnutChartLegend","config","defaultColor","borderWidth","DoughnutChart","memo","chartRef","setChartRef","chartData","generateChartData","height","element","ChartCard","footer","CardFooter","DoughnutChartCard","PaginationDropdown","toggleClassName","ranges","Infinity","dropLabelIfHidden","startsWith","highlightedData","HorizontalBarChart","highlightedStats","statsAreDefined","highlightedKey","stacked","indexAxis","determineHeight","renderChartComponent","customKey","toLowerIfString","toLower","pickKeyFromPair","pickValueFromPair","SortableBarChartCard","sortingItems","extraHeaderContent","withPagination","setItemsPerPage","determineCurrentPagePairs","firstPageLength","i","sortedPairs","pairs","sortBy","getSortedPairsForStats","sortedKeys","sortedHighlightedPairs","currentPageStats","currentPageHighlightedStats","highlightedPages","determineStats","sections","byTime","subPath","faCalendarAlt","byContext","faChartPie","byLocation","faMapMarkedAlt","faList","VisitsNavLink","RouterNavLink","endsWith","VisitsStats","visitsInfo","getVisits","cancelGetVisits","exportCsv","loadingLarge","progress","fallbackInterval","initialInterval","setInitialInterval","setDateRange","setHighlightedVisits","setHighlightedLabel","visitsFilter","setVisitsFilter","buildSectionUrl","normalizedVisits","mapLocations","highlightVisitsForProp","newSelectedBar","propEq","faFileDownload","Progress","striped","pills","section","amount","exportVisits","cancelGetShortUrlVisits","doIntervalFallback","ITEMS_PER_PAGE","isLastPage","calcProgress","getVisitsWithLoader","visitsLoader","lastVisitLoader","extraFinishActionData","actionMap","shouldCancel","loadVisitsInParallel","flatten","loadPagesBlocks","pagesBlocks","concat","loadVisits","pagesRange","fallbackToInterval","finish","lastVisitLoaderForLoader","loader","GET_SHORT_URL_VISITS_START","GET_SHORT_URL_VISITS_ERROR","GET_SHORT_URL_VISITS","GET_SHORT_URL_VISITS_LARGE","GET_SHORT_URL_VISITS_CANCEL","GET_SHORT_URL_VISITS_PROGRESS_CHANGED","GET_SHORT_URL_VISITS_FALLBACK_TO_INTERVAL","cancelLoad","newVisits","TagVisitsHeader","tagVisits","cancelGetTagVisits","GET_TAG_VISITS_START","GET_TAG_VISITS_ERROR","GET_TAG_VISITS","GET_TAG_VISITS_LARGE","GET_TAG_VISITS_CANCEL","GET_TAG_VISITS_PROGRESS_CHANGED","GET_TAG_VISITS_FALLBACK_TO_INTERVAL","OrphanVisitsHeader","cancelGetOrphanVisits","GET_ORPHAN_VISITS_START","GET_ORPHAN_VISITS_ERROR","GET_ORPHAN_VISITS","GET_ORPHAN_VISITS_LARGE","GET_ORPHAN_VISITS_CANCEL","GET_ORPHAN_VISITS_PROGRESS_CHANGED","GET_ORPHAN_VISITS_FALLBACK_TO_INTERVAL","matchesType","GET_OVERVIEW_START","GET_OVERVIEW_ERROR","GET_OVERVIEW","VisitsExporter","visitsParser","TagBullet","toComponentTag","searchMode","tagFilteringMode","tagComponent","onDelete","suggestions","suggestionComponent","allowNew","addOnBlur","minQueryLength","delimiters","suggestionsTransform","removedTagIndex","tagsCopy","splice","onAddition","TagCard","DeleteTagConfirmModal","EditTagModal","displayed","isEditModalOpen","toggleEdit","hasTitle","displayTitle","titleRef","scrollWidth","clientWidth","faLink","faEye","deleteTag","tagDelete","tagDeleted","deleting","doDelete","tagEdited","tagEdit","newTagName","setNewTagName","setColor","showColorPicker","toggleColorPicker","hideColorPicker","editing","saveTag","onClosed","colorIcon","Popover","disableAlpha","TAGS_ORDERABLE_FIELDS","TagsModeDropdown","renderTitle","cardsIcon","TagsCards","TagsTable","filterTags","forceListTags","defaultMode","setMode","resolveSortedTags","filteredTags","shortUrlsCount","normalizedTags","sortedTags","renderContent","DELETE_TAG_START","DELETE_TAG_ERROR","DELETE_TAG","TAG_DELETED","EDIT_TAG_START","EDIT_TAG_ERROR","EDIT_TAG","TAG_EDITED","pick","LIST_TAGS_START","LIST_TAGS_ERROR","LIST_TAGS","FILTER_TAGS","renameTag","rejectTag","tagToReject","calculateVisitsPerTag","increase","tagStats","stateTags","displayedTag","setDisplayedTag","tagsCount","tagsGroups","group","TagsTableRow","pageFromQuery","showPaginator","isDropdownOpen","listTagsActionFactory","force","processedStats","factory","GET_MERCURE_INFO_START","GET_MERCURE_INFO_ERROR","GET_MERCURE_INFO","info","RealTimeUpdatesSettings","SettingsSections","child","subChild","subIndex","Settings","RealTimeUpdates","ShortUrlCreation","UserInterface","Visits","Tags","tagFilteringModeText","ShortUrlCreationSettings","changeTagsFilteringMode","UserInterfaceSettings","faMoon","faSun","useDarkTheme","DateIntervalSelector","VisitsSettings","TagsSettings","tagsMode","ShortUrlsListSettings","replaceAuthorityFromUri","uri","newAuthority","schema","pathParts","normalizedPath","EDIT_DOMAIN_REDIRECTS","redirects","LIST_DOMAINS_START","LIST_DOMAINS_ERROR","LIST_DOMAINS","FILTER_DOMAINS","VALIDATE_DOMAIN","filteredDomains","replaceRedirectsOnDomain","replaceStatusOnDomain","defaultRedirects","filterDomains","checkDomainHealth","domainsList","inputDisplayed","showInput","hideInput","valueIsEmpty","unselectDomain","InputGroup","InputGroupAddon","addonType","faUndo","trigger","isDefault","isLast","EditDomainRedirectsModal","baseUrlRedirect","setBaseUrlRedirect","regular404Redirect","setRegular404Redirect","invalidShortUrlRedirect","setInvalidShortUrlRedirect","DomainStatusIcon","matchesMobile","isMobile","setIsMobile","loadingStatusIcon","invalidIcon","autohide","Nr","fallback","DefaultDomain","defaultDomainIcon","DomainRow","authority","canEditDomain","forbiddenIcon","resolvedDefaultRedirects","column","APP_UPDATE_AVAILABLE","RESET_APP_UPDATE","appUpdateAvailable","resetAppUpdate","AppUpdateBanner","forceUpdate","isUpdating","setUpdating","Alert","reloadIcon","navigator","serviceWorker","getRegistrations","registrations","registration","waiting","postMessage","App","appUpdated","isHome","Bottle","container","mapActionService","actionName","serviceName","lazyService","propsFromState","actionServiceNames","reduxConnect","provideAppServices","provideCommonServices","provideApiServices","provideShortUrlsServices","provideServersServices","provideTagsServices","provideVisitsServices","provideUtilsServices","provideMercureServices","provideSettingsServices","provideDomainsServices","combineReducers","serversReducer","selectedServerReducer","shortUrlsListReducer","shortUrlCreationReducer","shortUrlDeletionReducer","shortUrlEditionReducer","shortUrlVisitsReducer","tagVisitsReducer","orphanVisitsReducer","shortUrlDetailReducer","tagsListReducer","tagDeleteReducer","tagEditReducer","mercureInfoReducer","settingsReducer","domainsListReducer","visitsOverviewReducer","appUpdatesReducer","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","localStorageConfig","states","namespace","namespaceSeparator","debounce","preloadedState","migrateDeprecatedSettings","load","store","createStore","reducers","applyMiddleware","ReduxThunk","isLocalhost","hostname","registerValidSW","swUrl","register","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","L","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","marker2x","iconUrl","marker","shadowUrl","markerShadow","basename","getElementById","process","origin","fetch","contentType","indexOf","ready","unregister","checkValidServiceWorker","registerServiceWorker","versionToMatch","matchesMinVersion","compare","versionIsValidSemVer","defaultValue"],"mappings":"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","file":"static/js/main.fca9766b.chunk.js","sourcesContent":["import { FC, useEffect } from 'react';\n\ninterface WithoutSelectedServerProps {\n  resetSelectedServer: Function;\n}\n\nexport function withoutSelectedServer<T = {}>(WrappedComponent: FC<WithoutSelectedServerProps & T>) {\n  return (props: WithoutSelectedServerProps & T) => {\n    useEffect(() => {\n      props.resetSelectedServer();\n    }, []);\n\n    return <WrappedComponent {...props} />;\n  };\n}\n","export const saveUrl = ({ document }: Window, url: string, filename: string) => {\n  const link = document.createElement('a');\n\n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};\n\nexport const saveCsv = (window: Window, csv: string, filename: string) => {\n  const blob = new Blob([ csv ], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n\n  saveUrl(window, url, filename);\n};\n","import { MAIN_COLOR } from '../../utils/theme';\n\nexport interface ShlinkLogoProps {\n  color?: string;\n  className?: string;\n}\n\nexport const ShlinkLogo = ({ color = MAIN_COLOR, className }: ShlinkLogoProps) => (\n  <svg className={className} viewBox=\"0 0 512 512\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g fill={color}>\n      <path\n        d=\" M 23.71 85.08 C 17.22 49.81 49.44 14.86 85.08 18.12 C 118.83 19.21 145.72 53.33 139.45 86.37 C 155.64 102.30 171.32 118.83 187.87 134.36 C 198.32 111.73 208.84 89.12 219.57 66.62 C 226.05 53.84 243.47 48.74 255.73 56.27 C 263.76 62.10 270.34 69.69 277.25 76.75 C 286.28 86.61 285.72 102.89 276.31 112.31 C 223.38 165.37 170.38 218.37 117.35 271.34 C 107.72 280.99 91.01 281.25 81.11 271.86 C 74.39 264.94 66.82 258.69 61.24 250.77 C 53.72 238.52 58.85 221.07 71.64 214.62 C 94.11 203.87 116.72 193.38 139.33 182.91 C 123.81 166.36 107.30 150.68 91.37 134.49 C 60.20 140.28 27.37 116.78 23.71 85.08 Z\"\n      />\n      <path\n        d=\" M 205.21 201.23 C 225.32 181.36 260.88 181.11 281.14 200.86 C 299.25 218.75 317.37 236.65 335.10 254.93 C 356.73 278.01 352.01 318.70 326.03 336.56 C 320.07 330.47 313.73 324.65 308.12 318.28 C 323.86 309.39 328.76 286.18 316.63 272.39 C 301.73 256.95 286.30 242.03 271.24 226.75 C 264.49 219.65 256.80 212.00 246.37 211.52 C 224.65 208.64 205.52 233.36 214.49 253.58 C 221.09 266.81 234.22 275.12 243.62 286.24 C 240.43 295.96 238.09 306.13 238.29 316.46 C 225.55 304.29 213.16 291.73 200.89 279.09 C 180.97 257.57 183.10 220.45 205.21 201.23 Z\"\n      />\n      <path\n        d=\" M 273.90 352.07 C 252.28 328.99 256.98 288.31 282.96 270.46 C 288.93 276.54 295.26 282.36 300.88 288.72 C 285.14 297.62 280.23 320.82 292.38 334.61 C 307.27 350.05 322.70 364.96 337.75 380.25 C 344.51 387.35 352.20 395.00 362.64 395.48 C 384.35 398.37 403.49 373.64 394.51 353.42 C 387.92 340.18 374.78 331.88 365.38 320.76 C 368.56 311.04 370.91 300.86 370.71 290.54 C 383.45 302.70 395.84 315.27 408.11 327.91 C 428.03 349.43 425.90 386.55 403.78 405.77 C 383.68 425.64 348.13 425.89 327.86 406.14 C 309.75 388.25 291.60 370.37 273.90 352.07 Z\"\n      />\n      <path\n        d=\" M 422.11 403.83 C 431.96 394.07 441.60 384.06 451.66 374.51 C 460.90 383.74 471.89 392.70 474.89 406.11 C 480.16 429.97 484.08 454.13 488.76 478.12 C 490.00 483.41 484.47 488.29 479.35 486.63 C 454.66 481.52 429.55 478.12 405.14 471.84 C 393.17 467.97 385.20 457.75 376.55 449.27 C 386.39 439.49 396.13 429.60 406.06 419.91 C 416.37 433.45 435.74 414.00 422.11 403.83 Z\"\n      />\n    </g>\n  </svg>\n);\n","import { FC, useEffect } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport Message from '../../utils/Message';\nimport { isNotFoundServer, SelectedServer } from '../data';\nimport { NoMenuLayout } from '../../common/NoMenuLayout';\n\ninterface WithSelectedServerProps extends RouteComponentProps<{ serverId: string }> {\n  selectServer: (serverId: string) => void;\n  selectedServer: SelectedServer;\n}\n\nexport function withSelectedServer<T = {}>(WrappedComponent: FC<WithSelectedServerProps & T>, ServerError: FC) {\n  return (props: WithSelectedServerProps & T) => {\n    const { selectServer, selectedServer, match } = props;\n\n    useEffect(() => {\n      selectServer(match.params.serverId);\n    }, [ match.params.serverId ]);\n\n    if (!selectedServer) {\n      return (\n        <NoMenuLayout>\n          <Message loading />\n        </NoMenuLayout>\n      );\n    }\n\n    if (isNotFoundServer(selectedServer)) {\n      return <ServerError />;\n    }\n\n    return <WrappedComponent {...props} />;\n  };\n}\n","import { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport { SimpleCard } from '../utils/SimpleCard';\n\ninterface NotFoundProps {\n  to?: string;\n}\n\nconst NotFound: FC<NotFoundProps> = ({ to = '/', children = 'Home' }) => (\n  <div className=\"home\">\n    <SimpleCard className=\"p-4\">\n      <h2>Oops! We could not find requested route.</h2>\n      <p>\n        Use your browser&apos;s back button to navigate to the page you have previously come from, or just press this\n        button.\n      </p>\n      <br />\n      <Link to={to} className=\"btn btn-outline-primary btn-lg\">{children}</Link>\n    </SimpleCard>\n  </div>\n);\n\nexport default NotFound;\n","import { FC } from 'react';\nimport { ListGroup, ListGroupItem } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport classNames from 'classnames';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faChevronRight as chevronIcon } from '@fortawesome/free-solid-svg-icons';\nimport { ServerWithId } from './data';\nimport './ServersListGroup.scss';\n\ninterface ServersListGroupProps {\n  servers: ServerWithId[];\n  embedded?: boolean;\n}\n\nconst ServerListItem = ({ id, name }: { id: string; name: string }) => (\n  <ListGroupItem tag={Link} to={`/server/${id}`} className=\"servers-list__server-item\">\n    {name}\n    <FontAwesomeIcon icon={chevronIcon} className=\"servers-list__server-item-icon\" />\n  </ListGroupItem>\n);\n\nconst ServersListGroup: FC<ServersListGroupProps> = ({ servers, children, embedded = false }) => (\n  <>\n    {children && <h5 className=\"mb-md-3\">{children}</h5>}\n    {servers.length > 0 && (\n      <ListGroup\n        className={classNames('servers-list__list-group', { 'servers-list__list-group--embedded': embedded })}\n      >\n        {servers.map(({ id, name }) => <ServerListItem key={id} id={id} name={name} />)}\n      </ListGroup>\n    )}\n  </>\n);\n\nexport default ServersListGroup;\n","import { useState, useRef, EffectCallback, DependencyList, useEffect } from 'react';\nimport { useSwipeable as useReactSwipeable } from 'react-swipeable';\nimport { parseQuery, stringifyQuery } from './query';\n\nconst DEFAULT_DELAY = 2000;\n\nexport type StateFlagTimeout = (initialValue?: boolean, delay?: number) => [ boolean, () => void ];\n\nexport const useStateFlagTimeout = (\n  setTimeout: (callback: Function, timeout: number) => number,\n  clearTimeout: (timer: number) => void,\n): StateFlagTimeout => (initialValue = false, delay = DEFAULT_DELAY) => {\n  const [ flag, setFlag ] = useState<boolean>(initialValue);\n  const timeout = useRef<number | undefined>(undefined);\n  const callback = () => {\n    setFlag(!initialValue);\n\n    if (timeout.current) {\n      clearTimeout(timeout.current);\n    }\n\n    timeout.current = setTimeout(() => setFlag(initialValue), delay);\n  };\n\n  return [ flag, callback ];\n};\n\ntype ToggleResult = [ boolean, () => void, () => void, () => void ];\n\nexport const useToggle = (initialValue = false): ToggleResult => {\n  const [ flag, setFlag ] = useState<boolean>(initialValue);\n\n  return [ flag, () => setFlag(!flag), () => setFlag(true), () => setFlag(false) ];\n};\n\nexport const useSwipeable = (showSidebar: () => void, hideSidebar: () => void) => {\n  const swipeMenuIfNoModalExists = (callback: () => void) => (e: any) => {\n    const swippedOnVisitsTable = (e.event.composedPath() as HTMLElement[]).some( // eslint-disable-line @typescript-eslint/no-unsafe-call\n      ({ classList }) => classList?.contains('visits-table'),\n    );\n\n    if (swippedOnVisitsTable || document.querySelector('.modal')) {\n      return;\n    }\n\n    callback();\n  };\n\n  return useReactSwipeable({\n    delta: 40,\n    onSwipedLeft: swipeMenuIfNoModalExists(hideSidebar),\n    onSwipedRight: swipeMenuIfNoModalExists(showSidebar),\n  });\n};\n\nexport const useQueryState = <T>(paramName: string, initialState: T): [ T, (newValue: T) => void ] => {\n  const [ value, setValue ] = useState(initialState);\n  const setValueWithLocation = (value: T) => {\n    const { location, history } = window;\n    const query = parseQuery<any>(location.search);\n\n    query[paramName] = value;\n    history.pushState(null, '', `${location.pathname}?${stringifyQuery(query)}`);\n    setValue(value);\n  };\n\n  return [ value, setValueWithLocation ];\n};\n\nexport const useEffectExceptFirstTime = (callback: EffectCallback, deps: DependencyList): void => {\n  const isFirstLoad = useRef(true);\n\n  useEffect(() => {\n    !isFirstLoad.current && callback();\n    isFirstLoad.current = false;\n  }, deps);\n};\n","import axios from 'axios';\nimport Bottle, { Decorator } from 'bottlejs';\nimport ScrollToTop from '../ScrollToTop';\nimport MainHeader from '../MainHeader';\nimport Home from '../Home';\nimport MenuLayout from '../MenuLayout';\nimport AsideMenu from '../AsideMenu';\nimport ErrorHandler from '../ErrorHandler';\nimport ShlinkVersionsContainer from '../ShlinkVersionsContainer';\nimport { ConnectDecorator } from '../../container/types';\nimport { withoutSelectedServer } from '../../servers/helpers/withoutSelectedServer';\nimport { ImageDownloader } from './ImageDownloader';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator, withRouter: Decorator) => {\n  // Services\n  bottle.constant('window', (global as any).window);\n  bottle.constant('console', global.console);\n  bottle.constant('axios', axios);\n\n  bottle.service('ImageDownloader', ImageDownloader, 'axios', 'window');\n\n  // Components\n  bottle.serviceFactory('ScrollToTop', ScrollToTop);\n  bottle.decorator('ScrollToTop', withRouter);\n\n  bottle.serviceFactory('MainHeader', MainHeader, 'ServersDropdown');\n  bottle.decorator('MainHeader', withRouter);\n\n  bottle.serviceFactory('Home', () => Home);\n  bottle.decorator('Home', withoutSelectedServer);\n  bottle.decorator('Home', withRouter);\n  bottle.decorator('Home', connect([ 'servers' ], [ 'resetSelectedServer' ]));\n\n  bottle.serviceFactory(\n    'MenuLayout',\n    MenuLayout,\n    'TagsList',\n    'ShortUrlsList',\n    'AsideMenu',\n    'CreateShortUrl',\n    'ShortUrlVisits',\n    'TagVisits',\n    'OrphanVisits',\n    'ServerError',\n    'Overview',\n    'EditShortUrl',\n    'ManageDomains',\n  );\n  bottle.decorator('MenuLayout', connect([ 'selectedServer' ], [ 'selectServer' ]));\n  bottle.decorator('MenuLayout', withRouter);\n\n  bottle.serviceFactory('AsideMenu', AsideMenu, 'DeleteServerButton');\n\n  bottle.serviceFactory('ShlinkVersionsContainer', () => ShlinkVersionsContainer);\n  bottle.decorator('ShlinkVersionsContainer', connect([ 'selectedServer' ]));\n\n  bottle.serviceFactory('ErrorHandler', ErrorHandler, 'window', 'console');\n};\n\nexport default provideServices;\n","import { PropsWithChildren, useEffect } from 'react';\nimport { RouteComponentProps } from 'react-router';\n\nconst ScrollToTop = () => ({ location, children }: PropsWithChildren<RouteComponentProps>) => {\n  useEffect(() => {\n    scrollTo(0, 0);\n  }, [ location ]);\n\n  return <>{children}</>;\n};\n\nexport default ScrollToTop;\n","import { Component, ReactNode } from 'react';\nimport { Button } from 'reactstrap';\nimport { SimpleCard } from '../utils/SimpleCard';\n\ninterface ErrorHandlerState {\n  hasError: boolean;\n}\n\nconst ErrorHandler = (\n  { location }: Window,\n  { error }: Console,\n) => class ErrorHandler extends Component<any, ErrorHandlerState> {\n  public constructor(props: object) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  public static getDerivedStateFromError(): ErrorHandlerState {\n    return { hasError: true };\n  }\n\n  public componentDidCatch(e: Error): void {\n    if (process.env.NODE_ENV !== 'development') {\n      error(e);\n    }\n  }\n\n  public render(): ReactNode {\n    if (this.state.hasError) {\n      return (\n        <div className=\"home\">\n          <SimpleCard className=\"p-4\">\n            <h1>Oops! This is awkward :S</h1>\n            <p>It seems that something went wrong. Try refreshing the page or just click this button.</p>\n            <br />\n            <Button outline color=\"primary\" onClick={() => location.reload()}>Take me back</Button>\n          </SimpleCard>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n};\n\nexport default ErrorHandler;\n","import { AxiosInstance } from 'axios';\nimport { saveUrl } from '../../utils/helpers/files';\n\nexport class ImageDownloader {\n  public constructor(private readonly axios: AxiosInstance, private readonly window: Window) {}\n\n  public async saveImage(imgUrl: string, filename: string): Promise<void> {\n    const { data } = await this.axios.get(imgUrl, { responseType: 'blob' });\n    const url = URL.createObjectURL(data);\n\n    saveUrl(this.window, url, filename);\n  }\n}\n","import { omit } from 'ramda';\nimport { SemVer } from '../../utils/helpers/version';\n\nexport interface ServerData {\n  name: string;\n  url: string;\n  apiKey: string;\n}\n\nexport interface ServerWithId extends ServerData {\n  id: string;\n  autoConnect?: boolean;\n}\n\nexport interface ReachableServer extends ServerWithId {\n  version: SemVer;\n  printableVersion: string;\n}\n\nexport interface NonReachableServer extends ServerWithId {\n  serverNotReachable: true;\n}\n\nexport interface NotFoundServer {\n  serverNotFound: true;\n}\n\nexport type RegularServer = ReachableServer | NonReachableServer;\n\nexport type SelectedServer = RegularServer | NotFoundServer | null;\n\nexport type ServersMap = Record<string, ServerWithId>;\n\nexport const hasServerData = (server: SelectedServer | ServerData): server is ServerData =>\n  !!(server as ServerData)?.url && !!(server as ServerData)?.apiKey;\n\nexport const isServerWithId = (server: SelectedServer | ServerWithId): server is ServerWithId =>\n  !!server?.hasOwnProperty('id');\n\nexport const isReachableServer = (server: SelectedServer): server is ReachableServer =>\n  !!server?.hasOwnProperty('version');\n\nexport const isNotFoundServer = (server: SelectedServer): server is NotFoundServer =>\n  !!server?.hasOwnProperty('serverNotFound');\n\nexport const getServerId = (server: SelectedServer) => isServerWithId(server) ? server.id : '';\n\nexport const serverWithIdToServerData = (server: ServerWithId): ServerData =>\n  omit<ServerWithId, 'id' | 'autoConnect'>([ 'id', 'autoConnect' ], server);\n","import Bottle from 'bottlejs';\nimport { useStateFlagTimeout } from '../helpers/hooks';\nimport LocalStorage from './LocalStorage';\nimport ColorGenerator from './ColorGenerator';\n\nconst provideServices = (bottle: Bottle) => {\n  bottle.constant('localStorage', (global as any).localStorage);\n  bottle.service('Storage', LocalStorage, 'localStorage');\n  bottle.service('ColorGenerator', ColorGenerator, 'Storage');\n\n  bottle.constant('setTimeout', global.setTimeout);\n  bottle.constant('clearTimeout', global.clearTimeout);\n  bottle.serviceFactory('useStateFlagTimeout', useStateFlagTimeout, 'setTimeout', 'clearTimeout');\n};\n\nexport default provideServices;\n","const PREFIX = 'shlink';\nconst buildPath = (path: string) => `${PREFIX}.${path}`;\n\nexport default class LocalStorage {\n  public constructor(private readonly localStorage: Storage) {}\n\n  public readonly get = <T>(key: string): T | undefined => {\n    const item = this.localStorage.getItem(buildPath(key));\n\n    return item ? JSON.parse(item) as T : undefined;\n  };\n\n  public readonly set = (key: string, value: any) => this.localStorage.setItem(buildPath(key), JSON.stringify(value));\n}\n","import { rangeOf } from '../utils';\nimport LocalStorage from './LocalStorage';\n\nconst HEX_COLOR_LENGTH = 6;\nconst { floor, random, sqrt, round } = Math;\nconst letters = '0123456789ABCDEF';\nconst buildRandomColor = () => `#${rangeOf(HEX_COLOR_LENGTH, () => letters[floor(random() * letters.length)]).join('')}`;\nconst normalizeKey = (key: string) => key.toLowerCase().trim();\nconst hexColorToRgbArray = (colorHex: string): number[] =>\n  (colorHex.match(/../g) ?? []).map((hex) => parseInt(hex, 16) || 0);\n// HSP by Darel Rex Finley https://alienryderflex.com/hsp.html\nconst perceivedLightness = (r = 0, g = 0, b = 0) => round(sqrt(0.299 * r ** 2 + 0.587 * g ** 2 + 0.114 * b ** 2));\n\nexport default class ColorGenerator {\n  private readonly colors: Record<string, string>;\n  private readonly lights: Record<string, boolean>;\n\n  public constructor(private readonly storage: LocalStorage) {\n    this.colors = this.storage.get<Record<string, string>>('colors') ?? {};\n    this.lights = {};\n  }\n\n  public readonly getColorForKey = (key: string) => {\n    const normalizedKey = normalizeKey(key);\n    const color = this.colors[normalizedKey];\n\n    // If a color has not been set yet, generate a random one and save it\n    if (!color) {\n      return this.setColorForKey(normalizedKey, buildRandomColor());\n    }\n\n    return color;\n  };\n\n  public readonly setColorForKey = (key: string, color: string) => {\n    const normalizedKey = normalizeKey(key);\n\n    this.colors[normalizedKey] = color;\n    this.storage.set('colors', this.colors);\n\n    return color;\n  };\n\n  public readonly isColorLightForKey = (key: string): boolean => {\n    const colorHex = this.getColorForKey(key).substring(1);\n\n    if (!this.lights[colorHex]) {\n      const rgb = hexColorToRgbArray(colorHex);\n\n      this.lights[colorHex] = perceivedLightness(...rgb) >= 128;\n    }\n\n    return this.lights[colorHex];\n  };\n}\n","import { isEmpty, isNil, pipe, range } from 'ramda';\nimport { SyntheticEvent } from 'react';\n\nexport const rangeOf = <T>(size: number, mappingFn: (value: number) => T, startAt = 1): T[] =>\n  range(startAt, size + 1).map(mappingFn);\n\nexport type Empty = null | undefined | '' | never[];\n\nexport const hasValue = <T>(value: T | Empty): value is T => !isNil(value) && !isEmpty(value);\n\nexport const handleEventPreventingDefault = <T>(handler: () => T) => pipe(\n  (e: SyntheticEvent) => e.preventDefault(),\n  handler,\n);\n\nexport type Nullable<T> = {\n  [P in keyof T]: T[P] | null\n};\n\ntype Optional<T> = T | null | undefined;\n\nexport type OptionalString = Optional<string>;\n\nexport type RecursivePartial<T> = {\n  [P in keyof T]?: RecursivePartial<T[P]>;\n};\n\nexport const nonEmptyValueOrNull = <T>(value: T): T | null => isEmpty(value) ? null : value;\n\nexport const capitalize = <T extends string>(value: T): string => `${value.charAt(0).toUpperCase()}${value.slice(1)}`;\n","import { pipe } from 'ramda';\nimport { ExternalLink } from 'react-external-link';\nimport { versionToPrintable, versionToSemVer } from '../utils/helpers/version';\nimport { isReachableServer } from '../servers/data';\nimport { ShlinkVersionsContainerProps } from './ShlinkVersionsContainer';\n\nconst SHLINK_WEB_CLIENT_VERSION = '%_VERSION_%';\nconst normalizeVersion = pipe(versionToSemVer(), versionToPrintable);\n\nexport interface ShlinkVersionsProps extends ShlinkVersionsContainerProps {\n  clientVersion?: string;\n}\n\nconst VersionLink = ({ project, version }: { project: 'shlink' | 'shlink-web-client'; version: string }) => (\n  <ExternalLink href={`https://github.com/shlinkio/${project}/releases/${version}`} className=\"text-muted\">\n    <b>{version}</b>\n  </ExternalLink>\n);\n\nconst ShlinkVersions = ({ selectedServer, clientVersion = SHLINK_WEB_CLIENT_VERSION }: ShlinkVersionsProps) => {\n  const normalizedClientVersion = normalizeVersion(clientVersion);\n\n  return (\n    <small className=\"text-muted\">\n      {isReachableServer(selectedServer) &&\n        <>Server: <VersionLink project=\"shlink\" version={selectedServer.printableVersion} /> - </>\n      }\n      Client: <VersionLink project=\"shlink-web-client\" version={normalizedClientVersion} />\n    </small>\n  );\n};\n\nexport default ShlinkVersions;\n","import classNames from 'classnames';\nimport { isReachableServer, SelectedServer } from '../servers/data';\nimport ShlinkVersions from './ShlinkVersions';\nimport './ShlinkVersionsContainer.scss';\n\nexport interface ShlinkVersionsContainerProps {\n  selectedServer: SelectedServer;\n}\n\nconst ShlinkVersionsContainer = ({ selectedServer }: ShlinkVersionsContainerProps) => {\n  const classes = classNames('text-center', {\n    'shlink-versions-container--with-server': isReachableServer(selectedServer),\n  });\n\n  return (\n    <div className={classes}>\n      <ShlinkVersions selectedServer={selectedServer} />\n    </div>\n  );\n};\n\nexport default ShlinkVersionsContainer;\n","import { faChevronDown as arrowIcon, faCogs as cogsIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { FC, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Collapse, Nav, Navbar, NavbarBrand, NavbarToggler, NavItem, NavLink } from 'reactstrap';\nimport classNames from 'classnames';\nimport { RouteComponentProps } from 'react-router';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { ShlinkLogo } from './img/ShlinkLogo';\nimport './MainHeader.scss';\n\nconst MainHeader = (ServersDropdown: FC) => ({ location }: RouteComponentProps) => {\n  const [ isOpen, toggleOpen, , close ] = useToggle();\n  const { pathname } = location;\n\n  useEffect(close, [ location ]);\n\n  const settingsPath = '/settings';\n  const toggleClass = classNames('main-header__toggle-icon', { 'main-header__toggle-icon--opened': isOpen });\n\n  return (\n    <Navbar color=\"primary\" dark fixed=\"top\" className=\"main-header\" expand=\"md\">\n      <NavbarBrand tag={Link} to=\"/\">\n        <ShlinkLogo className=\"main-header__brand-logo\" color=\"white\" /> Shlink\n      </NavbarBrand>\n\n      <NavbarToggler onClick={toggleOpen}>\n        <FontAwesomeIcon icon={arrowIcon} className={toggleClass} />\n      </NavbarToggler>\n\n      <Collapse navbar isOpen={isOpen}>\n        <Nav navbar className=\"ml-auto\">\n          <NavItem>\n            <NavLink tag={Link} to={settingsPath} active={pathname === settingsPath}>\n              <FontAwesomeIcon icon={cogsIcon} />&nbsp; Settings\n            </NavLink>\n          </NavItem>\n          <ServersDropdown />\n        </Nav>\n      </Collapse>\n    </Navbar>\n  );\n};\n\nexport default MainHeader;\n","import { useEffect } from 'react';\nimport { isEmpty, values } from 'ramda';\nimport { Link, RouteChildrenProps } from 'react-router-dom';\nimport { Card, Row } from 'reactstrap';\nimport { ExternalLink } from 'react-external-link';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faExternalLinkAlt, faPlus } from '@fortawesome/free-solid-svg-icons';\nimport ServersListGroup from '../servers/ServersListGroup';\nimport { ServersMap } from '../servers/data';\nimport { ShlinkLogo } from './img/ShlinkLogo';\nimport './Home.scss';\n\nexport interface HomeProps extends RouteChildrenProps {\n  servers: ServersMap;\n}\n\nconst Home = ({ servers, history }: HomeProps) => {\n  const serversList = values(servers);\n  const hasServers = !isEmpty(serversList);\n\n  useEffect(() => {\n    // Try to redirect to the first server marked as auto-connect\n    const autoConnectServer = serversList.find(({ autoConnect }) => autoConnect);\n\n    autoConnectServer && history.push(`/server/${autoConnectServer.id}`);\n  }, []);\n\n  return (\n    <div className=\"home\">\n      <Card className=\"home__main-card\">\n        <Row noGutters>\n          <div className=\"col-md-5 d-none d-md-block\">\n            <div className=\"home__logo-wrapper\">\n              <div className=\"home__logo\">\n                <ShlinkLogo />\n              </div>\n            </div>\n          </div>\n          <div className=\"col-md-7 home__servers-container\">\n            <div className=\"home__title-wrapper\">\n              <h1 className=\"home__title\">Welcome!</h1>\n            </div>\n            <ServersListGroup embedded servers={serversList}>\n              {!hasServers && (\n                <div className=\"p-4 text-center\">\n                  <p className=\"mb-5\">This application will help you manage your Shlink servers.</p>\n                  <p>\n                    <Link to=\"/server/create\" className=\"btn btn-outline-primary btn-lg mr-2\">\n                      <FontAwesomeIcon icon={faPlus} /> <span className=\"ml-1\">Add a server</span>\n                    </Link>\n                  </p>\n                  <p className=\"mb-0 mt-5\">\n                    <ExternalLink href=\"https://shlink.io/documentation\">\n                      <small>\n                        <span className=\"mr-1\">Learn more about Shlink</span> <FontAwesomeIcon icon={faExternalLinkAlt} />\n                      </small>\n                    </ExternalLink>\n                  </p>\n                </div>\n              )}\n            </ServersListGroup>\n          </div>\n        </Row>\n      </Card>\n    </div>\n  );\n};\n\nexport default Home;\n","import { FC, useEffect } from 'react';\nimport { Redirect, Route, Switch } from 'react-router-dom';\nimport { faBars as burgerIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport classNames from 'classnames';\nimport { withSelectedServer } from '../servers/helpers/withSelectedServer';\nimport { useSwipeable, useToggle } from '../utils/helpers/hooks';\nimport { supportsDomainRedirects, supportsOrphanVisits } from '../utils/helpers/features';\nimport { isReachableServer } from '../servers/data';\nimport NotFound from './NotFound';\nimport { AsideMenuProps } from './AsideMenu';\nimport './MenuLayout.scss';\n\nconst MenuLayout = (\n  TagsList: FC,\n  ShortUrlsList: FC,\n  AsideMenu: FC<AsideMenuProps>,\n  CreateShortUrl: FC,\n  ShortUrlVisits: FC,\n  TagVisits: FC,\n  OrphanVisits: FC,\n  ServerError: FC,\n  Overview: FC,\n  EditShortUrl: FC,\n  ManageDomains: FC,\n) => withSelectedServer(({ location, selectedServer }) => {\n  const [ sidebarVisible, toggleSidebar, showSidebar, hideSidebar ] = useToggle();\n\n  useEffect(() => hideSidebar(), [ location ]);\n\n  if (!isReachableServer(selectedServer)) {\n    return <ServerError />;\n  }\n\n  const addOrphanVisitsRoute = supportsOrphanVisits(selectedServer);\n  const addManageDomainsRoute = supportsDomainRedirects(selectedServer);\n  const burgerClasses = classNames('menu-layout__burger-icon', { 'menu-layout__burger-icon--active': sidebarVisible });\n  const swipeableProps = useSwipeable(showSidebar, hideSidebar);\n\n  return (\n    <>\n      <FontAwesomeIcon icon={burgerIcon} className={burgerClasses} onClick={toggleSidebar} />\n\n      <div {...swipeableProps} className=\"menu-layout__swipeable\">\n        <div className=\"menu-layout__swipeable-inner\">\n          <AsideMenu selectedServer={selectedServer} showOnMobile={sidebarVisible} />\n          <div className=\"menu-layout__container\" onClick={() => hideSidebar()}>\n            <div className=\"container-xl\">\n              <Switch>\n                <Redirect exact from=\"/server/:serverId\" to=\"/server/:serverId/overview\" />\n                <Route exact path=\"/server/:serverId/overview\" component={Overview} />\n                <Route exact path=\"/server/:serverId/list-short-urls/:page\" component={ShortUrlsList} />\n                <Route exact path=\"/server/:serverId/create-short-url\" component={CreateShortUrl} />\n                <Route path=\"/server/:serverId/short-code/:shortCode/visits\" component={ShortUrlVisits} />\n                <Route path=\"/server/:serverId/short-code/:shortCode/edit\" component={EditShortUrl} />\n                <Route path=\"/server/:serverId/tag/:tag/visits\" component={TagVisits} />\n                {addOrphanVisitsRoute && <Route path=\"/server/:serverId/orphan-visits\" component={OrphanVisits} />}\n                <Route exact path=\"/server/:serverId/manage-tags\" component={TagsList} />\n                {addManageDomainsRoute && <Route exact path=\"/server/:serverId/manage-domains\" component={ManageDomains} />}\n                <Route\n                  render={() => <NotFound to={`/server/${selectedServer.id}/list-short-urls/1`}>List short URLs</NotFound>}\n                />\n              </Switch>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}, ServerError);\n\nexport default MenuLayout;\n","import {\n  faList as listIcon,\n  faLink as createIcon,\n  faTags as tagsIcon,\n  faPen as editIcon,\n  faHome as overviewIcon,\n  faGlobe as domainsIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { FC } from 'react';\nimport { NavLink, NavLinkProps } from 'react-router-dom';\nimport classNames from 'classnames';\nimport { Location } from 'history';\nimport { DeleteServerButtonProps } from '../servers/DeleteServerButton';\nimport { isServerWithId, SelectedServer } from '../servers/data';\nimport { supportsDomainRedirects } from '../utils/helpers/features';\nimport './AsideMenu.scss';\n\nexport interface AsideMenuProps {\n  selectedServer: SelectedServer;\n  className?: string;\n  showOnMobile?: boolean;\n}\n\ninterface AsideMenuItemProps extends NavLinkProps {\n  to: string;\n}\n\nconst AsideMenuItem: FC<AsideMenuItemProps> = ({ children, to, className, ...rest }) => (\n  <NavLink\n    className={classNames('aside-menu__item', className)}\n    activeClassName=\"aside-menu__item--selected\"\n    to={to}\n    {...rest}\n  >\n    {children}\n  </NavLink>\n);\n\nconst AsideMenu = (DeleteServerButton: FC<DeleteServerButtonProps>) => (\n  { selectedServer, showOnMobile = false }: AsideMenuProps,\n) => {\n  const hasId = isServerWithId(selectedServer);\n  const serverId = hasId ? selectedServer.id : '';\n  const addManageDomainsLink = supportsDomainRedirects(selectedServer);\n  const asideClass = classNames('aside-menu', {\n    'aside-menu--hidden': !showOnMobile,\n  });\n  const shortUrlsIsActive = (_: null, location: Location) => location.pathname.match('/list-short-urls') !== null;\n  const buildPath = (suffix: string) => `/server/${serverId}${suffix}`;\n\n  return (\n    <aside className={asideClass}>\n      <nav className=\"nav flex-column aside-menu__nav\">\n        <AsideMenuItem to={buildPath('/overview')}>\n          <FontAwesomeIcon fixedWidth icon={overviewIcon} />\n          <span className=\"aside-menu__item-text\">Overview</span>\n        </AsideMenuItem>\n        <AsideMenuItem to={buildPath('/list-short-urls/1')} isActive={shortUrlsIsActive}>\n          <FontAwesomeIcon fixedWidth icon={listIcon} />\n          <span className=\"aside-menu__item-text\">List short URLs</span>\n        </AsideMenuItem>\n        <AsideMenuItem to={buildPath('/create-short-url')}>\n          <FontAwesomeIcon fixedWidth icon={createIcon} flip=\"horizontal\" />\n          <span className=\"aside-menu__item-text\">Create short URL</span>\n        </AsideMenuItem>\n        <AsideMenuItem to={buildPath('/manage-tags')}>\n          <FontAwesomeIcon fixedWidth icon={tagsIcon} />\n          <span className=\"aside-menu__item-text\">Manage tags</span>\n        </AsideMenuItem>\n        {addManageDomainsLink && (\n          <AsideMenuItem to={buildPath('/manage-domains')}>\n            <FontAwesomeIcon fixedWidth icon={domainsIcon} />\n            <span className=\"aside-menu__item-text\">Manage domains</span>\n          </AsideMenuItem>\n        )}\n        <AsideMenuItem to={buildPath('/edit')} className=\"aside-menu__item--push\">\n          <FontAwesomeIcon fixedWidth icon={editIcon} />\n          <span className=\"aside-menu__item-text\">Edit this server</span>\n        </AsideMenuItem>\n        {hasId && (\n          <DeleteServerButton\n            className=\"aside-menu__item aside-menu__item--danger\"\n            textClassName=\"aside-menu__item-text\"\n            server={selectedServer}\n          />\n        )}\n      </nav>\n    </aside>\n  );\n};\n\nexport default AsideMenu;\n","import { CardProps } from 'reactstrap/lib/Card';\nimport { Card, CardBody, CardHeader } from 'reactstrap';\nimport { ReactNode } from 'react';\n\ninterface SimpleCardProps extends Omit<CardProps, 'title'> {\n  title?: ReactNode;\n  bodyClassName?: string;\n}\n\nexport const SimpleCard = ({ title, children, bodyClassName, ...rest }: SimpleCardProps) => (\n  <Card {...rest}>\n    {title && <CardHeader>{title}</CardHeader>}\n    <CardBody className={bodyClassName}>{children}</CardBody>\n  </Card>\n);\n","import { isReachableServer, SelectedServer } from '../../servers/data';\nimport { versionMatch, Versions } from './version';\n\nconst serverMatchesVersions = (versions: Versions) => (selectedServer: SelectedServer): boolean =>\n  isReachableServer(selectedServer) && versionMatch(selectedServer.version, versions);\n\nexport const supportsQrCodeSizeInQuery = serverMatchesVersions({ minVersion: '2.5.0' });\n\nexport const supportsShortUrlTitle = serverMatchesVersions({ minVersion: '2.6.0' });\n\nexport const supportsOrphanVisits = supportsShortUrlTitle;\n\nexport const supportsQrCodeMargin = supportsShortUrlTitle;\n\nexport const supportsTagsInPatch = supportsShortUrlTitle;\n\nexport const supportsBotVisits = serverMatchesVersions({ minVersion: '2.7.0' });\n\nexport const supportsCrawlableVisits = supportsBotVisits;\n\nexport const supportsQrErrorCorrection = serverMatchesVersions({ minVersion: '2.8.0' });\n\nexport const supportsDomainRedirects = supportsQrErrorCorrection;\n\nexport const supportsForwardQuery = serverMatchesVersions({ minVersion: '2.9.0' });\n\nexport const supportsDefaultDomainRedirectsEdition = serverMatchesVersions({ minVersion: '2.10.0' });\n","export const MAIN_COLOR = '#4696e5';\n\nexport const MAIN_COLOR_ALPHA = 'rgba(70, 150, 229, 0.4)';\n\nexport const HIGHLIGHTED_COLOR = '#f77f28';\n\nexport const HIGHLIGHTED_COLOR_ALPHA = 'rgba(247, 127, 40, 0.4)';\n\nexport const PRIMARY_LIGHT_COLOR = 'white';\n\nexport const PRIMARY_DARK_COLOR = '#161b22';\n\nexport type Theme = 'dark' | 'light';\n\nexport const changeThemeInMarkup = (theme: Theme) => {\n  const html = document.getElementsByTagName('html');\n\n  html?.[0]?.setAttribute('data-theme', theme);\n};\n\nexport const isDarkThemeEnabled = (): boolean => {\n  const html = document.getElementsByTagName('html');\n\n  return html?.[0]?.getAttribute('data-theme') === 'dark';\n};\n","import qs from 'qs';\n\nexport const parseQuery = <T>(search: string) => qs.parse(search, { ignoreQueryPrefix: true }) as unknown as T;\n\nexport const stringifyQuery = (query: any): string => qs.stringify(query, { arrayFormat: 'brackets' });\n","import { FC } from 'react';\nimport { Card, Row } from 'reactstrap';\nimport classNames from 'classnames';\nimport { faCircleNotch as preloader } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\ntype MessageType = 'default' | 'error';\n\nconst getClassForType = (type: MessageType) => {\n  const map: Record<MessageType, string> = {\n    error: 'border-danger',\n    default: '',\n  };\n\n  return map[type];\n};\nconst getTextClassForType = (type: MessageType) => {\n  const map: Record<MessageType, string> = {\n    error: 'text-danger',\n    default: 'text-muted',\n  };\n\n  return map[type];\n};\n\nexport interface MessageProps {\n  className?: string;\n  loading?: boolean;\n  fullWidth?: boolean;\n  type?: MessageType;\n}\n\nconst Message: FC<MessageProps> = ({ className, children, loading = false, type = 'default', fullWidth = false }) => {\n  const classes = classNames({\n    'col-md-12': fullWidth,\n    'col-md-10 offset-md-1': !fullWidth,\n  });\n\n  return (\n    <Row noGutters className={className}>\n      <div className={classes}>\n        <Card className={getClassForType(type)} body>\n          <h3 className={classNames('text-center mb-0', getTextClassForType(type))}>\n            {loading && <FontAwesomeIcon icon={preloader} spin />}\n            {loading && <span className=\"ml-2\">{children ?? 'Loading...'}</span>}\n            {!loading && children}\n          </h3>\n        </Card>\n      </div>\n    </Row>\n  );\n};\n\nexport default Message;\n","import { useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch as searchIcon } from '@fortawesome/free-solid-svg-icons';\nimport classNames from 'classnames';\nimport './SearchField.scss';\n\nconst DEFAULT_SEARCH_INTERVAL = 500;\nlet timer: NodeJS.Timeout | null;\n\ninterface SearchFieldProps {\n  onChange: (value: string) => void;\n  className?: string;\n  large?: boolean;\n  noBorder?: boolean;\n  initialValue?: string;\n}\n\nconst SearchField = ({ onChange, className, large = true, noBorder = false, initialValue = '' }: SearchFieldProps) => {\n  const [ searchTerm, setSearchTerm ] = useState(initialValue);\n\n  const resetTimer = () => {\n    timer && clearTimeout(timer);\n    timer = null;\n  };\n  const searchTermChanged = (newSearchTerm: string, timeout = DEFAULT_SEARCH_INTERVAL) => {\n    setSearchTerm(newSearchTerm);\n\n    resetTimer();\n\n    timer = setTimeout(() => {\n      onChange(newSearchTerm);\n      resetTimer();\n    }, timeout);\n  };\n\n  return (\n    <div className={classNames('search-field', className)}>\n      <input\n        type=\"text\"\n        className={classNames('form-control search-field__input', {\n          'form-control-lg': large,\n          'search-field__input--no-border': noBorder,\n        })}\n        placeholder=\"Search...\"\n        value={searchTerm}\n        onChange={(e) => searchTermChanged(e.target.value)}\n      />\n      <FontAwesomeIcon icon={searchIcon} className=\"search-field__icon\" />\n      <div\n        className=\"close search-field__close\"\n        hidden={searchTerm === ''}\n        id=\"search-field__close\"\n        onClick={() => searchTermChanged('', 0)}\n      >\n        &times;\n      </div>\n    </div>\n  );\n};\n\nexport default SearchField;\n","export type OrderDir = 'ASC' | 'DESC' | undefined;\n\nexport interface Order<Fields> {\n  field?: Fields;\n  dir?: OrderDir;\n}\n\nexport const determineOrderDir = <T extends string = string>(\n  currentField: T,\n  newField?: T,\n  currentOrderDir?: OrderDir,\n): OrderDir => {\n  if (currentField !== newField) {\n    return 'ASC';\n  }\n\n  const newOrderMap: Record<'ASC' | 'DESC', OrderDir> = {\n    ASC: 'DESC',\n    DESC: undefined,\n  };\n\n  return currentOrderDir ? newOrderMap[currentOrderDir] : 'ASC';\n};\n\nexport const sortList = <List>(list: List[], { field, dir }: Order<Partial<keyof List>>) => !field || !dir\n  ? list\n  : list.sort((a, b) => {\n    const greaterThan = dir === 'ASC' ? 1 : -1;\n    const smallerThan = dir === 'ASC' ? -1 : 1;\n\n    return a[field] > b[field] ? greaterThan : smallerThan;\n  });\n\nexport const orderToString = <T>(order: Order<T>): string | undefined =>\n  order.dir ? `${order.field}-${order.dir}` : undefined;\n\nexport const stringToOrder = <T>(order: string): Order<T> => {\n  const [ field, dir ] = order.split('-') as [ T | undefined, OrderDir | undefined ];\n\n  return { field, dir };\n};\n","import { isEmpty, isNil, reject } from 'ramda';\nimport { AxiosInstance, AxiosResponse, Method } from 'axios';\nimport { ShortUrl, ShortUrlData } from '../../short-urls/data';\nimport { OptionalString } from '../../utils/utils';\nimport {\n  ShlinkHealth,\n  ShlinkMercureInfo,\n  ShlinkShortUrlsResponse,\n  ShlinkTags,\n  ShlinkTagsResponse,\n  ShlinkVisits,\n  ShlinkVisitsParams,\n  ShlinkShortUrlData,\n  ShlinkDomainsResponse,\n  ShlinkVisitsOverview,\n  ShlinkEditDomainRedirects,\n  ShlinkDomainRedirects,\n  ShlinkShortUrlsListParams,\n  ShlinkShortUrlsListNormalizedParams,\n} from '../types';\nimport { stringifyQuery } from '../../utils/helpers/query';\nimport { orderToString } from '../../utils/helpers/ordering';\n\nconst buildShlinkBaseUrl = (url: string) => url ? `${url}/rest/v2` : '';\nconst rejectNilProps = reject(isNil);\nconst normalizeOrderByInParams = (params: ShlinkShortUrlsListParams): ShlinkShortUrlsListNormalizedParams => {\n  const { orderBy = {}, ...rest } = params;\n\n  return { ...rest, orderBy: orderToString(orderBy) };\n};\n\nexport default class ShlinkApiClient {\n  public constructor(\n    private readonly axios: AxiosInstance,\n    private readonly baseUrl: string,\n    private readonly apiKey: string,\n  ) {\n  }\n\n  public readonly listShortUrls = async (params: ShlinkShortUrlsListParams = {}): Promise<ShlinkShortUrlsResponse> =>\n    this.performRequest<{ shortUrls: ShlinkShortUrlsResponse }>('/short-urls', 'GET', normalizeOrderByInParams(params))\n      .then(({ data }) => data.shortUrls);\n\n  public readonly createShortUrl = async (options: ShortUrlData): Promise<ShortUrl> => {\n    const filteredOptions = reject((value) => isEmpty(value) || isNil(value), options as any);\n\n    return this.performRequest<ShortUrl>('/short-urls', 'POST', {}, filteredOptions)\n      .then((resp) => resp.data);\n  };\n\n  public readonly getShortUrlVisits = async (shortCode: string, query?: ShlinkVisitsParams): Promise<ShlinkVisits> =>\n    this.performRequest<{ visits: ShlinkVisits }>(`/short-urls/${shortCode}/visits`, 'GET', query)\n      .then(({ data }) => data.visits);\n\n  public readonly getTagVisits = async (tag: string, query?: Omit<ShlinkVisitsParams, 'domain'>): Promise<ShlinkVisits> =>\n    this.performRequest<{ visits: ShlinkVisits }>(`/tags/${tag}/visits`, 'GET', query)\n      .then(({ data }) => data.visits);\n\n  public readonly getOrphanVisits = async (query?: Omit<ShlinkVisitsParams, 'domain'>): Promise<ShlinkVisits> =>\n    this.performRequest<{ visits: ShlinkVisits }>('/visits/orphan', 'GET', query)\n      .then(({ data }) => data.visits);\n\n  public readonly getVisitsOverview = async (): Promise<ShlinkVisitsOverview> =>\n    this.performRequest<{ visits: ShlinkVisitsOverview }>('/visits', 'GET')\n      .then(({ data }) => data.visits);\n\n  public readonly getShortUrl = async (shortCode: string, domain?: OptionalString): Promise<ShortUrl> =>\n    this.performRequest<ShortUrl>(`/short-urls/${shortCode}`, 'GET', { domain })\n      .then(({ data }) => data);\n\n  public readonly deleteShortUrl = async (shortCode: string, domain?: OptionalString): Promise<void> =>\n    this.performRequest(`/short-urls/${shortCode}`, 'DELETE', { domain })\n      .then(() => {});\n\n  // eslint-disable-next-line valid-jsdoc\n  /**\n   * @deprecated. If using Shlink 2.6.0 or greater, use updateShortUrl instead\n   */\n  public readonly updateShortUrlTags = async (\n    shortCode: string,\n    domain: OptionalString,\n    tags: string[],\n  ): Promise<string[]> =>\n    this.performRequest<{ tags: string[] }>(`/short-urls/${shortCode}/tags`, 'PUT', { domain }, { tags })\n      .then(({ data }) => data.tags);\n\n  public readonly updateShortUrl = async (\n    shortCode: string,\n    domain: OptionalString,\n    data: ShlinkShortUrlData,\n  ): Promise<ShortUrl> =>\n    this.performRequest<ShortUrl>(`/short-urls/${shortCode}`, 'PATCH', { domain }, data)\n      .then(({ data }) => data);\n\n  public readonly listTags = async (): Promise<ShlinkTags> =>\n    this.performRequest<{ tags: ShlinkTagsResponse }>('/tags', 'GET', { withStats: 'true' })\n      .then((resp) => resp.data.tags)\n      .then(({ data, stats }) => ({ tags: data, stats }));\n\n  public readonly deleteTags = async (tags: string[]): Promise<{ tags: string[] }> =>\n    this.performRequest('/tags', 'DELETE', { tags })\n      .then(() => ({ tags }));\n\n  public readonly editTag = async (oldName: string, newName: string): Promise<{ oldName: string; newName: string }> =>\n    this.performRequest('/tags', 'PUT', {}, { oldName, newName })\n      .then(() => ({ oldName, newName }));\n\n  public readonly health = async (): Promise<ShlinkHealth> =>\n    this.performRequest<ShlinkHealth>('/health', 'GET')\n      .then((resp) => resp.data);\n\n  public readonly mercureInfo = async (): Promise<ShlinkMercureInfo> =>\n    this.performRequest<ShlinkMercureInfo>('/mercure-info', 'GET')\n      .then((resp) => resp.data);\n\n  public readonly listDomains = async (): Promise<ShlinkDomainsResponse> =>\n    this.performRequest<{ domains: ShlinkDomainsResponse }>('/domains', 'GET').then(({ data }) => data.domains);\n\n  public readonly editDomainRedirects = async (\n    domainRedirects: ShlinkEditDomainRedirects,\n  ): Promise<ShlinkDomainRedirects> =>\n    this.performRequest<ShlinkDomainRedirects>('/domains/redirects', 'PATCH', {}, domainRedirects).then(({ data }) => data);\n\n  private readonly performRequest = async <T>(url: string, method: Method = 'GET', query = {}, body = {}): Promise<AxiosResponse<T>> =>\n    this.axios({\n      method,\n      url: `${buildShlinkBaseUrl(this.baseUrl)}${url}`,\n      headers: { 'X-Api-Key': this.apiKey },\n      params: rejectNilProps(query),\n      data: body,\n      paramsSerializer: stringifyQuery,\n    });\n}\n","import { AxiosInstance } from 'axios';\nimport { prop } from 'ramda';\nimport { hasServerData, SelectedServer, ServerWithId } from '../../servers/data';\nimport { GetState } from '../../container/types';\nimport ShlinkApiClient from './ShlinkApiClient';\n\nconst apiClients: Record<string, ShlinkApiClient> = {};\n\nconst isGetState = (getStateOrSelectedServer: GetState | ServerWithId): getStateOrSelectedServer is GetState =>\n  typeof getStateOrSelectedServer === 'function';\nconst getSelectedServerFromState = (getState: GetState): SelectedServer => prop('selectedServer', getState());\n\nexport type ShlinkApiClientBuilder = (getStateOrSelectedServer: GetState | ServerWithId) => ShlinkApiClient;\n\nconst buildShlinkApiClient = (axios: AxiosInstance): ShlinkApiClientBuilder => (\n  getStateOrSelectedServer: GetState | ServerWithId,\n) => {\n  const server = isGetState(getStateOrSelectedServer)\n    ? getSelectedServerFromState(getStateOrSelectedServer)\n    : getStateOrSelectedServer;\n\n  if (!hasServerData(server)) {\n    throw new Error('There\\'s no selected server or it is not found');\n  }\n\n  const { url, apiKey } = server;\n  const clientKey = `${url}_${apiKey}`;\n\n  if (!apiClients[clientKey]) {\n    apiClients[clientKey] = new ShlinkApiClient(axios, url, apiKey);\n  }\n\n  return apiClients[clientKey];\n};\n\nexport default buildShlinkApiClient;\n","import Bottle from 'bottlejs';\nimport buildShlinkApiClient from './ShlinkApiClientBuilder';\n\nconst provideServices = (bottle: Bottle) => {\n  bottle.serviceFactory('buildShlinkApiClient', buildShlinkApiClient, 'axios');\n};\n\nexport default provideServices;\n","import { FC, MouseEventHandler } from 'react';\nimport classNames from 'classnames';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport './Tag.scss';\n\ninterface TagProps {\n  colorGenerator: ColorGenerator;\n  text: string;\n  className?: string;\n  clearable?: boolean;\n  onClick?: MouseEventHandler;\n  onClose?: MouseEventHandler;\n}\n\nconst Tag: FC<TagProps> = ({ text, children, clearable, className = '', colorGenerator, onClick, onClose }) => (\n  <span\n    className={classNames('badge tag', className, { 'tag--light-bg': colorGenerator.isColorLightForKey(text) })}\n    style={{ backgroundColor: colorGenerator.getColorForKey(text), cursor: clearable || !onClick ? 'auto' : 'pointer' }}\n    onClick={onClick}\n  >\n    {children ?? text}\n    {clearable && <span className=\"close tag__close-selected-tag\" onClick={onClose}>&times;</span>}\n  </span>\n);\n\nexport default Tag;\n","import { FC } from 'react';\nimport { Dropdown, DropdownMenu, DropdownToggle } from 'reactstrap';\nimport { useToggle } from './helpers/hooks';\nimport './DropdownBtn.scss';\n\nexport interface DropdownBtnProps {\n  text: string;\n  disabled?: boolean;\n  className?: string;\n  dropdownClassName?: string;\n  right?: boolean;\n  minWidth?: number;\n}\n\nexport const DropdownBtn: FC<DropdownBtnProps> = (\n  { text, disabled = false, className = '', children, dropdownClassName, right = false, minWidth },\n) => {\n  const [ isOpen, toggle ] = useToggle();\n  const toggleClasses = `dropdown-btn__toggle btn-block ${className}`;\n  const style = { minWidth: minWidth && `${minWidth}px` };\n\n  return (\n    <Dropdown isOpen={isOpen} toggle={toggle} disabled={disabled} className={dropdownClassName}>\n      <DropdownToggle caret className={toggleClasses} color=\"primary\">{text}</DropdownToggle>\n      <DropdownMenu className=\"w-100\" right={right} style={style}>{children}</DropdownMenu>\n    </Dropdown>\n  );\n};\n","import { format, formatISO, isBefore, isEqual, isWithinInterval, parse, parseISO as stdParseISO } from 'date-fns';\nimport { OptionalString } from '../utils';\n\nexport type DateOrString = Date | string;\n\ntype NullableDate = DateOrString | null;\n\nexport const isDateObject = (date: DateOrString): date is Date => typeof date !== 'string';\n\nconst formatDateFromFormat = (date?: NullableDate, theFormat?: string): OptionalString => {\n  if (!date || !isDateObject(date)) {\n    return date;\n  }\n\n  return theFormat ? format(date, theFormat) : formatISO(date);\n};\n\nexport const formatDate = (format = 'yyyy-MM-dd') => (date?: NullableDate) => formatDateFromFormat(date, format);\n\nexport const formatIsoDate = (date?: NullableDate) => formatDateFromFormat(date, undefined);\n\nexport const formatInternational = formatDate();\n\nexport const parseDate = (date: string, format: string) => parse(date, format, new Date());\n\nexport const parseISO = (date: DateOrString): Date => isDateObject(date) ? date : stdParseISO(date);\n\nexport const isBetween = (date: DateOrString, start?: DateOrString, end?: DateOrString): boolean => {\n  try {\n    return isWithinInterval(parseISO(date), { start: parseISO(start ?? date), end: parseISO(end ?? date) });\n  } catch (e) {\n    return false;\n  }\n};\n\nexport const isBeforeOrEqual = (date: Date | number, dateToCompare: Date | number) =>\n  isEqual(date, dateToCompare) || isBefore(date, dateToCompare);\n","import { subDays, startOfDay, endOfDay } from 'date-fns';\nimport { cond, filter, isEmpty, T } from 'ramda';\nimport { DateOrString, formatInternational, isBeforeOrEqual, parseISO } from '../../helpers/date';\n\nexport interface DateRange {\n  startDate?: Date | null;\n  endDate?: Date | null;\n}\n\nexport type DateInterval = 'all' | 'today' | 'yesterday' | 'last7Days' | 'last30Days' | 'last90Days' | 'last180Days' | 'last365Days';\n\nexport const dateRangeIsEmpty = (dateRange?: DateRange): boolean => dateRange === undefined\n  || isEmpty(filter(Boolean, dateRange as any));\n\nexport const rangeIsInterval = (range?: DateRange | DateInterval): range is DateInterval =>\n  typeof range === 'string';\n\nconst INTERVAL_TO_STRING_MAP: Record<DateInterval, string | undefined> = {\n  today: 'Today',\n  yesterday: 'Yesterday',\n  last7Days: 'Last 7 days',\n  last30Days: 'Last 30 days',\n  last90Days: 'Last 90 days',\n  last180Days: 'Last 180 days',\n  last365Days: 'Last 365 days',\n  all: undefined,\n};\n\nexport const DATE_INTERVALS = Object.keys(INTERVAL_TO_STRING_MAP).filter((value) => value !== 'all') as DateInterval[];\n\nconst dateRangeToString = (range?: DateRange): string | undefined => {\n  if (!range || dateRangeIsEmpty(range)) {\n    return undefined;\n  }\n\n  if (range.startDate && !range.endDate) {\n    return `Since ${formatInternational(range.startDate)}`;\n  }\n\n  if (!range.startDate && range.endDate) {\n    return `Until ${formatInternational(range.endDate)}`;\n  }\n\n  return `${formatInternational(range.startDate)} - ${formatInternational(range.endDate)}`;\n};\n\nexport const rangeOrIntervalToString = (range?: DateRange | DateInterval): string | undefined => {\n  if (!range || range === 'all') {\n    return undefined;\n  }\n\n  if (!rangeIsInterval(range)) {\n    return dateRangeToString(range);\n  }\n\n  return INTERVAL_TO_STRING_MAP[range];\n};\n\nconst startOfDaysAgo = (daysAgo: number) => startOfDay(subDays(new Date(), daysAgo));\nconst endingToday = (startDate: Date): DateRange => ({ startDate, endDate: endOfDay(new Date()) });\n\nexport const intervalToDateRange = (dateInterval?: DateInterval): DateRange => {\n  if (!dateInterval || dateInterval === 'all') {\n    return {};\n  }\n\n  switch (dateInterval) {\n    case 'today':\n      return endingToday(startOfDay(new Date()));\n    case 'yesterday':\n      return { startDate: startOfDaysAgo(1), endDate: endOfDay(subDays(new Date(), 1)) };\n    case 'last7Days':\n      return endingToday(startOfDaysAgo(7));\n    case 'last30Days':\n      return endingToday(startOfDaysAgo(30));\n    case 'last90Days':\n      return endingToday(startOfDaysAgo(90));\n    case 'last180Days':\n      return endingToday(startOfDaysAgo(180));\n    case 'last365Days':\n      return endingToday(startOfDaysAgo(365));\n  }\n\n  return {};\n};\n\nexport const dateToMatchingInterval = (date: DateOrString): DateInterval => {\n  const theDate: Date = parseISO(date);\n\n  return cond<never, DateInterval>([\n    [ () => isBeforeOrEqual(startOfDay(new Date()), theDate), () => 'today' ],\n    [ () => isBeforeOrEqual(startOfDaysAgo(1), theDate), () => 'yesterday' ],\n    [ () => isBeforeOrEqual(startOfDaysAgo(7), theDate), () => 'last7Days' ],\n    [ () => isBeforeOrEqual(startOfDaysAgo(30), theDate), () => 'last30Days' ],\n    [ () => isBeforeOrEqual(startOfDaysAgo(90), theDate), () => 'last90Days' ],\n    [ () => isBeforeOrEqual(startOfDaysAgo(180), theDate), () => 'last180Days' ],\n    [ () => isBeforeOrEqual(startOfDaysAgo(365), theDate), () => 'last365Days' ],\n    [ T, () => 'all' ],\n  ])();\n};\n","import { useRef } from 'react';\nimport { isNil } from 'ramda';\nimport DatePicker, { ReactDatePickerProps } from 'react-datepicker';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCalendarAlt as calendarIcon } from '@fortawesome/free-regular-svg-icons';\nimport classNames from 'classnames';\nimport './DateInput.scss';\n\nexport type DateInputProps = ReactDatePickerProps;\n\nconst DateInput = (props: DateInputProps) => {\n  const { className, isClearable, selected } = props;\n  const showCalendarIcon = !isClearable || isNil(selected);\n  const ref = useRef<{ input: HTMLInputElement }>();\n\n  return (\n    <div className=\"date-input-container\">\n      <DatePicker\n        {...props}\n        dateFormat=\"yyyy-MM-dd\"\n        className={classNames('date-input-container__input form-control', className)}\n        // @ts-expect-error The DatePicker type definition is wrong. It has a ref prop\n        ref={ref}\n      />\n      {showCalendarIcon && (\n        <FontAwesomeIcon\n          icon={calendarIcon}\n          className=\"date-input-container__icon\"\n          onClick={() => ref.current?.input.focus()}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default DateInput;\n","import DateInput from '../DateInput';\nimport { DateRange } from './types';\n\ninterface DateRangeRowProps extends DateRange {\n  onStartDateChange: (date: Date | null) => void;\n  onEndDateChange: (date: Date | null) => void;\n  disabled?: boolean;\n}\n\nconst DateRangeRow = (\n  { startDate = null, endDate = null, disabled = false, onStartDateChange, onEndDateChange }: DateRangeRowProps,\n) => (\n  <div className=\"row\">\n    <div className=\"col-md-6\">\n      <DateInput\n        selected={startDate}\n        placeholderText=\"Since...\"\n        isClearable\n        maxDate={endDate ?? undefined}\n        disabled={disabled}\n        onChange={onStartDateChange}\n      />\n    </div>\n    <div className=\"col-md-6\">\n      <DateInput\n        className=\"mt-2 mt-md-0\"\n        selected={endDate}\n        placeholderText=\"Until...\"\n        isClearable\n        minDate={startDate ?? undefined}\n        disabled={disabled}\n        onChange={onEndDateChange}\n      />\n    </div>\n  </div>\n);\n\nexport default DateRangeRow;\n","import { DropdownItem } from 'reactstrap';\nimport { FC } from 'react';\nimport { DATE_INTERVALS, DateInterval, rangeOrIntervalToString } from './types';\n\nexport interface DateIntervalDropdownProps {\n  active?: DateInterval;\n  allText: string;\n  onChange: (interval: DateInterval) => void;\n}\n\nexport const DateIntervalDropdownItems: FC<DateIntervalDropdownProps> = ({ active, allText, onChange }) => (\n  <>\n    <DropdownItem active={active === 'all'} onClick={() => onChange('all')}>\n      {allText}\n    </DropdownItem>\n    <DropdownItem divider />\n    {DATE_INTERVALS.map(\n      (interval) => (\n        <DropdownItem key={interval} active={active === interval} onClick={() => onChange(interval)}>\n          {rangeOrIntervalToString(interval)}\n        </DropdownItem>\n      ),\n    )}\n  </>\n);\n","import { useState } from 'react';\nimport { DropdownItem } from 'reactstrap';\nimport { DropdownBtn } from '../DropdownBtn';\nimport { useEffectExceptFirstTime } from '../helpers/hooks';\nimport {\n  DateInterval,\n  DateRange,\n  rangeOrIntervalToString,\n  intervalToDateRange,\n  rangeIsInterval,\n  dateRangeIsEmpty,\n} from './types';\nimport DateRangeRow from './DateRangeRow';\nimport { DateIntervalDropdownItems } from './DateIntervalDropdownItems';\n\nexport interface DateRangeSelectorProps {\n  initialDateRange?: DateInterval | DateRange;\n  disabled?: boolean;\n  onDatesChange: (dateRange: DateRange) => void;\n  defaultText: string;\n  updatable?: boolean;\n}\n\nexport const DateRangeSelector = (\n  { onDatesChange, initialDateRange, defaultText, disabled, updatable = false }: DateRangeSelectorProps,\n) => {\n  const initialIntervalIsRange = rangeIsInterval(initialDateRange);\n  const [ activeInterval, setActiveInterval ] = useState(initialIntervalIsRange ? initialDateRange : undefined);\n  const [ activeDateRange, setActiveDateRange ] = useState(initialIntervalIsRange ? undefined : initialDateRange);\n\n  const updateDateRange = (dateRange: DateRange) => {\n    setActiveInterval(dateRangeIsEmpty(dateRange) ? 'all' : undefined);\n    setActiveDateRange(dateRange);\n    onDatesChange(dateRange);\n  };\n  const updateInterval = (dateInterval: DateInterval) => {\n    setActiveInterval(dateInterval);\n    setActiveDateRange(undefined);\n    onDatesChange(intervalToDateRange(dateInterval));\n  };\n\n  updatable && useEffectExceptFirstTime(() => {\n    const isDateInterval = rangeIsInterval(initialDateRange);\n\n    isDateInterval && updateInterval(initialDateRange);\n    initialDateRange && !isDateInterval && updateDateRange(initialDateRange);\n  }, [ initialDateRange ]);\n\n  return (\n    <DropdownBtn disabled={disabled} text={rangeOrIntervalToString(activeInterval ?? activeDateRange) ?? defaultText}>\n      <DateIntervalDropdownItems allText={defaultText} active={activeInterval} onChange={updateInterval} />\n      <DropdownItem divider />\n      <DropdownItem header>Custom:</DropdownItem>\n      <DropdownItem text>\n        <DateRangeRow\n          {...activeDateRange}\n          onStartDateChange={(startDate) => updateDateRange({ ...activeDateRange, startDate })}\n          onEndDateChange={(endDate) => updateDateRange({ ...activeDateRange, endDate })}\n        />\n      </DropdownItem>\n    </DropdownBtn>\n  );\n};\n","import { RouteChildrenProps } from 'react-router-dom';\nimport { useMemo } from 'react';\nimport { isEmpty, pipe } from 'ramda';\nimport { parseQuery, stringifyQuery } from '../../utils/helpers/query';\nimport { ShortUrlsOrder, ShortUrlsOrderableFields } from '../data';\nimport { orderToString, stringToOrder } from '../../utils/helpers/ordering';\n\ntype ServerIdRouteProps = RouteChildrenProps<{ serverId: string }>;\ntype ToFirstPage = (extra: Partial<ShortUrlsFiltering>) => void;\n\nexport interface ShortUrlListRouteParams {\n  page: string;\n  serverId: string;\n}\n\ninterface ShortUrlsQueryCommon {\n  tags?: string;\n  search?: string;\n  startDate?: string;\n  endDate?: string;\n}\n\ninterface ShortUrlsQuery extends ShortUrlsQueryCommon {\n  orderBy?: string;\n}\n\ninterface ShortUrlsFiltering extends ShortUrlsQueryCommon {\n  orderBy?: ShortUrlsOrder;\n}\n\nexport const useShortUrlsQuery = (\n  { history, location, match }: ServerIdRouteProps,\n): [ShortUrlsFiltering, ToFirstPage] => {\n  const query = useMemo(\n    pipe(\n      () => parseQuery<ShortUrlsQuery>(location.search),\n      ({ orderBy, ...rest }: ShortUrlsQuery): ShortUrlsFiltering => !orderBy ? rest : {\n        ...rest,\n        orderBy: stringToOrder<ShortUrlsOrderableFields>(orderBy),\n      },\n    ),\n    [ location.search ],\n  );\n  const toFirstPageWithExtra = (extra: Partial<ShortUrlsFiltering>) => {\n    const { orderBy, ...mergedQuery } = { ...query, ...extra };\n    const normalizedQuery: ShortUrlsQuery = { ...mergedQuery, orderBy: orderBy && orderToString(orderBy) };\n    const evolvedQuery = stringifyQuery(normalizedQuery);\n    const queryString = isEmpty(evolvedQuery) ? '' : `?${evolvedQuery}`;\n\n    history.push(`/server/${match?.params.serverId}/list-short-urls/1${queryString}`);\n  };\n\n  return [ query, toFirstPageWithExtra ];\n};\n","import { faTags as tagsIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { isEmpty, pipe } from 'ramda';\nimport { parseISO } from 'date-fns';\nimport { RouteChildrenProps } from 'react-router-dom';\nimport SearchField from '../utils/SearchField';\nimport Tag from '../tags/helpers/Tag';\nimport { DateRangeSelector } from '../utils/dates/DateRangeSelector';\nimport { formatIsoDate } from '../utils/helpers/date';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport { DateRange } from '../utils/dates/types';\nimport { ShortUrlListRouteParams, useShortUrlsQuery } from './helpers/hooks';\nimport './ShortUrlsFilteringBar.scss';\n\nexport type ShortUrlsFilteringProps = RouteChildrenProps<ShortUrlListRouteParams>;\n\nconst dateOrNull = (date?: string) => date ? parseISO(date) : null;\n\nconst ShortUrlsFilteringBar = (colorGenerator: ColorGenerator) => (props: ShortUrlsFilteringProps) => {\n  const [{ search, tags, startDate, endDate }, toFirstPage ] = useShortUrlsQuery(props);\n  const selectedTags = tags?.split(',') ?? [];\n  const setDates = pipe(\n    ({ startDate, endDate }: DateRange) => ({\n      startDate: formatIsoDate(startDate) ?? undefined,\n      endDate: formatIsoDate(endDate) ?? undefined,\n    }),\n    toFirstPage,\n  );\n  const setSearch = pipe(\n    (searchTerm: string) => isEmpty(searchTerm) ? undefined : searchTerm,\n    (search) => toFirstPage({ search }),\n  );\n  const removeTag = pipe(\n    (tag: string) => selectedTags.filter((selectedTag) => selectedTag !== tag),\n    (tagsList) => tagsList.length === 0 ? undefined : tagsList.join(','),\n    (tags) => toFirstPage({ tags }),\n  );\n\n  return (\n    <div className=\"short-urls-filtering-bar-container\">\n      <SearchField initialValue={search} onChange={setSearch} />\n\n      <div className=\"mt-3\">\n        <div className=\"row\">\n          <div className=\"col-lg-8 offset-lg-4 col-xl-6 offset-xl-6\">\n            <DateRangeSelector\n              defaultText=\"All short URLs\"\n              initialDateRange={{\n                startDate: dateOrNull(startDate),\n                endDate: dateOrNull(endDate),\n              }}\n              onDatesChange={setDates}\n            />\n          </div>\n        </div>\n      </div>\n\n      {selectedTags.length > 0 && (\n        <h4 className=\"short-urls-filtering-bar__selected-tag mt-3\">\n          <FontAwesomeIcon icon={tagsIcon} className=\"short-urls-filtering-bar__tags-icon\" />\n          &nbsp;\n          {selectedTags.map((tag) =>\n            <Tag colorGenerator={colorGenerator} key={tag} text={tag} clearable onClose={() => removeTag(tag)} />)}\n        </h4>\n      )}\n    </div>\n  );\n};\n\nexport default ShortUrlsFilteringBar;\n","import { UncontrolledDropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { toPairs } from 'ramda';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSortAmountUp as sortAscIcon, faSortAmountDown as sortDescIcon } from '@fortawesome/free-solid-svg-icons';\nimport classNames from 'classnames';\nimport { determineOrderDir, Order, OrderDir } from './helpers/ordering';\nimport './OrderingDropdown.scss';\n\nexport interface OrderingDropdownProps<T extends string = string> {\n  items: Record<T, string>;\n  order: Order<T>;\n  onChange: (orderField?: T, orderDir?: OrderDir) => void;\n  isButton?: boolean;\n  right?: boolean;\n}\n\nexport function OrderingDropdown<T extends string = string>(\n  { items, order, onChange, isButton = true, right = false }: OrderingDropdownProps<T>,\n) {\n  const handleItemClick = (fieldKey: T) => () => {\n    const newOrderDir = determineOrderDir(fieldKey, order.field, order.dir);\n\n    onChange(newOrderDir ? fieldKey : undefined, newOrderDir);\n  };\n\n  return (\n    <UncontrolledDropdown>\n      <DropdownToggle\n        caret\n        color={isButton ? 'primary' : 'link'}\n        className={classNames({ 'dropdown-btn__toggle btn-block': isButton, 'btn-sm p-0': !isButton })}\n      >\n        {!isButton && <>Order by</>}\n        {isButton && !order.field && <>Order by...</>}\n        {isButton && order.field && `Order by: \"${items[order.field]}\" - \"${order.dir ?? 'DESC'}\"`}\n      </DropdownToggle>\n      <DropdownMenu\n        right={right}\n        className={classNames('w-100', { 'ordering-dropdown__menu--link': !isButton })}\n      >\n        {toPairs(items).map(([ fieldKey, fieldValue ]) => (\n          <DropdownItem key={fieldKey} active={order.field === fieldKey} onClick={handleItemClick(fieldKey as T)}>\n            {fieldValue}\n            {order.field === fieldKey && (\n              <FontAwesomeIcon\n                icon={order.dir === 'ASC' ? sortAscIcon : sortDescIcon}\n                className=\"ordering-dropdown__sort-icon\"\n              />\n            )}\n          </DropdownItem>\n        ))}\n        <DropdownItem divider />\n        <DropdownItem disabled={!order.field} onClick={() => onChange()}>\n          <i>Clear selection</i>\n        </DropdownItem>\n      </DropdownMenu>\n    </UncontrolledDropdown>\n  );\n}\n","import { FC, useEffect } from 'react';\nimport { pipe } from 'ramda';\nimport { CreateVisit } from '../../visits/types';\nimport { MercureInfo } from '../reducers/mercureInfo';\nimport { bindToMercureTopic } from './index';\n\nexport interface MercureBoundProps {\n  createNewVisits: (createdVisits: CreateVisit[]) => void;\n  loadMercureInfo: () => void;\n  mercureInfo: MercureInfo;\n}\n\nexport function boundToMercureHub<T = {}>(\n  WrappedComponent: FC<MercureBoundProps & T>,\n  getTopicsForProps: (props: T) => string[],\n) {\n  const pendingUpdates = new Set<CreateVisit>();\n\n  return (props: MercureBoundProps & T) => {\n    const { createNewVisits, loadMercureInfo, mercureInfo } = props;\n    const { interval } = mercureInfo;\n\n    useEffect(() => {\n      const onMessage = (visit: CreateVisit) => interval ? pendingUpdates.add(visit) : createNewVisits([ visit ]);\n      const closeEventSource = bindToMercureTopic(mercureInfo, getTopicsForProps(props), onMessage, loadMercureInfo);\n\n      if (!interval) {\n        return closeEventSource;\n      }\n\n      const timer = setInterval(() => {\n        createNewVisits([ ...pendingUpdates ]);\n        pendingUpdates.clear();\n      }, interval * 1000 * 60);\n\n      return pipe(() => clearInterval(timer), () => closeEventSource?.());\n    }, [ mercureInfo ]);\n\n    return <WrappedComponent {...props} />;\n  };\n}\n","import { EventSourcePolyfill as EventSource } from 'event-source-polyfill';\nimport { MercureInfo } from '../reducers/mercureInfo';\n\nexport const bindToMercureTopic = <T>(mercureInfo: MercureInfo, topics: string[], onMessage: (message: T) => void, onTokenExpired: () => void) => { // eslint-disable-line max-len\n  const { mercureHubUrl, token, loading, error } = mercureInfo;\n\n  if (loading || error || !mercureHubUrl) {\n    return undefined;\n  }\n\n  const onEventSourceMessage = ({ data }: { data: string }) => onMessage(JSON.parse(data) as T);\n  const onEventSourceError = ({ status }: { status: number }) => status === 401 && onTokenExpired();\n\n  const subscriptions = topics.map((topic) => {\n    const hubUrl = new URL(mercureHubUrl);\n\n    hubUrl.searchParams.append('topic', topic);\n    const es = new EventSource(hubUrl, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    es.onmessage = onEventSourceMessage;\n    es.onerror = onEventSourceError;\n\n    return es;\n  });\n\n  return () => subscriptions.forEach((es) => es.close());\n};\n","export class Topics {\n  public static readonly visits = 'https://shlink.io/new-visit';\n\n  public static readonly orphanVisits = 'https://shlink.io/new-orphan-visit';\n\n  public static readonly shortUrlVisits = (shortCode: string) => `https://shlink.io/new-visit/${shortCode}`;\n}\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCaretDown as caretDownIcon, faCaretUp as caretUpIcon } from '@fortawesome/free-solid-svg-icons';\nimport { Order } from '../helpers/ordering';\n\ninterface TableOrderIconProps<T> {\n  currentOrder: Order<T>;\n  field: T;\n  className?: string;\n}\n\nexport function TableOrderIcon<T extends string = string>(\n  { currentOrder, field, className = 'ml-1' }: TableOrderIconProps<T>,\n) {\n  if (!currentOrder.dir || currentOrder.field !== field) {\n    return null;\n  }\n\n  return <FontAwesomeIcon icon={currentOrder.dir === 'ASC' ? caretUpIcon : caretDownIcon} className={className} />;\n}\n","import { isEmpty, propEq, values } from 'ramda';\nimport { useState, useEffect, useMemo, FC, useRef } from 'react';\nimport { Button, Card, Nav, NavLink, Progress, Row } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCalendarAlt, faMapMarkedAlt, faList, faChartPie, faFileDownload } from '@fortawesome/free-solid-svg-icons';\nimport { IconDefinition } from '@fortawesome/fontawesome-common-types';\nimport { Route, Switch, NavLink as RouterNavLink, Redirect } from 'react-router-dom';\nimport { Location } from 'history';\nimport classNames from 'classnames';\nimport { DateRangeSelector } from '../utils/dates/DateRangeSelector';\nimport Message from '../utils/Message';\nimport { DateInterval, DateRange, intervalToDateRange } from '../utils/dates/types';\nimport { Result } from '../utils/Result';\nimport { ShlinkApiError } from '../api/ShlinkApiError';\nimport { Settings } from '../settings/reducers/settings';\nimport { SelectedServer } from '../servers/data';\nimport { supportsBotVisits } from '../utils/helpers/features';\nimport { prettify } from '../utils/helpers/numbers';\nimport LineChartCard from './charts/LineChartCard';\nimport VisitsTable from './VisitsTable';\nimport { NormalizedOrphanVisit, NormalizedVisit, VisitsFilter, VisitsInfo, VisitsParams } from './types';\nimport OpenMapModalBtn from './helpers/OpenMapModalBtn';\nimport { normalizeVisits, processStatsFromVisits } from './services/VisitsParser';\nimport { VisitsFilterDropdown } from './helpers/VisitsFilterDropdown';\nimport { HighlightableProps, highlightedVisitsToStats } from './types/helpers';\nimport { DoughnutChartCard } from './charts/DoughnutChartCard';\nimport { SortableBarChartCard } from './charts/SortableBarChartCard';\nimport './VisitsStats.scss';\n\nexport interface VisitsStatsProps {\n  getVisits: (params: VisitsParams, doIntervalFallback?: boolean) => void;\n  visitsInfo: VisitsInfo;\n  settings: Settings;\n  selectedServer: SelectedServer;\n  cancelGetVisits: () => void;\n  baseUrl: string;\n  domain?: string;\n  exportCsv: (visits: NormalizedVisit[]) => void;\n  isOrphanVisits?: boolean;\n}\n\ninterface VisitsNavLinkProps {\n  title: string;\n  subPath: string;\n  icon: IconDefinition;\n}\n\ntype Section = 'byTime' | 'byContext' | 'byLocation' | 'list';\n\nconst sections: Record<Section, VisitsNavLinkProps> = {\n  byTime: { title: 'By time', subPath: '', icon: faCalendarAlt },\n  byContext: { title: 'By context', subPath: '/by-context', icon: faChartPie },\n  byLocation: { title: 'By location', subPath: '/by-location', icon: faMapMarkedAlt },\n  list: { title: 'List', subPath: '/list', icon: faList },\n};\n\nlet selectedBar: string | undefined;\n\nconst VisitsNavLink: FC<VisitsNavLinkProps & { to: string }> = ({ subPath, title, icon, to }) => (\n  <NavLink\n    tag={RouterNavLink}\n    className=\"visits-stats__nav-link\"\n    to={to}\n    isActive={(_: null, { pathname }: Location) => pathname.endsWith(`visits${subPath}`)}\n    replace\n  >\n    <FontAwesomeIcon icon={icon} />\n    <span className=\"ml-2 d-none d-sm-inline\">{title}</span>\n  </NavLink>\n);\n\nconst VisitsStats: FC<VisitsStatsProps> = ({\n  children,\n  visitsInfo,\n  getVisits,\n  cancelGetVisits,\n  baseUrl,\n  domain,\n  settings,\n  exportCsv,\n  selectedServer,\n  isOrphanVisits = false,\n}) => {\n  const { visits, loading, loadingLarge, error, errorData, progress, fallbackInterval } = visitsInfo;\n  const [ initialInterval, setInitialInterval ] = useState<DateInterval>(\n    fallbackInterval ?? settings.visits?.defaultInterval ?? 'last30Days',\n  );\n  const [ dateRange, setDateRange ] = useState<DateRange>(intervalToDateRange(initialInterval));\n  const [ highlightedVisits, setHighlightedVisits ] = useState<NormalizedVisit[]>([]);\n  const [ highlightedLabel, setHighlightedLabel ] = useState<string | undefined>();\n  const [ visitsFilter, setVisitsFilter ] = useState<VisitsFilter>({});\n  const botsSupported = supportsBotVisits(selectedServer);\n  const isFirstLoad = useRef(true);\n\n  const buildSectionUrl = (subPath?: string) => {\n    const query = domain ? `?domain=${domain}` : '';\n\n    return !subPath ? `${baseUrl}${query}` : `${baseUrl}${subPath}${query}`;\n  };\n  const normalizedVisits = useMemo(() => normalizeVisits(visits), [ visits ]);\n  const { os, browsers, referrers, countries, cities, citiesForMap, visitedUrls } = useMemo(\n    () => processStatsFromVisits(normalizedVisits),\n    [ normalizedVisits ],\n  );\n  const mapLocations = values(citiesForMap);\n\n  const setSelectedVisits = (selectedVisits: NormalizedVisit[]) => {\n    selectedBar = undefined;\n    setHighlightedVisits(selectedVisits);\n  };\n  const highlightVisitsForProp = (prop: HighlightableProps<NormalizedOrphanVisit>) => (value: string) => {\n    const newSelectedBar = `${prop}_${value}`;\n\n    if (selectedBar === newSelectedBar) {\n      setHighlightedVisits([]);\n      setHighlightedLabel(undefined);\n      selectedBar = undefined;\n    } else {\n      setHighlightedVisits((normalizedVisits as NormalizedOrphanVisit[]).filter(propEq(prop, value)));\n      setHighlightedLabel(value);\n      selectedBar = newSelectedBar;\n    }\n  };\n\n  useEffect(() => cancelGetVisits, []);\n  useEffect(() => {\n    getVisits({ dateRange, filter: visitsFilter }, isFirstLoad.current);\n    isFirstLoad.current = false;\n  }, [ dateRange, visitsFilter ]);\n  useEffect(() => {\n    fallbackInterval && setInitialInterval(fallbackInterval);\n  }, [ fallbackInterval ]);\n\n  const renderVisitsContent = () => {\n    if (loadingLarge) {\n      return (\n        <Message loading>\n          This is going to take a while... :S\n          <Progress value={progress} striped={progress === 100} className=\"mt-3\" />\n        </Message>\n      );\n    }\n\n    if (loading) {\n      return <Message loading />;\n    }\n\n    if (error) {\n      return (\n        <Result type=\"error\">\n          <ShlinkApiError errorData={errorData} fallbackMessage=\"An error occurred while loading visits :(\" />\n        </Result>\n      );\n    }\n\n    if (isEmpty(visits)) {\n      return <Message>There are no visits matching current filter  :(</Message>;\n    }\n\n    return (\n      <>\n        <Card className=\"visits-stats__nav p-0 overflow-hidden\" body>\n          <Nav pills fill>\n            {Object.entries(sections).map(([ section, props ]) =>\n              <VisitsNavLink key={section} {...props} to={buildSectionUrl(props.subPath)} />)}\n          </Nav>\n        </Card>\n        <Row>\n          <Switch>\n            <Route exact path={baseUrl}>\n              <div className=\"col-12 mt-3\">\n                <LineChartCard\n                  title=\"Visits during time\"\n                  visits={normalizedVisits}\n                  highlightedVisits={highlightedVisits}\n                  highlightedLabel={highlightedLabel}\n                  setSelectedVisits={setSelectedVisits}\n                />\n              </div>\n            </Route>\n\n            <Route exact path={`${baseUrl}${sections.byContext.subPath}`}>\n              <div className={classNames('mt-3 col-lg-6', { 'col-xl-4': !isOrphanVisits })}>\n                <DoughnutChartCard title=\"Operating systems\" stats={os} />\n              </div>\n              <div className={classNames('mt-3 col-lg-6', { 'col-xl-4': !isOrphanVisits })}>\n                <DoughnutChartCard title=\"Browsers\" stats={browsers} />\n              </div>\n              <div className={classNames('mt-3', { 'col-xl-4': !isOrphanVisits, 'col-lg-6': isOrphanVisits })}>\n                <SortableBarChartCard\n                  title=\"Referrers\"\n                  stats={referrers}\n                  withPagination={false}\n                  highlightedStats={highlightedVisitsToStats(highlightedVisits, 'referer')}\n                  highlightedLabel={highlightedLabel}\n                  sortingItems={{\n                    name: 'Referrer name',\n                    amount: 'Visits amount',\n                  }}\n                  onClick={highlightVisitsForProp('referer')}\n                />\n              </div>\n              {isOrphanVisits && (\n                <div className=\"mt-3 col-lg-6\">\n                  <SortableBarChartCard\n                    title=\"Visited URLs\"\n                    stats={visitedUrls}\n                    highlightedLabel={highlightedLabel}\n                    highlightedStats={highlightedVisitsToStats(highlightedVisits, 'visitedUrl')}\n                    sortingItems={{\n                      visitedUrl: 'Visited URL',\n                      amount: 'Visits amount',\n                    }}\n                    onClick={highlightVisitsForProp('visitedUrl')}\n                  />\n                </div>\n              )}\n            </Route>\n\n            <Route exact path={`${baseUrl}${sections.byLocation.subPath}`}>\n              <div className=\"col-lg-6 mt-3\">\n                <SortableBarChartCard\n                  title=\"Countries\"\n                  stats={countries}\n                  highlightedStats={highlightedVisitsToStats(highlightedVisits, 'country')}\n                  highlightedLabel={highlightedLabel}\n                  sortingItems={{\n                    name: 'Country name',\n                    amount: 'Visits amount',\n                  }}\n                  onClick={highlightVisitsForProp('country')}\n                />\n              </div>\n              <div className=\"col-lg-6 mt-3\">\n                <SortableBarChartCard\n                  title=\"Cities\"\n                  stats={cities}\n                  highlightedStats={highlightedVisitsToStats(highlightedVisits, 'city')}\n                  highlightedLabel={highlightedLabel}\n                  extraHeaderContent={(activeCities: string[]) =>\n                    mapLocations.length > 0 &&\n                    <OpenMapModalBtn modalTitle=\"Cities\" locations={mapLocations} activeCities={activeCities} />\n                  }\n                  sortingItems={{\n                    name: 'City name',\n                    amount: 'Visits amount',\n                  }}\n                  onClick={highlightVisitsForProp('city')}\n                />\n              </div>\n            </Route>\n\n            <Route exact path={`${baseUrl}${sections.list.subPath}`}>\n              <div className=\"col-12\">\n                <VisitsTable\n                  visits={normalizedVisits}\n                  selectedVisits={highlightedVisits}\n                  setSelectedVisits={setSelectedVisits}\n                  isOrphanVisits={isOrphanVisits}\n                  selectedServer={selectedServer}\n                />\n              </div>\n            </Route>\n\n            <Redirect to={baseUrl} />\n          </Switch>\n        </Row>\n      </>\n    );\n  };\n\n  return (\n    <>\n      {children}\n\n      <section className=\"mt-3\">\n        <div className=\"row flex-md-row-reverse\">\n          <div className=\"col-lg-7 col-xl-6\">\n            <div className=\"d-md-flex\">\n              <div className=\"flex-fill\">\n                <DateRangeSelector\n                  updatable\n                  disabled={loading}\n                  initialDateRange={initialInterval}\n                  defaultText=\"All visits\"\n                  onDatesChange={setDateRange}\n                />\n              </div>\n              <VisitsFilterDropdown\n                className=\"ml-0 ml-md-2 mt-3 mt-md-0\"\n                isOrphanVisits={isOrphanVisits}\n                botsSupported={botsSupported}\n                selected={visitsFilter}\n                onChange={setVisitsFilter}\n              />\n            </div>\n          </div>\n          {visits.length > 0 && (\n            <div className=\"col-lg-5 col-xl-6 mt-3 mt-lg-0\">\n              <div className=\"d-flex\">\n                <Button\n                  outline\n                  disabled={highlightedVisits.length === 0}\n                  className=\"btn-md-block mr-2\"\n                  onClick={() => setSelectedVisits([])}\n                >\n                  Clear selection {highlightedVisits.length > 0 && <>({prettify(highlightedVisits.length)})</>}\n                </Button>\n                <Button\n                  outline\n                  color=\"primary\"\n                  className=\"btn-md-block\"\n                  onClick={() => exportCsv(normalizedVisits)}\n                >\n                  <FontAwesomeIcon icon={faFileDownload} /> Export ({prettify(normalizedVisits.length)})\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <section className=\"mt-3\">\n        {renderVisitsContent()}\n      </section>\n    </>\n  );\n};\n\nexport default VisitsStats;\n","import { Action } from 'redux';\n\ntype ActionHandler<State, AT> = (currentState: State, action: AT) => State;\ntype ActionHandlerMap<State, AT> = Record<string, ActionHandler<State, AT>>;\n\nexport const buildReducer = <State, AT extends Action>(map: ActionHandlerMap<State, AT>, initialState: State) => (\n  state: State | undefined,\n  action: AT,\n): State => {\n  const { type } = action;\n  const actionHandler = map[type];\n  const currentState = state ?? initialState;\n\n  return actionHandler ? actionHandler(currentState, action) : currentState;\n};\n\nexport const buildActionCreator = <T extends string>(type: T) => (): Action<T> => ({ type });\n","import { Action } from 'redux';\nimport { dissoc, mergeDeepRight } from 'ramda';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { RecursivePartial } from '../../utils/utils';\nimport { Theme } from '../../utils/theme';\nimport { DateInterval } from '../../utils/dates/types';\nimport { TagsOrder } from '../../tags/data/TagsListChildrenProps';\nimport { ShortUrlsOrder } from '../../short-urls/data';\n\nexport const SET_SETTINGS = 'shlink/realTimeUpdates/SET_SETTINGS';\n\nexport const DEFAULT_SHORT_URLS_ORDERING: ShortUrlsOrder = {\n  field: 'dateCreated',\n  dir: 'DESC',\n};\n\n/**\n * Important! When adding new props in the main Settings interface or any of the nested props, they have to be set as\n * optional, as old instances of the app will load partial objects from local storage until it is saved again.\n */\n\nexport interface RealTimeUpdatesSettings {\n  enabled: boolean;\n  interval?: number;\n}\n\nexport type TagFilteringMode = 'startsWith' | 'includes';\n\nexport interface ShortUrlCreationSettings {\n  validateUrls: boolean;\n  tagFilteringMode?: TagFilteringMode;\n  forwardQuery?: boolean;\n}\n\nexport type TagsMode = 'cards' | 'list';\n\nexport interface UiSettings {\n  theme: Theme;\n}\n\nexport interface VisitsSettings {\n  defaultInterval: DateInterval;\n}\n\nexport interface TagsSettings {\n  defaultOrdering?: TagsOrder;\n  defaultMode?: TagsMode;\n}\n\nexport interface ShortUrlsListSettings {\n  defaultOrdering?: ShortUrlsOrder;\n}\n\nexport interface Settings {\n  realTimeUpdates: RealTimeUpdatesSettings;\n  shortUrlCreation?: ShortUrlCreationSettings;\n  shortUrlsList?: ShortUrlsListSettings;\n  ui?: UiSettings;\n  visits?: VisitsSettings;\n  tags?: TagsSettings;\n}\n\nconst initialState: Settings = {\n  realTimeUpdates: {\n    enabled: true,\n  },\n  shortUrlCreation: {\n    validateUrls: false,\n  },\n  ui: {\n    theme: 'light',\n  },\n  visits: {\n    defaultInterval: 'last30Days',\n  },\n  shortUrlsList: {\n    defaultOrdering: DEFAULT_SHORT_URLS_ORDERING,\n  },\n};\n\ntype SettingsAction = Action & Settings;\n\ntype PartialSettingsAction = Action & RecursivePartial<Settings>;\n\nexport default buildReducer<Settings, SettingsAction>({\n  [SET_SETTINGS]: (state, action) => mergeDeepRight(state, dissoc('type', action)),\n}, initialState);\n\nexport const toggleRealTimeUpdates = (enabled: boolean): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  realTimeUpdates: { enabled },\n});\n\nexport const setRealTimeUpdatesInterval = (interval: number): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  realTimeUpdates: { interval },\n});\n\nexport const setShortUrlCreationSettings = (settings: ShortUrlCreationSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  shortUrlCreation: settings,\n});\n\nexport const setShortUrlsListSettings = (settings: ShortUrlsListSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  shortUrlsList: settings,\n});\n\nexport const setUiSettings = (settings: UiSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  ui: settings,\n});\n\nexport const setVisitsSettings = (settings: VisitsSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  visits: settings,\n});\n\nexport const setTagsSettings = (settings: TagsSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  tags: settings,\n});\n","const TEN_ROUNDING_NUMBER = 10;\nconst { ceil } = Math;\nconst formatter = new Intl.NumberFormat('en-US');\n\nexport const prettify = (number: number | string) => formatter.format(Number(number));\n\nexport const roundTen = (number: number) => ceil(number / TEN_ROUNDING_NUMBER) * TEN_ROUNDING_NUMBER;\n","import { max, min, range } from 'ramda';\nimport { prettify } from './numbers';\n\nconst DELTA = 2;\n\nexport const ELLIPSIS = '...';\n\ntype Ellipsis = typeof ELLIPSIS;\n\nexport type NumberOrEllipsis = number | Ellipsis;\n\nexport const progressivePagination = (currentPage: number, pageCount: number): NumberOrEllipsis[] => {\n  const pages: NumberOrEllipsis[] = range(\n    max(DELTA, currentPage - DELTA),\n    min(pageCount - 1, currentPage + DELTA) + 1,\n  );\n\n  if (currentPage - DELTA > DELTA) {\n    pages.unshift(ELLIPSIS);\n  }\n  if (currentPage + DELTA < pageCount - 1) {\n    pages.push(ELLIPSIS);\n  }\n\n  pages.unshift(1);\n  pages.push(pageCount);\n\n  return pages;\n};\n\nexport const pageIsEllipsis = (pageNumber: NumberOrEllipsis): pageNumber is Ellipsis => pageNumber === ELLIPSIS;\n\nexport const prettifyPageNumber = (pageNumber: NumberOrEllipsis): string =>\n  pageIsEllipsis(pageNumber) ? pageNumber : prettify(pageNumber);\n\nexport const keyForPage = (pageNumber: NumberOrEllipsis, index: number) => !pageIsEllipsis(pageNumber) ? `${pageNumber}` : `${pageNumber}_${index}`;\n","import { Link } from 'react-router-dom';\nimport { Pagination, PaginationItem, PaginationLink } from 'reactstrap';\nimport {\n  pageIsEllipsis,\n  keyForPage,\n  progressivePagination,\n  prettifyPageNumber,\n  NumberOrEllipsis,\n} from '../utils/helpers/pagination';\nimport { ShlinkPaginator } from '../api/types';\n\ninterface PaginatorProps {\n  paginator?: ShlinkPaginator;\n  serverId: string;\n  currentQueryString?: string;\n}\n\nconst Paginator = ({ paginator, serverId, currentQueryString = '' }: PaginatorProps) => {\n  const { currentPage = 0, pagesCount = 0 } = paginator ?? {};\n  const urlForPage = (pageNumber: NumberOrEllipsis) =>\n    `/server/${serverId}/list-short-urls/${pageNumber}${currentQueryString}`;\n\n  if (pagesCount <= 1) {\n    return null;\n  }\n\n  const renderPages = () =>\n    progressivePagination(currentPage, pagesCount).map((pageNumber, index) => (\n      <PaginationItem\n        key={keyForPage(pageNumber, index)}\n        disabled={pageIsEllipsis(pageNumber)}\n        active={currentPage === pageNumber}\n      >\n        <PaginationLink tag={Link} to={urlForPage(pageNumber)}>\n          {prettifyPageNumber(pageNumber)}\n        </PaginationLink>\n      </PaginationItem>\n    ));\n\n  return (\n    <Pagination className=\"sticky-card-paginator\" listClassName=\"flex-wrap justify-content-center mb-0\">\n      <PaginationItem disabled={currentPage === 1}>\n        <PaginationLink previous tag={Link} to={urlForPage(currentPage - 1)} />\n      </PaginationItem>\n      {renderPages()}\n      <PaginationItem disabled={currentPage >= pagesCount}>\n        <PaginationLink next tag={Link} to={urlForPage(currentPage + 1)} />\n      </PaginationItem>\n    </Pagination>\n  );\n};\n\nexport default Paginator;\n","import { Nullable, OptionalString } from '../../utils/utils';\nimport { Order } from '../../utils/helpers/ordering';\n\nexport interface EditShortUrlData {\n  longUrl?: string;\n  tags?: string[];\n  title?: string | null;\n  validSince?: Date | string | null;\n  validUntil?: Date | string | null;\n  maxVisits?: number | null;\n  validateUrl?: boolean;\n  crawlable?: boolean;\n  forwardQuery?: boolean;\n}\n\nexport interface ShortUrlData extends EditShortUrlData {\n  longUrl: string;\n  customSlug?: string;\n  shortCodeLength?: number;\n  domain?: string;\n  findIfExists?: boolean;\n}\n\nexport interface ShortUrl {\n  shortCode: string;\n  shortUrl: string;\n  longUrl: string;\n  dateCreated: string;\n  visitsCount: number;\n  meta: Required<Nullable<ShortUrlMeta>>;\n  tags: string[];\n  domain: string | null;\n  title?: string | null;\n  crawlable?: boolean;\n  forwardQuery?: boolean;\n}\n\nexport interface ShortUrlMeta {\n  validSince?: string;\n  validUntil?: string;\n  maxVisits?: number;\n}\n\nexport interface ShortUrlModalProps {\n  shortUrl: ShortUrl;\n  isOpen: boolean;\n  toggle: () => void;\n}\n\nexport interface ShortUrlIdentifier {\n  shortCode: string;\n  domain: OptionalString;\n}\n\nexport const SHORT_URLS_ORDERABLE_FIELDS = {\n  dateCreated: 'Created at',\n  shortCode: 'Short URL',\n  longUrl: 'Long URL',\n  title: 'Title',\n  visits: 'Visits',\n};\n\nexport type ShortUrlsOrderableFields = keyof typeof SHORT_URLS_ORDERABLE_FIELDS;\n\nexport type ShortUrlsOrder = Order<ShortUrlsOrderableFields>;\n","import { pipe } from 'ramda';\nimport { FC, useEffect, useMemo, useState } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport { Card } from 'reactstrap';\nimport { OrderingDropdown } from '../utils/OrderingDropdown';\nimport { determineOrderDir, OrderDir } from '../utils/helpers/ordering';\nimport { getServerId, SelectedServer } from '../servers/data';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { TableOrderIcon } from '../utils/table/TableOrderIcon';\nimport { ShlinkShortUrlsListParams } from '../api/types';\nimport { DEFAULT_SHORT_URLS_ORDERING, Settings } from '../settings/reducers/settings';\nimport { ShortUrlsList as ShortUrlsListState } from './reducers/shortUrlsList';\nimport { ShortUrlsTableProps } from './ShortUrlsTable';\nimport Paginator from './Paginator';\nimport { ShortUrlListRouteParams, useShortUrlsQuery } from './helpers/hooks';\nimport { ShortUrlsOrderableFields, SHORT_URLS_ORDERABLE_FIELDS } from './data';\n\ninterface ShortUrlsListProps extends RouteComponentProps<ShortUrlListRouteParams> {\n  selectedServer: SelectedServer;\n  shortUrlsList: ShortUrlsListState;\n  listShortUrls: (params: ShlinkShortUrlsListParams) => void;\n  settings: Settings;\n}\n\nconst ShortUrlsList = (ShortUrlsTable: FC<ShortUrlsTableProps>, ShortUrlsFilteringBar: FC) => boundToMercureHub(({\n  listShortUrls,\n  match,\n  location,\n  history,\n  shortUrlsList,\n  selectedServer,\n  settings,\n}: ShortUrlsListProps) => {\n  const serverId = getServerId(selectedServer);\n  const [{ tags, search, startDate, endDate, orderBy }, toFirstPage ] = useShortUrlsQuery({ history, match, location });\n  const [ actualOrderBy, setActualOrderBy ] = useState(\n    // This separated state handling is needed to be able to fall back to settings value, but only once when loaded\n    orderBy ?? settings.shortUrlsList?.defaultOrdering ?? DEFAULT_SHORT_URLS_ORDERING,\n  );\n  const selectedTags = useMemo(() => tags?.split(',') ?? [], [ tags ]);\n  const { pagination } = shortUrlsList?.shortUrls ?? {};\n  const handleOrderBy = (field?: ShortUrlsOrderableFields, dir?: OrderDir) => {\n    toFirstPage({ orderBy: { field, dir } });\n    setActualOrderBy({ field, dir });\n  };\n  const orderByColumn = (field: ShortUrlsOrderableFields) => () =>\n    handleOrderBy(field, determineOrderDir(field, actualOrderBy.field, actualOrderBy.dir));\n  const renderOrderIcon = (field: ShortUrlsOrderableFields) =>\n    <TableOrderIcon currentOrder={actualOrderBy} field={field} />;\n  const addTag = pipe(\n    (newTag: string) => [ ...new Set([ ...selectedTags, newTag ]) ].join(','),\n    (tags) => toFirstPage({ tags }),\n  );\n\n  useEffect(() => {\n    listShortUrls({\n      page: match.params.page,\n      searchTerm: search,\n      tags: selectedTags,\n      startDate,\n      endDate,\n      orderBy: actualOrderBy,\n    });\n  }, [ match.params.page, search, selectedTags, startDate, endDate, actualOrderBy ]);\n\n  return (\n    <>\n      <div className=\"mb-3\"><ShortUrlsFilteringBar /></div>\n      <div className=\"d-block d-lg-none mb-3\">\n        <OrderingDropdown items={SHORT_URLS_ORDERABLE_FIELDS} order={actualOrderBy} onChange={handleOrderBy} />\n      </div>\n      <Card body className=\"pb-1\">\n        <ShortUrlsTable\n          selectedServer={selectedServer}\n          shortUrlsList={shortUrlsList}\n          orderByColumn={orderByColumn}\n          renderOrderIcon={renderOrderIcon}\n          onTagClick={addTag}\n        />\n        <Paginator paginator={pagination} serverId={serverId} currentQueryString={location.search} />\n      </Card>\n    </>\n  );\n}, () => [ Topics.visits ]);\n\nexport default ShortUrlsList;\n","import { FC } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCopy as copyIcon } from '@fortawesome/free-regular-svg-icons';\nimport CopyToClipboard from 'react-copy-to-clipboard';\nimport './CopyToClipboardIcon.scss';\n\ninterface CopyToClipboardIconProps {\n  text: string;\n  onCopy?: (text: string, result: boolean) => void;\n}\n\nexport const CopyToClipboardIcon: FC<CopyToClipboardIconProps> = ({ text, onCopy }) => (\n  <CopyToClipboard text={text} onCopy={onCopy}>\n    <FontAwesomeIcon icon={copyIcon} className=\"ml-2 copy-to-clipboard-icon\" />\n  </CopyToClipboard>\n);\n","import { parseISO, format as formatDate, getUnixTime, formatDistance } from 'date-fns';\nimport { isDateObject } from './helpers/date';\n\nexport interface DateProps {\n  date: Date | string;\n  format?: string;\n  relative?: boolean;\n}\n\nexport const Time = ({ date, format = 'yyyy-MM-dd HH:mm', relative = false }: DateProps) => {\n  const dateObject = isDateObject(date) ? date : parseISO(date);\n\n  return (\n    <time dateTime={`${getUnixTime(dateObject)}000`}>\n      {relative ? `${formatDistance(new Date(), dateObject)} ago` : formatDate(dateObject, format)}\n    </time>\n  );\n};\n","import { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport { isServerWithId, SelectedServer, ServerWithId } from '../../servers/data';\nimport { ShortUrl } from '../data';\n\nexport type LinkSuffix = 'visits' | 'edit';\n\nexport interface ShortUrlDetailLinkProps {\n  shortUrl?: ShortUrl | null;\n  selectedServer?: SelectedServer;\n  suffix: LinkSuffix;\n}\n\nconst buildUrl = ({ id }: ServerWithId, { shortCode, domain }: ShortUrl, suffix: LinkSuffix) => {\n  const query = domain ? `?domain=${domain}` : '';\n\n  return `/server/${id}/short-code/${shortCode}/${suffix}${query}`;\n};\n\nconst ShortUrlDetailLink: FC<ShortUrlDetailLinkProps & Record<string | number, any>> = (\n  { selectedServer, shortUrl, suffix, children, ...rest },\n) => {\n  if (!selectedServer || !isServerWithId(selectedServer) || !shortUrl) {\n    return <span {...rest}>{children}</span>;\n  }\n\n  return <Link to={buildUrl(selectedServer, shortUrl, suffix)} {...rest}>{children}</Link>;\n};\n\nexport default ShortUrlDetailLink;\n","import { useRef } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faInfoCircle as infoIcon } from '@fortawesome/free-solid-svg-icons';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport classNames from 'classnames';\nimport { prettify } from '../../utils/helpers/numbers';\nimport { ShortUrl } from '../data';\nimport { SelectedServer } from '../../servers/data';\nimport ShortUrlDetailLink from './ShortUrlDetailLink';\nimport './ShortUrlVisitsCount.scss';\n\ninterface ShortUrlVisitsCountProps {\n  shortUrl?: ShortUrl | null;\n  selectedServer?: SelectedServer;\n  visitsCount: number;\n  active?: boolean;\n}\n\nconst ShortUrlVisitsCount = ({ visitsCount, shortUrl, selectedServer, active = false }: ShortUrlVisitsCountProps) => {\n  const maxVisits = shortUrl?.meta?.maxVisits;\n  const visitsLink = (\n    <ShortUrlDetailLink selectedServer={selectedServer} shortUrl={shortUrl} suffix=\"visits\">\n      <strong\n        className={classNames('short-url-visits-count__amount', { 'short-url-visits-count__amount--big': active })}\n      >\n        {prettify(visitsCount)}\n      </strong>\n    </ShortUrlDetailLink>\n  );\n\n  if (!maxVisits) {\n    return visitsLink;\n  }\n\n  const prettifiedMaxVisits = prettify(maxVisits);\n  const tooltipRef = useRef<HTMLElement | null>();\n\n  return (\n    <>\n      <span className=\"indivisible\">\n        {visitsLink}\n        <small\n          className=\"short-urls-visits-count__max-visits-control\"\n          ref={(el) => {\n            tooltipRef.current = el;\n          }}\n        >\n          {' '}/ {prettifiedMaxVisits}{' '}\n          <sup>\n            <FontAwesomeIcon icon={infoIcon} />\n          </sup>\n        </small>\n      </span>\n      <UncontrolledTooltip target={(() => tooltipRef.current) as any} placement=\"bottom\">\n        This short URL will not accept more than <b>{prettifiedMaxVisits}</b> visits.\n      </UncontrolledTooltip>\n    </>\n  );\n};\n\nexport default ShortUrlVisitsCount;\n","import { FC, useEffect, useRef } from 'react';\nimport { isEmpty } from 'ramda';\nimport { ExternalLink } from 'react-external-link';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { StateFlagTimeout } from '../../utils/helpers/hooks';\nimport Tag from '../../tags/helpers/Tag';\nimport { SelectedServer } from '../../servers/data';\nimport { CopyToClipboardIcon } from '../../utils/CopyToClipboardIcon';\nimport { ShortUrl } from '../data';\nimport { Time } from '../../utils/Time';\nimport ShortUrlVisitsCount from './ShortUrlVisitsCount';\nimport { ShortUrlsRowMenuProps } from './ShortUrlsRowMenu';\nimport './ShortUrlsRow.scss';\n\nexport interface ShortUrlsRowProps {\n  onTagClick?: (tag: string) => void;\n  selectedServer: SelectedServer;\n  shortUrl: ShortUrl;\n}\n\nconst ShortUrlsRow = (\n  ShortUrlsRowMenu: FC<ShortUrlsRowMenuProps>,\n  colorGenerator: ColorGenerator,\n  useStateFlagTimeout: StateFlagTimeout,\n) => ({ shortUrl, selectedServer, onTagClick }: ShortUrlsRowProps) => {\n  const [ copiedToClipboard, setCopiedToClipboard ] = useStateFlagTimeout();\n  const [ active, setActive ] = useStateFlagTimeout(false, 500);\n  const isFirstRun = useRef(true);\n\n  const renderTags = (tags: string[]) => {\n    if (isEmpty(tags)) {\n      return <i className=\"indivisible\"><small>No tags</small></i>;\n    }\n\n    return tags.map((tag) => (\n      <Tag\n        colorGenerator={colorGenerator}\n        key={tag}\n        text={tag}\n        onClick={() => onTagClick?.(tag)}\n      />\n    ));\n  };\n\n  useEffect(() => {\n    if (isFirstRun.current) {\n      isFirstRun.current = false;\n    } else {\n      setActive();\n    }\n  }, [ shortUrl.visitsCount ]);\n\n  return (\n    <tr className=\"responsive-table__row\">\n      <td className=\"indivisible short-urls-row__cell responsive-table__cell\" data-th=\"Created at\">\n        <Time date={shortUrl.dateCreated} />\n      </td>\n      <td className=\"responsive-table__cell short-urls-row__cell\" data-th=\"Short URL\">\n        <span className=\"indivisible short-urls-row__cell--relative\">\n          <ExternalLink href={shortUrl.shortUrl} />\n          <CopyToClipboardIcon text={shortUrl.shortUrl} onCopy={setCopiedToClipboard} />\n          <span className=\"badge badge-warning short-urls-row__copy-hint\" hidden={!copiedToClipboard}>\n            Copied short URL!\n          </span>\n        </span>\n      </td>\n      <td className=\"responsive-table__cell short-urls-row__cell short-urls-row__cell--break\" data-th={`${shortUrl.title ? 'Title' : 'Long URL'}`}>\n        <ExternalLink href={shortUrl.longUrl}>{shortUrl.title ?? shortUrl.longUrl}</ExternalLink>\n      </td>\n      {shortUrl.title && (\n        <td className=\"short-urls-row__cell responsive-table__cell short-urls-row__cell--break d-lg-none\" data-th=\"Long URL\">\n          <ExternalLink href={shortUrl.longUrl} />\n        </td>\n      )}\n      <td className=\"responsive-table__cell short-urls-row__cell\" data-th=\"Tags\">{renderTags(shortUrl.tags)}</td>\n      <td className=\"responsive-table__cell short-urls-row__cell text-lg-right\" data-th=\"Visits\">\n        <ShortUrlVisitsCount\n          visitsCount={shortUrl.visitsCount}\n          shortUrl={shortUrl}\n          selectedServer={selectedServer}\n          active={active}\n        />\n      </td>\n      <td className=\"responsive-table__cell short-urls-row__cell\">\n        <ShortUrlsRowMenu selectedServer={selectedServer} shortUrl={shortUrl} />\n      </td>\n    </tr>\n  );\n};\n\nexport default ShortUrlsRow;\n","import { FC } from 'react';\nimport { ButtonDropdown, DropdownMenu, DropdownToggle } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEllipsisV as menuIcon } from '@fortawesome/free-solid-svg-icons';\nimport './DropdownBtnMenu.scss';\n\nexport interface DropdownBtnMenuProps {\n  isOpen: boolean;\n  toggle: () => void;\n  right?: boolean;\n}\n\nexport const DropdownBtnMenu: FC<DropdownBtnMenuProps> = ({ isOpen, toggle, children, right = true }) => (\n  <ButtonDropdown toggle={toggle} isOpen={isOpen}>\n    <DropdownToggle size=\"sm\" caret outline className=\"dropdown-btn-menu__dropdown-toggle\">\n      &nbsp;<FontAwesomeIcon icon={menuIcon} />&nbsp;\n    </DropdownToggle>\n    <DropdownMenu right={right}>{children}</DropdownMenu>\n  </ButtonDropdown>\n);\n","import {\n  faChartPie as pieChartIcon,\n  faQrcode as qrIcon,\n  faMinusCircle as deleteIcon,\n  faEdit as editIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { FC } from 'react';\nimport { DropdownItem } from 'reactstrap';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { ShortUrl, ShortUrlModalProps } from '../data';\nimport { SelectedServer } from '../../servers/data';\nimport { DropdownBtnMenu } from '../../utils/DropdownBtnMenu';\nimport ShortUrlDetailLink from './ShortUrlDetailLink';\n\nexport interface ShortUrlsRowMenuProps {\n  selectedServer: SelectedServer;\n  shortUrl: ShortUrl;\n}\ntype ShortUrlModal = FC<ShortUrlModalProps>;\n\nconst ShortUrlsRowMenu = (\n  DeleteShortUrlModal: ShortUrlModal,\n  QrCodeModal: ShortUrlModal,\n) => ({ shortUrl, selectedServer }: ShortUrlsRowMenuProps) => {\n  const [ isOpen, toggle ] = useToggle();\n  const [ isQrModalOpen, toggleQrCode ] = useToggle();\n  const [ isDeleteModalOpen, toggleDelete ] = useToggle();\n\n  return (\n    <DropdownBtnMenu toggle={toggle} isOpen={isOpen}>\n      <DropdownItem tag={ShortUrlDetailLink} selectedServer={selectedServer} shortUrl={shortUrl} suffix=\"visits\">\n        <FontAwesomeIcon icon={pieChartIcon} fixedWidth /> Visit stats\n      </DropdownItem>\n\n      <DropdownItem tag={ShortUrlDetailLink} selectedServer={selectedServer} shortUrl={shortUrl} suffix=\"edit\">\n        <FontAwesomeIcon icon={editIcon} fixedWidth /> Edit short URL\n      </DropdownItem>\n\n      <DropdownItem onClick={toggleQrCode}>\n        <FontAwesomeIcon icon={qrIcon} fixedWidth /> QR code\n      </DropdownItem>\n      <QrCodeModal shortUrl={shortUrl} isOpen={isQrModalOpen} toggle={toggleQrCode} />\n\n      <DropdownItem divider />\n\n      <DropdownItem className=\"dropdown-item--danger\" onClick={toggleDelete}>\n        <FontAwesomeIcon icon={deleteIcon} fixedWidth /> Delete short URL\n      </DropdownItem>\n      <DeleteShortUrlModal shortUrl={shortUrl} isOpen={isDeleteModalOpen} toggle={toggleDelete} />\n    </DropdownBtnMenu>\n  );\n};\n\nexport default ShortUrlsRowMenu;\n","import { FC, useMemo } from 'react';\nimport { SelectedServer } from '../servers/data';\nimport { Settings, ShortUrlCreationSettings } from '../settings/reducers/settings';\nimport { ShortUrlData } from './data';\nimport { ShortUrlCreation } from './reducers/shortUrlCreation';\nimport { CreateShortUrlResultProps } from './helpers/CreateShortUrlResult';\nimport { ShortUrlFormProps } from './ShortUrlForm';\n\nexport interface CreateShortUrlProps {\n  basicMode?: boolean;\n}\n\ninterface CreateShortUrlConnectProps extends CreateShortUrlProps {\n  settings: Settings;\n  shortUrlCreationResult: ShortUrlCreation;\n  selectedServer: SelectedServer;\n  createShortUrl: (data: ShortUrlData) => Promise<void>;\n  resetCreateShortUrl: () => void;\n}\n\nconst getInitialState = (settings?: ShortUrlCreationSettings): ShortUrlData => ({\n  longUrl: '',\n  tags: [],\n  customSlug: '',\n  title: undefined,\n  shortCodeLength: undefined,\n  domain: '',\n  validSince: undefined,\n  validUntil: undefined,\n  maxVisits: undefined,\n  findIfExists: false,\n  validateUrl: settings?.validateUrls ?? false,\n  forwardQuery: settings?.forwardQuery ?? true,\n});\n\nconst CreateShortUrl = (ShortUrlForm: FC<ShortUrlFormProps>, CreateShortUrlResult: FC<CreateShortUrlResultProps>) => ({\n  createShortUrl,\n  shortUrlCreationResult,\n  resetCreateShortUrl,\n  selectedServer,\n  basicMode = false,\n  settings: { shortUrlCreation: shortUrlCreationSettings },\n}: CreateShortUrlConnectProps) => {\n  const initialState = useMemo(() => getInitialState(shortUrlCreationSettings), [ shortUrlCreationSettings ]);\n\n  return (\n    <>\n      <ShortUrlForm\n        initialState={initialState}\n        saving={shortUrlCreationResult.saving}\n        selectedServer={selectedServer}\n        mode={basicMode ? 'create-basic' : 'create'}\n        onSave={async (data: ShortUrlData) => {\n          resetCreateShortUrl();\n\n          return createShortUrl(data);\n        }}\n      />\n      <CreateShortUrlResult\n        {...shortUrlCreationResult}\n        resetCreateShortUrl={resetCreateShortUrl}\n        canBeClosed={basicMode}\n      />\n    </>\n  );\n};\n\nexport default CreateShortUrl;\n","import { FC } from 'react';\nimport { Row } from 'reactstrap';\nimport classNames from 'classnames';\nimport { SimpleCard } from './SimpleCard';\n\nexport type ResultType = 'success' | 'error' | 'warning';\n\nexport interface ResultProps {\n  type: ResultType;\n  className?: string;\n  small?: boolean;\n}\n\nexport const Result: FC<ResultProps> = ({ children, type, className, small = false }) => (\n  <Row className={className}>\n    <div className={classNames({ 'col-md-10 offset-md-1': !small, 'col-12': small })}>\n      <SimpleCard\n        className={classNames('text-center', {\n          'bg-main': type === 'success',\n          'bg-danger': type === 'error',\n          'bg-warning': type === 'warning',\n          'text-white': type !== 'warning',\n        })}\n        bodyClassName={classNames({ 'p-2': small })}\n      >\n        {children}\n      </SimpleCard>\n    </div>\n  </Row>\n);\n","import { AxiosError } from 'axios';\nimport { InvalidArgumentError, InvalidShortUrlDeletion, ProblemDetailsError } from '../types';\n\nexport const parseApiError = (e: AxiosError<ProblemDetailsError>) => e.response?.data;\n\nexport const isInvalidArgumentError = (error?: ProblemDetailsError): error is InvalidArgumentError =>\n  error?.type === 'INVALID_ARGUMENT';\n\nexport const isInvalidDeletionError = (error?: ProblemDetailsError): error is InvalidShortUrlDeletion =>\n  error?.type === 'INVALID_SHORTCODE_DELETION';\n","import { ProblemDetailsError } from './types';\nimport { isInvalidArgumentError } from './utils';\n\nexport interface ShlinkApiErrorProps {\n  errorData?: ProblemDetailsError;\n  fallbackMessage?: string;\n}\n\nexport const ShlinkApiError = ({ errorData, fallbackMessage }: ShlinkApiErrorProps) => (\n  <>\n    {errorData?.detail ?? fallbackMessage}\n    {isInvalidArgumentError(errorData) &&\n      <p className=\"mb-0\">Invalid elements: [{errorData.invalidElements.join(', ')}]</p>\n    }\n  </>\n);\n","import { useEffect, useState } from 'react';\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { identity, pipe } from 'ramda';\nimport { ShortUrlDeletion } from '../reducers/shortUrlDeletion';\nimport { ShortUrlModalProps } from '../data';\nimport { handleEventPreventingDefault, OptionalString } from '../../utils/utils';\nimport { Result } from '../../utils/Result';\nimport { isInvalidDeletionError } from '../../api/utils';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\n\ninterface DeleteShortUrlModalConnectProps extends ShortUrlModalProps {\n  shortUrlDeletion: ShortUrlDeletion;\n  deleteShortUrl: (shortCode: string, domain: OptionalString) => Promise<void>;\n  resetDeleteShortUrl: () => void;\n}\n\nconst DeleteShortUrlModal = (\n  { shortUrl, toggle, isOpen, shortUrlDeletion, resetDeleteShortUrl, deleteShortUrl }: DeleteShortUrlModalConnectProps,\n) => {\n  const [ inputValue, setInputValue ] = useState('');\n\n  useEffect(() => resetDeleteShortUrl, []);\n\n  const { error, errorData } = shortUrlDeletion;\n  const close = pipe(resetDeleteShortUrl, toggle);\n  const handleDeleteUrl = handleEventPreventingDefault(() => {\n    const { shortCode, domain } = shortUrl;\n\n    deleteShortUrl(shortCode, domain)\n      .then(toggle)\n      .catch(identity);\n  });\n\n  return (\n    <Modal isOpen={isOpen} toggle={close} centered>\n      <form onSubmit={handleDeleteUrl}>\n        <ModalHeader toggle={close}>\n          <span className=\"text-danger\">Delete short URL</span>\n        </ModalHeader>\n        <ModalBody>\n          <p><b className=\"text-danger\">Caution!</b> You are about to delete a short URL.</p>\n          <p>This action cannot be undone. Once you have deleted it, all the visits stats will be lost.</p>\n          <p>Write <b>{shortUrl.shortCode}</b> to confirm deletion.</p>\n\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder={`Insert the short code (${shortUrl.shortCode})`}\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n          />\n\n          {error && (\n            <Result type={isInvalidDeletionError(errorData) ? 'warning' : 'error'} small className=\"mt-2\">\n              <ShlinkApiError errorData={errorData} fallbackMessage=\"Something went wrong while deleting the URL :(\" />\n            </Result>\n          )}\n        </ModalBody>\n        <ModalFooter>\n          <button type=\"button\" className=\"btn btn-link\" onClick={close}>Cancel</button>\n          <button\n            type=\"submit\"\n            className=\"btn btn-danger\"\n            disabled={inputValue !== shortUrl.shortCode || shortUrlDeletion.loading}\n          >\n            {shortUrlDeletion.loading ? 'Deleting...' : 'Delete'}\n          </button>\n        </ModalFooter>\n      </form>\n    </Modal>\n  );\n};\n\nexport default DeleteShortUrlModal;\n","import { faCopy as copyIcon } from '@fortawesome/free-regular-svg-icons';\nimport { faTimes as closeIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { isNil } from 'ramda';\nimport { useEffect } from 'react';\nimport CopyToClipboard from 'react-copy-to-clipboard';\nimport { Tooltip } from 'reactstrap';\nimport { ShortUrlCreation } from '../reducers/shortUrlCreation';\nimport { StateFlagTimeout } from '../../utils/helpers/hooks';\nimport { Result } from '../../utils/Result';\nimport './CreateShortUrlResult.scss';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\n\nexport interface CreateShortUrlResultProps extends ShortUrlCreation {\n  resetCreateShortUrl: () => void;\n  canBeClosed?: boolean;\n}\n\nconst CreateShortUrlResult = (useStateFlagTimeout: StateFlagTimeout) => (\n  { error, errorData, result, resetCreateShortUrl, canBeClosed = false }: CreateShortUrlResultProps,\n) => {\n  const [ showCopyTooltip, setShowCopyTooltip ] = useStateFlagTimeout();\n\n  useEffect(() => {\n    resetCreateShortUrl();\n  }, []);\n\n  if (error) {\n    return (\n      <Result type=\"error\" className=\"mt-3\">\n        {canBeClosed && <FontAwesomeIcon icon={closeIcon} className=\"float-right pointer\" onClick={resetCreateShortUrl} />}\n        <ShlinkApiError errorData={errorData} fallbackMessage=\"An error occurred while creating the URL :(\" />\n      </Result>\n    );\n  }\n\n  if (isNil(result)) {\n    return null;\n  }\n\n  const { shortUrl } = result;\n\n  return (\n    <Result type=\"success\" className=\"mt-3\">\n      {canBeClosed && <FontAwesomeIcon icon={closeIcon} className=\"float-right pointer\" onClick={resetCreateShortUrl} />}\n      <b>Great!</b> The short URL is <b>{shortUrl}</b>\n\n      <CopyToClipboard text={shortUrl} onCopy={setShowCopyTooltip}>\n        <button\n          className=\"btn btn-light btn-sm create-short-url-result__copy-btn\"\n          id=\"copyBtn\"\n          type=\"button\"\n        >\n          <FontAwesomeIcon icon={copyIcon} /> Copy\n        </button>\n      </CopyToClipboard>\n\n      <Tooltip placement=\"left\" isOpen={showCopyTooltip} target=\"copyBtn\">\n        Copied!\n      </Tooltip>\n    </Result>\n  );\n};\n\nexport default CreateShortUrlResult;\n","import { isNil } from 'ramda';\nimport { ShortUrl } from '../data';\nimport { OptionalString } from '../../utils/utils';\n\nexport const shortUrlMatches = (shortUrl: ShortUrl, shortCode: string, domain: OptionalString): boolean => {\n  if (isNil(domain)) {\n    return shortUrl.shortCode === shortCode && !shortUrl.domain;\n  }\n\n  return shortUrl.shortCode === shortCode && shortUrl.domain === domain;\n};\n","import { Action } from 'redux';\nimport { CreateVisit } from '../types';\n\nexport const CREATE_VISITS = 'shlink/visitCreation/CREATE_VISITS';\n\nexport interface CreateVisitsAction extends Action<typeof CREATE_VISITS> {\n  createdVisits: CreateVisit[];\n}\n\nexport const createNewVisits = (createdVisits: CreateVisit[]): CreateVisitsAction => ({\n  type: CREATE_VISITS,\n  createdVisits,\n});\n","import { Action, Dispatch } from 'redux';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ProblemDetailsError } from '../../api/types';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { parseApiError } from '../../api/utils';\nimport { ApiErrorAction } from '../../api/types/actions';\n\n/* eslint-disable padding-line-between-statements */\nexport const DELETE_SHORT_URL_START = 'shlink/deleteShortUrl/DELETE_SHORT_URL_START';\nexport const DELETE_SHORT_URL_ERROR = 'shlink/deleteShortUrl/DELETE_SHORT_URL_ERROR';\nexport const SHORT_URL_DELETED = 'shlink/deleteShortUrl/SHORT_URL_DELETED';\nexport const RESET_DELETE_SHORT_URL = 'shlink/deleteShortUrl/RESET_DELETE_SHORT_URL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlDeletion {\n  shortCode: string;\n  loading: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface DeleteShortUrlAction extends Action<string> {\n  shortCode: string;\n  domain?: string | null;\n}\n\nconst initialState: ShortUrlDeletion = {\n  shortCode: '',\n  loading: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlDeletion, DeleteShortUrlAction & ApiErrorAction>({\n  [DELETE_SHORT_URL_START]: (state) => ({ ...state, loading: true, error: false }),\n  [DELETE_SHORT_URL_ERROR]: (state, { errorData }) => ({ ...state, errorData, loading: false, error: true }),\n  [SHORT_URL_DELETED]: (state, { shortCode }) => ({ ...state, shortCode, loading: false, error: false }),\n  [RESET_DELETE_SHORT_URL]: () => initialState,\n}, initialState);\n\nexport const deleteShortUrl = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  domain?: string | null,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: DELETE_SHORT_URL_START });\n  const { deleteShortUrl } = buildShlinkApiClient(getState);\n\n  try {\n    await deleteShortUrl(shortCode, domain);\n    dispatch<DeleteShortUrlAction>({ type: SHORT_URL_DELETED, shortCode, domain });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: DELETE_SHORT_URL_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const resetDeleteShortUrl = buildActionCreator(RESET_DELETE_SHORT_URL);\n","import { Action, Dispatch } from 'redux';\nimport { GetState } from '../../container/types';\nimport { ShortUrl, ShortUrlData } from '../data';\nimport { buildReducer, buildActionCreator } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\nimport { ApiErrorAction } from '../../api/types/actions';\n\n/* eslint-disable padding-line-between-statements */\nexport const CREATE_SHORT_URL_START = 'shlink/createShortUrl/CREATE_SHORT_URL_START';\nexport const CREATE_SHORT_URL_ERROR = 'shlink/createShortUrl/CREATE_SHORT_URL_ERROR';\nexport const CREATE_SHORT_URL = 'shlink/createShortUrl/CREATE_SHORT_URL';\nexport const RESET_CREATE_SHORT_URL = 'shlink/createShortUrl/RESET_CREATE_SHORT_URL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlCreation {\n  result: ShortUrl | null;\n  saving: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface CreateShortUrlAction extends Action<string> {\n  result: ShortUrl;\n}\n\nconst initialState: ShortUrlCreation = {\n  result: null,\n  saving: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlCreation, CreateShortUrlAction & ApiErrorAction>({\n  [CREATE_SHORT_URL_START]: (state) => ({ ...state, saving: true, error: false }),\n  [CREATE_SHORT_URL_ERROR]: (state, { errorData }) => ({ ...state, saving: false, error: true, errorData }),\n  [CREATE_SHORT_URL]: (_, { result }) => ({ result, saving: false, error: false }),\n  [RESET_CREATE_SHORT_URL]: () => initialState,\n}, initialState);\n\nexport const createShortUrl = (buildShlinkApiClient: ShlinkApiClientBuilder) => (data: ShortUrlData) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: CREATE_SHORT_URL_START });\n  const { createShortUrl } = buildShlinkApiClient(getState);\n\n  try {\n    const result = await createShortUrl(data);\n\n    dispatch<CreateShortUrlAction>({ type: CREATE_SHORT_URL, result });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: CREATE_SHORT_URL_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const resetCreateShortUrl = buildActionCreator(RESET_CREATE_SHORT_URL);\n","import { Action, Dispatch } from 'redux';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport { OptionalString } from '../../utils/utils';\nimport { EditShortUrlData, ShortUrl } from '../data';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\nimport { supportsTagsInPatch } from '../../utils/helpers/features';\nimport { ApiErrorAction } from '../../api/types/actions';\n\n/* eslint-disable padding-line-between-statements */\nexport const EDIT_SHORT_URL_START = 'shlink/shortUrlEdition/EDIT_SHORT_URL_START';\nexport const EDIT_SHORT_URL_ERROR = 'shlink/shortUrlEdition/EDIT_SHORT_URL_ERROR';\nexport const SHORT_URL_EDITED = 'shlink/shortUrlEdition/SHORT_URL_EDITED';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlEdition {\n  shortUrl?: ShortUrl;\n  saving: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface ShortUrlEditedAction extends Action<string> {\n  shortUrl: ShortUrl;\n}\n\nconst initialState: ShortUrlEdition = {\n  saving: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlEdition, ShortUrlEditedAction & ApiErrorAction>({\n  [EDIT_SHORT_URL_START]: (state) => ({ ...state, saving: true, error: false }),\n  [EDIT_SHORT_URL_ERROR]: (state, { errorData }) => ({ ...state, saving: false, error: true, errorData }),\n  [SHORT_URL_EDITED]: (_, { shortUrl }) => ({ shortUrl, saving: false, error: false }),\n}, initialState);\n\nexport const editShortUrl = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  domain: OptionalString,\n  data: EditShortUrlData,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: EDIT_SHORT_URL_START });\n\n  const { selectedServer } = getState();\n  const sendTagsSeparately = !supportsTagsInPatch(selectedServer);\n  const { updateShortUrl, updateShortUrlTags } = buildShlinkApiClient(getState);\n\n  try {\n    const [ shortUrl ] = await Promise.all([\n      updateShortUrl(shortCode, domain, data as any), // FIXME Parse dates\n      sendTagsSeparately && data.tags ? updateShortUrlTags(shortCode, domain, data.tags) : undefined,\n    ]);\n\n    dispatch<ShortUrlEditedAction>({ shortUrl, type: SHORT_URL_EDITED });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: EDIT_SHORT_URL_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n","import { assoc, assocPath, last, pipe, reject } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { shortUrlMatches } from '../helpers';\nimport { CREATE_VISITS, CreateVisitsAction } from '../../visits/reducers/visitCreation';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ShlinkShortUrlsListParams, ShlinkShortUrlsResponse } from '../../api/types';\nimport { DeleteShortUrlAction, SHORT_URL_DELETED } from './shortUrlDeletion';\nimport { CREATE_SHORT_URL, CreateShortUrlAction } from './shortUrlCreation';\nimport { SHORT_URL_EDITED, ShortUrlEditedAction } from './shortUrlEdition';\n\n/* eslint-disable padding-line-between-statements */\nexport const LIST_SHORT_URLS_START = 'shlink/shortUrlsList/LIST_SHORT_URLS_START';\nexport const LIST_SHORT_URLS_ERROR = 'shlink/shortUrlsList/LIST_SHORT_URLS_ERROR';\nexport const LIST_SHORT_URLS = 'shlink/shortUrlsList/LIST_SHORT_URLS';\n/* eslint-enable padding-line-between-statements */\n\nexport const ITEMS_IN_OVERVIEW_PAGE = 5;\n\nexport interface ShortUrlsList {\n  shortUrls?: ShlinkShortUrlsResponse;\n  loading: boolean;\n  error: boolean;\n}\n\nexport interface ListShortUrlsAction extends Action<string> {\n  shortUrls: ShlinkShortUrlsResponse;\n}\n\nexport type ListShortUrlsCombinedAction = (\n  ListShortUrlsAction\n  & CreateVisitsAction\n  & CreateShortUrlAction\n  & DeleteShortUrlAction\n  & ShortUrlEditedAction\n);\n\nconst initialState: ShortUrlsList = {\n  loading: true,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlsList, ListShortUrlsCombinedAction>({\n  [LIST_SHORT_URLS_START]: (state) => ({ ...state, loading: true, error: false }),\n  [LIST_SHORT_URLS_ERROR]: () => ({ loading: false, error: true }),\n  [LIST_SHORT_URLS]: (_, { shortUrls }) => ({ loading: false, error: false, shortUrls }),\n  [SHORT_URL_DELETED]: pipe(\n    (state: ShortUrlsList, { shortCode, domain }: DeleteShortUrlAction) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'data' ],\n      reject((shortUrl) => shortUrlMatches(shortUrl, shortCode, domain), state.shortUrls.data),\n      state,\n    ),\n    (state) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'pagination', 'totalItems' ],\n      state.shortUrls.pagination.totalItems - 1,\n      state,\n    ),\n  ),\n  [CREATE_VISITS]: (state, { createdVisits }) => assocPath(\n    [ 'shortUrls', 'data' ],\n    state.shortUrls?.data?.map(\n      (currentShortUrl) => {\n        // Find the last of the new visit for this short URL, and pick the amount of visits from it\n        const lastVisit = last(\n          createdVisits.filter(\n            ({ shortUrl }) => shortUrl && shortUrlMatches(currentShortUrl, shortUrl.shortCode, shortUrl.domain),\n          ),\n        );\n\n        return lastVisit?.shortUrl\n          ? assoc('visitsCount', lastVisit.shortUrl.visitsCount, currentShortUrl)\n          : currentShortUrl;\n      },\n    ),\n    state,\n  ),\n  [CREATE_SHORT_URL]: pipe(\n    // The only place where the list and the creation form coexist is the overview page.\n    // There we can assume we are displaying page 1, and therefore, we can safely prepend the new short URL.\n    // We can also remove the items above the amount that is displayed there.\n    (state: ShortUrlsList, { result }: CreateShortUrlAction) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'data' ],\n      [ result, ...state.shortUrls.data.slice(0, ITEMS_IN_OVERVIEW_PAGE - 1) ],\n      state,\n    ),\n    (state: ShortUrlsList) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'pagination', 'totalItems' ],\n      state.shortUrls.pagination.totalItems + 1,\n      state,\n    ),\n  ),\n  [SHORT_URL_EDITED]: (state, { shortUrl: editedShortUrl }) => !state.shortUrls ? state : assocPath(\n    [ 'shortUrls', 'data' ],\n    state.shortUrls.data.map((shortUrl) => {\n      const { shortCode, domain } = editedShortUrl;\n\n      return shortUrlMatches(shortUrl, shortCode, domain) ? editedShortUrl : shortUrl;\n    }),\n    state,\n  ),\n}, initialState);\n\nexport const listShortUrls = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  params: ShlinkShortUrlsListParams = {},\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: LIST_SHORT_URLS_START });\n  const { listShortUrls } = buildShlinkApiClient(getState);\n\n  try {\n    const shortUrls = await listShortUrls(params);\n\n    dispatch<ListShortUrlsAction>({ type: LIST_SHORT_URLS, shortUrls });\n  } catch (e) {\n    dispatch({ type: LIST_SHORT_URLS_ERROR });\n  }\n};\n","import { FC, ReactNode } from 'react';\nimport { isEmpty } from 'ramda';\nimport classNames from 'classnames';\nimport { SelectedServer } from '../servers/data';\nimport { supportsShortUrlTitle } from '../utils/helpers/features';\nimport { ShortUrlsList as ShortUrlsListState } from './reducers/shortUrlsList';\nimport { ShortUrlsRowProps } from './helpers/ShortUrlsRow';\nimport { ShortUrlsOrderableFields } from './data';\nimport './ShortUrlsTable.scss';\n\nexport interface ShortUrlsTableProps {\n  orderByColumn?: (column: ShortUrlsOrderableFields) => () => void;\n  renderOrderIcon?: (column: ShortUrlsOrderableFields) => ReactNode;\n  shortUrlsList: ShortUrlsListState;\n  selectedServer: SelectedServer;\n  onTagClick?: (tag: string) => void;\n  className?: string;\n}\n\nexport const ShortUrlsTable = (ShortUrlsRow: FC<ShortUrlsRowProps>) => ({\n  orderByColumn,\n  renderOrderIcon,\n  shortUrlsList,\n  onTagClick,\n  selectedServer,\n  className,\n}: ShortUrlsTableProps) => {\n  const { error, loading, shortUrls } = shortUrlsList;\n  const actionableFieldClasses = classNames({ 'short-urls-table__header-cell--with-action': !!orderByColumn });\n  const orderableColumnsClasses = classNames('short-urls-table__header-cell', actionableFieldClasses);\n  const tableClasses = classNames('table table-hover', className);\n  const supportsTitle = supportsShortUrlTitle(selectedServer);\n\n  const renderShortUrls = () => {\n    if (error) {\n      return (\n        <tr>\n          <td colSpan={6} className=\"text-center table-danger text-dark\">\n            Something went wrong while loading short URLs :(\n          </td>\n        </tr>\n      );\n    }\n\n    if (loading) {\n      return <tr><td colSpan={6} className=\"text-center\">Loading...</td></tr>;\n    }\n\n    if (!loading && isEmpty(shortUrls?.data)) {\n      return <tr><td colSpan={6} className=\"text-center\">No results found</td></tr>;\n    }\n\n    return shortUrls?.data.map((shortUrl) => (\n      <ShortUrlsRow\n        key={shortUrl.shortUrl}\n        shortUrl={shortUrl}\n        selectedServer={selectedServer}\n        onTagClick={onTagClick}\n      />\n    ));\n  };\n\n  return (\n    <table className={tableClasses}>\n      <thead className=\"responsive-table__header short-urls-table__header\">\n        <tr>\n          <th className={orderableColumnsClasses} onClick={orderByColumn?.('dateCreated')}>\n            Created at {renderOrderIcon?.('dateCreated')}\n          </th>\n          <th className={orderableColumnsClasses} onClick={orderByColumn?.('shortCode')}>\n            Short URL {renderOrderIcon?.('shortCode')}\n          </th>\n          {!supportsTitle && (\n            <th className={orderableColumnsClasses} onClick={orderByColumn?.('longUrl')}>\n              Long URL {renderOrderIcon?.('longUrl')}\n            </th>\n          ) || (\n            <th className=\"short-urls-table__header-cell\">\n              <span className={actionableFieldClasses} onClick={orderByColumn?.('title')}>\n                Title {renderOrderIcon?.('title')}\n              </span>\n              &nbsp;&nbsp;/&nbsp;&nbsp;\n              <span className={actionableFieldClasses} onClick={orderByColumn?.('longUrl')}>\n                <span className=\"indivisible\">Long URL</span> {renderOrderIcon?.('longUrl')}\n              </span>\n            </th>\n          )}\n          <th className=\"short-urls-table__header-cell\">Tags</th>\n          <th className={orderableColumnsClasses} onClick={orderByColumn?.('visits')}>\n            <span className=\"indivisible\">Visits {renderOrderIcon?.('visits')}</span>\n          </th>\n          <th className=\"short-urls-table__header-cell\">&nbsp;</th>\n        </tr>\n      </thead>\n      <tbody>\n        {renderShortUrls()}\n      </tbody>\n    </table>\n  );\n};\n","import { FC } from 'react';\nimport { DropdownItem } from 'reactstrap';\nimport { DropdownBtn } from '../../../utils/DropdownBtn';\nimport { QrCodeFormat } from '../../../utils/helpers/qrCodes';\n\ninterface QrFormatDropdownProps {\n  format: QrCodeFormat;\n  setFormat: (format: QrCodeFormat) => void;\n}\n\nexport const QrFormatDropdown: FC<QrFormatDropdownProps> = ({ format, setFormat }) => (\n  <DropdownBtn text={`Format (${format})`}>\n    <DropdownItem active={format === 'png'} onClick={() => setFormat('png')}>PNG</DropdownItem>\n    <DropdownItem active={format === 'svg'} onClick={() => setFormat('svg')}>SVG</DropdownItem>\n  </DropdownBtn>\n);\n","import { FC } from 'react';\nimport { DropdownItem } from 'reactstrap';\nimport { DropdownBtn } from '../../../utils/DropdownBtn';\nimport { QrErrorCorrection } from '../../../utils/helpers/qrCodes';\n\ninterface QrErrorCorrectionDropdownProps {\n  errorCorrection: QrErrorCorrection;\n  setErrorCorrection: (errorCorrection: QrErrorCorrection) => void;\n}\n\nexport const QrErrorCorrectionDropdown: FC<QrErrorCorrectionDropdownProps> = (\n  { errorCorrection, setErrorCorrection },\n) => (\n  <DropdownBtn text={`Error correction (${errorCorrection})`}>\n    <DropdownItem active={errorCorrection === 'L'} onClick={() => setErrorCorrection('L')}>\n      <b>L</b>ow\n    </DropdownItem>\n    <DropdownItem active={errorCorrection === 'M'} onClick={() => setErrorCorrection('M')}>\n      <b>M</b>edium\n    </DropdownItem>\n    <DropdownItem active={errorCorrection === 'Q'} onClick={() => setErrorCorrection('Q')}>\n      <b>Q</b>uartile\n    </DropdownItem>\n    <DropdownItem active={errorCorrection === 'H'} onClick={() => setErrorCorrection('H')}>\n      <b>H</b>igh\n    </DropdownItem>\n  </DropdownBtn>\n);\n","import { FC, useMemo, useState } from 'react';\nimport { Modal, FormGroup, ModalBody, ModalHeader, Row, Button } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faFileDownload as downloadIcon } from '@fortawesome/free-solid-svg-icons';\nimport { ExternalLink } from 'react-external-link';\nimport classNames from 'classnames';\nimport { ShortUrlModalProps } from '../data';\nimport { SelectedServer } from '../../servers/data';\nimport { CopyToClipboardIcon } from '../../utils/CopyToClipboardIcon';\nimport { buildQrCodeUrl, QrCodeCapabilities, QrCodeFormat, QrErrorCorrection } from '../../utils/helpers/qrCodes';\nimport {\n  supportsQrCodeSizeInQuery,\n  supportsQrCodeMargin,\n  supportsQrErrorCorrection,\n} from '../../utils/helpers/features';\nimport { ImageDownloader } from '../../common/services/ImageDownloader';\nimport { Versions } from '../../utils/helpers/version';\nimport { QrFormatDropdown } from './qr-codes/QrFormatDropdown';\nimport './QrCodeModal.scss';\nimport { QrErrorCorrectionDropdown } from './qr-codes/QrErrorCorrectionDropdown';\n\ninterface QrCodeModalConnectProps extends ShortUrlModalProps {\n  selectedServer: SelectedServer;\n}\n\nconst QrCodeModal = (imageDownloader: ImageDownloader, ForServerVersion: FC<Versions>) => ( // eslint-disable-line\n  { shortUrl: { shortUrl, shortCode }, toggle, isOpen, selectedServer }: QrCodeModalConnectProps,\n) => {\n  const [ size, setSize ] = useState(300);\n  const [ margin, setMargin ] = useState(0);\n  const [ format, setFormat ] = useState<QrCodeFormat>('png');\n  const [ errorCorrection, setErrorCorrection ] = useState<QrErrorCorrection>('L');\n  const capabilities: QrCodeCapabilities = useMemo(() => ({\n    useSizeInPath: !supportsQrCodeSizeInQuery(selectedServer),\n    marginIsSupported: supportsQrCodeMargin(selectedServer),\n    errorCorrectionIsSupported: supportsQrErrorCorrection(selectedServer),\n  }), [ selectedServer ]);\n  const willRenderThreeControls = capabilities.marginIsSupported !== capabilities.errorCorrectionIsSupported;\n  const qrCodeUrl = useMemo(\n    () => buildQrCodeUrl(shortUrl, { size, format, margin, errorCorrection }, capabilities),\n    [ shortUrl, size, format, margin, errorCorrection, capabilities ],\n  );\n  const totalSize = useMemo(() => size + margin, [ size, margin ]);\n  const modalSize = useMemo(() => {\n    if (totalSize < 500) {\n      return undefined;\n    }\n\n    return totalSize < 800 ? 'lg' : 'xl';\n  }, [ totalSize ]);\n\n  return (\n    <Modal isOpen={isOpen} toggle={toggle} centered size={modalSize}>\n      <ModalHeader toggle={toggle}>\n        QR code for <ExternalLink href={shortUrl}>{shortUrl}</ExternalLink>\n      </ModalHeader>\n      <ModalBody>\n        <Row>\n          <FormGroup\n            className={classNames({ 'col-md-4': willRenderThreeControls, 'col-md-6': !willRenderThreeControls })}\n          >\n            <label className=\"mb-0\">Size: {size}px</label>\n            <input\n              type=\"range\"\n              className=\"form-control-range\"\n              value={size}\n              step={10}\n              min={50}\n              max={1000}\n              onChange={(e) => setSize(Number(e.target.value))}\n            />\n          </FormGroup>\n          {capabilities.marginIsSupported && (\n            <FormGroup className={willRenderThreeControls ? 'col-md-4' : 'col-md-6'}>\n              <label className=\"mb-0\">Margin: {margin}px</label>\n              <input\n                type=\"range\"\n                className=\"form-control-range\"\n                value={margin}\n                step={1}\n                min={0}\n                max={100}\n                onChange={(e) => setMargin(Number(e.target.value))}\n              />\n            </FormGroup>\n          )}\n          <FormGroup className={willRenderThreeControls ? 'col-md-4' : 'col-md-6'}>\n            <QrFormatDropdown format={format} setFormat={setFormat} />\n          </FormGroup>\n          {capabilities.errorCorrectionIsSupported && (\n            <FormGroup className=\"col-md-6\">\n              <QrErrorCorrectionDropdown errorCorrection={errorCorrection} setErrorCorrection={setErrorCorrection} />\n            </FormGroup>\n          )}\n        </Row>\n        <div className=\"text-center\">\n          <div className=\"mb-3\">\n            <ExternalLink href={qrCodeUrl} />\n            <CopyToClipboardIcon text={qrCodeUrl} />\n          </div>\n          <img src={qrCodeUrl} className=\"qr-code-modal__img\" alt=\"QR code\" />\n          <ForServerVersion minVersion=\"2.9.0\">\n            <div className=\"mt-3\">\n              <Button\n                block\n                color=\"primary\"\n                onClick={async () => imageDownloader.saveImage(qrCodeUrl, `${shortCode}-qr-code.${format}`)}\n              >\n                Download <FontAwesomeIcon icon={downloadIcon} className=\"ml-1\" />\n              </Button>\n            </div>\n          </ForServerVersion>\n        </div>\n      </ModalBody>\n    </Modal>\n  );\n};\n\nexport default QrCodeModal;\n","import { isEmpty } from 'ramda';\nimport { stringifyQuery } from './query';\n\nexport interface QrCodeCapabilities {\n  useSizeInPath: boolean;\n  marginIsSupported: boolean;\n  errorCorrectionIsSupported: boolean;\n}\n\nexport type QrCodeFormat = 'svg' | 'png';\n\nexport type QrErrorCorrection = 'L' | 'M' | 'Q' | 'H';\n\nexport interface QrCodeOptions {\n  size: number;\n  format: QrCodeFormat;\n  margin: number;\n  errorCorrection: QrErrorCorrection;\n}\n\nexport const buildQrCodeUrl = (\n  shortUrl: string,\n  { size, format, margin, errorCorrection }: QrCodeOptions,\n  { useSizeInPath, marginIsSupported, errorCorrectionIsSupported }: QrCodeCapabilities,\n): string => {\n  const baseUrl = `${shortUrl}/qr-code${useSizeInPath ? `/${size}` : ''}`;\n  const query = stringifyQuery({\n    size: useSizeInPath ? undefined : size,\n    format,\n    margin: marginIsSupported && margin > 0 ? margin : undefined,\n    errorCorrection: errorCorrectionIsSupported ? errorCorrection : undefined,\n  });\n\n  return `${baseUrl}${isEmpty(query) ? '' : `?${query}`}`;\n};\n","import { ChangeEvent, FC, useRef } from 'react';\nimport classNames from 'classnames';\nimport { v4 as uuid } from 'uuid';\nimport { identity } from 'ramda';\n\nexport interface BooleanControlProps {\n  checked?: boolean;\n  onChange?: (checked: boolean, e: ChangeEvent<HTMLInputElement>) => void;\n  className?: string;\n  inline?: boolean;\n}\n\ninterface BooleanControlWithTypeProps extends BooleanControlProps {\n  type: 'switch' | 'checkbox';\n}\n\nconst BooleanControl: FC<BooleanControlWithTypeProps> = (\n  { checked = false, onChange = identity, className, children, type, inline = false },\n) => {\n  const { current: id } = useRef(uuid());\n  const onChecked = (e: ChangeEvent<HTMLInputElement>) => onChange(e.target.checked, e);\n  const typeClasses = {\n    'custom-switch': type === 'switch',\n    'custom-checkbox': type === 'checkbox',\n  };\n  const style = inline ? { display: 'inline-block' } : {};\n\n  return (\n    <span className={classNames('custom-control', typeClasses, className)} style={style}>\n      <input type=\"checkbox\" className=\"custom-control-input\" id={id} checked={checked} onChange={onChecked} />\n      <label className=\"custom-control-label\" htmlFor={id}>{children}</label>\n    </span>\n  );\n};\n\nexport default BooleanControl;\n","import { FC } from 'react';\nimport BooleanControl, { BooleanControlProps } from './BooleanControl';\n\nconst Checkbox: FC<BooleanControlProps> = (props) => <BooleanControl type=\"checkbox\" {...props} />;\n\nexport default Checkbox;\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faInfoCircle as infoIcon } from '@fortawesome/free-solid-svg-icons';\nimport { Modal, ModalBody, ModalHeader } from 'reactstrap';\nimport { useToggle } from '../utils/helpers/hooks';\nimport './UseExistingIfFoundInfoIcon.scss';\n\nconst InfoModal = ({ isOpen, toggle }: { isOpen: boolean; toggle: () => void }) => (\n  <Modal isOpen={isOpen} toggle={toggle} centered size=\"lg\">\n    <ModalHeader toggle={toggle}>Info</ModalHeader>\n    <ModalBody>\n      <p>\n        When the&nbsp;\n        <b><i>&quot;Use existing URL if found&quot;</i></b>\n        &nbsp;checkbox is checked, the server will return an existing short URL if it matches provided params.\n      </p>\n      <p>\n        These are the checks performed by Shlink in order to determine if an existing short URL should be returned:\n      </p>\n      <ul>\n        <li>\n          When only the long URL is provided: The most recent match will be returned, or a new short URL will be created\n          if none is found.\n        </li>\n        <li>\n          When long URL and custom slug and/or domain are provided: Same as in previous case, but it will try to match\n          the short URL using both the long URL and the slug, the long URL and the domain, or the three of them.\n          <br />\n          If the slug is being used by another long URL, an error will be returned.\n        </li>\n        <li>\n          When other params are provided: Same as in previous cases, but it will try to match existing short URLs with\n          all provided data. If any of them does not match, a new short URL will be created\n        </li>\n      </ul>\n    </ModalBody>\n  </Modal>\n);\n\nconst UseExistingIfFoundInfoIcon = () => {\n  const [ isModalOpen, toggleModal ] = useToggle();\n\n  return (\n    <>\n      <span title=\"What does this mean?\">\n        <FontAwesomeIcon icon={infoIcon} style={{ cursor: 'pointer' }} onClick={toggleModal} />\n      </span>\n      <InfoModal isOpen={isModalOpen} toggle={toggleModal} />\n    </>\n  );\n};\n\nexport default UseExistingIfFoundInfoIcon;\n","import { FC, useRef } from 'react';\nimport * as Popper from 'popper.js';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faInfoCircle as infoIcon } from '@fortawesome/free-solid-svg-icons';\nimport { UncontrolledTooltip } from 'reactstrap';\n\ninterface InfoTooltipProps {\n  className?: string;\n  placement: Popper.Placement;\n}\n\nexport const InfoTooltip: FC<InfoTooltipProps> = ({ className = '', placement, children }) => {\n  const ref = useRef<HTMLSpanElement | null>();\n  const refCallback = (el: HTMLSpanElement) => {\n    ref.current = el;\n  };\n\n  return (\n    <>\n      <span className={className} ref={refCallback}>\n        <FontAwesomeIcon icon={infoIcon} />\n      </span>\n      <UncontrolledTooltip target={(() => ref.current) as any} placement={placement}>{children}</UncontrolledTooltip>\n    </>\n  );\n};\n","import { ChangeEvent, FC } from 'react';\nimport Checkbox from '../../utils/Checkbox';\nimport { InfoTooltip } from '../../utils/InfoTooltip';\n\ninterface ShortUrlFormCheckboxGroupProps {\n  checked?: boolean;\n  onChange?: (checked: boolean, e: ChangeEvent<HTMLInputElement>) => void;\n  infoTooltip?: string;\n}\n\nexport const ShortUrlFormCheckboxGroup: FC<ShortUrlFormCheckboxGroupProps> = (\n  { children, infoTooltip, checked, onChange },\n) => (\n  <p>\n    <Checkbox inline checked={checked} className={infoTooltip ? 'mr-2' : ''} onChange={onChange}>\n      {children}\n    </Checkbox>\n    {infoTooltip && <InfoTooltip placement=\"right\">{infoTooltip}</InfoTooltip>}\n  </p>\n);\n","import { FC, useEffect, useState } from 'react';\nimport { InputType } from 'reactstrap/lib/Input';\nimport { Button, FormGroup, Input, Row } from 'reactstrap';\nimport { cond, isEmpty, pipe, replace, trim, T } from 'ramda';\nimport classNames from 'classnames';\nimport { parseISO } from 'date-fns';\nimport DateInput, { DateInputProps } from '../utils/DateInput';\nimport { supportsCrawlableVisits, supportsForwardQuery, supportsShortUrlTitle } from '../utils/helpers/features';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { handleEventPreventingDefault, hasValue, OptionalString } from '../utils/utils';\nimport Checkbox from '../utils/Checkbox';\nimport { SelectedServer } from '../servers/data';\nimport { TagsSelectorProps } from '../tags/helpers/TagsSelector';\nimport { DomainSelectorProps } from '../domains/DomainSelector';\nimport { formatIsoDate } from '../utils/helpers/date';\nimport UseExistingIfFoundInfoIcon from './UseExistingIfFoundInfoIcon';\nimport { ShortUrlData } from './data';\nimport { ShortUrlFormCheckboxGroup } from './helpers/ShortUrlFormCheckboxGroup';\nimport './ShortUrlForm.scss';\n\nexport type Mode = 'create' | 'create-basic' | 'edit';\n\ntype DateFields = 'validSince' | 'validUntil';\ntype NonDateFields = 'longUrl' | 'customSlug' | 'shortCodeLength' | 'domain' | 'maxVisits' | 'title';\n\nexport interface ShortUrlFormProps {\n  mode: Mode;\n  saving: boolean;\n  initialState: ShortUrlData;\n  onSave: (shortUrlData: ShortUrlData) => Promise<unknown>;\n  selectedServer: SelectedServer;\n}\n\nconst normalizeTag = pipe(trim, replace(/ /g, '-'));\nconst toDate = (date?: string | Date): Date | undefined => typeof date === 'string' ? parseISO(date) : date;\nconst dynamicColClasses = (flag: boolean) => ({ 'col-sm-6': flag, 'col-sm-12': !flag });\n\nexport const ShortUrlForm = (\n  TagsSelector: FC<TagsSelectorProps>,\n  DomainSelector: FC<DomainSelectorProps>,\n): FC<ShortUrlFormProps> => ({ mode, saving, onSave, initialState, selectedServer }) => {\n  const [ shortUrlData, setShortUrlData ] = useState(initialState);\n  const isEdit = mode === 'edit';\n  const isBasicMode = mode === 'create-basic';\n  const hadTitleOriginally = hasValue(initialState.title);\n  const changeTags = (tags: string[]) => setShortUrlData({ ...shortUrlData, tags: tags.map(normalizeTag) });\n  const reset = () => setShortUrlData(initialState);\n  const resolveNewTitle = (): OptionalString => {\n    const hasNewTitle = hasValue(shortUrlData.title);\n    const matcher = cond<never, OptionalString>([\n      [ () => !hasNewTitle && !hadTitleOriginally, () => undefined ],\n      [ () => !hasNewTitle && hadTitleOriginally, () => null ],\n      [ T, () => shortUrlData.title ],\n    ]);\n\n    return matcher();\n  };\n  const submit = handleEventPreventingDefault(async () => onSave({\n    ...shortUrlData,\n    validSince: formatIsoDate(shortUrlData.validSince) ?? null,\n    validUntil: formatIsoDate(shortUrlData.validUntil) ?? null,\n    maxVisits: !hasValue(shortUrlData.maxVisits) ? null : Number(shortUrlData.maxVisits),\n    title: resolveNewTitle(),\n  }).then(() => !isEdit && reset()).catch(() => {}));\n\n  useEffect(() => {\n    setShortUrlData(initialState);\n  }, [ initialState ]);\n\n  const renderOptionalInput = (\n    id: NonDateFields,\n    placeholder: string,\n    type: InputType = 'text',\n    props = {},\n    fromGroupProps = {},\n  ) => (\n    <FormGroup {...fromGroupProps}>\n      <Input\n        id={id}\n        type={type}\n        placeholder={placeholder}\n        value={shortUrlData[id] ?? ''}\n        onChange={(e) => setShortUrlData({ ...shortUrlData, [id]: e.target.value })}\n        {...props}\n      />\n    </FormGroup>\n  );\n  const renderDateInput = (id: DateFields, placeholder: string, props: Partial<DateInputProps> = {}) => (\n    <div className=\"form-group\">\n      <DateInput\n        selected={shortUrlData[id] ? toDate(shortUrlData[id] as string | Date) : null}\n        placeholderText={placeholder}\n        isClearable\n        onChange={(date) => setShortUrlData({ ...shortUrlData, [id]: date })}\n        {...props}\n      />\n    </div>\n  );\n  const basicComponents = (\n    <>\n      <FormGroup>\n        <Input\n          bsSize=\"lg\"\n          type=\"url\"\n          placeholder=\"URL to be shortened\"\n          required\n          value={shortUrlData.longUrl}\n          onChange={(e) => setShortUrlData({ ...shortUrlData, longUrl: e.target.value })}\n        />\n      </FormGroup>\n      <Row>\n        {isBasicMode && renderOptionalInput('customSlug', 'Custom slug', 'text', { bsSize: 'lg' }, { className: 'col-lg-6' })}\n        <FormGroup className={isBasicMode ? 'col-lg-6' : 'col-12 mb-0'}>\n          <TagsSelector selectedTags={shortUrlData.tags ?? []} onChange={changeTags} />\n        </FormGroup>\n      </Row>\n    </>\n  );\n\n  const supportsTitle = supportsShortUrlTitle(selectedServer);\n  const showCustomizeCard = supportsTitle || !isEdit;\n  const limitAccessCardClasses = classNames('mb-3', dynamicColClasses(showCustomizeCard));\n  const showCrawlableControl = supportsCrawlableVisits(selectedServer);\n  const showForwardQueryControl = supportsForwardQuery(selectedServer);\n  const showBehaviorCard = showCrawlableControl || showForwardQueryControl;\n  const extraChecksCardClasses = classNames('mb-3', dynamicColClasses(showBehaviorCard));\n\n  return (\n    <form className=\"short-url-form\" onSubmit={submit}>\n      {isBasicMode && basicComponents}\n      {!isBasicMode && (\n        <>\n          <SimpleCard title=\"Basic options\" className=\"mb-3\">\n            {basicComponents}\n          </SimpleCard>\n\n          <Row>\n            {showCustomizeCard && (\n              <div className=\"col-sm-6 mb-3\">\n                <SimpleCard title=\"Customize the short URL\">\n                  {supportsTitle && renderOptionalInput('title', 'Title')}\n                  {!isEdit && (\n                    <>\n                      <Row>\n                        <div className=\"col-lg-6\">\n                          {renderOptionalInput('customSlug', 'Custom slug', 'text', {\n                            disabled: hasValue(shortUrlData.shortCodeLength),\n                          })}\n                        </div>\n                        <div className=\"col-lg-6\">\n                          {renderOptionalInput('shortCodeLength', 'Short code length', 'number', {\n                            min: 4,\n                            disabled: hasValue(shortUrlData.customSlug),\n                          })}\n                        </div>\n                      </Row>\n                      <FormGroup>\n                        <DomainSelector\n                          value={shortUrlData.domain}\n                          onChange={(domain?: string) => setShortUrlData({ ...shortUrlData, domain })}\n                        />\n                      </FormGroup>\n                    </>\n                  )}\n                </SimpleCard>\n              </div>\n            )}\n\n            <div className={limitAccessCardClasses}>\n              <SimpleCard title=\"Limit access to the short URL\">\n                {renderOptionalInput('maxVisits', 'Maximum number of visits allowed', 'number', { min: 1 })}\n                {renderDateInput('validSince', 'Enabled since...', { maxDate: shortUrlData.validUntil ? toDate(shortUrlData.validUntil) : undefined })}\n                {renderDateInput('validUntil', 'Enabled until...', { minDate: shortUrlData.validSince ? toDate(shortUrlData.validSince) : undefined })}\n              </SimpleCard>\n            </div>\n          </Row>\n\n          <Row>\n            <div className={extraChecksCardClasses}>\n              <SimpleCard title=\"Extra checks\">\n                <ShortUrlFormCheckboxGroup\n                  infoTooltip=\"If checked, Shlink will try to reach the long URL, failing in case it's not publicly accessible.\"\n                  checked={shortUrlData.validateUrl}\n                  onChange={(validateUrl) => setShortUrlData({ ...shortUrlData, validateUrl })}\n                >\n                  Validate URL\n                </ShortUrlFormCheckboxGroup>\n                {!isEdit && (\n                  <p>\n                    <Checkbox\n                      inline\n                      className=\"mr-2\"\n                      checked={shortUrlData.findIfExists}\n                      onChange={(findIfExists) => setShortUrlData({ ...shortUrlData, findIfExists })}\n                    >\n                      Use existing URL if found\n                    </Checkbox>\n                    <UseExistingIfFoundInfoIcon />\n                  </p>\n                )}\n              </SimpleCard>\n            </div>\n            {showBehaviorCard && (\n              <div className=\"col-sm-6 mb-3\">\n                <SimpleCard title=\"Configure behavior\">\n                  {showCrawlableControl && (\n                    <ShortUrlFormCheckboxGroup\n                      infoTooltip=\"This short URL will be included in the robots.txt for your Shlink instance, allowing web crawlers (like Google) to index it.\"\n                      checked={shortUrlData.crawlable}\n                      onChange={(crawlable) => setShortUrlData({ ...shortUrlData, crawlable })}\n                    >\n                      Make it crawlable\n                    </ShortUrlFormCheckboxGroup>\n                  )}\n                  {showForwardQueryControl && (\n                    <ShortUrlFormCheckboxGroup\n                      infoTooltip=\"When this short URL is visited, any query params appended to it will be forwarded to the long URL.\"\n                      checked={shortUrlData.forwardQuery}\n                      onChange={(forwardQuery) => setShortUrlData({ ...shortUrlData, forwardQuery })}\n                    >\n                      Forward query params on redirect\n                    </ShortUrlFormCheckboxGroup>\n                  )}\n                </SimpleCard>\n              </div>\n            )}\n          </Row>\n        </>\n      )}\n\n      <div className=\"text-center\">\n        <Button\n          outline\n          color=\"primary\"\n          disabled={saving || isEmpty(shortUrlData.longUrl)}\n          className=\"btn-xs-block\"\n        >\n          {saving ? 'Saving...' : 'Save'}\n        </Button>\n      </div>\n    </form>\n  );\n};\n","import { FC, useEffect, useMemo } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport { Button, Card } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\nimport { ExternalLink } from 'react-external-link';\nimport { SelectedServer } from '../servers/data';\nimport { Settings, ShortUrlCreationSettings } from '../settings/reducers/settings';\nimport { OptionalString } from '../utils/utils';\nimport { parseQuery } from '../utils/helpers/query';\nimport Message from '../utils/Message';\nimport { Result } from '../utils/Result';\nimport { ShlinkApiError } from '../api/ShlinkApiError';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { ShortUrlFormProps } from './ShortUrlForm';\nimport { ShortUrlDetail } from './reducers/shortUrlDetail';\nimport { EditShortUrlData, ShortUrl, ShortUrlData } from './data';\nimport { ShortUrlEdition } from './reducers/shortUrlEdition';\n\ninterface EditShortUrlConnectProps extends RouteComponentProps<{ shortCode: string }> {\n  settings: Settings;\n  selectedServer: SelectedServer;\n  shortUrlDetail: ShortUrlDetail;\n  shortUrlEdition: ShortUrlEdition;\n  getShortUrlDetail: (shortCode: string, domain: OptionalString) => void;\n  editShortUrl: (shortUrl: string, domain: OptionalString, data: EditShortUrlData) => Promise<void>;\n}\n\nconst getInitialState = (shortUrl?: ShortUrl, settings?: ShortUrlCreationSettings): ShortUrlData => {\n  const validateUrl = settings?.validateUrls ?? false;\n\n  if (!shortUrl) {\n    return { longUrl: '', validateUrl };\n  }\n\n  return {\n    longUrl: shortUrl.longUrl,\n    tags: shortUrl.tags,\n    title: shortUrl.title ?? undefined,\n    domain: shortUrl.domain ?? undefined,\n    validSince: shortUrl.meta.validSince ?? undefined,\n    validUntil: shortUrl.meta.validUntil ?? undefined,\n    maxVisits: shortUrl.meta.maxVisits ?? undefined,\n    crawlable: shortUrl.crawlable,\n    forwardQuery: shortUrl.forwardQuery,\n    validateUrl,\n  };\n};\n\nexport const EditShortUrl = (ShortUrlForm: FC<ShortUrlFormProps>) => ({\n  history: { goBack },\n  match: { params },\n  location: { search },\n  settings: { shortUrlCreation: shortUrlCreationSettings },\n  selectedServer,\n  shortUrlDetail,\n  getShortUrlDetail,\n  shortUrlEdition,\n  editShortUrl,\n}: EditShortUrlConnectProps) => {\n  const { loading, error, errorData, shortUrl } = shortUrlDetail;\n  const { saving, error: savingError, errorData: savingErrorData } = shortUrlEdition;\n  const { domain } = parseQuery<{ domain?: string }>(search);\n  const initialState = useMemo(\n    () => getInitialState(shortUrl, shortUrlCreationSettings),\n    [ shortUrl, shortUrlCreationSettings ],\n  );\n  const [ savingSucceeded,, isSuccessful, isNotSuccessful ] = useToggle();\n\n  useEffect(() => {\n    getShortUrlDetail(params.shortCode, domain);\n  }, []);\n\n  if (loading) {\n    return <Message loading />;\n  }\n\n  if (error) {\n    return (\n      <Result type=\"error\">\n        <ShlinkApiError errorData={errorData} fallbackMessage=\"An error occurred while loading short URL detail :(\" />\n      </Result>\n    );\n  }\n\n  return (\n    <>\n      <header className=\"mb-3\">\n        <Card body>\n          <h2 className=\"d-sm-flex justify-content-between align-items-center mb-0\">\n            <Button color=\"link\" size=\"lg\" className=\"p-0 mr-3\" onClick={goBack}>\n              <FontAwesomeIcon icon={faArrowLeft} />\n            </Button>\n            <span className=\"text-center\">\n              <small>Edit <ExternalLink href={shortUrl?.shortUrl ?? ''} /></small>\n            </span>\n            <span />\n          </h2>\n        </Card>\n      </header>\n      <ShortUrlForm\n        initialState={initialState}\n        saving={saving}\n        selectedServer={selectedServer}\n        mode=\"edit\"\n        onSave={async (shortUrlData) => {\n          if (!shortUrl) {\n            return;\n          }\n\n          isNotSuccessful();\n          editShortUrl(shortUrl.shortCode, shortUrl.domain, shortUrlData)\n            .then(isSuccessful)\n            .catch(isNotSuccessful);\n        }}\n      />\n      {savingError && (\n        <Result type=\"error\" className=\"mt-3\">\n          <ShlinkApiError errorData={savingErrorData} fallbackMessage=\"An error occurred while updating short URL :(\" />\n        </Result>\n      )}\n      {savingSucceeded && <Result type=\"success\" className=\"mt-3\">Short URL properly edited.</Result>}\n    </>\n  );\n};\n","import { Action, Dispatch } from 'redux';\nimport { ShortUrl } from '../data';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { OptionalString } from '../../utils/utils';\nimport { GetState } from '../../container/types';\nimport { shortUrlMatches } from '../helpers';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\nimport { ApiErrorAction } from '../../api/types/actions';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_SHORT_URL_DETAIL_START = 'shlink/shortUrlDetail/GET_SHORT_URL_DETAIL_START';\nexport const GET_SHORT_URL_DETAIL_ERROR = 'shlink/shortUrlDetail/GET_SHORT_URL_DETAIL_ERROR';\nexport const GET_SHORT_URL_DETAIL = 'shlink/shortUrlDetail/GET_SHORT_URL_DETAIL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlDetail {\n  shortUrl?: ShortUrl;\n  loading: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface ShortUrlDetailAction extends Action<string> {\n  shortUrl: ShortUrl;\n}\n\nconst initialState: ShortUrlDetail = {\n  loading: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlDetail, ShortUrlDetailAction & ApiErrorAction>({\n  [GET_SHORT_URL_DETAIL_START]: () => ({ loading: true, error: false }),\n  [GET_SHORT_URL_DETAIL_ERROR]: (_, { errorData }) => ({ loading: false, error: true, errorData }),\n  [GET_SHORT_URL_DETAIL]: (_, { shortUrl }) => ({ shortUrl, ...initialState }),\n}, initialState);\n\nexport const getShortUrlDetail = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  domain: OptionalString,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: GET_SHORT_URL_DETAIL_START });\n\n  try {\n    const { shortUrlsList } = getState();\n    const shortUrl = shortUrlsList?.shortUrls?.data.find(\n      (shortUrl) => shortUrlMatches(shortUrl, shortCode, domain),\n    ) ?? await buildShlinkApiClient(getState).getShortUrl(shortCode, domain);\n\n    dispatch<ShortUrlDetailAction>({ shortUrl, type: GET_SHORT_URL_DETAIL });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: GET_SHORT_URL_DETAIL_ERROR, errorData: parseApiError(e) });\n  }\n};\n","import Bottle, { Decorator } from 'bottlejs';\nimport ShortUrlsFilteringBar from '../ShortUrlsFilteringBar';\nimport ShortUrlsList from '../ShortUrlsList';\nimport ShortUrlsRow from '../helpers/ShortUrlsRow';\nimport ShortUrlsRowMenu from '../helpers/ShortUrlsRowMenu';\nimport CreateShortUrl from '../CreateShortUrl';\nimport DeleteShortUrlModal from '../helpers/DeleteShortUrlModal';\nimport CreateShortUrlResult from '../helpers/CreateShortUrlResult';\nimport { listShortUrls } from '../reducers/shortUrlsList';\nimport { createShortUrl, resetCreateShortUrl } from '../reducers/shortUrlCreation';\nimport { deleteShortUrl, resetDeleteShortUrl } from '../reducers/shortUrlDeletion';\nimport { editShortUrl } from '../reducers/shortUrlEdition';\nimport { ConnectDecorator } from '../../container/types';\nimport { ShortUrlsTable } from '../ShortUrlsTable';\nimport QrCodeModal from '../helpers/QrCodeModal';\nimport { ShortUrlForm } from '../ShortUrlForm';\nimport { EditShortUrl } from '../EditShortUrl';\nimport { getShortUrlDetail } from '../reducers/shortUrlDetail';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator, withRouter: Decorator) => {\n  // Components\n  bottle.serviceFactory('ShortUrlsList', ShortUrlsList, 'ShortUrlsTable', 'ShortUrlsFilteringBar');\n  bottle.decorator('ShortUrlsList', connect(\n    [ 'selectedServer', 'mercureInfo', 'shortUrlsList', 'settings' ],\n    [ 'listShortUrls', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  bottle.serviceFactory('ShortUrlsTable', ShortUrlsTable, 'ShortUrlsRow');\n  bottle.serviceFactory('ShortUrlsRow', ShortUrlsRow, 'ShortUrlsRowMenu', 'ColorGenerator', 'useStateFlagTimeout');\n  bottle.serviceFactory('ShortUrlsRowMenu', ShortUrlsRowMenu, 'DeleteShortUrlModal', 'QrCodeModal');\n  bottle.serviceFactory('CreateShortUrlResult', CreateShortUrlResult, 'useStateFlagTimeout');\n  bottle.serviceFactory('ShortUrlForm', ShortUrlForm, 'TagsSelector', 'DomainSelector');\n\n  bottle.serviceFactory('CreateShortUrl', CreateShortUrl, 'ShortUrlForm', 'CreateShortUrlResult');\n  bottle.decorator(\n    'CreateShortUrl',\n    connect([ 'shortUrlCreationResult', 'selectedServer', 'settings' ], [ 'createShortUrl', 'resetCreateShortUrl' ]),\n  );\n\n  bottle.serviceFactory('EditShortUrl', EditShortUrl, 'ShortUrlForm');\n  bottle.decorator('EditShortUrl', connect(\n    [ 'shortUrlDetail', 'shortUrlEdition', 'selectedServer', 'settings' ],\n    [ 'getShortUrlDetail', 'editShortUrl' ],\n  ));\n\n  bottle.serviceFactory('DeleteShortUrlModal', () => DeleteShortUrlModal);\n  bottle.decorator('DeleteShortUrlModal', connect([ 'shortUrlDeletion' ], [ 'deleteShortUrl', 'resetDeleteShortUrl' ]));\n\n  bottle.serviceFactory('QrCodeModal', QrCodeModal, 'ImageDownloader', 'ForServerVersion');\n  bottle.decorator('QrCodeModal', connect([ 'selectedServer' ]));\n\n  // Services\n  bottle.serviceFactory('ShortUrlsFilteringBar', ShortUrlsFilteringBar, 'ColorGenerator');\n  bottle.decorator('ShortUrlsFilteringBar', withRouter);\n\n  // Actions\n  bottle.serviceFactory('listShortUrls', listShortUrls, 'buildShlinkApiClient');\n\n  bottle.serviceFactory('createShortUrl', createShortUrl, 'buildShlinkApiClient');\n  bottle.serviceFactory('resetCreateShortUrl', () => resetCreateShortUrl);\n\n  bottle.serviceFactory('deleteShortUrl', deleteShortUrl, 'buildShlinkApiClient');\n  bottle.serviceFactory('resetDeleteShortUrl', () => resetDeleteShortUrl);\n\n  bottle.serviceFactory('getShortUrlDetail', getShortUrlDetail, 'buildShlinkApiClient');\n\n  bottle.serviceFactory('editShortUrl', editShortUrl, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import { FC, useRef } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { InputType } from 'reactstrap/lib/Input';\nimport { FormGroup } from 'reactstrap';\n\nexport interface FormGroupContainerProps {\n  value: string;\n  onChange: (newValue: string) => void;\n  id?: string;\n  type?: InputType;\n  required?: boolean;\n  placeholder?: string;\n  className?: string;\n  labelClassName?: string;\n}\n\nexport const FormGroupContainer: FC<FormGroupContainerProps> = (\n  { children, value, onChange, id, type, required, placeholder, className, labelClassName },\n) => {\n  const forId = useRef<string>(id ?? uuid());\n\n  return (\n    <FormGroup className={className ?? ''}>\n      <label htmlFor={forId.current} className={labelClassName ?? ''}>\n        {children}:\n      </label>\n      <input\n        className=\"form-control\"\n        type={type ?? 'text'}\n        id={forId.current}\n        value={value}\n        required={required ?? true}\n        placeholder={placeholder}\n        onChange={(e) => onChange(e.target.value)}\n      />\n    </FormGroup>\n  );\n};\n","import { FC, ReactNode, useEffect, useState } from 'react';\nimport { FormGroupContainer, FormGroupContainerProps } from '../../utils/FormGroupContainer';\nimport { handleEventPreventingDefault } from '../../utils/utils';\nimport { ServerData } from '../data';\nimport { SimpleCard } from '../../utils/SimpleCard';\nimport './ServerForm.scss';\n\ninterface ServerFormProps {\n  onSubmit: (server: ServerData) => void;\n  initialValues?: ServerData;\n  title?: ReactNode;\n}\n\nconst FormGroup: FC<FormGroupContainerProps> = (props) =>\n  <FormGroupContainer {...props} labelClassName=\"server-form__label\" />;\n\nexport const ServerForm: FC<ServerFormProps> = ({ onSubmit, initialValues, children, title }) => {\n  const [ name, setName ] = useState('');\n  const [ url, setUrl ] = useState('');\n  const [ apiKey, setApiKey ] = useState('');\n  const handleSubmit = handleEventPreventingDefault(() => onSubmit({ name, url, apiKey }));\n\n  useEffect(() => {\n    initialValues && setName(initialValues.name);\n    initialValues && setUrl(initialValues.url);\n    initialValues && setApiKey(initialValues.apiKey);\n  }, [ initialValues ]);\n\n  return (\n    <form className=\"server-form\" onSubmit={handleSubmit}>\n      <SimpleCard className=\"mb-3\" title={title}>\n        <FormGroup value={name} onChange={setName}>Name</FormGroup>\n        <FormGroup type=\"url\" value={url} onChange={setUrl}>URL</FormGroup>\n        <FormGroup value={apiKey} onChange={setApiKey}>API key</FormGroup>\n      </SimpleCard>\n\n      <div className=\"text-right\">{children}</div>\n    </form>\n  );\n};\n","import { FC, Fragment } from 'react';\nimport { Button, Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { ServerData } from '../data';\n\ninterface DuplicatedServersModalProps {\n  duplicatedServers: ServerData[];\n  isOpen: boolean;\n  onDiscard: () => void;\n  onSave: () => void;\n}\n\nexport const DuplicatedServersModal: FC<DuplicatedServersModalProps> = (\n  { isOpen, duplicatedServers, onDiscard, onSave },\n) => {\n  const hasMultipleServers = duplicatedServers.length > 1;\n\n  return (\n    <Modal centered isOpen={isOpen}>\n      <ModalHeader>Duplicated server{hasMultipleServers && 's'}</ModalHeader>\n      <ModalBody>\n        <p>{hasMultipleServers ? 'The next servers already exist:' : 'There is already a server with:'}</p>\n        <ul>\n          {duplicatedServers.map(({ url, apiKey }, index) => !hasMultipleServers ? (\n            <Fragment key={index}>\n              <li>URL: <b>{url}</b></li>\n              <li>API key: <b>{apiKey}</b></li>\n            </Fragment>\n          ) : <li key={index}><b>{url}</b> - <b>{apiKey}</b></li>)}\n        </ul>\n        <span>\n          {hasMultipleServers ? 'Do you want to ignore duplicated servers' : 'Do you want to save this server anyway'}?\n        </span>\n      </ModalBody>\n      <ModalFooter>\n        <Button color=\"link\" onClick={onDiscard}>{hasMultipleServers ? 'Ignore duplicated' : 'Discard'}</Button>\n        <Button color=\"primary\" onClick={onSave}>Save anyway</Button>\n      </ModalFooter>\n    </Modal>\n  );\n};\n","import { FC, useEffect, useState } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { RouterProps } from 'react-router';\nimport { Button } from 'reactstrap';\nimport { Result } from '../utils/Result';\nimport { NoMenuLayout } from '../common/NoMenuLayout';\nimport { StateFlagTimeout, useToggle } from '../utils/helpers/hooks';\nimport { ServerForm } from './helpers/ServerForm';\nimport { ImportServersBtnProps } from './helpers/ImportServersBtn';\nimport { ServerData, ServersMap, ServerWithId } from './data';\nimport { DuplicatedServersModal } from './helpers/DuplicatedServersModal';\n\nconst SHOW_IMPORT_MSG_TIME = 4000;\n\ninterface CreateServerProps extends RouterProps {\n  createServer: (server: ServerWithId) => void;\n  servers: ServersMap;\n}\n\nconst ImportResult = ({ type }: { type: 'error' | 'success' }) => (\n  <div className=\"mt-3\">\n    <Result type={type}>\n      {type === 'success' && 'Servers properly imported. You can now select one from the list :)'}\n      {type === 'error' && 'The servers could not be imported. Make sure the format is correct.'}\n    </Result>\n  </div>\n);\n\nconst CreateServer = (ImportServersBtn: FC<ImportServersBtnProps>, useStateFlagTimeout: StateFlagTimeout) => (\n  { servers, createServer, history: { push, goBack } }: CreateServerProps,\n) => {\n  const hasServers = !!Object.keys(servers).length;\n  const [ serversImported, setServersImported ] = useStateFlagTimeout(false, SHOW_IMPORT_MSG_TIME);\n  const [ errorImporting, setErrorImporting ] = useStateFlagTimeout(false, SHOW_IMPORT_MSG_TIME);\n  const [ isConfirmModalOpen, toggleConfirmModal ] = useToggle();\n  const [ serverData, setServerData ] = useState<ServerData | undefined>();\n  const save = () => {\n    if (!serverData) {\n      return;\n    }\n\n    const id = uuid();\n\n    createServer({ ...serverData, id });\n    push(`/server/${id}`);\n  };\n\n  useEffect(() => {\n    const serverExists = Object.values(servers).some(\n      ({ url, apiKey }) => serverData?.url === url && serverData?.apiKey === apiKey,\n    );\n\n    serverExists ? toggleConfirmModal() : save();\n  }, [ serverData ]);\n\n  return (\n    <NoMenuLayout>\n      <ServerForm title={<h5 className=\"mb-0\">Add new server</h5>} onSubmit={setServerData}>\n        {!hasServers &&\n          <ImportServersBtn tooltipPlacement=\"top\" onImport={setServersImported} onImportError={setErrorImporting} />}\n        {hasServers && <Button outline onClick={goBack}>Cancel</Button>}\n        <Button outline color=\"primary\" className=\"ml-2\">Create server</Button>\n      </ServerForm>\n\n      {serversImported && <ImportResult type=\"success\" />}\n      {errorImporting && <ImportResult type=\"error\" />}\n\n      <DuplicatedServersModal\n        isOpen={isConfirmModalOpen}\n        duplicatedServers={serverData ? [ serverData ] : []}\n        onDiscard={goBack}\n        onSave={save}\n      />\n    </NoMenuLayout>\n  );\n};\n\nexport default CreateServer;\n","import { isEmpty, values } from 'ramda';\nimport { DropdownItem, DropdownMenu, DropdownToggle, UncontrolledDropdown } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport { faPlus as plusIcon, faServer as serverIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { getServerId, SelectedServer, ServersMap } from './data';\n\nexport interface ServersDropdownProps {\n  servers: ServersMap;\n  selectedServer: SelectedServer;\n}\n\nconst ServersDropdown = ({ servers, selectedServer }: ServersDropdownProps) => {\n  const serversList = values(servers);\n\n  const renderServers = () => {\n    if (isEmpty(serversList)) {\n      return (\n        <DropdownItem tag={Link} to=\"/server/create\">\n          <FontAwesomeIcon icon={plusIcon} /> <span className=\"ml-1\">Add a server</span>\n        </DropdownItem>\n      );\n    }\n\n    return (\n      <>\n        {serversList.map(({ name, id }) => (\n          <DropdownItem key={id} tag={Link} to={`/server/${id}`} active={getServerId(selectedServer) === id}>\n            {name}\n          </DropdownItem>\n        ))}\n        <DropdownItem divider />\n        <DropdownItem tag={Link} to=\"/manage-servers\">\n          <FontAwesomeIcon icon={serverIcon} /> <span className=\"ml-1\">Manage servers</span>\n        </DropdownItem>\n      </>\n    );\n  };\n\n  return (\n    <UncontrolledDropdown nav inNavbar>\n      <DropdownToggle nav caret>\n        <FontAwesomeIcon icon={serverIcon} /> <span className=\"ml-1\">Servers</span>\n      </DropdownToggle>\n      <DropdownMenu right>{renderServers()}</DropdownMenu>\n    </UncontrolledDropdown>\n  );\n};\n\nexport default ServersDropdown;\n","import { FC } from 'react';\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { RouterProps } from 'react-router';\nimport { ServerWithId } from './data';\n\nexport interface DeleteServerModalProps {\n  server: ServerWithId;\n  toggle: () => void;\n  isOpen: boolean;\n  redirectHome?: boolean;\n}\n\ninterface DeleteServerModalConnectProps extends DeleteServerModalProps, RouterProps {\n  deleteServer: (server: ServerWithId) => void;\n}\n\nconst DeleteServerModal: FC<DeleteServerModalConnectProps> = (\n  { server, toggle, isOpen, deleteServer, history, redirectHome = true },\n) => {\n  const closeModal = () => {\n    deleteServer(server);\n    toggle();\n    redirectHome && history.push('/');\n  };\n\n  return (\n    <Modal isOpen={isOpen} toggle={toggle} centered>\n      <ModalHeader toggle={toggle}><span className=\"text-danger\">Remove server</span></ModalHeader>\n      <ModalBody>\n        <p>Are you sure you want to remove <b>{server ? server.name : ''}</b>?</p>\n        <p>\n          <i>\n            No data will be deleted, only the access to this server will be removed from this device.\n            You can create it again at any moment.\n          </i>\n        </p>\n      </ModalBody>\n      <ModalFooter>\n        <button className=\"btn btn-link\" onClick={toggle}>Cancel</button>\n        <button className=\"btn btn-danger\" onClick={() => closeModal()}>Delete</button>\n      </ModalFooter>\n    </Modal>\n  );\n};\n\nexport default DeleteServerModal;\n","import { FC } from 'react';\nimport { faMinusCircle as deleteIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { DeleteServerModalProps } from './DeleteServerModal';\nimport { ServerWithId } from './data';\n\nexport interface DeleteServerButtonProps {\n  server: ServerWithId;\n  className?: string;\n  textClassName?: string;\n}\n\nconst DeleteServerButton = (DeleteServerModal: FC<DeleteServerModalProps>): FC<DeleteServerButtonProps> => (\n  { server, className, children, textClassName },\n) => {\n  const [ isModalOpen, , showModal, hideModal ] = useToggle();\n\n  return (\n    <>\n      <span className={className} onClick={showModal}>\n        {!children && <FontAwesomeIcon fixedWidth icon={deleteIcon} />}\n        <span className={textClassName}>{children ?? 'Remove this server'}</span>\n      </span>\n\n      <DeleteServerModal server={server} isOpen={isModalOpen} toggle={hideModal} />\n    </>\n  );\n};\n\nexport default DeleteServerButton;\n","import { FC } from 'react';\nimport { Button } from 'reactstrap';\nimport { NoMenuLayout } from '../common/NoMenuLayout';\nimport { ServerForm } from './helpers/ServerForm';\nimport { withSelectedServer } from './helpers/withSelectedServer';\nimport { isServerWithId, ServerData } from './data';\n\ninterface EditServerProps {\n  editServer: (serverId: string, serverData: ServerData) => void;\n}\n\nexport const EditServer = (ServerError: FC) => withSelectedServer<EditServerProps>((\n  { editServer, selectedServer, history: { goBack } },\n) => {\n  if (!isServerWithId(selectedServer)) {\n    return null;\n  }\n\n  const handleSubmit = (serverData: ServerData) => {\n    editServer(selectedServer.id, serverData);\n    goBack();\n  };\n\n  return (\n    <NoMenuLayout>\n      <ServerForm\n        title={<h5 className=\"mb-0\">Edit &quot;{selectedServer.name}&quot;</h5>}\n        initialValues={selectedServer}\n        onSubmit={handleSubmit}\n      >\n        <Button outline className=\"mr-2\" onClick={goBack}>Cancel</Button>\n        <Button outline color=\"primary\">Save</Button>\n      </ServerForm>\n    </NoMenuLayout>\n  );\n}, ServerError);\n","import { useRef, RefObject, ChangeEvent, MutableRefObject, FC, useState, useEffect } from 'react';\nimport { Button, UncontrolledTooltip } from 'reactstrap';\nimport { complement, pipe } from 'ramda';\nimport { faFileUpload as importIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { ServersImporter } from '../services/ServersImporter';\nimport { ServerData, ServersMap } from '../data';\nimport { DuplicatedServersModal } from './DuplicatedServersModal';\nimport './ImportServersBtn.scss';\n\ntype Ref<T> = RefObject<T> | MutableRefObject<T>;\n\nexport interface ImportServersBtnProps {\n  onImport?: () => void;\n  onImportError?: (error: Error) => void;\n  tooltipPlacement?: 'top' | 'bottom';\n  className?: string;\n}\n\ninterface ImportServersBtnConnectProps extends ImportServersBtnProps {\n  createServers: (servers: ServerData[]) => void;\n  servers: ServersMap;\n  fileRef: Ref<HTMLInputElement>;\n}\n\nconst serversFiltering = (servers: ServerData[]) =>\n  ({ url, apiKey }: ServerData) => servers.some((server) => server.url === url && server.apiKey === apiKey);\n\nconst ImportServersBtn = ({ importServersFromFile }: ServersImporter): FC<ImportServersBtnConnectProps> => ({\n  createServers,\n  servers,\n  fileRef,\n  children,\n  onImport = () => {},\n  onImportError = () => {},\n  tooltipPlacement = 'bottom',\n  className = '',\n}) => {\n  const ref = fileRef ?? useRef<HTMLInputElement>();\n  const [ serversToCreate, setServersToCreate ] = useState<ServerData[] | undefined>();\n  const [ duplicatedServers, setDuplicatedServers ] = useState<ServerData[]>([]);\n  const [ isModalOpen,, showModal, hideModal ] = useToggle();\n  const create = pipe(createServers, onImport);\n  const createAllServers = pipe(() => create(serversToCreate ?? []), hideModal);\n  const createNonDuplicatedServers = pipe(\n    () => create((serversToCreate ?? []).filter(complement(serversFiltering(duplicatedServers)))),\n    hideModal,\n  );\n  const onFile = async ({ target }: ChangeEvent<HTMLInputElement>) =>\n    importServersFromFile(target.files?.[0])\n      .then(setServersToCreate)\n      .then(() => {\n        // Reset input after processing file\n        (target as { value: string | null }).value = null;\n      })\n      .catch(onImportError);\n\n  useEffect(() => {\n    if (!serversToCreate) {\n      return;\n    }\n\n    const existingServers = Object.values(servers);\n    const duplicatedServers = serversToCreate.filter(serversFiltering(existingServers));\n    const hasDuplicatedServers = !!duplicatedServers.length;\n\n    !hasDuplicatedServers ? create(serversToCreate) : setDuplicatedServers(duplicatedServers);\n    hasDuplicatedServers && showModal();\n  }, [ serversToCreate ]);\n\n  return (\n    <>\n      <Button outline id=\"importBtn\" className={className} onClick={() => ref.current?.click()}>\n        <FontAwesomeIcon icon={importIcon} fixedWidth /> {children ?? 'Import from file'}\n      </Button>\n      <UncontrolledTooltip placement={tooltipPlacement} target=\"importBtn\">\n        You can create servers by importing a CSV file with columns <b>name</b>, <b>apiKey</b> and <b>url</b>.\n      </UncontrolledTooltip>\n\n      <input type=\"file\" accept=\"text/csv\" className=\"import-servers-btn__csv-select\" ref={ref} onChange={onFile} />\n\n      <DuplicatedServersModal\n        isOpen={isModalOpen}\n        duplicatedServers={duplicatedServers}\n        onDiscard={createNonDuplicatedServers}\n        onSave={createAllServers}\n      />\n    </>\n  );\n};\n\nexport default ImportServersBtn;\n","import { identity, memoizeWith, pipe } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { versionToPrintable, versionToSemVer as toSemVer } from '../../utils/helpers/version';\nimport { SelectedServer } from '../data';\nimport { GetState } from '../../container/types';\nimport { ShlinkHealth } from '../../api/types';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\n\n/* eslint-disable padding-line-between-statements */\nexport const SELECT_SERVER = 'shlink/selectedServer/SELECT_SERVER';\nexport const RESET_SELECTED_SERVER = 'shlink/selectedServer/RESET_SELECTED_SERVER';\n\nexport const MIN_FALLBACK_VERSION = '1.0.0';\nexport const MAX_FALLBACK_VERSION = '999.999.999';\nexport const LATEST_VERSION_CONSTRAINT = 'latest';\n/* eslint-enable padding-line-between-statements */\n\nexport interface SelectServerAction extends Action<string> {\n  selectedServer: SelectedServer;\n}\n\nconst versionToSemVer = pipe(\n  (version: string) => version === LATEST_VERSION_CONSTRAINT ? MAX_FALLBACK_VERSION : version,\n  toSemVer(MIN_FALLBACK_VERSION),\n);\n\nconst getServerVersion = memoizeWith(\n  identity,\n  async (_serverId: string, health: () => Promise<ShlinkHealth>) => health().then(({ version }) => ({\n    version: versionToSemVer(version),\n    printableVersion: versionToPrintable(version),\n  })),\n);\n\nconst initialState: SelectedServer = null;\n\nexport default buildReducer<SelectedServer, SelectServerAction>({\n  [RESET_SELECTED_SERVER]: () => initialState,\n  [SELECT_SERVER]: (_, { selectedServer }) => selectedServer,\n}, initialState);\n\nexport const resetSelectedServer = buildActionCreator(RESET_SELECTED_SERVER);\n\nexport const selectServer = (\n  buildShlinkApiClient: ShlinkApiClientBuilder,\n  loadMercureInfo: () => Action,\n) => (\n  serverId: string,\n) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch(resetSelectedServer());\n\n  const { servers } = getState();\n  const selectedServer = servers[serverId];\n\n  if (!selectedServer) {\n    dispatch<SelectServerAction>({\n      type: SELECT_SERVER,\n      selectedServer: { serverNotFound: true },\n    });\n\n    return;\n  }\n\n  try {\n    const { health } = buildShlinkApiClient(selectedServer);\n    const { version, printableVersion } = await getServerVersion(serverId, health);\n\n    dispatch<SelectServerAction>({\n      type: SELECT_SERVER,\n      selectedServer: {\n        ...selectedServer,\n        version,\n        printableVersion,\n      },\n    });\n    dispatch(loadMercureInfo());\n  } catch (e) {\n    dispatch<SelectServerAction>({\n      type: SELECT_SERVER,\n      selectedServer: { ...selectedServer, serverNotReachable: true },\n    });\n  }\n};\n","import { assoc, dissoc, fromPairs, map, pipe, reduce, toPairs } from 'ramda';\nimport { v4 as uuid } from 'uuid';\nimport { Action } from 'redux';\nimport { ServerData, ServersMap, ServerWithId } from '../data';\nimport { buildReducer } from '../../utils/helpers/redux';\n\n/* eslint-disable padding-line-between-statements */\nexport const EDIT_SERVER = 'shlink/servers/EDIT_SERVER';\nexport const DELETE_SERVER = 'shlink/servers/DELETE_SERVER';\nexport const CREATE_SERVERS = 'shlink/servers/CREATE_SERVERS';\nexport const SET_AUTO_CONNECT = 'shlink/servers/SET_AUTO_CONNECT';\n/* eslint-enable padding-line-between-statements */\n\nexport interface CreateServersAction extends Action<string> {\n  newServers: ServersMap;\n}\n\ninterface DeleteServerAction extends Action<string> {\n  serverId: string;\n}\n\ninterface SetAutoConnectAction extends Action<string> {\n  serverId: string;\n  autoConnect: boolean;\n}\n\nconst initialState: ServersMap = {};\n\nconst serverWithId = (server: ServerWithId | ServerData): ServerWithId => {\n  if ((server as ServerWithId).id) {\n    return server as ServerWithId;\n  }\n\n  return assoc('id', uuid(), server);\n};\n\nexport default buildReducer<ServersMap, CreateServersAction & DeleteServerAction & SetAutoConnectAction>({\n  [CREATE_SERVERS]: (state, { newServers }) => ({ ...state, ...newServers }),\n  [DELETE_SERVER]: (state, { serverId }) => dissoc(serverId, state),\n  [EDIT_SERVER]: (state, { serverId, serverData }: any) => !state[serverId]\n    ? state\n    : assoc(serverId, { ...state[serverId], ...serverData }, state),\n  [SET_AUTO_CONNECT]: (state, { serverId, autoConnect }) => {\n    if (!state[serverId]) {\n      return state;\n    }\n\n    if (!autoConnect) {\n      return assoc(serverId, { ...state[serverId], autoConnect }, state);\n    }\n\n    return fromPairs(\n      toPairs(state).map(([ evaluatedServerId, server ]) => [\n        evaluatedServerId,\n        { ...server, autoConnect: evaluatedServerId === serverId },\n      ]),\n    );\n  },\n}, initialState);\n\nconst serversListToMap = reduce<ServerWithId, ServersMap>((acc, server) => assoc(server.id, server, acc), {});\n\nexport const createServers = pipe(\n  map(serverWithId),\n  serversListToMap,\n  (newServers: ServersMap) => ({ type: CREATE_SERVERS, newServers }),\n);\n\nexport const createServer = (server: ServerWithId) => createServers([ server ]);\n\nexport const editServer = (serverId: string, serverData: Partial<ServerData>) => ({\n  type: EDIT_SERVER,\n  serverId,\n  serverData,\n});\n\nexport const deleteServer = ({ id }: ServerWithId): DeleteServerAction => ({ type: DELETE_SERVER, serverId: id });\n\nexport const setAutoConnect = ({ id }: ServerWithId, autoConnect: boolean): SetAutoConnectAction => ({\n  type: SET_AUTO_CONNECT,\n  serverId: id,\n  autoConnect,\n});\n","import { pipe, prop } from 'ramda';\nimport { AxiosInstance } from 'axios';\nimport { Dispatch } from 'redux';\nimport { homepage } from '../../../package.json';\nimport { hasServerData, ServerData } from '../data';\nimport { createServers } from './servers';\n\nconst responseToServersList = pipe(\n  prop<any, any>('data'),\n  (data: any): ServerData[] => Array.isArray(data) ? data.filter(hasServerData) : [],\n);\n\nexport const fetchServers = ({ get }: AxiosInstance) => () => async (dispatch: Dispatch) => {\n  const resp = await get(`${homepage}/servers.json`);\n  const remoteList = responseToServersList(resp);\n\n  dispatch(createServers(remoteList));\n};\n","import { FC } from 'react';\nimport { versionMatch, Versions } from '../../utils/helpers/version';\nimport { isReachableServer, SelectedServer } from '../data';\n\ninterface ForServerVersionProps extends Versions {\n  selectedServer: SelectedServer;\n}\n\nconst ForServerVersion: FC<ForServerVersionProps> = ({ minVersion, maxVersion, selectedServer, children }) => {\n  if (!isReachableServer(selectedServer)) {\n    return null;\n  }\n\n  const { version } = selectedServer;\n  const matchesVersion = versionMatch(version, { maxVersion, minVersion });\n\n  if (!matchesVersion) {\n    return null;\n  }\n\n  return <>{children}</>;\n};\n\nexport default ForServerVersion;\n","import { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport Message from '../../utils/Message';\nimport ServersListGroup from '../ServersListGroup';\nimport { DeleteServerButtonProps } from '../DeleteServerButton';\nimport { isServerWithId, SelectedServer, ServersMap } from '../data';\nimport { NoMenuLayout } from '../../common/NoMenuLayout';\nimport './ServerError.scss';\n\ninterface ServerErrorProps {\n  servers: ServersMap;\n  selectedServer: SelectedServer;\n}\n\nexport const ServerError = (DeleteServerButton: FC<DeleteServerButtonProps>): FC<ServerErrorProps> => (\n  { servers, selectedServer },\n) => (\n  <NoMenuLayout>\n    <div className=\"server-error__container flex-column\">\n      <Message className=\"w-100 mb-3 mb-md-5\" type=\"error\" fullWidth>\n        {!isServerWithId(selectedServer) && 'Could not find this Shlink server.'}\n        {isServerWithId(selectedServer) && (\n          <>\n            <p>Oops! Could not connect to this Shlink server.</p>\n            Make sure you have internet connection, and the server is properly configured and on-line.\n          </>\n        )}\n      </Message>\n\n      <ServersListGroup servers={Object.values(servers)}>\n        These are the Shlink servers currently configured. Choose one of\n        them or <Link to=\"/server/create\">add a new one</Link>.\n      </ServersListGroup>\n\n      {isServerWithId(selectedServer) && (\n        <div className=\"container mt-3 mt-md-5\">\n          <h5>\n            Alternatively, if you think you may have miss-configured this server, you\n            can <DeleteServerButton server={selectedServer} className=\"server-error__delete-btn\">remove it</DeleteServerButton> or&nbsp;\n            <Link to={`/server/${selectedServer.id}/edit`}>edit it</Link>.\n          </h5>\n        </div>\n      )}\n    </div>\n  </NoMenuLayout>\n);\n","import { FC, useEffect } from 'react';\nimport { Card, CardBody, CardHeader, CardText, CardTitle, Row } from 'reactstrap';\nimport { Link, useHistory } from 'react-router-dom';\nimport { ITEMS_IN_OVERVIEW_PAGE, ShortUrlsList as ShortUrlsListState } from '../short-urls/reducers/shortUrlsList';\nimport { prettify } from '../utils/helpers/numbers';\nimport { TagsList } from '../tags/reducers/tagsList';\nimport { ShortUrlsTableProps } from '../short-urls/ShortUrlsTable';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { CreateShortUrlProps } from '../short-urls/CreateShortUrl';\nimport { VisitsOverview } from '../visits/reducers/visitsOverview';\nimport { Versions } from '../utils/helpers/version';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { ShlinkShortUrlsListParams } from '../api/types';\nimport { getServerId, SelectedServer } from './data';\nimport './Overview.scss';\n\ninterface OverviewConnectProps {\n  shortUrlsList: ShortUrlsListState;\n  listShortUrls: (params: ShlinkShortUrlsListParams) => void;\n  listTags: Function;\n  tagsList: TagsList;\n  selectedServer: SelectedServer;\n  visitsOverview: VisitsOverview;\n  loadVisitsOverview: Function;\n}\n\nexport const Overview = (\n  ShortUrlsTable: FC<ShortUrlsTableProps>,\n  CreateShortUrl: FC<CreateShortUrlProps>,\n  ForServerVersion: FC<Versions>,\n) => boundToMercureHub(({\n  shortUrlsList,\n  listShortUrls,\n  listTags,\n  tagsList,\n  selectedServer,\n  loadVisitsOverview,\n  visitsOverview,\n}: OverviewConnectProps) => {\n  const { loading, shortUrls } = shortUrlsList;\n  const { loading: loadingTags } = tagsList;\n  const { loading: loadingVisits, visitsCount, orphanVisitsCount } = visitsOverview;\n  const serverId = getServerId(selectedServer);\n  const history = useHistory();\n\n  useEffect(() => {\n    listShortUrls({ itemsPerPage: ITEMS_IN_OVERVIEW_PAGE, orderBy: { field: 'dateCreated', dir: 'DESC' } });\n    listTags();\n    loadVisitsOverview();\n  }, []);\n\n  return (\n    <>\n      <Row>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Visits</CardTitle>\n            <CardText tag=\"h2\">{loadingVisits ? 'Loading...' : prettify(visitsCount)}</CardText>\n          </Card>\n        </div>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body tag={Link} to={`/server/${serverId}/orphan-visits`}>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Orphan visits</CardTitle>\n            <CardText tag=\"h2\">\n              <ForServerVersion minVersion=\"2.6.0\">\n                {loadingVisits ? 'Loading...' : prettify(orphanVisitsCount ?? 0)}\n              </ForServerVersion>\n              <ForServerVersion maxVersion=\"2.5.*\">\n                <small className=\"text-muted\"><i>Shlink 2.6 is needed</i></small>\n              </ForServerVersion>\n            </CardText>\n          </Card>\n        </div>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body tag={Link} to={`/server/${serverId}/list-short-urls/1`}>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Short URLs</CardTitle>\n            <CardText tag=\"h2\">\n              {loading ? 'Loading...' : prettify(shortUrls?.pagination.totalItems ?? 0)}\n            </CardText>\n          </Card>\n        </div>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body tag={Link} to={`/server/${serverId}/manage-tags`}>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Tags</CardTitle>\n            <CardText tag=\"h2\">{loadingTags ? 'Loading...' : prettify(tagsList.tags.length)}</CardText>\n          </Card>\n        </div>\n      </Row>\n      <Card className=\"mb-3\">\n        <CardHeader>\n          <span className=\"d-sm-none\">Create a short URL</span>\n          <h5 className=\"d-none d-sm-inline\">Create a short URL</h5>\n          <Link className=\"float-right\" to={`/server/${serverId}/create-short-url`}>Advanced options &raquo;</Link>\n        </CardHeader>\n        <CardBody>\n          <CreateShortUrl basicMode />\n        </CardBody>\n      </Card>\n      <Card>\n        <CardHeader>\n          <span className=\"d-sm-none\">Recently created URLs</span>\n          <h5 className=\"d-none d-sm-inline\">Recently created URLs</h5>\n          <Link className=\"float-right\" to={`/server/${serverId}/list-short-urls/1`}>See all &raquo;</Link>\n        </CardHeader>\n        <CardBody>\n          <ShortUrlsTable\n            shortUrlsList={shortUrlsList}\n            selectedServer={selectedServer}\n            className=\"mb-0\"\n            onTagClick={(tag) => history.push(`/server/${serverId}/list-short-urls/1?tags=${encodeURIComponent(tag)}`)}\n          />\n        </CardBody>\n      </Card>\n    </>\n  );\n}, () => [ Topics.visits, Topics.orphanVisits ]);\n","import { FC, useEffect, useState } from 'react';\nimport { Button, Row } from 'reactstrap';\nimport { faFileDownload as exportIcon, faPlus as plusIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Link } from 'react-router-dom';\nimport { NoMenuLayout } from '../common/NoMenuLayout';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport SearchField from '../utils/SearchField';\nimport { Result } from '../utils/Result';\nimport { StateFlagTimeout } from '../utils/helpers/hooks';\nimport { ImportServersBtnProps } from './helpers/ImportServersBtn';\nimport { ServersMap } from './data';\nimport { ManageServersRowProps } from './ManageServersRow';\nimport ServersExporter from './services/ServersExporter';\n\ninterface ManageServersProps {\n  servers: ServersMap;\n}\n\nconst SHOW_IMPORT_MSG_TIME = 4000;\n\nexport const ManageServers = (\n  serversExporter: ServersExporter,\n  ImportServersBtn: FC<ImportServersBtnProps>,\n  useStateFlagTimeout: StateFlagTimeout,\n  ManageServersRow: FC<ManageServersRowProps>,\n): FC<ManageServersProps> => ({ servers }) => {\n  const allServers = Object.values(servers);\n  const [ serversList, setServersList ] = useState(allServers);\n  const filterServers = (searchTerm: string) => setServersList(\n    allServers.filter(({ name, url }) => `${name} ${url}`.match(searchTerm)),\n  );\n  const hasAutoConnect = serversList.some(({ autoConnect }) => !!autoConnect);\n  const [ errorImporting, setErrorImporting ] = useStateFlagTimeout(false, SHOW_IMPORT_MSG_TIME);\n\n  useEffect(() => {\n    setServersList(Object.values(servers));\n  }, [ servers ]);\n\n  return (\n    <NoMenuLayout>\n      <SearchField className=\"mb-3\" onChange={filterServers} />\n\n      <Row className=\"mb-3\">\n        <div className=\"col-md-6 d-flex d-md-block mb-2 mb-md-0\">\n          <ImportServersBtn className=\"flex-fill\" onImportError={setErrorImporting}>Import servers</ImportServersBtn>\n          {allServers.length > 0 && (\n            <Button outline className=\"ml-2 flex-fill\" onClick={async () => serversExporter.exportServers()}>\n              <FontAwesomeIcon icon={exportIcon} fixedWidth /> Export servers\n            </Button>\n          )}\n        </div>\n        <div className=\"col-md-6 text-md-right d-flex d-md-block\">\n          <Button outline color=\"primary\" className=\"flex-fill\" tag={Link} to=\"/server/create\">\n            <FontAwesomeIcon icon={plusIcon} fixedWidth /> Add a server\n          </Button>\n        </div>\n      </Row>\n\n      <SimpleCard>\n        <table className=\"table table-hover mb-0\">\n          <thead className=\"responsive-table__header\">\n            <tr>\n              {hasAutoConnect && <th style={{ width: '50px' }} />}\n              <th>Name</th>\n              <th>Base URL</th>\n              <th />\n            </tr>\n          </thead>\n          <tbody>\n            {!serversList.length && <tr className=\"text-center\"><td colSpan={4}>No servers found.</td></tr>}\n            {serversList.map((server) =>\n              <ManageServersRow key={server.id} server={server} hasAutoConnect={hasAutoConnect} />)\n            }\n          </tbody>\n        </table>\n      </SimpleCard>\n\n      {errorImporting && (\n        <div className=\"mt-3\">\n          <Result type=\"error\">The servers could not be imported. Make sure the format is correct.</Result>\n        </div>\n      )}\n    </NoMenuLayout>\n  );\n};\n","import { FC } from 'react';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCheck as checkIcon } from '@fortawesome/free-solid-svg-icons';\nimport { ServerWithId } from './data';\nimport { ManageServersRowDropdownProps } from './ManageServersRowDropdown';\n\nexport interface ManageServersRowProps {\n  server: ServerWithId;\n  hasAutoConnect: boolean;\n}\n\nexport const ManageServersRow = (\n  ManageServersRowDropdown: FC<ManageServersRowDropdownProps>,\n): FC<ManageServersRowProps> => ({ server, hasAutoConnect }) => (\n  <tr className=\"responsive-table__row\">\n    {hasAutoConnect && (\n      <td className=\"responsive-table__cell\" data-th=\"Auto-connect\">\n        {server.autoConnect && (\n          <>\n            <FontAwesomeIcon icon={checkIcon} className=\"text-primary\" id=\"autoConnectIcon\" />\n            <UncontrolledTooltip target=\"autoConnectIcon\" placement=\"right\">\n              Auto-connect to this server\n            </UncontrolledTooltip>\n          </>\n        )}\n      </td>\n    )}\n    <th className=\"responsive-table__cell\" data-th=\"Name\">\n      <Link to={`/server/${server.id}`}>{server.name}</Link>\n    </th>\n    <td className=\"responsive-table__cell\" data-th=\"Base URL\">{server.url}</td>\n    <td className=\"responsive-table__cell text-right\">\n      <ManageServersRowDropdown server={server} />\n    </td>\n  </tr>\n);\n","import { FC } from 'react';\nimport { DropdownItem } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faBan as toggleOffIcon,\n  faEdit as editIcon,\n  faMinusCircle as deleteIcon,\n  faPlug as connectIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { faCircle as toggleOnIcon } from '@fortawesome/free-regular-svg-icons';\nimport { DropdownBtnMenu } from '../utils/DropdownBtnMenu';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { DeleteServerModalProps } from './DeleteServerModal';\nimport { ServerWithId } from './data';\n\nexport interface ManageServersRowDropdownProps {\n  server: ServerWithId;\n}\n\ninterface ManageServersRowDropdownConnectProps extends ManageServersRowDropdownProps {\n  setAutoConnect: (server: ServerWithId, autoConnect: boolean) => void;\n}\n\nexport const ManageServersRowDropdown = (\n  DeleteServerModal: FC<DeleteServerModalProps>,\n): FC<ManageServersRowDropdownConnectProps> => ({ server, setAutoConnect }) => {\n  const [ isMenuOpen, toggleMenu ] = useToggle();\n  const [ isModalOpen,, showModal, hideModal ] = useToggle();\n  const serverUrl = `/server/${server.id}`;\n  const { autoConnect: isAutoConnect } = server;\n  const autoConnectIcon = isAutoConnect ? toggleOffIcon : toggleOnIcon;\n\n  return (\n    <DropdownBtnMenu isOpen={isMenuOpen} toggle={toggleMenu}>\n      <DropdownItem tag={Link} to={serverUrl}>\n        <FontAwesomeIcon icon={connectIcon} fixedWidth /> Connect\n      </DropdownItem>\n      <DropdownItem tag={Link} to={`${serverUrl}/edit`}>\n        <FontAwesomeIcon icon={editIcon} fixedWidth /> Edit server\n      </DropdownItem>\n      <DropdownItem onClick={() => setAutoConnect(server, !server.autoConnect)}>\n        <FontAwesomeIcon icon={autoConnectIcon} fixedWidth /> {isAutoConnect ? 'Do not a' : 'A'}uto-connect\n      </DropdownItem>\n      <DropdownItem divider />\n      <DropdownItem className=\"dropdown-item--danger\" onClick={showModal}>\n        <FontAwesomeIcon icon={deleteIcon} fixedWidth /> Remove server\n      </DropdownItem>\n\n      <DeleteServerModal redirectHome={false} server={server} isOpen={isModalOpen} toggle={hideModal} />\n    </DropdownBtnMenu>\n  );\n};\n","import { CsvJson } from 'csvjson';\nimport { ServerData } from '../data';\n\nconst validateServer = (server: any): server is ServerData =>\n  typeof server.url === 'string' && typeof server.apiKey === 'string' && typeof server.name === 'string';\n\nconst validateServers = (servers: any): servers is ServerData[] =>\n  Array.isArray(servers) && servers.every(validateServer);\n\nexport class ServersImporter {\n  public constructor(private readonly csvJson: CsvJson, private readonly fileReaderFactory: () => FileReader) {}\n\n  public readonly importServersFromFile = async (file?: File | null): Promise<ServerData[]> => {\n    if (!file) {\n      throw new Error('No file provided');\n    }\n\n    const reader = this.fileReaderFactory();\n\n    return new Promise((resolve, reject) => {\n      reader.addEventListener('loadend', (e: ProgressEvent<FileReader>) => {\n        try {\n          // TODO Read as stream, otherwise, if the file is too big, this will block the browser tab\n          const content = e.target?.result?.toString() ?? '';\n          const servers = this.csvJson.toObject(content);\n\n          if (!validateServers(servers)) {\n            throw new Error('Provided file does not have the right format.');\n          }\n\n          resolve(servers);\n        } catch (e) {\n          reject(e);\n        }\n      });\n      reader.readAsText(file);\n    });\n  };\n}\n","import { values } from 'ramda';\nimport { CsvJson } from 'csvjson';\nimport LocalStorage from '../../utils/services/LocalStorage';\nimport { ServersMap, serverWithIdToServerData } from '../data';\nimport { saveCsv } from '../../utils/helpers/files';\n\nconst SERVERS_FILENAME = 'shlink-servers.csv';\n\nexport default class ServersExporter {\n  public constructor(\n    private readonly storage: LocalStorage,\n    private readonly window: Window,\n    private readonly csvjson: CsvJson,\n  ) {}\n\n  public readonly exportServers = async () => {\n    const servers = values(this.storage.get<ServersMap>('servers') ?? {}).map(serverWithIdToServerData);\n\n    try {\n      const csv = this.csvjson.toCSV(servers, { headers: 'key' });\n\n      saveCsv(this.window, csv, SERVERS_FILENAME);\n    } catch (e) {\n      // FIXME Handle error\n      console.error(e); // eslint-disable-line no-console\n    }\n  };\n}\n","import csvjson from 'csvjson';\nimport Bottle, { Decorator } from 'bottlejs';\nimport CreateServer from '../CreateServer';\nimport ServersDropdown from '../ServersDropdown';\nimport DeleteServerModal from '../DeleteServerModal';\nimport DeleteServerButton from '../DeleteServerButton';\nimport { EditServer } from '../EditServer';\nimport ImportServersBtn from '../helpers/ImportServersBtn';\nimport { resetSelectedServer, selectServer } from '../reducers/selectedServer';\nimport { createServer, createServers, deleteServer, editServer, setAutoConnect } from '../reducers/servers';\nimport { fetchServers } from '../reducers/remoteServers';\nimport ForServerVersion from '../helpers/ForServerVersion';\nimport { ServerError } from '../helpers/ServerError';\nimport { ConnectDecorator } from '../../container/types';\nimport { withoutSelectedServer } from '../helpers/withoutSelectedServer';\nimport { Overview } from '../Overview';\nimport { ManageServers } from '../ManageServers';\nimport { ManageServersRow } from '../ManageServersRow';\nimport { ManageServersRowDropdown } from '../ManageServersRowDropdown';\nimport { ServersImporter } from './ServersImporter';\nimport ServersExporter from './ServersExporter';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator, withRouter: Decorator) => {\n  // Components\n  bottle.serviceFactory(\n    'ManageServers',\n    ManageServers,\n    'ServersExporter',\n    'ImportServersBtn',\n    'useStateFlagTimeout',\n    'ManageServersRow',\n  );\n  bottle.decorator('ManageServers', connect([ 'servers' ]));\n\n  bottle.serviceFactory('ManageServersRow', ManageServersRow, 'ManageServersRowDropdown');\n\n  bottle.serviceFactory('ManageServersRowDropdown', ManageServersRowDropdown, 'DeleteServerModal');\n  bottle.decorator('ManageServersRowDropdown', connect(null, [ 'setAutoConnect' ]));\n\n  bottle.serviceFactory('CreateServer', CreateServer, 'ImportServersBtn', 'useStateFlagTimeout');\n  bottle.decorator('CreateServer', withoutSelectedServer);\n  bottle.decorator('CreateServer', connect([ 'selectedServer', 'servers' ], [ 'createServer', 'resetSelectedServer' ]));\n\n  bottle.serviceFactory('EditServer', EditServer, 'ServerError');\n  bottle.decorator('EditServer', connect([ 'selectedServer' ], [ 'editServer', 'selectServer' ]));\n\n  bottle.serviceFactory('ServersDropdown', () => ServersDropdown);\n  bottle.decorator('ServersDropdown', connect([ 'servers', 'selectedServer' ]));\n\n  bottle.serviceFactory('DeleteServerModal', () => DeleteServerModal);\n  bottle.decorator('DeleteServerModal', withRouter);\n  bottle.decorator('DeleteServerModal', connect(null, [ 'deleteServer' ]));\n\n  bottle.serviceFactory('DeleteServerButton', DeleteServerButton, 'DeleteServerModal');\n\n  bottle.serviceFactory('ImportServersBtn', ImportServersBtn, 'ServersImporter');\n  bottle.decorator('ImportServersBtn', connect([ 'servers' ], [ 'createServers' ]));\n\n  bottle.serviceFactory('ForServerVersion', () => ForServerVersion);\n  bottle.decorator('ForServerVersion', connect([ 'selectedServer' ]));\n\n  bottle.serviceFactory('ServerError', ServerError, 'DeleteServerButton');\n  bottle.decorator('ServerError', connect([ 'servers', 'selectedServer' ]));\n\n  bottle.serviceFactory('Overview', Overview, 'ShortUrlsTable', 'CreateShortUrl', 'ForServerVersion');\n  bottle.decorator('Overview', connect(\n    [ 'shortUrlsList', 'tagsList', 'selectedServer', 'mercureInfo', 'visitsOverview' ],\n    [ 'listShortUrls', 'listTags', 'createNewVisits', 'loadMercureInfo', 'loadVisitsOverview' ],\n  ));\n\n  // Services\n  bottle.constant('csvjson', csvjson);\n  bottle.constant('fileReaderFactory', () => new FileReader());\n  bottle.service('ServersImporter', ServersImporter, 'csvjson', 'fileReaderFactory');\n  bottle.service('ServersExporter', ServersExporter, 'Storage', 'window', 'csvjson');\n\n  // Actions\n  bottle.serviceFactory('selectServer', selectServer, 'buildShlinkApiClient', 'loadMercureInfo');\n  bottle.serviceFactory('createServer', () => createServer);\n  bottle.serviceFactory('createServers', () => createServers);\n  bottle.serviceFactory('deleteServer', () => deleteServer);\n  bottle.serviceFactory('editServer', () => editServer);\n  bottle.serviceFactory('setAutoConnect', () => setAutoConnect);\n  bottle.serviceFactory('fetchServers', fetchServers, 'axios');\n\n  bottle.serviceFactory('resetSelectedServer', () => resetSelectedServer);\n};\n\nexport default provideServices;\n","import { Button, Card } from 'reactstrap';\nimport { FC, ReactNode } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\nimport ShortUrlVisitsCount from '../short-urls/helpers/ShortUrlVisitsCount';\nimport { ShortUrl } from '../short-urls/data';\nimport { Visit } from './types';\n\ninterface VisitsHeaderProps {\n  visits: Visit[];\n  goBack: () => void;\n  title: ReactNode;\n  shortUrl?: ShortUrl;\n}\n\nconst VisitsHeader: FC<VisitsHeaderProps> = ({ visits, goBack, shortUrl, children, title }) => (\n  <header>\n    <Card body>\n      <h2 className=\"d-flex justify-content-between align-items-center mb-0\">\n        <Button color=\"link\" size=\"lg\" className=\"p-0 mr-3\" onClick={goBack}>\n          <FontAwesomeIcon icon={faArrowLeft} />\n        </Button>\n        <span className=\"text-center d-none d-sm-block\">\n          <small>{title}</small>\n        </span>\n        <span className=\"badge badge-main ml-3\">\n          Visits:{' '}\n          <ShortUrlVisitsCount visitsCount={visits.length} shortUrl={shortUrl} />\n        </span>\n      </h2>\n      <h3 className=\"text-center d-block d-sm-none mb-0 mt-3\">\n        <small>{title}</small>\n      </h3>\n\n      {children && <div className=\"mt-md-2\">{children}</div>}\n    </Card>\n  </header>\n);\n\nexport default VisitsHeader;\n","import { UncontrolledTooltip } from 'reactstrap';\nimport { ExternalLink } from 'react-external-link';\nimport { ShortUrlDetail } from '../short-urls/reducers/shortUrlDetail';\nimport { Time } from '../utils/Time';\nimport { ShortUrlVisits } from './reducers/shortUrlVisits';\nimport VisitsHeader from './VisitsHeader';\nimport './ShortUrlVisitsHeader.scss';\n\ninterface ShortUrlVisitsHeaderProps {\n  shortUrlDetail: ShortUrlDetail;\n  shortUrlVisits: ShortUrlVisits;\n  goBack: () => void;\n}\n\nconst ShortUrlVisitsHeader = ({ shortUrlDetail, shortUrlVisits, goBack }: ShortUrlVisitsHeaderProps) => {\n  const { shortUrl, loading } = shortUrlDetail;\n  const { visits } = shortUrlVisits;\n  const shortLink = shortUrl?.shortUrl ?? '';\n  const longLink = shortUrl?.longUrl ?? '';\n  const title = shortUrl?.title;\n\n  const renderDate = () => !shortUrl ? <small>Loading...</small> : (\n    <span>\n      <b id=\"created\" className=\"short-url-visits-header__created-at\">\n        <Time date={shortUrl.dateCreated} relative />\n      </b>\n      <UncontrolledTooltip placement=\"bottom\" target=\"created\">\n        <Time date={shortUrl.dateCreated} />\n      </UncontrolledTooltip>\n    </span>\n  );\n  const visitsStatsTitle = <>Visits for <ExternalLink href={shortLink} /></>;\n\n  return (\n    <VisitsHeader title={visitsStatsTitle} goBack={goBack} visits={visits} shortUrl={shortUrl}>\n      <hr />\n      <div>Created: {renderDate()}</div>\n      <div>\n        {`${title ? 'Title' : 'Long URL'}: `}\n        {loading && <small>Loading...</small>}\n        {!loading && <ExternalLink href={longLink}>{title ?? longLink}</ExternalLink>}\n      </div>\n    </VisitsHeader>\n  );\n};\n\nexport default ShortUrlVisitsHeader;\n","import bowser from 'bowser';\nimport { zipObj } from 'ramda';\nimport { Empty, hasValue } from '../utils';\nimport { Stats, UserAgent } from '../../visits/types';\n\nconst DEFAULT = 'Others';\nconst BROWSERS_WHITELIST = [\n  'Android Browser',\n  'Chrome',\n  'Chromium',\n  'Firefox',\n  'Internet Explorer',\n  'Microsoft Edge',\n  'Opera',\n  'Safari',\n  'Samsung Internet for Android',\n  'Vivaldi',\n  'WeChat',\n];\n\nexport const parseUserAgent = (userAgent: string | Empty): UserAgent => {\n  if (!hasValue(userAgent)) {\n    return { browser: DEFAULT, os: DEFAULT };\n  }\n\n  const { browser: { name: browser }, os: { name: os } } = bowser.parse(userAgent);\n\n  return { os: os ?? DEFAULT, browser: browser && BROWSERS_WHITELIST.includes(browser) ? browser : DEFAULT };\n};\n\nexport const extractDomain = (url: string | Empty): string => {\n  if (!hasValue(url)) {\n    return 'Direct';\n  }\n\n  return url.split('/')[url.includes('://') ? 2 : 0]?.split(':')[0] ?? '';\n};\n\nexport const fillTheGaps = (stats: Stats, labels: string[]): number[] =>\n  Object.values({ ...zipObj(labels, labels.map(() => 0)), ...stats });\n","import { FC } from 'react';\nimport BooleanControl, { BooleanControlProps } from './BooleanControl';\n\nconst ToggleSwitch: FC<BooleanControlProps> = (props) => <BooleanControl type=\"switch\" {...props} />;\n\nexport default ToggleSwitch;\n","import { ActiveElement, ChartEvent, ChartType, TooltipItem } from 'chart.js';\nimport { prettify } from './numbers';\n\nexport const pointerOnHover = ({ native }: ChartEvent, [ firstElement ]: ActiveElement[]) => {\n  if (!native?.target) {\n    return;\n  }\n\n  const canvas = native.target as HTMLCanvasElement;\n\n  canvas.style.cursor = firstElement ? 'pointer' : 'default';\n};\n\nexport const renderChartLabel = ({ dataset, formattedValue }: TooltipItem<ChartType>) =>\n  `${dataset.label}: ${prettify(formattedValue)}`;\n\nexport const renderPieChartLabel = ({ label, formattedValue }: TooltipItem<ChartType>) =>\n  `${label}: ${prettify(formattedValue)}`;\n","import { useState, useMemo } from 'react';\nimport {\n  Card,\n  CardHeader,\n  CardBody,\n  UncontrolledDropdown,\n  DropdownToggle,\n  DropdownMenu,\n  DropdownItem,\n} from 'reactstrap';\nimport { Line } from 'react-chartjs-2';\nimport { always, cond, countBy, reverse } from 'ramda';\nimport {\n  add,\n  differenceInDays,\n  differenceInHours,\n  differenceInMonths,\n  differenceInWeeks,\n  parseISO,\n  format,\n  startOfISOWeek,\n  endOfISOWeek,\n} from 'date-fns';\nimport { ChartData, ChartDataset, ChartOptions } from 'chart.js';\nimport { NormalizedVisit, Stats } from '../types';\nimport { fillTheGaps } from '../../utils/helpers/visits';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { rangeOf } from '../../utils/utils';\nimport ToggleSwitch from '../../utils/ToggleSwitch';\nimport { prettify } from '../../utils/helpers/numbers';\nimport { pointerOnHover, renderChartLabel } from '../../utils/helpers/charts';\nimport { HIGHLIGHTED_COLOR, MAIN_COLOR } from '../../utils/theme';\nimport './LineChartCard.scss';\n\ninterface LineChartCardProps {\n  title: string;\n  highlightedLabel?: string;\n  visits: NormalizedVisit[];\n  highlightedVisits: NormalizedVisit[];\n  setSelectedVisits?: (visits: NormalizedVisit[]) => void;\n}\n\ntype Step = 'monthly' | 'weekly' | 'daily' | 'hourly';\n\nconst STEPS_MAP: Record<Step, string> = {\n  monthly: 'Month',\n  weekly: 'Week',\n  daily: 'Day',\n  hourly: 'Hour',\n};\n\nconst STEP_TO_DURATION_MAP: Record<Step, (amount: number) => Duration> = {\n  hourly: (hours: number) => ({ hours }),\n  daily: (days: number) => ({ days }),\n  weekly: (weeks: number) => ({ weeks }),\n  monthly: (months: number) => ({ months }),\n};\n\nconst STEP_TO_DIFF_FUNC_MAP: Record<Step, (dateLeft: Date, dateRight: Date) => number> = {\n  hourly: differenceInHours,\n  daily: differenceInDays,\n  weekly: differenceInWeeks,\n  monthly: differenceInMonths,\n};\n\nconst STEP_TO_DATE_FORMAT: Record<Step, (date: Date) => string> = {\n  hourly: (date) => format(date, 'yyyy-MM-dd HH:00'),\n  daily: (date) => format(date, 'yyyy-MM-dd'),\n  weekly(date) {\n    const firstWeekDay = format(startOfISOWeek(date), 'yyyy-MM-dd');\n    const lastWeekDay = format(endOfISOWeek(date), 'yyyy-MM-dd');\n\n    return `${firstWeekDay} - ${lastWeekDay}`;\n  },\n  monthly: (date) => format(date, 'yyyy-MM'),\n};\n\nconst determineInitialStep = (oldestVisitDate: string): Step => {\n  const now = new Date();\n  const oldestDate = parseISO(oldestVisitDate);\n  const matcher = cond<never, Step | undefined>([\n    [ () => differenceInDays(now, oldestDate) <= 2, always<Step>('hourly') ], // Less than 2 days\n    [ () => differenceInMonths(now, oldestDate) <= 1, always<Step>('daily') ], // Between 2 days and 1 month\n    [ () => differenceInMonths(now, oldestDate) <= 6, always<Step>('weekly') ], // Between 1 and 6 months\n  ]);\n\n  return matcher() ?? 'monthly';\n};\n\nconst groupVisitsByStep = (step: Step, visits: NormalizedVisit[]): Stats => countBy(\n  (visit) => STEP_TO_DATE_FORMAT[step](parseISO(visit.date)),\n  visits,\n);\n\nconst visitsToDatasetGroups = (step: Step, visits: NormalizedVisit[]) =>\n  visits.reduce<Record<string, NormalizedVisit[]>>(\n    (acc, visit) => {\n      const key = STEP_TO_DATE_FORMAT[step](parseISO(visit.date));\n\n      acc[key] = acc[key] ?? [];\n      acc[key].push(visit);\n\n      return acc;\n    },\n    {},\n  );\n\nconst generateLabels = (step: Step, visits: NormalizedVisit[]): string[] => {\n  const diffFunc = STEP_TO_DIFF_FUNC_MAP[step];\n  const formatter = STEP_TO_DATE_FORMAT[step];\n  const newerDate = parseISO(visits[0].date);\n  const oldestDate = parseISO(visits[visits.length - 1].date);\n  const size = diffFunc(newerDate, oldestDate);\n  const duration = STEP_TO_DURATION_MAP[step];\n\n  return [\n    formatter(oldestDate),\n    ...rangeOf(size, (num) => formatter(add(oldestDate, duration(num)))),\n  ];\n};\n\nconst generateLabelsAndGroupedVisits = (\n  visits: NormalizedVisit[],\n  groupedVisitsWithGaps: Stats,\n  step: Step,\n  skipNoElements: boolean,\n): [string[], number[]] => {\n  if (skipNoElements) {\n    return [ Object.keys(groupedVisitsWithGaps), Object.values(groupedVisitsWithGaps) ];\n  }\n\n  const labels = generateLabels(step, visits);\n\n  return [ labels, fillTheGaps(groupedVisitsWithGaps, labels) ];\n};\n\nconst generateDataset = (data: number[], label: string, color: string): ChartDataset => ({\n  label,\n  data,\n  fill: false,\n  tension: 0.2,\n  borderColor: color,\n  backgroundColor: color,\n});\n\nlet selectedLabel: string | null = null;\n\nconst chartElementAtEvent = (\n  labels: string[],\n  datasetsByPoint: Record<string, NormalizedVisit[]>,\n  setSelectedVisits?: (visits: NormalizedVisit[]) => void,\n) => ([ chart ]: [{ index: number }]) => {\n  if (!setSelectedVisits || !chart) {\n    return;\n  }\n\n  const { index } = chart;\n\n  if (selectedLabel === labels[index]) {\n    setSelectedVisits([]);\n    selectedLabel = null;\n  } else {\n    setSelectedVisits(labels[index] && datasetsByPoint[labels[index]] || []);\n    selectedLabel = labels[index] ?? null;\n  }\n};\n\nconst LineChartCard = (\n  { title, visits, highlightedVisits, highlightedLabel = 'Selected', setSelectedVisits }: LineChartCardProps,\n) => {\n  const [ step, setStep ] = useState<Step>(\n    visits.length > 0 ? determineInitialStep(visits[visits.length - 1].date) : 'monthly',\n  );\n  const [ skipNoVisits, toggleSkipNoVisits ] = useToggle(true);\n\n  const datasetsByPoint = useMemo(() => visitsToDatasetGroups(step, visits), [ step, visits ]);\n  const groupedVisitsWithGaps = useMemo(() => groupVisitsByStep(step, reverse(visits)), [ step, visits ]);\n  const [ labels, groupedVisits ] = useMemo(\n    () => generateLabelsAndGroupedVisits(visits, groupedVisitsWithGaps, step, skipNoVisits),\n    [ visits, step, skipNoVisits ],\n  );\n  const groupedHighlighted = useMemo(\n    () => fillTheGaps(groupVisitsByStep(step, reverse(highlightedVisits)), labels),\n    [ highlightedVisits, step, labels ],\n  );\n  const generateChartDatasets = (): ChartDataset[] => {\n    const mainDataset = generateDataset(groupedVisits, 'Visits', MAIN_COLOR);\n\n    if (highlightedVisits.length === 0) {\n      return [ mainDataset ];\n    }\n\n    const highlightedDataset = generateDataset(groupedHighlighted, highlightedLabel, HIGHLIGHTED_COLOR);\n\n    return [ mainDataset, highlightedDataset ];\n  };\n  const generateChartData = (): ChartData => ({ labels, datasets: generateChartDatasets() });\n\n  const options: ChartOptions = {\n    maintainAspectRatio: false,\n    plugins: {\n      legend: { display: false },\n      tooltip: {\n        intersect: false,\n        axis: 'x',\n        callbacks: { label: renderChartLabel },\n      },\n    },\n    scales: {\n      y: {\n        beginAtZero: true,\n        ticks: {\n          precision: 0,\n          callback: prettify,\n        },\n      },\n      x: {\n        title: { display: true, text: STEPS_MAP[step] },\n      },\n    },\n    onHover: pointerOnHover,\n  };\n  const renderLineChart = () => (\n    <Line\n      data={generateChartData()}\n      options={options}\n      getElementAtEvent={chartElementAtEvent(labels, datasetsByPoint, setSelectedVisits) as any}\n    />\n  );\n\n  return (\n    <Card>\n      <CardHeader>\n        {title}\n        <div className=\"float-right\">\n          <UncontrolledDropdown>\n            <DropdownToggle caret color=\"link\" className=\"btn-sm p-0\">\n              Group by\n            </DropdownToggle>\n            <DropdownMenu right>\n              {Object.entries(STEPS_MAP).map(([ value, menuText ]) => (\n                <DropdownItem key={value} active={step === value} onClick={() => setStep(value as Step)}>\n                  {menuText}\n                </DropdownItem>\n              ))}\n            </DropdownMenu>\n          </UncontrolledDropdown>\n        </div>\n        <div className=\"float-right mr-2\">\n          <ToggleSwitch checked={skipNoVisits} onChange={toggleSkipNoVisits}>\n            <small>Skip dates with no visits</small>\n          </ToggleSwitch>\n        </div>\n      </CardHeader>\n      <CardBody className=\"line-chart-card__body\">\n        {/* It's VERY IMPORTANT to render two different components here, as one has 1 dataset and the other has 2 */}\n        {/* Using the same component causes a crash when switching from 1 to 2 datasets, and then back to 1 dataset */}\n        {highlightedVisits.length > 0 && renderLineChart()}\n        {highlightedVisits.length === 0 && renderLineChart()}\n      </CardBody>\n    </Card>\n  );\n};\n\nexport default LineChartCard;\n","import { FC } from 'react';\nimport classNames from 'classnames';\nimport { Pagination, PaginationItem, PaginationLink } from 'reactstrap';\nimport {\n  pageIsEllipsis,\n  keyForPage,\n  NumberOrEllipsis,\n  progressivePagination,\n  prettifyPageNumber,\n} from '../utils/helpers/pagination';\nimport './SimplePaginator.scss';\n\ninterface SimplePaginatorProps {\n  pagesCount: number;\n  currentPage: number;\n  setCurrentPage: (currentPage: number) => void;\n  centered?: boolean;\n}\n\nconst SimplePaginator: FC<SimplePaginatorProps> = ({ pagesCount, currentPage, setCurrentPage, centered = true }) => {\n  if (pagesCount < 2) {\n    return null;\n  }\n\n  const onClick = (page: NumberOrEllipsis) => () => !pageIsEllipsis(page) && setCurrentPage(page);\n\n  return (\n    <Pagination listClassName={classNames('flex-wrap mb-0 simple-paginator', { 'justify-content-center': centered })}>\n      <PaginationItem disabled={currentPage <= 1}>\n        <PaginationLink previous tag=\"span\" onClick={onClick(currentPage - 1)} />\n      </PaginationItem>\n      {progressivePagination(currentPage, pagesCount).map((pageNumber, index) => (\n        <PaginationItem\n          key={keyForPage(pageNumber, index)}\n          disabled={pageIsEllipsis(pageNumber)}\n          active={currentPage === pageNumber}\n        >\n          <PaginationLink tag=\"span\" onClick={onClick(pageNumber)}>{prettifyPageNumber(pageNumber)}</PaginationLink>\n        </PaginationItem>\n      ))}\n      <PaginationItem disabled={currentPage >= pagesCount}>\n        <PaginationLink next tag=\"span\" onClick={onClick(currentPage + 1)} />\n      </PaginationItem>\n    </Pagination>\n  );\n};\n\nexport default SimplePaginator;\n","import { useEffect, useMemo, useState, useRef } from 'react';\nimport classNames from 'classnames';\nimport { min, splitEvery } from 'ramda';\nimport { faCheck as checkIcon, faRobot as botIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport SimplePaginator from '../common/SimplePaginator';\nimport SearchField from '../utils/SearchField';\nimport { determineOrderDir, Order, sortList } from '../utils/helpers/ordering';\nimport { prettify } from '../utils/helpers/numbers';\nimport { supportsBotVisits } from '../utils/helpers/features';\nimport { SelectedServer } from '../servers/data';\nimport { Time } from '../utils/Time';\nimport { TableOrderIcon } from '../utils/table/TableOrderIcon';\nimport { MediaMatcher } from '../utils/types';\nimport { NormalizedOrphanVisit, NormalizedVisit } from './types';\nimport './VisitsTable.scss';\n\nexport interface VisitsTableProps {\n  visits: NormalizedVisit[];\n  selectedVisits?: NormalizedVisit[];\n  setSelectedVisits: (visits: NormalizedVisit[]) => void;\n  matchMedia?: MediaMatcher;\n  isOrphanVisits?: boolean;\n  selectedServer: SelectedServer;\n}\n\ntype OrderableFields = 'date' | 'country' | 'city' | 'browser' | 'os' | 'referer' | 'visitedUrl' | 'potentialBot';\ntype VisitsOrder = Order<OrderableFields>;\n\nconst PAGE_SIZE = 20;\nconst visitMatchesSearch = ({ browser, os, referer, country, city, ...rest }: NormalizedVisit, searchTerm: string) =>\n  `${browser} ${os} ${referer} ${country} ${city} ${(rest as NormalizedOrphanVisit).visitedUrl}`.toLowerCase().includes(\n    searchTerm.toLowerCase(),\n  );\nconst searchVisits = (searchTerm: string, visits: NormalizedVisit[]) =>\n  visits.filter((visit) => visitMatchesSearch(visit, searchTerm));\nconst sortVisits = (order: VisitsOrder, visits: NormalizedVisit[]) => sortList<NormalizedVisit>(visits, order as any);\nconst calculateVisits = (allVisits: NormalizedVisit[], searchTerm: string | undefined, order: VisitsOrder) => {\n  const filteredVisits = searchTerm ? searchVisits(searchTerm, allVisits) : [ ...allVisits ];\n  const sortedVisits = sortVisits(order, filteredVisits);\n  const total = sortedVisits.length;\n  const visitsGroups = splitEvery(PAGE_SIZE, sortedVisits);\n\n  return { visitsGroups, total };\n};\n\nconst VisitsTable = ({\n  visits,\n  selectedVisits = [],\n  setSelectedVisits,\n  selectedServer,\n  matchMedia = window.matchMedia,\n  isOrphanVisits = false,\n}: VisitsTableProps) => {\n  const headerCellsClass = 'visits-table__header-cell visits-table__sticky';\n  const matchMobile = () => matchMedia('(max-width: 767px)').matches;\n\n  const [ isMobileDevice, setIsMobileDevice ] = useState(matchMobile());\n  const [ searchTerm, setSearchTerm ] = useState<string | undefined>(undefined);\n  const [ order, setOrder ] = useState<VisitsOrder>({});\n  const resultSet = useMemo(() => calculateVisits(visits, searchTerm, order), [ searchTerm, order ]);\n  const isFirstLoad = useRef(true);\n  const [ page, setPage ] = useState(1);\n  const end = page * PAGE_SIZE;\n  const start = end - PAGE_SIZE;\n  const supportsBots = supportsBotVisits(selectedServer);\n  const fullSizeColSpan = 7 + Number(supportsBots) + Number(isOrphanVisits);\n\n  const orderByColumn = (field: OrderableFields) =>\n    () => setOrder({ field, dir: determineOrderDir(field, order.field, order.dir) });\n  const renderOrderIcon = (field: OrderableFields) =>\n    <TableOrderIcon currentOrder={order} field={field} className=\"visits-table__header-icon\" />;\n\n  useEffect(() => {\n    const listener = () => setIsMobileDevice(matchMobile());\n\n    window.addEventListener('resize', listener);\n\n    return () => window.removeEventListener('resize', listener);\n  }, []);\n  useEffect(() => {\n    setPage(1);\n\n    !isFirstLoad.current && setSelectedVisits([]);\n    isFirstLoad.current = false;\n  }, [ searchTerm ]);\n\n  return (\n    <table className=\"table table-bordered table-hover table-sm table-responsive-sm visits-table\">\n      <thead className=\"visits-table__header\">\n        <tr>\n          <th\n            className={`${headerCellsClass} text-center`}\n            onClick={() => setSelectedVisits(\n              selectedVisits.length < resultSet.total ? resultSet.visitsGroups.flat() : [],\n            )}\n          >\n            <FontAwesomeIcon icon={checkIcon} className={classNames({ 'text-primary': selectedVisits.length > 0 })} />\n          </th>\n          {supportsBots && (\n            <th className={`${headerCellsClass} text-center`} onClick={orderByColumn('potentialBot')}>\n              <FontAwesomeIcon icon={botIcon} />\n              {renderOrderIcon('potentialBot')}\n            </th>\n          )}\n          <th className={headerCellsClass} onClick={orderByColumn('date')}>\n            Date\n            {renderOrderIcon('date')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('country')}>\n            Country\n            {renderOrderIcon('country')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('city')}>\n            City\n            {renderOrderIcon('city')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('browser')}>\n            Browser\n            {renderOrderIcon('browser')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('os')}>\n            OS\n            {renderOrderIcon('os')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('referer')}>\n            Referrer\n            {renderOrderIcon('referer')}\n          </th>\n          {isOrphanVisits && (\n            <th className={headerCellsClass} onClick={orderByColumn('visitedUrl')}>\n              Visited URL\n              {renderOrderIcon('visitedUrl')}\n            </th>\n          )}\n        </tr>\n        <tr>\n          <td colSpan={fullSizeColSpan} className=\"p-0\">\n            <SearchField noBorder large={false} onChange={setSearchTerm} />\n          </td>\n        </tr>\n      </thead>\n      <tbody>\n        {!resultSet.visitsGroups[page - 1]?.length && (\n          <tr>\n            <td colSpan={fullSizeColSpan} className=\"text-center\">\n              No visits found with current filtering\n            </td>\n          </tr>\n        )}\n        {resultSet.visitsGroups[page - 1]?.map((visit, index) => {\n          const isSelected = selectedVisits.includes(visit);\n\n          return (\n            <tr\n              key={index}\n              style={{ cursor: 'pointer' }}\n              className={classNames({ 'table-active': isSelected })}\n              onClick={() => setSelectedVisits(\n                isSelected ? selectedVisits.filter((v) => v !== visit) : [ ...selectedVisits, visit ],\n              )}\n            >\n              <td className=\"text-center\">\n                {isSelected && <FontAwesomeIcon icon={checkIcon} className=\"text-primary\" />}\n              </td>\n              {supportsBots && (\n                <td className=\"text-center\">\n                  {visit.potentialBot && (\n                    <>\n                      <FontAwesomeIcon icon={botIcon} id={`botIcon${index}`} />\n                      <UncontrolledTooltip placement=\"right\" target={`botIcon${index}`}>\n                        Potentially a visit from a bot or crawler\n                      </UncontrolledTooltip>\n                    </>\n                  )}\n                </td>\n              )}\n              <td><Time date={visit.date} /></td>\n              <td>{visit.country}</td>\n              <td>{visit.city}</td>\n              <td>{visit.browser}</td>\n              <td>{visit.os}</td>\n              <td>{visit.referer}</td>\n              {isOrphanVisits && <td>{(visit as NormalizedOrphanVisit).visitedUrl}</td>}\n            </tr>\n          );\n        })}\n      </tbody>\n      {resultSet.total > PAGE_SIZE && (\n        <tfoot>\n          <tr>\n            <td colSpan={fullSizeColSpan} className=\"visits-table__footer-cell visits-table__sticky\">\n              <div className=\"row\">\n                <div className=\"col-md-6\">\n                  <SimplePaginator\n                    pagesCount={Math.ceil(resultSet.total / PAGE_SIZE)}\n                    currentPage={page}\n                    setCurrentPage={setPage}\n                    centered={isMobileDevice}\n                  />\n                </div>\n                <div\n                  className={classNames('col-md-6', {\n                    'd-flex align-items-center flex-row-reverse': !isMobileDevice,\n                    'text-center mt-3': isMobileDevice,\n                  })}\n                >\n                  <div>\n                    Visits <b>{prettify(start + 1)}</b> to{' '}\n                    <b>{prettify(min(end, resultSet.total))}</b> of{' '}\n                    <b>{prettify(resultSet.total)}</b>\n                  </div>\n                </div>\n              </div>\n            </td>\n          </tr>\n        </tfoot>\n      )}\n    </table>\n  );\n};\n\nexport default VisitsTable;\n","import { FC } from 'react';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { MapContainer, TileLayer, Marker, Popup, MapContainerProps } from 'react-leaflet';\nimport { prop } from 'ramda';\nimport { CityStats } from '../types';\nimport './MapModal.scss';\n\ninterface MapModalProps {\n  toggle: () => void;\n  isOpen: boolean;\n  title: string;\n  locations?: CityStats[];\n}\n\nconst OpenStreetMapTile: FC = () => (\n  <TileLayer\n    attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n  />\n);\n\nconst calculateMapProps = (locations: CityStats[]): MapContainerProps => {\n  if (locations.length === 0) {\n    return {};\n  }\n\n  if (locations.length > 1) {\n    return { bounds: locations.map(prop('latLong')) };\n  }\n\n  // When there's only one location, an error is thrown if trying to calculate the bounds.\n  // When that happens, we use zoom and center as a workaround\n  const [{ latLong: center }] = locations;\n\n  return { zoom: 10, center };\n};\n\nconst MapModal = ({ toggle, isOpen, title, locations = [] }: MapModalProps) => (\n  <Modal toggle={toggle} isOpen={isOpen} className=\"map-modal__modal\" contentClassName=\"map-modal__modal-content\">\n    <ModalBody className=\"map-modal__modal-body\">\n      <h3 className=\"map-modal__modal-title\">\n        {title}\n        <button type=\"button\" className=\"close\" onClick={toggle}>&times;</button>\n      </h3>\n      <MapContainer {...calculateMapProps(locations)}>\n        <OpenStreetMapTile />\n        {locations.map(({ cityName, latLong, count }, index) => (\n          <Marker key={index} position={latLong}>\n            <Popup><b>{count}</b> visit{count > 1 ? 's' : ''} from <b>{cityName}</b></Popup>\n          </Marker>\n        ))}\n      </MapContainer>\n    </ModalBody>\n  </Modal>\n);\n\nexport default MapModal;\n","import { useRef, useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faMapMarkedAlt as mapIcon } from '@fortawesome/free-solid-svg-icons';\nimport { Dropdown, DropdownItem, DropdownMenu, UncontrolledTooltip } from 'reactstrap';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { CityStats } from '../types';\nimport MapModal from './MapModal';\nimport './OpenMapModalBtn.scss';\n\ninterface OpenMapModalBtnProps {\n  modalTitle: string;\n  activeCities: string[];\n  locations?: CityStats[];\n}\n\nconst OpenMapModalBtn = ({ modalTitle, activeCities, locations = [] }: OpenMapModalBtnProps) => {\n  const [ mapIsOpened, , openMap, closeMap ] = useToggle();\n  const [ dropdownIsOpened, toggleDropdown, openDropdown ] = useToggle();\n  const [ locationsToShow, setLocationsToShow ] = useState<CityStats[]>([]);\n  const buttonRef = useRef<HTMLElement>();\n\n  const filterLocations = (cities: CityStats[]) => cities.filter(({ cityName }) => activeCities.includes(cityName));\n  const onClick = () => {\n    if (!activeCities) {\n      setLocationsToShow(locations);\n      openMap();\n\n      return;\n    }\n\n    openDropdown();\n  };\n  const openMapWithLocations = (filtered: boolean) => () => {\n    setLocationsToShow(filtered ? filterLocations(locations) : locations);\n    openMap();\n  };\n\n  return (\n    <>\n      <button className=\"btn btn-link open-map-modal-btn__btn\" ref={buttonRef as any} onClick={onClick}>\n        <FontAwesomeIcon icon={mapIcon} />\n      </button>\n      <UncontrolledTooltip placement=\"left\" target={(() => buttonRef.current) as any}>Show in map</UncontrolledTooltip>\n      <Dropdown isOpen={dropdownIsOpened} toggle={toggleDropdown} inNavbar>\n        <DropdownMenu right>\n          <DropdownItem onClick={openMapWithLocations(false)}>Show all locations</DropdownItem>\n          <DropdownItem onClick={openMapWithLocations(true)}>Show locations in current page</DropdownItem>\n        </DropdownMenu>\n      </Dropdown>\n      <MapModal toggle={closeMap} isOpen={mapIsOpened} title={modalTitle} locations={locationsToShow} />\n    </>\n  );\n};\n\nexport default OpenMapModalBtn;\n","import { countBy, groupBy, pipe, prop } from 'ramda';\nimport { formatIsoDate } from '../../utils/helpers/date';\nimport { ShlinkVisitsParams } from '../../api/types';\nimport { CreateVisit, NormalizedOrphanVisit, NormalizedVisit, OrphanVisit, Stats, Visit, VisitsParams } from './index';\n\nexport const isOrphanVisit = (visit: Visit): visit is OrphanVisit => visit.hasOwnProperty('visitedUrl');\n\nexport const isNormalizedOrphanVisit = (visit: NormalizedVisit): visit is NormalizedOrphanVisit =>\n  visit.hasOwnProperty('visitedUrl');\n\nexport interface GroupedNewVisits {\n  orphanVisits: CreateVisit[];\n  regularVisits: CreateVisit[];\n}\n\nexport const groupNewVisitsByType = pipe(\n  groupBy((newVisit: CreateVisit) => isOrphanVisit(newVisit.visit) ? 'orphanVisits' : 'regularVisits'),\n  // @ts-expect-error Type declaration on groupBy is not correct. It can return undefined props\n  (result): GroupedNewVisits => ({ orphanVisits: [], regularVisits: [], ...result }),\n);\n\nexport type HighlightableProps<T extends NormalizedVisit> = T extends NormalizedOrphanVisit\n  ? ('referer' | 'country' | 'city' | 'visitedUrl')\n  : ('referer' | 'country' | 'city');\n\nexport const highlightedVisitsToStats = <T extends NormalizedVisit>(\n  highlightedVisits: T[],\n  property: HighlightableProps<T>,\n): Stats => countBy(prop(property) as any, highlightedVisits);\n\nexport const toApiParams = ({ page, itemsPerPage, filter, dateRange }: VisitsParams): ShlinkVisitsParams => {\n  const startDate = (dateRange?.startDate && formatIsoDate(dateRange?.startDate)) ?? undefined;\n  const endDate = (dateRange?.endDate && formatIsoDate(dateRange?.endDate)) ?? undefined;\n  const excludeBots = filter?.excludeBots || undefined; // eslint-disable-line @typescript-eslint/prefer-nullish-coalescing\n\n  return { page, itemsPerPage, startDate, endDate, excludeBots };\n};\n","import { isNil, map } from 'ramda';\nimport { extractDomain, parseUserAgent } from '../../utils/helpers/visits';\nimport { hasValue } from '../../utils/utils';\nimport { CityStats, NormalizedVisit, Stats, Visit, VisitsStats } from '../types';\nimport { isNormalizedOrphanVisit, isOrphanVisit } from '../types/helpers';\n\nconst visitHasProperty = (visit: NormalizedVisit, propertyName: keyof NormalizedVisit) =>\n  !isNil(visit) && hasValue(visit[propertyName]);\n\nconst optionalNumericToNumber = (numeric: string | number | null | undefined): number => {\n  if (typeof numeric === 'number') {\n    return numeric;\n  }\n\n  return numeric ? parseFloat(numeric) : 0;\n};\n\nconst updateOsStatsForVisit = (osStats: Stats, { os }: NormalizedVisit) => {\n  osStats[os] = (osStats[os] || 0) + 1;\n};\n\nconst updateBrowsersStatsForVisit = (browsersStats: Stats, { browser }: NormalizedVisit) => {\n  browsersStats[browser] = (browsersStats[browser] || 0) + 1;\n};\n\nconst updateReferrersStatsForVisit = (referrersStats: Stats, { referer: domain }: NormalizedVisit) => {\n  referrersStats[domain] = (referrersStats[domain] || 0) + 1;\n};\n\nconst updateLocationsStatsForVisit = (propertyName: 'country' | 'city') => (stats: Stats, visit: NormalizedVisit) => {\n  const hasLocationProperty = visitHasProperty(visit, propertyName);\n  const value = hasLocationProperty ? visit[propertyName] : 'Unknown';\n\n  stats[value] = (stats[value] || 0) + 1;\n};\n\nconst updateCountriesStatsForVisit = updateLocationsStatsForVisit('country');\nconst updateCitiesStatsForVisit = updateLocationsStatsForVisit('city');\n\nconst updateCitiesForMapForVisit = (citiesForMapStats: Record<string, CityStats>, visit: NormalizedVisit) => {\n  if (!visitHasProperty(visit, 'city') || visit.city === 'Unknown') {\n    return;\n  }\n\n  const { city, latitude, longitude } = visit;\n  const currentCity = citiesForMapStats[city] || {\n    cityName: city,\n    count: 0,\n    latLong: [ optionalNumericToNumber(latitude), optionalNumericToNumber(longitude) ],\n  };\n\n  currentCity.count++;\n\n  citiesForMapStats[city] = currentCity;\n};\n\nconst updateVisitedUrlsForVisit = (visitedUrlsStats: Stats, visit: NormalizedVisit) => {\n  if (!isNormalizedOrphanVisit(visit)) {\n    return;\n  }\n\n  const { visitedUrl } = visit;\n\n  visitedUrlsStats[visitedUrl] = (visitedUrlsStats[visitedUrl] || 0) + 1;\n};\n\nexport const processStatsFromVisits = (visits: NormalizedVisit[]) => visits.reduce(\n  (stats: VisitsStats, visit: NormalizedVisit) => {\n    // We mutate the original object because it has a big performance impact when large data sets are processed\n    updateOsStatsForVisit(stats.os, visit);\n    updateBrowsersStatsForVisit(stats.browsers, visit);\n    updateReferrersStatsForVisit(stats.referrers, visit);\n    updateCountriesStatsForVisit(stats.countries, visit);\n    updateCitiesStatsForVisit(stats.cities, visit);\n    updateCitiesForMapForVisit(stats.citiesForMap, visit);\n    updateVisitedUrlsForVisit(stats.visitedUrls, visit);\n\n    return stats;\n  },\n  { os: {}, browsers: {}, referrers: {}, countries: {}, cities: {}, citiesForMap: {}, visitedUrls: {} },\n);\n\nexport const normalizeVisits = map((visit: Visit): NormalizedVisit => {\n  const { userAgent, date, referer, visitLocation, potentialBot = false } = visit;\n  const common = {\n    date,\n    potentialBot,\n    ...parseUserAgent(userAgent),\n    referer: extractDomain(referer),\n    country: visitLocation?.countryName || 'Unknown', // eslint-disable-line @typescript-eslint/prefer-nullish-coalescing\n    city: visitLocation?.cityName || 'Unknown', // eslint-disable-line @typescript-eslint/prefer-nullish-coalescing\n    latitude: visitLocation?.latitude,\n    longitude: visitLocation?.longitude,\n  };\n\n  if (!isOrphanVisit(visit)) {\n    return common;\n  }\n\n  return { ...common, type: visit.type, visitedUrl: visit.visitedUrl };\n});\n\nexport interface VisitsParser {\n  processStatsFromVisits: (normalizedVisits: NormalizedVisit[]) => VisitsStats;\n  normalizeVisits: (visits: Visit[]) => NormalizedVisit[];\n}\n","import { DropdownItem, DropdownItemProps } from 'reactstrap'; // eslint-disable-line import/named\nimport { OrphanVisitType, VisitsFilter } from '../types';\nimport { DropdownBtn } from '../../utils/DropdownBtn';\nimport { hasValue } from '../../utils/utils';\n\ninterface VisitsFilterDropdownProps {\n  onChange: (filters: VisitsFilter) => void;\n  selected?: VisitsFilter;\n  className?: string;\n  isOrphanVisits: boolean;\n  botsSupported: boolean;\n}\n\nexport const VisitsFilterDropdown = (\n  { onChange, selected = {}, className, isOrphanVisits, botsSupported }: VisitsFilterDropdownProps,\n) => {\n  if (!botsSupported && !isOrphanVisits) {\n    return null;\n  }\n\n  const { orphanVisitsType, excludeBots = false } = selected;\n  const propsForOrphanVisitsTypeItem = (type: OrphanVisitType): DropdownItemProps => ({\n    active: orphanVisitsType === type,\n    onClick: () => onChange({ ...selected, orphanVisitsType: type === selected?.orphanVisitsType ? undefined : type }),\n  });\n  const onBotsClick = () => onChange({ ...selected, excludeBots: !selected?.excludeBots });\n\n  return (\n    <DropdownBtn text=\"Filters\" dropdownClassName={className} className=\"mr-3\" right minWidth={250}>\n      {botsSupported && (\n        <>\n          <DropdownItem header>Bots:</DropdownItem>\n          <DropdownItem active={excludeBots} onClick={onBotsClick}>Exclude potential bots</DropdownItem>\n        </>\n      )}\n\n      {botsSupported && isOrphanVisits && <DropdownItem divider />}\n\n      {isOrphanVisits && (\n        <>\n          <DropdownItem header>Orphan visits type:</DropdownItem>\n          <DropdownItem {...propsForOrphanVisitsTypeItem('base_url')}>Base URL</DropdownItem>\n          <DropdownItem {...propsForOrphanVisitsTypeItem('invalid_short_url')}>Invalid short URL</DropdownItem>\n          <DropdownItem {...propsForOrphanVisitsTypeItem('regular_404')}>Regular 404</DropdownItem>\n        </>\n      )}\n\n      <DropdownItem divider />\n      <DropdownItem disabled={!hasValue(selected)} onClick={() => onChange({})}><i>Clear filters</i></DropdownItem>\n    </DropdownBtn>\n  );\n};\n","import { FC } from 'react';\nimport { Chart } from 'chart.js';\nimport './DoughnutChartLegend.scss';\n\ninterface DoughnutChartLegendProps {\n  chart: Chart;\n}\n\nexport const DoughnutChartLegend: FC<DoughnutChartLegendProps> = ({ chart }) => {\n  const { config } = chart;\n  const { labels = [], datasets = [] } = config.data ?? {};\n  const [{ backgroundColor: colors }] = datasets;\n  const { defaultColor } = config.options ?? {} as any;\n\n  return (\n    <ul className=\"doughnut-chart-legend\">\n      {(labels as string[]).map((label, index) => (\n        <li key={label} className=\"doughnut-chart-legend__item d-flex\">\n          <div\n            className=\"doughnut-chart-legend__item-color\"\n            style={{ backgroundColor: (colors as string[])[index] ?? defaultColor }}\n          />\n          <small className=\"doughnut-chart-legend__item-text flex-fill\">{label}</small>\n        </li>\n      ))}\n    </ul>\n  );\n};\n","import { FC, useState, memo } from 'react';\nimport { Chart, ChartData, ChartDataset, ChartOptions } from 'chart.js';\nimport { keys, values } from 'ramda';\nimport { Doughnut } from 'react-chartjs-2';\nimport { renderPieChartLabel } from '../../utils/helpers/charts';\nimport { isDarkThemeEnabled, PRIMARY_DARK_COLOR, PRIMARY_LIGHT_COLOR } from '../../utils/theme';\nimport { Stats } from '../types';\nimport { DoughnutChartLegend } from './DoughnutChartLegend';\n\ninterface DoughnutChartProps {\n  stats: Stats;\n}\n\nconst generateChartDatasets = (data: number[]): ChartDataset[] => [\n  {\n    data,\n    backgroundColor: [\n      '#97BBCD',\n      '#F7464A',\n      '#46BFBD',\n      '#FDB45C',\n      '#949FB1',\n      '#57A773',\n      '#414066',\n      '#08B2E3',\n      '#B6C454',\n      '#DCDCDC',\n      '#463730',\n    ],\n    borderColor: isDarkThemeEnabled() ? PRIMARY_DARK_COLOR : PRIMARY_LIGHT_COLOR,\n    borderWidth: 2,\n  },\n];\nconst generateChartData = (labels: string[], data: number[]): ChartData => ({\n  labels,\n  datasets: generateChartDatasets(data),\n});\n\nexport const DoughnutChart: FC<DoughnutChartProps> = memo(({ stats }) => {\n  const [ chartRef, setChartRef ] = useState<Chart | undefined>(); // Cannot use useRef here\n  const labels = keys(stats);\n  const data = values(stats);\n\n  const options: ChartOptions = {\n    plugins: {\n      legend: { display: false },\n      tooltip: {\n        intersect: true,\n        callbacks: { label: renderPieChartLabel },\n      },\n    },\n  };\n  const chartData = generateChartData(labels, data);\n\n  return (\n    <div className=\"row\">\n      <div className=\"col-sm-12 col-md-7\">\n        <Doughnut\n          height={300}\n          data={chartData}\n          options={options}\n          ref={(element) => {\n            setChartRef(element ?? undefined);\n          }}\n        />\n      </div>\n      <div className=\"col-sm-12 col-md-5\">\n        {chartRef && <DoughnutChartLegend chart={chartRef} />}\n      </div>\n    </div>\n  );\n});\n","import { Card, CardHeader, CardBody, CardFooter } from 'reactstrap';\nimport { FC, ReactNode } from 'react';\nimport './ChartCard.scss';\n\ninterface ChartCardProps {\n  title: Function | string;\n  footer?: ReactNode;\n}\n\nexport const ChartCard: FC<ChartCardProps> = ({ title, footer, children }) => (\n  <Card>\n    <CardHeader className=\"chart-card__header\">{typeof title === 'function' ? title() : title}</CardHeader>\n    <CardBody>{children}</CardBody>\n    {footer && <CardFooter className=\"chart-card__footer--sticky\">{footer}</CardFooter>}\n  </Card>\n);\n","import { FC } from 'react';\nimport { Stats } from '../types';\nimport { DoughnutChart } from './DoughnutChart';\nimport { ChartCard } from './ChartCard';\n\ninterface DoughnutChartCardProps {\n  title: string;\n  stats: Stats;\n}\n\nexport const DoughnutChartCard: FC<DoughnutChartCardProps> = ({ title, stats }) => (\n  <ChartCard title={title}>\n    <DoughnutChart stats={stats} />\n  </ChartCard>\n);\n","import { DropdownItem, DropdownMenu, DropdownToggle, UncontrolledDropdown } from 'reactstrap';\n\ninterface PaginationDropdownProps {\n  ranges: number[];\n  value: number;\n  setValue: (newValue: number) => void;\n  toggleClassName?: string;\n}\n\nconst PaginationDropdown = ({ toggleClassName, ranges, value, setValue }: PaginationDropdownProps) => (\n  <UncontrolledDropdown>\n    <DropdownToggle caret color=\"link\" className={toggleClassName}>\n      Paginate\n    </DropdownToggle>\n    <DropdownMenu right>\n      {ranges.map((itemsPerPage) => (\n        <DropdownItem key={itemsPerPage} active={itemsPerPage === value} onClick={() => setValue(itemsPerPage)}>\n          <b>{itemsPerPage}</b> items per page\n        </DropdownItem>\n      ))}\n      <DropdownItem divider />\n      <DropdownItem disabled={value === Infinity} onClick={() => setValue(Infinity)}>\n        <i>Clear pagination</i>\n      </DropdownItem>\n    </DropdownMenu>\n  </UncontrolledDropdown>\n);\n\nexport default PaginationDropdown;\n","import { FC } from 'react';\nimport { ChartData, ChartDataset, ChartOptions } from 'chart.js';\nimport { keys, values } from 'ramda';\nimport { Bar } from 'react-chartjs-2';\nimport { fillTheGaps } from '../../utils/helpers/visits';\nimport { pointerOnHover, renderChartLabel } from '../../utils/helpers/charts';\nimport { prettify } from '../../utils/helpers/numbers';\nimport { Stats } from '../types';\nimport { HIGHLIGHTED_COLOR, HIGHLIGHTED_COLOR_ALPHA, MAIN_COLOR, MAIN_COLOR_ALPHA } from '../../utils/theme';\n\nexport interface HorizontalBarChartProps {\n  stats: Stats;\n  max?: number;\n  highlightedStats?: Stats;\n  highlightedLabel?: string;\n  onClick?: (label: string) => void;\n}\n\nconst dropLabelIfHidden = (label: string) => label.startsWith('hidden') ? '' : label;\nconst statsAreDefined = (stats: Stats | undefined): stats is Stats => !!stats && Object.keys(stats).length > 0;\nconst determineHeight = (labels: string[]): number | undefined => labels.length > 20 ? labels.length * 10 : undefined;\n\nconst generateChartDatasets = (\n  data: number[],\n  highlightedData: number[],\n  highlightedLabel?: string,\n): ChartDataset[] => {\n  const mainDataset: ChartDataset = {\n    data,\n    label: highlightedLabel ? 'Non-selected' : 'Visits',\n    backgroundColor: MAIN_COLOR_ALPHA,\n    borderColor: MAIN_COLOR,\n    borderWidth: 2,\n  };\n\n  if (highlightedData.every((value) => value === 0)) {\n    return [ mainDataset ];\n  }\n\n  const highlightedDataset: ChartDataset = {\n    label: highlightedLabel ?? 'Selected',\n    data: highlightedData,\n    backgroundColor: HIGHLIGHTED_COLOR_ALPHA,\n    borderColor: HIGHLIGHTED_COLOR,\n    borderWidth: 2,\n  };\n\n  return [ mainDataset, highlightedDataset ];\n};\nconst generateChartData = (\n  labels: string[],\n  data: number[],\n  highlightedData: number[],\n  highlightedLabel?: string,\n): ChartData => ({\n  labels,\n  datasets: generateChartDatasets(data, highlightedData, highlightedLabel),\n});\n\ntype ClickedCharts = [{ index: number }] | [];\nconst chartElementAtEvent = (labels: string[], onClick?: (label: string) => void) => ([ chart ]: ClickedCharts) => {\n  if (!onClick || !chart) {\n    return;\n  }\n\n  onClick(labels[chart.index]);\n};\n\nexport const HorizontalBarChart: FC<HorizontalBarChartProps> = (\n  { stats, highlightedStats, highlightedLabel, onClick, max },\n) => {\n  const labels = keys(stats).map(dropLabelIfHidden);\n  const data = values(\n    !statsAreDefined(highlightedStats) ? stats : keys(highlightedStats).reduce((acc, highlightedKey) => {\n      if (acc[highlightedKey]) {\n        acc[highlightedKey] -= highlightedStats[highlightedKey];\n      }\n\n      return acc;\n    }, { ...stats }),\n  );\n  const highlightedData = fillTheGaps(highlightedStats ?? {}, labels);\n\n  const options: ChartOptions = {\n    plugins: {\n      legend: { display: false },\n      tooltip: {\n        mode: 'y',\n        // Do not show tooltip on items with empty label when in a bar chart\n        filter: ({ label }) => label !== '',\n        callbacks: { label: renderChartLabel },\n      },\n    },\n    scales: {\n      x: {\n        beginAtZero: true,\n        stacked: true,\n        max,\n        ticks: {\n          precision: 0,\n          callback: prettify,\n        },\n      },\n      y: { stacked: true },\n    },\n    onHover: pointerOnHover,\n    indexAxis: 'y',\n  };\n  const chartData = generateChartData(labels, data, highlightedData, highlightedLabel);\n  const height = determineHeight(labels);\n\n  // Provide a key based on the height, to force re-render every time the dataset changes (example, due to pagination)\n  const renderChartComponent = (customKey: string) => (\n    <Bar\n      key={`${height}_${customKey}`}\n      data={chartData}\n      options={options}\n      height={height}\n      getElementAtEvent={chartElementAtEvent(labels, onClick) as any}\n    />\n  );\n\n  return (\n    <>\n      {/* It's VERY IMPORTANT to render two different components here, as one has 1 dataset and the other has 2 */}\n      {/* Using the same component causes a crash when switching from 1 to 2 datasets, and then back to 1 dataset */}\n      {highlightedStats !== undefined && renderChartComponent('with_stats')}\n      {highlightedStats === undefined && renderChartComponent('without_stats')}\n    </>\n  );\n};\n","import { FC, useState } from 'react';\nimport { fromPairs, pipe, reverse, sortBy, splitEvery, toLower, toPairs, type, zipObj } from 'ramda';\nimport { rangeOf } from '../../utils/utils';\nimport { Order } from '../../utils/helpers/ordering';\nimport SimplePaginator from '../../common/SimplePaginator';\nimport { roundTen } from '../../utils/helpers/numbers';\nimport { OrderingDropdown } from '../../utils/OrderingDropdown';\nimport PaginationDropdown from '../../utils/PaginationDropdown';\nimport { Stats, StatsRow } from '../types';\nimport { HorizontalBarChart, HorizontalBarChartProps } from './HorizontalBarChart';\nimport { ChartCard } from './ChartCard';\n\ninterface SortableBarChartCardProps extends Omit<HorizontalBarChartProps, 'max'> {\n  title: Function | string;\n  sortingItems: Record<string, string>;\n  withPagination?: boolean;\n  extraHeaderContent?: Function;\n}\n\nconst toLowerIfString = (value: any) => type(value) === 'String' ? toLower(value) : value; // eslint-disable-line @typescript-eslint/no-unsafe-return\nconst pickKeyFromPair = ([ key ]: StatsRow) => key;\nconst pickValueFromPair = ([ , value ]: StatsRow) => value;\n\nexport const SortableBarChartCard: FC<SortableBarChartCardProps> = ({\n  stats,\n  highlightedStats,\n  title,\n  sortingItems,\n  extraHeaderContent,\n  withPagination = true,\n  ...rest\n}) => {\n  const [ order, setOrder ] = useState<Order<string>>({});\n  const [ currentPage, setCurrentPage ] = useState(1);\n  const [ itemsPerPage, setItemsPerPage ] = useState(50);\n\n  const getSortedPairsForStats = (stats: Stats, sortingItems: Record<string, string>) => {\n    const pairs = toPairs(stats);\n    const sortedPairs = !order.field ? pairs : sortBy(\n      pipe<StatsRow, string | number, string | number>(\n        order.field === Object.keys(sortingItems)[0] ? pickKeyFromPair : pickValueFromPair,\n        toLowerIfString,\n      ),\n      pairs,\n    );\n\n    return !order.dir || order.dir === 'ASC' ? sortedPairs : reverse(sortedPairs);\n  };\n  const determineCurrentPagePairs = (pages: StatsRow[][]): StatsRow[] => {\n    const page = pages[currentPage - 1];\n\n    if (currentPage < pages.length) {\n      return page;\n    }\n\n    const firstPageLength = pages[0].length;\n\n    // Using the \"hidden\" key, the chart will just replace the label by an empty string\n    return [ ...page, ...rangeOf(firstPageLength - page.length, (i): StatsRow => [ `hidden_${i}`, 0 ]) ];\n  };\n  const renderPagination = (pagesCount: number) =>\n    <SimplePaginator currentPage={currentPage} pagesCount={pagesCount} setCurrentPage={setCurrentPage} />;\n  const determineStats = (stats: Stats, highlightedStats: Stats | undefined, sortingItems: Record<string, string>) => {\n    const sortedPairs = getSortedPairsForStats(stats, sortingItems);\n    const sortedKeys = sortedPairs.map(pickKeyFromPair);\n    // The highlighted stats have to be ordered based on the regular stats, not on its own values\n    const sortedHighlightedPairs = highlightedStats && toPairs(\n      { ...zipObj(sortedKeys, sortedKeys.map(() => 0)), ...highlightedStats },\n    );\n\n    if (sortedPairs.length <= itemsPerPage) {\n      return {\n        currentPageStats: fromPairs(sortedPairs),\n        currentPageHighlightedStats: sortedHighlightedPairs && fromPairs(sortedHighlightedPairs),\n      };\n    }\n\n    const pages = splitEvery(itemsPerPage, sortedPairs);\n    const highlightedPages = sortedHighlightedPairs && splitEvery(itemsPerPage, sortedHighlightedPairs);\n\n    return {\n      currentPageStats: fromPairs(determineCurrentPagePairs(pages)),\n      currentPageHighlightedStats: highlightedPages && fromPairs(determineCurrentPagePairs(highlightedPages)),\n      pagination: renderPagination(pages.length),\n      max: roundTen(Math.max(...sortedPairs.map(pickValueFromPair))),\n    };\n  };\n\n  const { currentPageStats, currentPageHighlightedStats, pagination, max } = determineStats(\n    stats,\n    highlightedStats && Object.keys(highlightedStats).length > 0 ? highlightedStats : undefined,\n    sortingItems,\n  );\n  const activeCities = Object.keys(currentPageStats);\n  const computeTitle = () => (\n    <>\n      {title}\n      <div className=\"float-right\">\n        <OrderingDropdown\n          isButton={false}\n          right\n          items={sortingItems}\n          order={order}\n          onChange={(field, dir) => {\n            setOrder({ field, dir });\n            setCurrentPage(1);\n          }}\n        />\n      </div>\n      {withPagination && Object.keys(stats).length > 50 && (\n        <div className=\"float-right\">\n          <PaginationDropdown\n            toggleClassName=\"btn-sm p-0 mr-3\"\n            ranges={[ 50, 100, 200, 500 ]}\n            value={itemsPerPage}\n            setValue={(itemsPerPage) => {\n              setItemsPerPage(itemsPerPage);\n              setCurrentPage(1);\n            }}\n          />\n        </div>\n      )}\n      {extraHeaderContent && (\n        <div className=\"float-right\">\n          {extraHeaderContent(pagination ? activeCities : undefined)}\n        </div>\n      )}\n    </>\n  );\n\n  return (\n    <ChartCard\n      title={computeTitle}\n      footer={pagination}\n    >\n      <HorizontalBarChart stats={currentPageStats} highlightedStats={currentPageHighlightedStats} max={max} {...rest} />\n    </ChartCard>\n  );\n};\n","import { useEffect } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { ShlinkVisitsParams } from '../api/types';\nimport { parseQuery } from '../utils/helpers/query';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { ShortUrlDetail } from '../short-urls/reducers/shortUrlDetail';\nimport { ShortUrlVisits as ShortUrlVisitsState } from './reducers/shortUrlVisits';\nimport ShortUrlVisitsHeader from './ShortUrlVisitsHeader';\nimport VisitsStats from './VisitsStats';\nimport { VisitsExporter } from './services/VisitsExporter';\nimport { NormalizedVisit, VisitsParams } from './types';\nimport { CommonVisitsProps } from './types/CommonVisitsProps';\nimport { toApiParams } from './types/helpers';\n\nexport interface ShortUrlVisitsProps extends CommonVisitsProps, RouteComponentProps<{ shortCode: string }> {\n  getShortUrlVisits: (shortCode: string, query?: ShlinkVisitsParams, doIntervalFallback?: boolean) => void;\n  shortUrlVisits: ShortUrlVisitsState;\n  getShortUrlDetail: Function;\n  shortUrlDetail: ShortUrlDetail;\n  cancelGetShortUrlVisits: () => void;\n}\n\nconst ShortUrlVisits = ({ exportVisits }: VisitsExporter) => boundToMercureHub(({\n  history: { goBack },\n  match: { params, url },\n  location: { search },\n  shortUrlVisits,\n  shortUrlDetail,\n  getShortUrlVisits,\n  getShortUrlDetail,\n  cancelGetShortUrlVisits,\n  settings,\n  selectedServer,\n}: ShortUrlVisitsProps) => {\n  const { shortCode } = params;\n  const { domain } = parseQuery<{ domain?: string }>(search);\n  const loadVisits = (params: VisitsParams, doIntervalFallback?: boolean) =>\n    getShortUrlVisits(shortCode, { ...toApiParams(params), domain }, doIntervalFallback);\n  const exportCsv = (visits: NormalizedVisit[]) => exportVisits(\n    `short-url_${shortUrlDetail.shortUrl?.shortUrl.replace(/https?:\\/\\//g, '')}_visits.csv`,\n    visits,\n  );\n\n  useEffect(() => {\n    getShortUrlDetail(shortCode, domain);\n  }, []);\n\n  return (\n    <VisitsStats\n      getVisits={loadVisits}\n      cancelGetVisits={cancelGetShortUrlVisits}\n      visitsInfo={shortUrlVisits}\n      baseUrl={url}\n      domain={domain}\n      settings={settings}\n      exportCsv={exportCsv}\n      selectedServer={selectedServer}\n    >\n      <ShortUrlVisitsHeader shortUrlDetail={shortUrlDetail} shortUrlVisits={shortUrlVisits} goBack={goBack} />\n    </VisitsStats>\n  );\n}, ({ match }) => [ Topics.shortUrlVisits(match.params.shortCode) ]);\n\nexport default ShortUrlVisits;\n","import { flatten, prop, range, splitEvery } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { ShlinkPaginator, ShlinkVisits, ShlinkVisitsParams } from '../../api/types';\nimport { Visit } from '../types';\nimport { parseApiError } from '../../api/utils';\nimport { ApiErrorAction } from '../../api/types/actions';\nimport { dateToMatchingInterval } from '../../utils/dates/types';\n\nconst ITEMS_PER_PAGE = 5000;\nconst PARALLEL_REQUESTS_COUNT = 4;\nconst PARALLEL_STARTING_PAGE = 2;\n\nconst isLastPage = ({ currentPage, pagesCount }: ShlinkPaginator): boolean => currentPage >= pagesCount;\nconst calcProgress = (total: number, current: number): number => current * 100 / total;\n\ntype VisitsLoader = (page: number, itemsPerPage: number) => Promise<ShlinkVisits>;\ntype LastVisitLoader = () => Promise<Visit | undefined>;\ninterface ActionMap {\n  start: string;\n  large: string;\n  finish: string;\n  error: string;\n  progress: string;\n  fallbackToInterval: string;\n}\n\nexport const getVisitsWithLoader = async <T extends Action<string> & { visits: Visit[] }>(\n  visitsLoader: VisitsLoader,\n  lastVisitLoader: LastVisitLoader,\n  extraFinishActionData: Partial<T>,\n  actionMap: ActionMap,\n  dispatch: Dispatch,\n  shouldCancel: () => boolean,\n) => {\n  dispatch({ type: actionMap.start });\n\n  const loadVisitsInParallel = async (pages: number[]): Promise<Visit[]> =>\n    Promise.all(pages.map(async (page) => visitsLoader(page, ITEMS_PER_PAGE).then(prop('data')))).then(flatten);\n\n  const loadPagesBlocks = async (pagesBlocks: number[][], index = 0): Promise<Visit[]> => {\n    if (shouldCancel()) {\n      return [];\n    }\n\n    const data = await loadVisitsInParallel(pagesBlocks[index]);\n\n    dispatch({ type: actionMap.progress, progress: calcProgress(pagesBlocks.length, index + PARALLEL_STARTING_PAGE) });\n\n    if (index < pagesBlocks.length - 1) {\n      return data.concat(await loadPagesBlocks(pagesBlocks, index + 1));\n    }\n\n    return data;\n  };\n\n  const loadVisits = async (page = 1) => {\n    const { pagination, data } = await visitsLoader(page, ITEMS_PER_PAGE);\n\n    // If pagination was not returned, then this is an old shlink version. Just return data\n    if (!pagination || isLastPage(pagination)) {\n      return data;\n    }\n\n    // If there are more pages, make requests in blocks of 4\n    const pagesRange = range(PARALLEL_STARTING_PAGE, pagination.pagesCount + 1);\n    const pagesBlocks = splitEvery(PARALLEL_REQUESTS_COUNT, pagesRange);\n\n    if (pagination.pagesCount - 1 > PARALLEL_REQUESTS_COUNT) {\n      dispatch({ type: actionMap.large });\n    }\n\n    return data.concat(await loadPagesBlocks(pagesBlocks));\n  };\n\n  try {\n    const [ visits, lastVisit ] = await Promise.all([ loadVisits(), lastVisitLoader() ]);\n\n    dispatch(\n      !visits.length && lastVisit\n        ? { type: actionMap.fallbackToInterval, fallbackInterval: dateToMatchingInterval(lastVisit.date) }\n        : { ...extraFinishActionData, visits, type: actionMap.finish },\n    );\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: actionMap.error, errorData: parseApiError(e) });\n  }\n};\n\nexport const lastVisitLoaderForLoader = (\n  doIntervalFallback: boolean,\n  loader: (params: ShlinkVisitsParams) => Promise<ShlinkVisits>,\n): LastVisitLoader => {\n  if (!doIntervalFallback) {\n    return async () => Promise.resolve(undefined);\n  }\n\n  return async () => loader({ page: 1, itemsPerPage: 1 }).then((result) => result.data[0]);\n};\n","import { Action, Dispatch } from 'redux';\nimport { shortUrlMatches } from '../../short-urls/helpers';\nimport { Visit, VisitsFallbackIntervalAction, VisitsInfo, VisitsLoadProgressChangedAction } from '../types';\nimport { ShortUrlIdentifier } from '../../short-urls/data';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { ShlinkVisitsParams } from '../../api/types';\nimport { ApiErrorAction } from '../../api/types/actions';\nimport { isBetween } from '../../utils/helpers/date';\nimport { getVisitsWithLoader, lastVisitLoaderForLoader } from './common';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_SHORT_URL_VISITS_START = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_START';\nexport const GET_SHORT_URL_VISITS_ERROR = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_ERROR';\nexport const GET_SHORT_URL_VISITS = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS';\nexport const GET_SHORT_URL_VISITS_LARGE = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_LARGE';\nexport const GET_SHORT_URL_VISITS_CANCEL = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_CANCEL';\nexport const GET_SHORT_URL_VISITS_PROGRESS_CHANGED = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_PROGRESS_CHANGED';\nexport const GET_SHORT_URL_VISITS_FALLBACK_TO_INTERVAL = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_FALLBACK_TO_INTERVAL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlVisits extends VisitsInfo, ShortUrlIdentifier {}\n\ninterface ShortUrlVisitsAction extends Action<string>, ShortUrlIdentifier {\n  visits: Visit[];\n  query?: ShlinkVisitsParams;\n}\n\ntype ShortUrlVisitsCombinedAction = ShortUrlVisitsAction\n& VisitsLoadProgressChangedAction\n& VisitsFallbackIntervalAction\n& CreateVisitsAction\n& ApiErrorAction;\n\nconst initialState: ShortUrlVisits = {\n  visits: [],\n  shortCode: '',\n  domain: undefined, // Deprecated. Value from query params can be used instead\n  loading: false,\n  loadingLarge: false,\n  error: false,\n  cancelLoad: false,\n  progress: 0,\n};\n\nexport default buildReducer<ShortUrlVisits, ShortUrlVisitsCombinedAction>({\n  [GET_SHORT_URL_VISITS_START]: () => ({ ...initialState, loading: true }),\n  [GET_SHORT_URL_VISITS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [GET_SHORT_URL_VISITS]: (state, { visits, query, shortCode, domain }) => ({\n    ...state,\n    visits,\n    shortCode,\n    domain,\n    query,\n    loading: false,\n    error: false,\n  }),\n  [GET_SHORT_URL_VISITS_LARGE]: (state) => ({ ...state, loadingLarge: true }),\n  [GET_SHORT_URL_VISITS_CANCEL]: (state) => ({ ...state, cancelLoad: true }),\n  [GET_SHORT_URL_VISITS_PROGRESS_CHANGED]: (state, { progress }) => ({ ...state, progress }),\n  [GET_SHORT_URL_VISITS_FALLBACK_TO_INTERVAL]: (state, { fallbackInterval }) => ({ ...state, fallbackInterval }),\n  [CREATE_VISITS]: (state, { createdVisits }) => {\n    const { shortCode, domain, visits, query = {} } = state;\n    const { startDate, endDate } = query;\n    const newVisits = createdVisits\n      .filter(\n        ({ shortUrl, visit }) =>\n          shortUrl && shortUrlMatches(shortUrl, shortCode, domain) && isBetween(visit.date, startDate, endDate),\n      )\n      .map(({ visit }) => visit);\n\n    return newVisits.length === 0 ? state : { ...state, visits: [ ...newVisits, ...visits ] };\n  },\n}, initialState);\n\nexport const getShortUrlVisits = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  query: ShlinkVisitsParams = {},\n  doIntervalFallback = false,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  const { getShortUrlVisits } = buildShlinkApiClient(getState);\n  const visitsLoader = async (page: number, itemsPerPage: number) => getShortUrlVisits(\n    shortCode,\n    { ...query, page, itemsPerPage },\n  );\n  const lastVisitLoader = lastVisitLoaderForLoader(\n    doIntervalFallback,\n    async (params) => getShortUrlVisits(shortCode, { ...params, domain: query.domain }),\n  );\n  const shouldCancel = () => getState().shortUrlVisits.cancelLoad;\n  const extraFinishActionData: Partial<ShortUrlVisitsAction> = { shortCode, query, domain: query.domain };\n  const actionMap = {\n    start: GET_SHORT_URL_VISITS_START,\n    large: GET_SHORT_URL_VISITS_LARGE,\n    finish: GET_SHORT_URL_VISITS,\n    error: GET_SHORT_URL_VISITS_ERROR,\n    progress: GET_SHORT_URL_VISITS_PROGRESS_CHANGED,\n    fallbackToInterval: GET_SHORT_URL_VISITS_FALLBACK_TO_INTERVAL,\n  };\n\n  return getVisitsWithLoader(visitsLoader, lastVisitLoader, extraFinishActionData, actionMap, dispatch, shouldCancel);\n};\n\nexport const cancelGetShortUrlVisits = buildActionCreator(GET_SHORT_URL_VISITS_CANCEL);\n","import Tag from '../tags/helpers/Tag';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport VisitsHeader from './VisitsHeader';\nimport { TagVisits } from './reducers/tagVisits';\nimport './ShortUrlVisitsHeader.scss';\n\ninterface TagVisitsHeaderProps {\n  tagVisits: TagVisits;\n  goBack: () => void;\n  colorGenerator: ColorGenerator;\n}\n\nconst TagVisitsHeader = ({ tagVisits, goBack, colorGenerator }: TagVisitsHeaderProps) => {\n  const { visits, tag } = tagVisits;\n\n  const visitsStatsTitle = (\n    <span className=\"d-flex align-items-center justify-content-center\">\n      <span className=\"mr-2\">Visits for</span>\n      <Tag text={tag} colorGenerator={colorGenerator} />\n    </span>\n  );\n\n  return <VisitsHeader title={visitsStatsTitle} goBack={goBack} visits={visits} />;\n};\n\nexport default TagVisitsHeader;\n","import { RouteComponentProps } from 'react-router';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport { ShlinkVisitsParams } from '../api/types';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { TagVisits as TagVisitsState } from './reducers/tagVisits';\nimport TagVisitsHeader from './TagVisitsHeader';\nimport VisitsStats from './VisitsStats';\nimport { VisitsExporter } from './services/VisitsExporter';\nimport { NormalizedVisit } from './types';\nimport { CommonVisitsProps } from './types/CommonVisitsProps';\nimport { toApiParams } from './types/helpers';\n\nexport interface TagVisitsProps extends CommonVisitsProps, RouteComponentProps<{ tag: string }> {\n  getTagVisits: (tag: string, query?: ShlinkVisitsParams, doIntervalFallback?: boolean) => void;\n  tagVisits: TagVisitsState;\n  cancelGetTagVisits: () => void;\n}\n\nconst TagVisits = (colorGenerator: ColorGenerator, { exportVisits }: VisitsExporter) => boundToMercureHub(({\n  history: { goBack },\n  match: { params, url },\n  getTagVisits,\n  tagVisits,\n  cancelGetTagVisits,\n  settings,\n  selectedServer,\n}: TagVisitsProps) => {\n  const { tag } = params;\n  const loadVisits = (params: ShlinkVisitsParams, doIntervalFallback?: boolean) =>\n    getTagVisits(tag, toApiParams(params), doIntervalFallback);\n  const exportCsv = (visits: NormalizedVisit[]) => exportVisits(`tag_${tag}_visits.csv`, visits);\n\n  return (\n    <VisitsStats\n      getVisits={loadVisits}\n      cancelGetVisits={cancelGetTagVisits}\n      visitsInfo={tagVisits}\n      baseUrl={url}\n      settings={settings}\n      exportCsv={exportCsv}\n      selectedServer={selectedServer}\n    >\n      <TagVisitsHeader tagVisits={tagVisits} goBack={goBack} colorGenerator={colorGenerator} />\n    </VisitsStats>\n  );\n}, () => [ Topics.visits ]);\n\nexport default TagVisits;\n","import { Action, Dispatch } from 'redux';\nimport { Visit, VisitsFallbackIntervalAction, VisitsInfo, VisitsLoadProgressChangedAction } from '../types';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { ShlinkVisitsParams } from '../../api/types';\nimport { ApiErrorAction } from '../../api/types/actions';\nimport { isBetween } from '../../utils/helpers/date';\nimport { getVisitsWithLoader, lastVisitLoaderForLoader } from './common';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_TAG_VISITS_START = 'shlink/tagVisits/GET_TAG_VISITS_START';\nexport const GET_TAG_VISITS_ERROR = 'shlink/tagVisits/GET_TAG_VISITS_ERROR';\nexport const GET_TAG_VISITS = 'shlink/tagVisits/GET_TAG_VISITS';\nexport const GET_TAG_VISITS_LARGE = 'shlink/tagVisits/GET_TAG_VISITS_LARGE';\nexport const GET_TAG_VISITS_CANCEL = 'shlink/tagVisits/GET_TAG_VISITS_CANCEL';\nexport const GET_TAG_VISITS_PROGRESS_CHANGED = 'shlink/tagVisits/GET_TAG_VISITS_PROGRESS_CHANGED';\nexport const GET_TAG_VISITS_FALLBACK_TO_INTERVAL = 'shlink/tagVisits/GET_TAG_VISITS_FALLBACK_TO_INTERVAL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface TagVisits extends VisitsInfo {\n  tag: string;\n}\n\nexport interface TagVisitsAction extends Action<string> {\n  visits: Visit[];\n  tag: string;\n  query?: ShlinkVisitsParams;\n}\n\ntype TagsVisitsCombinedAction = TagVisitsAction\n& VisitsLoadProgressChangedAction\n& VisitsFallbackIntervalAction\n& CreateVisitsAction\n& ApiErrorAction;\n\nconst initialState: TagVisits = {\n  visits: [],\n  tag: '',\n  loading: false,\n  loadingLarge: false,\n  error: false,\n  cancelLoad: false,\n  progress: 0,\n};\n\nexport default buildReducer<TagVisits, TagsVisitsCombinedAction>({\n  [GET_TAG_VISITS_START]: () => ({ ...initialState, loading: true }),\n  [GET_TAG_VISITS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [GET_TAG_VISITS]: (state, { visits, tag, query }) => ({ ...state, visits, tag, query, loading: false, error: false }),\n  [GET_TAG_VISITS_LARGE]: (state) => ({ ...state, loadingLarge: true }),\n  [GET_TAG_VISITS_CANCEL]: (state) => ({ ...state, cancelLoad: true }),\n  [GET_TAG_VISITS_PROGRESS_CHANGED]: (state, { progress }) => ({ ...state, progress }),\n  [GET_TAG_VISITS_FALLBACK_TO_INTERVAL]: (state, { fallbackInterval }) => ({ ...state, fallbackInterval }),\n  [CREATE_VISITS]: (state, { createdVisits }) => {\n    const { tag, visits, query = {} } = state;\n    const { startDate, endDate } = query;\n    const newVisits = createdVisits\n      .filter(({ shortUrl, visit }) => shortUrl?.tags.includes(tag) && isBetween(visit.date, startDate, endDate))\n      .map(({ visit }) => visit);\n\n    return { ...state, visits: [ ...newVisits, ...visits ] };\n  },\n}, initialState);\n\nexport const getTagVisits = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  tag: string,\n  query: ShlinkVisitsParams = {},\n  doIntervalFallback = false,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  const { getTagVisits } = buildShlinkApiClient(getState);\n  const visitsLoader = async (page: number, itemsPerPage: number) => getTagVisits(\n    tag,\n    { ...query, page, itemsPerPage },\n  );\n  const lastVisitLoader = lastVisitLoaderForLoader(doIntervalFallback, async (params) => getTagVisits(tag, params));\n  const shouldCancel = () => getState().tagVisits.cancelLoad;\n  const extraFinishActionData: Partial<TagVisitsAction> = { tag, query };\n  const actionMap = {\n    start: GET_TAG_VISITS_START,\n    large: GET_TAG_VISITS_LARGE,\n    finish: GET_TAG_VISITS,\n    error: GET_TAG_VISITS_ERROR,\n    progress: GET_TAG_VISITS_PROGRESS_CHANGED,\n    fallbackToInterval: GET_TAG_VISITS_FALLBACK_TO_INTERVAL,\n  };\n\n  return getVisitsWithLoader(visitsLoader, lastVisitLoader, extraFinishActionData, actionMap, dispatch, shouldCancel);\n};\n\nexport const cancelGetTagVisits = buildActionCreator(GET_TAG_VISITS_CANCEL);\n","import VisitsHeader from './VisitsHeader';\nimport { VisitsInfo } from './types';\nimport './ShortUrlVisitsHeader.scss';\n\ninterface OrphanVisitsHeaderProps {\n  orphanVisits: VisitsInfo;\n  goBack: () => void;\n}\n\nexport const OrphanVisitsHeader = ({ orphanVisits, goBack }: OrphanVisitsHeaderProps) => {\n  const { visits } = orphanVisits;\n\n  return <VisitsHeader title=\"Orphan visits\" goBack={goBack} visits={visits} />;\n};\n","import { RouteComponentProps } from 'react-router';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { ShlinkVisitsParams } from '../api/types';\nimport { Topics } from '../mercure/helpers/Topics';\nimport VisitsStats from './VisitsStats';\nimport { OrphanVisitsHeader } from './OrphanVisitsHeader';\nimport { NormalizedVisit, OrphanVisitType, VisitsInfo, VisitsParams } from './types';\nimport { VisitsExporter } from './services/VisitsExporter';\nimport { CommonVisitsProps } from './types/CommonVisitsProps';\nimport { toApiParams } from './types/helpers';\n\nexport interface OrphanVisitsProps extends CommonVisitsProps, RouteComponentProps {\n  getOrphanVisits: (\n    params?: ShlinkVisitsParams,\n    orphanVisitsType?: OrphanVisitType,\n    doIntervalFallback?: boolean,\n  ) => void;\n  orphanVisits: VisitsInfo;\n  cancelGetOrphanVisits: () => void;\n}\n\nexport const OrphanVisits = ({ exportVisits }: VisitsExporter) => boundToMercureHub(({\n  history: { goBack },\n  match: { url },\n  getOrphanVisits,\n  orphanVisits,\n  cancelGetOrphanVisits,\n  settings,\n  selectedServer,\n}: OrphanVisitsProps) => {\n  const exportCsv = (visits: NormalizedVisit[]) => exportVisits('orphan_visits.csv', visits);\n  const loadVisits = (params: VisitsParams, doIntervalFallback?: boolean) =>\n    getOrphanVisits(toApiParams(params), params.filter?.orphanVisitsType, doIntervalFallback);\n\n  return (\n    <VisitsStats\n      getVisits={loadVisits}\n      cancelGetVisits={cancelGetOrphanVisits}\n      visitsInfo={orphanVisits}\n      baseUrl={url}\n      settings={settings}\n      exportCsv={exportCsv}\n      selectedServer={selectedServer}\n      isOrphanVisits\n    >\n      <OrphanVisitsHeader orphanVisits={orphanVisits} goBack={goBack} />\n    </VisitsStats>\n  );\n}, () => [ Topics.orphanVisits ]);\n","import { Action, Dispatch } from 'redux';\nimport {\n  OrphanVisit,\n  OrphanVisitType,\n  Visit,\n  VisitsFallbackIntervalAction,\n  VisitsInfo,\n  VisitsLoadProgressChangedAction,\n} from '../types';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { ShlinkVisitsParams } from '../../api/types';\nimport { isOrphanVisit } from '../types/helpers';\nimport { ApiErrorAction } from '../../api/types/actions';\nimport { isBetween } from '../../utils/helpers/date';\nimport { getVisitsWithLoader, lastVisitLoaderForLoader } from './common';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_ORPHAN_VISITS_START = 'shlink/orphanVisits/GET_ORPHAN_VISITS_START';\nexport const GET_ORPHAN_VISITS_ERROR = 'shlink/orphanVisits/GET_ORPHAN_VISITS_ERROR';\nexport const GET_ORPHAN_VISITS = 'shlink/orphanVisits/GET_ORPHAN_VISITS';\nexport const GET_ORPHAN_VISITS_LARGE = 'shlink/orphanVisits/GET_ORPHAN_VISITS_LARGE';\nexport const GET_ORPHAN_VISITS_CANCEL = 'shlink/orphanVisits/GET_ORPHAN_VISITS_CANCEL';\nexport const GET_ORPHAN_VISITS_PROGRESS_CHANGED = 'shlink/orphanVisits/GET_ORPHAN_VISITS_PROGRESS_CHANGED';\nexport const GET_ORPHAN_VISITS_FALLBACK_TO_INTERVAL = 'shlink/orphanVisits/GET_ORPHAN_VISITS_FALLBACK_TO_INTERVAL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface OrphanVisitsAction extends Action<string> {\n  visits: Visit[];\n  query?: ShlinkVisitsParams;\n}\n\ntype OrphanVisitsCombinedAction = OrphanVisitsAction\n& VisitsLoadProgressChangedAction\n& VisitsFallbackIntervalAction\n& CreateVisitsAction\n& ApiErrorAction;\n\nconst initialState: VisitsInfo = {\n  visits: [],\n  loading: false,\n  loadingLarge: false,\n  error: false,\n  cancelLoad: false,\n  progress: 0,\n};\n\nexport default buildReducer<VisitsInfo, OrphanVisitsCombinedAction>({\n  [GET_ORPHAN_VISITS_START]: () => ({ ...initialState, loading: true }),\n  [GET_ORPHAN_VISITS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [GET_ORPHAN_VISITS]: (state, { visits, query }) => ({ ...state, visits, query, loading: false, error: false }),\n  [GET_ORPHAN_VISITS_LARGE]: (state) => ({ ...state, loadingLarge: true }),\n  [GET_ORPHAN_VISITS_CANCEL]: (state) => ({ ...state, cancelLoad: true }),\n  [GET_ORPHAN_VISITS_PROGRESS_CHANGED]: (state, { progress }) => ({ ...state, progress }),\n  [GET_ORPHAN_VISITS_FALLBACK_TO_INTERVAL]: (state, { fallbackInterval }) => ({ ...state, fallbackInterval }),\n  [CREATE_VISITS]: (state, { createdVisits }) => {\n    const { visits, query = {} } = state;\n    const { startDate, endDate } = query;\n    const newVisits = createdVisits\n      .filter(({ visit }) => isBetween(visit.date, startDate, endDate))\n      .map(({ visit }) => visit);\n\n    return { ...state, visits: [ ...newVisits, ...visits ] };\n  },\n}, initialState);\n\nconst matchesType = (visit: OrphanVisit, orphanVisitsType?: OrphanVisitType) =>\n  !orphanVisitsType || orphanVisitsType === visit.type;\n\nexport const getOrphanVisits = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  query: ShlinkVisitsParams = {},\n  orphanVisitsType?: OrphanVisitType,\n  doIntervalFallback = false,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  const { getOrphanVisits } = buildShlinkApiClient(getState);\n  const visitsLoader = async (page: number, itemsPerPage: number) => getOrphanVisits({ ...query, page, itemsPerPage })\n    .then((result) => {\n      const visits = result.data.filter((visit) => isOrphanVisit(visit) && matchesType(visit, orphanVisitsType));\n\n      return { ...result, data: visits };\n    });\n  const lastVisitLoader = lastVisitLoaderForLoader(doIntervalFallback, getOrphanVisits);\n  const shouldCancel = () => getState().orphanVisits.cancelLoad;\n  const extraFinishActionData: Partial<OrphanVisitsAction> = { query };\n  const actionMap = {\n    start: GET_ORPHAN_VISITS_START,\n    large: GET_ORPHAN_VISITS_LARGE,\n    finish: GET_ORPHAN_VISITS,\n    error: GET_ORPHAN_VISITS_ERROR,\n    progress: GET_ORPHAN_VISITS_PROGRESS_CHANGED,\n    fallbackToInterval: GET_ORPHAN_VISITS_FALLBACK_TO_INTERVAL,\n  };\n\n  return getVisitsWithLoader(visitsLoader, lastVisitLoader, extraFinishActionData, actionMap, dispatch, shouldCancel);\n};\n\nexport const cancelGetOrphanVisits = buildActionCreator(GET_ORPHAN_VISITS_CANCEL);\n","import { Action, Dispatch } from 'redux';\nimport { ShlinkVisitsOverview } from '../../api/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { groupNewVisitsByType } from '../types/helpers';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_OVERVIEW_START = 'shlink/visitsOverview/GET_OVERVIEW_START';\nexport const GET_OVERVIEW_ERROR = 'shlink/visitsOverview/GET_OVERVIEW_ERROR';\nexport const GET_OVERVIEW = 'shlink/visitsOverview/GET_OVERVIEW';\n/* eslint-enable padding-line-between-statements */\n\nexport interface VisitsOverview {\n  visitsCount: number;\n  orphanVisitsCount?: number;\n  loading: boolean;\n  error: boolean;\n}\n\nexport type GetVisitsOverviewAction = ShlinkVisitsOverview & Action<string>;\n\nconst initialState: VisitsOverview = {\n  visitsCount: 0,\n  orphanVisitsCount: 0,\n  loading: false,\n  error: false,\n};\n\nexport default buildReducer<VisitsOverview, GetVisitsOverviewAction & CreateVisitsAction>({\n  [GET_OVERVIEW_START]: () => ({ ...initialState, loading: true }),\n  [GET_OVERVIEW_ERROR]: () => ({ ...initialState, error: true }),\n  [GET_OVERVIEW]: (_, { visitsCount, orphanVisitsCount }) => ({ ...initialState, visitsCount, orphanVisitsCount }),\n  [CREATE_VISITS]: ({ visitsCount, orphanVisitsCount = 0, ...rest }, { createdVisits }) => {\n    const { regularVisits, orphanVisits } = groupNewVisitsByType(createdVisits);\n\n    return {\n      ...rest,\n      visitsCount: visitsCount + regularVisits.length,\n      orphanVisitsCount: orphanVisitsCount + orphanVisits.length,\n    };\n  },\n}, initialState);\n\nexport const loadVisitsOverview = (buildShlinkApiClient: ShlinkApiClientBuilder) => () => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: GET_OVERVIEW_START });\n\n  try {\n    const { getVisitsOverview } = buildShlinkApiClient(getState);\n    const result = await getVisitsOverview();\n\n    dispatch({ type: GET_OVERVIEW, ...result });\n  } catch (e) {\n    dispatch({ type: GET_OVERVIEW_ERROR });\n  }\n};\n","import { CsvJson } from 'csvjson';\nimport { NormalizedVisit } from '../types';\nimport { saveCsv } from '../../utils/helpers/files';\n\nexport class VisitsExporter {\n  public constructor(\n    private readonly window: Window,\n    private readonly csvjson: CsvJson,\n  ) {}\n\n  public readonly exportVisits = (filename: string, visits: NormalizedVisit[]) => {\n    if (!visits.length) {\n      return;\n    }\n\n    const csv = this.csvjson.toCSV(visits, { headers: 'key' });\n\n    saveCsv(this.window, csv, filename);\n  };\n}\n","import Bottle from 'bottlejs';\nimport ShortUrlVisits from '../ShortUrlVisits';\nimport { cancelGetShortUrlVisits, getShortUrlVisits } from '../reducers/shortUrlVisits';\nimport MapModal from '../helpers/MapModal';\nimport { createNewVisits } from '../reducers/visitCreation';\nimport TagVisits from '../TagVisits';\nimport { cancelGetTagVisits, getTagVisits } from '../reducers/tagVisits';\nimport { OrphanVisits } from '../OrphanVisits';\nimport { cancelGetOrphanVisits, getOrphanVisits } from '../reducers/orphanVisits';\nimport { ConnectDecorator } from '../../container/types';\nimport { loadVisitsOverview } from '../reducers/visitsOverview';\nimport * as visitsParser from './VisitsParser';\nimport { VisitsExporter } from './VisitsExporter';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('MapModal', () => MapModal);\n\n  bottle.serviceFactory('ShortUrlVisits', ShortUrlVisits, 'VisitsExporter');\n  bottle.decorator('ShortUrlVisits', connect(\n    [ 'shortUrlVisits', 'shortUrlDetail', 'mercureInfo', 'settings', 'selectedServer' ],\n    [ 'getShortUrlVisits', 'getShortUrlDetail', 'cancelGetShortUrlVisits', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  bottle.serviceFactory('TagVisits', TagVisits, 'ColorGenerator', 'VisitsExporter');\n  bottle.decorator('TagVisits', connect(\n    [ 'tagVisits', 'mercureInfo', 'settings', 'selectedServer' ],\n    [ 'getTagVisits', 'cancelGetTagVisits', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  bottle.serviceFactory('OrphanVisits', OrphanVisits, 'VisitsExporter');\n  bottle.decorator('OrphanVisits', connect(\n    [ 'orphanVisits', 'mercureInfo', 'settings', 'selectedServer' ],\n    [ 'getOrphanVisits', 'cancelGetOrphanVisits', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  // Services\n  bottle.serviceFactory('VisitsParser', () => visitsParser);\n  bottle.service('VisitsExporter', VisitsExporter, 'window', 'csvjson');\n\n  // Actions\n  bottle.serviceFactory('getShortUrlVisits', getShortUrlVisits, 'buildShlinkApiClient');\n  bottle.serviceFactory('cancelGetShortUrlVisits', () => cancelGetShortUrlVisits);\n\n  bottle.serviceFactory('getTagVisits', getTagVisits, 'buildShlinkApiClient');\n  bottle.serviceFactory('cancelGetTagVisits', () => cancelGetTagVisits);\n\n  bottle.serviceFactory('getOrphanVisits', getOrphanVisits, 'buildShlinkApiClient');\n  bottle.serviceFactory('cancelGetOrphanVisits', () => cancelGetOrphanVisits);\n\n  bottle.serviceFactory('createNewVisits', () => createNewVisits);\n  bottle.serviceFactory('loadVisitsOverview', loadVisitsOverview, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import ColorGenerator from '../../utils/services/ColorGenerator';\nimport './TagBullet.scss';\n\ninterface TagBulletProps {\n  tag: string;\n  colorGenerator: ColorGenerator;\n}\n\nconst TagBullet = ({ tag, colorGenerator }: TagBulletProps) => (\n  <div\n    style={{ backgroundColor: colorGenerator.getColorForKey(tag) }}\n    className=\"tag-bullet\"\n  />\n);\n\nexport default TagBullet;\n","import { useEffect } from 'react';\nimport ReactTags, { SuggestionComponentProps, TagComponentProps } from 'react-tag-autocomplete';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { Settings } from '../../settings/reducers/settings';\nimport { TagsList } from '../reducers/tagsList';\nimport TagBullet from './TagBullet';\nimport Tag from './Tag';\n\nexport interface TagsSelectorProps {\n  selectedTags: string[];\n  onChange: (tags: string[]) => void;\n  placeholder?: string;\n}\n\ninterface TagsSelectorConnectProps extends TagsSelectorProps {\n  listTags: Function;\n  tagsList: TagsList;\n  settings: Settings;\n}\n\nconst toComponentTag = (tag: string) => ({ id: tag, name: tag });\n\nconst TagsSelector = (colorGenerator: ColorGenerator) => (\n  { selectedTags, onChange, placeholder, listTags, tagsList, settings }: TagsSelectorConnectProps,\n) => {\n  useEffect(() => {\n    listTags();\n  }, []);\n\n  const searchMode = settings.shortUrlCreation?.tagFilteringMode ?? 'startsWith';\n  const ReactTagsTag = ({ tag, onDelete }: TagComponentProps) =>\n    <Tag colorGenerator={colorGenerator} text={tag.name} clearable className=\"react-tags__tag\" onClose={onDelete} />;\n  const ReactTagsSuggestion = ({ item }: SuggestionComponentProps) => (\n    <>\n      <TagBullet tag={`${item.name}`} colorGenerator={colorGenerator} />\n      {item.name}\n    </>\n  );\n\n  return (\n    <ReactTags\n      tags={selectedTags.map(toComponentTag)}\n      tagComponent={ReactTagsTag}\n      suggestions={tagsList.tags.filter((tag) => !selectedTags.includes(tag)).map(toComponentTag)}\n      suggestionComponent={ReactTagsSuggestion}\n      allowNew\n      addOnBlur\n      placeholderText={placeholder ?? 'Add tags to the URL'}\n      minQueryLength={1}\n      delimiters={[ 'Enter', 'Tab', ',' ]}\n      suggestionsTransform={\n        searchMode === 'includes'\n          ? (query, suggestions) => suggestions.filter(({ name }) => name.includes(query))\n          : undefined\n      }\n      onDelete={(removedTagIndex) => {\n        const tagsCopy = [ ...selectedTags ];\n\n        tagsCopy.splice(removedTagIndex, 1);\n        onChange(tagsCopy);\n      }}\n      onAddition={({ name: newTag }) => onChange(\n        // * Avoid duplicated tags (thanks to the Set),\n        // * Split any of the new tags by comma, allowing to paste multiple comma-separated tags at once.\n        [ ...new Set([ ...selectedTags, ...newTag.toLowerCase().split(',') ]) ],\n      )}\n    />\n  );\n};\n\nexport default TagsSelector;\n","import { Card, CardHeader, CardBody, Button, Collapse } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faTrash as deleteIcon, faPencilAlt as editIcon, faLink, faEye } from '@fortawesome/free-solid-svg-icons';\nimport { FC, useEffect, useRef } from 'react';\nimport { Link } from 'react-router-dom';\nimport { prettify } from '../utils/helpers/numbers';\nimport { useToggle } from '../utils/helpers/hooks';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport { getServerId, SelectedServer } from '../servers/data';\nimport TagBullet from './helpers/TagBullet';\nimport { NormalizedTag, TagModalProps } from './data';\nimport './TagCard.scss';\n\nexport interface TagCardProps {\n  tag: NormalizedTag;\n  selectedServer: SelectedServer;\n  displayed: boolean;\n  toggle: () => void;\n}\n\nconst isTruncated = (el: HTMLElement | undefined): boolean => !!el && el.scrollWidth > el.clientWidth;\n\nconst TagCard = (\n  DeleteTagConfirmModal: FC<TagModalProps>,\n  EditTagModal: FC<TagModalProps>,\n  colorGenerator: ColorGenerator,\n) => ({ tag, selectedServer, displayed, toggle }: TagCardProps) => {\n  const [ isDeleteModalOpen, toggleDelete ] = useToggle();\n  const [ isEditModalOpen, toggleEdit ] = useToggle();\n  const [ hasTitle,, displayTitle ] = useToggle();\n  const titleRef = useRef<HTMLElement>();\n  const serverId = getServerId(selectedServer);\n\n  useEffect(() => {\n    if (isTruncated(titleRef.current)) {\n      displayTitle();\n    }\n  }, [ titleRef.current ]);\n\n  return (\n    <Card className=\"tag-card\">\n      <CardHeader className=\"tag-card__header\">\n        <Button color=\"link\" size=\"sm\" className=\"tag-card__btn tag-card__btn--last\" onClick={toggleDelete}>\n          <FontAwesomeIcon icon={deleteIcon} />\n        </Button>\n        <Button color=\"link\" size=\"sm\" className=\"tag-card__btn\" onClick={toggleEdit}>\n          <FontAwesomeIcon icon={editIcon} />\n        </Button>\n        <h5\n          className=\"tag-card__tag-title text-ellipsis\"\n          title={hasTitle ? tag.tag : undefined}\n          ref={(el) => {\n            titleRef.current = el ?? undefined;\n          }}\n        >\n          <TagBullet tag={tag.tag} colorGenerator={colorGenerator} />\n          <span className=\"tag-card__tag-name\" onClick={toggle}>{tag.tag}</span>\n        </h5>\n      </CardHeader>\n\n      <Collapse isOpen={displayed}>\n        <CardBody className=\"tag-card__body\">\n          <Link\n            to={`/server/${serverId}/list-short-urls/1?tags=${encodeURIComponent(tag.tag)}`}\n            className=\"btn btn-outline-secondary btn-block d-flex justify-content-between align-items-center mb-1\"\n          >\n            <span className=\"text-ellipsis\"><FontAwesomeIcon icon={faLink} className=\"mr-2\" />Short URLs</span>\n            <b>{prettify(tag.shortUrls)}</b>\n          </Link>\n          <Link\n            to={`/server/${serverId}/tag/${tag.tag}/visits`}\n            className=\"btn btn-outline-secondary btn-block d-flex justify-content-between align-items-center\"\n          >\n            <span className=\"text-ellipsis\"><FontAwesomeIcon icon={faEye} className=\"mr-2\" />Visits</span>\n            <b>{prettify(tag.visits)}</b>\n          </Link>\n        </CardBody>\n      </Collapse>\n\n      <DeleteTagConfirmModal tag={tag.tag} toggle={toggleDelete} isOpen={isDeleteModalOpen} />\n      <EditTagModal tag={tag.tag} toggle={toggleEdit} isOpen={isEditModalOpen} />\n    </Card>\n  );\n};\n\nexport default TagCard;\n","import { Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { TagDeletion } from '../reducers/tagDelete';\nimport { TagModalProps } from '../data';\nimport { Result } from '../../utils/Result';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\n\ninterface DeleteTagConfirmModalProps extends TagModalProps {\n  deleteTag: (tag: string) => Promise<void>;\n  tagDeleted: (tag: string) => void;\n  tagDelete: TagDeletion;\n}\n\nconst DeleteTagConfirmModal = (\n  { tag, toggle, isOpen, deleteTag, tagDelete, tagDeleted }: DeleteTagConfirmModalProps,\n) => {\n  const { deleting, error, errorData } = tagDelete;\n  const doDelete = async () => {\n    await deleteTag(tag);\n    tagDeleted(tag);\n    toggle();\n  };\n\n  return (\n    <Modal toggle={toggle} isOpen={isOpen} centered>\n      <ModalHeader toggle={toggle}>\n        <span className=\"text-danger\">Delete tag</span>\n      </ModalHeader>\n      <ModalBody>\n        Are you sure you want to delete tag <b>{tag}</b>?\n        {error && (\n          <Result type=\"error\" small className=\"mt-2\">\n            <ShlinkApiError errorData={errorData} fallbackMessage=\"Something went wrong while deleting the tag :(\" />\n          </Result>\n        )}\n      </ModalBody>\n      <ModalFooter>\n        <button className=\"btn btn-link\" onClick={toggle}>Cancel</button>\n        <button className=\"btn btn-danger\" disabled={deleting} onClick={doDelete}>\n          {deleting ? 'Deleting tag...' : 'Delete tag'}\n        </button>\n      </ModalFooter>\n    </Modal>\n  );\n};\n\nexport default DeleteTagConfirmModal;\n","import { useState } from 'react';\nimport { Button, Input, Modal, ModalBody, ModalFooter, ModalHeader, Popover } from 'reactstrap';\nimport { ChromePicker } from 'react-color';\nimport { faPalette as colorIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { handleEventPreventingDefault } from '../../utils/utils';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { TagModalProps } from '../data';\nimport { TagEdition } from '../reducers/tagEdit';\nimport { Result } from '../../utils/Result';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\nimport './EditTagModal.scss';\n\ninterface EditTagModalProps extends TagModalProps {\n  tagEdit: TagEdition;\n  editTag: (oldName: string, newName: string, color: string) => Promise<void>;\n  tagEdited: (oldName: string, newName: string, color: string) => void;\n}\n\nconst EditTagModal = ({ getColorForKey }: ColorGenerator) => (\n  { tag, editTag, toggle, tagEdited, isOpen, tagEdit }: EditTagModalProps,\n) => {\n  const [ newTagName, setNewTagName ] = useState(tag);\n  const [ color, setColor ] = useState(getColorForKey(tag));\n  const [ showColorPicker, toggleColorPicker, , hideColorPicker ] = useToggle();\n  const { editing, error, errorData } = tagEdit;\n  const saveTag = handleEventPreventingDefault(\n    async () => editTag(tag, newTagName, color)\n      .then(() => tagEdited(tag, newTagName, color))\n      .then(toggle)\n      .catch(() => {}),\n  );\n\n  return (\n    <Modal isOpen={isOpen} toggle={toggle} centered onClosed={hideColorPicker}>\n      <form onSubmit={saveTag}>\n        <ModalHeader toggle={toggle}>Edit tag</ModalHeader>\n        <ModalBody>\n          <div className=\"input-group\">\n            <div className=\"input-group-prepend\" id=\"colorPickerBtn\" onClick={toggleColorPicker}>\n              <div\n                className=\"input-group-text edit-tag-modal__color-picker-toggle\"\n                style={{ backgroundColor: color, borderColor: color }}\n              >\n                <FontAwesomeIcon icon={colorIcon} className=\"edit-tag-modal__color-icon\" />\n              </div>\n            </div>\n            <Popover isOpen={showColorPicker} toggle={toggleColorPicker} target=\"colorPickerBtn\" placement=\"right\">\n              <ChromePicker color={color} disableAlpha onChange={({ hex }) => setColor(hex)} />\n            </Popover>\n            <Input\n              value={newTagName}\n              placeholder=\"Tag\"\n              required\n              onChange={({ target }) => setNewTagName(target.value)}\n            />\n          </div>\n\n          {error && (\n            <Result type=\"error\" small className=\"mt-2\">\n              <ShlinkApiError errorData={errorData} fallbackMessage=\"Something went wrong while editing the tag :(\" />\n            </Result>\n          )}\n        </ModalBody>\n        <ModalFooter>\n          <Button type=\"button\" color=\"link\" onClick={toggle}>Cancel</Button>\n          <Button color=\"primary\" disabled={editing}>{editing ? 'Saving...' : 'Save'}</Button>\n        </ModalFooter>\n      </form>\n    </Modal>\n  );\n};\n\nexport default EditTagModal;\n","import { SelectedServer } from '../../servers/data';\nimport { Order } from '../../utils/helpers/ordering';\nimport { NormalizedTag } from './index';\n\nexport const TAGS_ORDERABLE_FIELDS = {\n  tag: 'Tag',\n  shortUrls: 'Short URLs',\n  visits: 'Visits',\n};\n\nexport type TagsOrderableFields = keyof typeof TAGS_ORDERABLE_FIELDS;\n\nexport type TagsOrder = Order<TagsOrderableFields>;\n\nexport interface TagsListChildrenProps {\n  sortedTags: NormalizedTag[];\n  selectedServer: SelectedServer;\n}\n","import { FC } from 'react';\nimport { DropdownItem } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBars as listIcon, faThLarge as cardsIcon } from '@fortawesome/free-solid-svg-icons';\nimport { DropdownBtn } from '../utils/DropdownBtn';\nimport { TagsMode } from '../settings/reducers/settings';\n\ninterface TagsModeDropdownProps {\n  mode: TagsMode;\n  onChange: (newMode: TagsMode) => void;\n  renderTitle?: (mode: TagsMode) => string;\n}\n\nexport const TagsModeDropdown: FC<TagsModeDropdownProps> = ({ mode, onChange, renderTitle }) => (\n  <DropdownBtn text={renderTitle?.(mode) ?? `Display mode: ${mode}`}>\n    <DropdownItem active={mode === 'cards'} onClick={() => onChange('cards')}>\n      <FontAwesomeIcon icon={cardsIcon} fixedWidth className=\"mr-1\" /> Cards\n    </DropdownItem>\n    <DropdownItem active={mode === 'list'} onClick={() => onChange('list')}>\n      <FontAwesomeIcon icon={listIcon} fixedWidth className=\"mr-1\" /> List\n    </DropdownItem>\n  </DropdownBtn>\n);\n","import { FC, useEffect, useState } from 'react';\nimport { Row } from 'reactstrap';\nimport { pipe } from 'ramda';\nimport Message from '../utils/Message';\nimport SearchField from '../utils/SearchField';\nimport { SelectedServer } from '../servers/data';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { Result } from '../utils/Result';\nimport { ShlinkApiError } from '../api/ShlinkApiError';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { Settings, TagsMode } from '../settings/reducers/settings';\nimport { determineOrderDir, sortList } from '../utils/helpers/ordering';\nimport { OrderingDropdown } from '../utils/OrderingDropdown';\nimport { TagsList as TagsListState } from './reducers/tagsList';\nimport {\n  TagsOrderableFields,\n  TAGS_ORDERABLE_FIELDS,\n  TagsListChildrenProps,\n  TagsOrder,\n} from './data/TagsListChildrenProps';\nimport { TagsModeDropdown } from './TagsModeDropdown';\nimport { NormalizedTag } from './data';\nimport { TagsTableProps } from './TagsTable';\n\nexport interface TagsListProps {\n  filterTags: (searchTerm: string) => void;\n  forceListTags: Function;\n  tagsList: TagsListState;\n  selectedServer: SelectedServer;\n  settings: Settings;\n}\n\nconst TagsList = (TagsCards: FC<TagsListChildrenProps>, TagsTable: FC<TagsTableProps>) => boundToMercureHub((\n  { filterTags, forceListTags, tagsList, selectedServer, settings }: TagsListProps,\n) => {\n  const [ mode, setMode ] = useState<TagsMode>(settings.tags?.defaultMode ?? 'cards');\n  const [ order, setOrder ] = useState<TagsOrder>(settings.tags?.defaultOrdering ?? {});\n  const resolveSortedTags = pipe(\n    () => tagsList.filteredTags.map((tag): NormalizedTag => ({\n      tag,\n      shortUrls: tagsList.stats[tag]?.shortUrlsCount ?? 0,\n      visits: tagsList.stats[tag]?.visitsCount ?? 0,\n    })),\n    (normalizedTags) => sortList<NormalizedTag>(normalizedTags, order),\n  );\n\n  useEffect(() => {\n    forceListTags();\n  }, []);\n\n  if (tagsList.loading) {\n    return <Message loading />;\n  }\n\n  if (tagsList.error) {\n    return (\n      <Result type=\"error\">\n        <ShlinkApiError errorData={tagsList.errorData} fallbackMessage=\"Error loading tags :(\" />\n      </Result>\n    );\n  }\n\n  const orderByColumn = (field: TagsOrderableFields) => () => {\n    const dir = determineOrderDir(field, order.field, order.dir);\n\n    setOrder({ field: dir ? field : undefined, dir });\n  };\n\n  const renderContent = () => {\n    if (tagsList.filteredTags.length < 1) {\n      return <Message>No tags found</Message>;\n    }\n\n    const sortedTags = resolveSortedTags();\n\n    return mode === 'cards'\n      ? <TagsCards sortedTags={sortedTags} selectedServer={selectedServer} />\n      : (\n        <TagsTable\n          sortedTags={sortedTags}\n          selectedServer={selectedServer}\n          currentOrder={order}\n          orderByColumn={orderByColumn}\n        />\n      );\n  };\n\n  return (\n    <>\n      <SearchField className=\"mb-3\" onChange={filterTags} />\n      <Row className=\"mb-3\">\n        <div className=\"col-lg-6\">\n          <TagsModeDropdown mode={mode} onChange={setMode} />\n        </div>\n        <div className=\"col-lg-6 mt-3 mt-lg-0\">\n          <OrderingDropdown\n            items={TAGS_ORDERABLE_FIELDS}\n            order={order}\n            onChange={(field, dir) => setOrder({ field, dir })}\n          />\n        </div>\n      </Row>\n      {renderContent()}\n    </>\n  );\n}, () => [ Topics.visits ]);\n\nexport default TagsList;\n","import { Action, Dispatch } from 'redux';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\nimport { ApiErrorAction } from '../../api/types/actions';\n\n/* eslint-disable padding-line-between-statements */\nexport const DELETE_TAG_START = 'shlink/deleteTag/DELETE_TAG_START';\nexport const DELETE_TAG_ERROR = 'shlink/deleteTag/DELETE_TAG_ERROR';\nexport const DELETE_TAG = 'shlink/deleteTag/DELETE_TAG';\nexport const TAG_DELETED = 'shlink/deleteTag/TAG_DELETED';\n/* eslint-enable padding-line-between-statements */\n\nexport interface TagDeletion {\n  deleting: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface DeleteTagAction extends Action<string> {\n  tag: string;\n}\n\nconst initialState: TagDeletion = {\n  deleting: false,\n  error: false,\n};\n\nexport default buildReducer<TagDeletion, ApiErrorAction>({\n  [DELETE_TAG_START]: () => ({ deleting: true, error: false }),\n  [DELETE_TAG_ERROR]: (_, { errorData }) => ({ deleting: false, error: true, errorData }),\n  [DELETE_TAG]: () => ({ deleting: false, error: false }),\n}, initialState);\n\nexport const deleteTag = (buildShlinkApiClient: ShlinkApiClientBuilder) => (tag: string) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: DELETE_TAG_START });\n  const { deleteTags } = buildShlinkApiClient(getState);\n\n  try {\n    await deleteTags([ tag ]);\n    dispatch({ type: DELETE_TAG });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: DELETE_TAG_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const tagDeleted = (tag: string): DeleteTagAction => ({ type: TAG_DELETED, tag });\n","import { pick } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\nimport { ApiErrorAction } from '../../api/types/actions';\n\n/* eslint-disable padding-line-between-statements */\nexport const EDIT_TAG_START = 'shlink/editTag/EDIT_TAG_START';\nexport const EDIT_TAG_ERROR = 'shlink/editTag/EDIT_TAG_ERROR';\nexport const EDIT_TAG = 'shlink/editTag/EDIT_TAG';\n/* eslint-enable padding-line-between-statements */\n\nexport const TAG_EDITED = 'shlink/editTag/TAG_EDITED';\n\nexport interface TagEdition {\n  oldName: string;\n  newName: string;\n  editing: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface EditTagAction extends Action<string> {\n  oldName: string;\n  newName: string;\n  color: string;\n}\n\nconst initialState: TagEdition = {\n  oldName: '',\n  newName: '',\n  editing: false,\n  error: false,\n};\n\nexport default buildReducer<TagEdition, EditTagAction & ApiErrorAction>({\n  [EDIT_TAG_START]: (state) => ({ ...state, editing: true, error: false }),\n  [EDIT_TAG_ERROR]: (state, { errorData }) => ({ ...state, editing: false, error: true, errorData }),\n  [EDIT_TAG]: (_, action) => ({\n    ...pick([ 'oldName', 'newName' ], action),\n    editing: false,\n    error: false,\n  }),\n}, initialState);\n\nexport const editTag = (buildShlinkApiClient: ShlinkApiClientBuilder, colorGenerator: ColorGenerator) => (\n  oldName: string,\n  newName: string,\n  color: string,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: EDIT_TAG_START });\n  const { editTag } = buildShlinkApiClient(getState);\n\n  try {\n    await editTag(oldName, newName);\n    colorGenerator.setColorForKey(newName, color);\n    dispatch({ type: EDIT_TAG, oldName, newName });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: EDIT_TAG_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const tagEdited = (oldName: string, newName: string, color: string): EditTagAction => ({\n  type: TAG_EDITED,\n  oldName,\n  newName,\n  color,\n});\n","import { isEmpty, reject } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { CREATE_VISITS, CreateVisitsAction } from '../../visits/reducers/visitCreation';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ProblemDetailsError, ShlinkTags } from '../../api/types';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { CreateVisit, Stats } from '../../visits/types';\nimport { parseApiError } from '../../api/utils';\nimport { TagStats } from '../data';\nimport { ApiErrorAction } from '../../api/types/actions';\nimport { CREATE_SHORT_URL, CreateShortUrlAction } from '../../short-urls/reducers/shortUrlCreation';\nimport { DeleteTagAction, TAG_DELETED } from './tagDelete';\nimport { EditTagAction, TAG_EDITED } from './tagEdit';\n\n/* eslint-disable padding-line-between-statements */\nexport const LIST_TAGS_START = 'shlink/tagsList/LIST_TAGS_START';\nexport const LIST_TAGS_ERROR = 'shlink/tagsList/LIST_TAGS_ERROR';\nexport const LIST_TAGS = 'shlink/tagsList/LIST_TAGS';\nexport const FILTER_TAGS = 'shlink/tagsList/FILTER_TAGS';\n/* eslint-enable padding-line-between-statements */\n\ntype TagsStatsMap = Record<string, TagStats>;\n\nexport interface TagsList {\n  tags: string[];\n  filteredTags: string[];\n  stats: TagsStatsMap;\n  loading: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\ninterface ListTagsAction extends Action<string> {\n  tags: string[];\n  stats: TagsStatsMap;\n}\n\ninterface FilterTagsAction extends Action<string> {\n  searchTerm: string;\n}\n\ntype TagsCombinedAction = ListTagsAction\n& DeleteTagAction\n& CreateVisitsAction\n& CreateShortUrlAction\n& EditTagAction\n& FilterTagsAction\n& ApiErrorAction;\n\nconst initialState = {\n  tags: [],\n  filteredTags: [],\n  stats: {},\n  loading: false,\n  error: false,\n};\n\ntype TagIncrease = [string, number];\n\nconst renameTag = (oldName: string, newName: string) => (tag: string) => tag === oldName ? newName : tag;\nconst rejectTag = (tags: string[], tagToReject: string) => reject((tag) => tag === tagToReject, tags);\nconst increaseVisitsForTags = (tags: TagIncrease[], stats: TagsStatsMap) => tags.reduce((stats, [ tag, increase ]) => {\n  if (!stats[tag]) {\n    return stats;\n  }\n\n  const tagStats = stats[tag];\n\n  tagStats.visitsCount = tagStats.visitsCount + increase;\n  stats[tag] = tagStats;\n\n  return stats;\n}, { ...stats });\nconst calculateVisitsPerTag = (createdVisits: CreateVisit[]): TagIncrease[] => Object.entries(\n  createdVisits.reduce<Stats>((acc, { shortUrl }) => {\n    shortUrl?.tags.forEach((tag) => {\n      acc[tag] = (acc[tag] || 0) + 1;\n    });\n\n    return acc;\n  }, {}),\n);\n\nexport default buildReducer<TagsList, TagsCombinedAction>({\n  [LIST_TAGS_START]: () => ({ ...initialState, loading: true }),\n  [LIST_TAGS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [LIST_TAGS]: (_, { tags, stats }) => ({ ...initialState, stats, tags, filteredTags: tags }),\n  [TAG_DELETED]: (state, { tag }) => ({\n    ...state,\n    tags: rejectTag(state.tags, tag),\n    filteredTags: rejectTag(state.filteredTags, tag),\n  }),\n  [TAG_EDITED]: (state, { oldName, newName }) => ({\n    ...state,\n    tags: state.tags.map(renameTag(oldName, newName)).sort(),\n    filteredTags: state.filteredTags.map(renameTag(oldName, newName)).sort(),\n  }),\n  [FILTER_TAGS]: (state, { searchTerm }) => ({\n    ...state,\n    filteredTags: state.tags.filter((tag) => tag.toLowerCase().match(searchTerm)),\n  }),\n  [CREATE_VISITS]: (state, { createdVisits }) => ({\n    ...state,\n    stats: increaseVisitsForTags(calculateVisitsPerTag(createdVisits), state.stats),\n  }),\n  [CREATE_SHORT_URL]: ({ tags: stateTags, ...rest }, { result }) => ({\n    ...rest,\n    tags: stateTags.concat(result.tags.filter((tag) => !stateTags.includes(tag))), // More performant than [ ...new Set(...) ]\n  }),\n}, initialState);\n\nexport const listTags = (buildShlinkApiClient: ShlinkApiClientBuilder, force = true) => () => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  const { tagsList } = getState();\n\n  if (!force && (tagsList.loading || !isEmpty(tagsList.tags))) {\n    return;\n  }\n\n  dispatch({ type: LIST_TAGS_START });\n\n  try {\n    const { listTags } = buildShlinkApiClient(getState);\n    const { tags, stats = [] }: ShlinkTags = await listTags();\n    const processedStats = stats.reduce<TagsStatsMap>((acc, { tag, shortUrlsCount, visitsCount }) => {\n      acc[tag] = { shortUrlsCount, visitsCount };\n\n      return acc;\n    }, {});\n\n    dispatch<ListTagsAction>({ tags, stats: processedStats, type: LIST_TAGS });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: LIST_TAGS_ERROR, errorData: parseApiError(e) });\n  }\n};\n\nexport const filterTags = (searchTerm: string): FilterTagsAction => ({ type: FILTER_TAGS, searchTerm });\n","import { FC, useState } from 'react';\nimport { splitEvery } from 'ramda';\nimport { Row } from 'reactstrap';\nimport { TagCardProps } from './TagCard';\nimport { TagsListChildrenProps } from './data/TagsListChildrenProps';\n\nconst { ceil } = Math;\nconst TAGS_GROUPS_AMOUNT = 4;\n\nexport const TagsCards = (TagCard: FC<TagCardProps>): FC<TagsListChildrenProps> => ({ sortedTags, selectedServer }) => {\n  const [ displayedTag, setDisplayedTag ] = useState<string | undefined>();\n  const tagsCount = sortedTags.length;\n  const tagsGroups = splitEvery(ceil(tagsCount / TAGS_GROUPS_AMOUNT), sortedTags);\n\n  return (\n    <Row>\n      {tagsGroups.map((group, index) => (\n        <div key={index} className=\"col-md-6 col-xl-3\">\n          {group.map((tag) => (\n            <TagCard\n              key={tag.tag}\n              tag={tag}\n              selectedServer={selectedServer}\n              displayed={displayedTag === tag.tag}\n              toggle={() => setDisplayedTag(displayedTag !== tag.tag ? tag.tag : undefined)}\n            />\n          ))}\n        </div>\n      ))}\n    </Row>\n  );\n};\n","import { FC, useEffect, useRef } from 'react';\nimport { splitEvery } from 'ramda';\nimport { RouteChildrenProps } from 'react-router';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport SimplePaginator from '../common/SimplePaginator';\nimport { useQueryState } from '../utils/helpers/hooks';\nimport { parseQuery } from '../utils/helpers/query';\nimport { TableOrderIcon } from '../utils/table/TableOrderIcon';\nimport { TagsOrderableFields, TagsListChildrenProps, TagsOrder } from './data/TagsListChildrenProps';\nimport { TagsTableRowProps } from './TagsTableRow';\nimport './TagsTable.scss';\n\nexport interface TagsTableProps extends TagsListChildrenProps {\n  orderByColumn: (field: TagsOrderableFields) => () => void;\n  currentOrder: TagsOrder;\n}\n\nconst TAGS_PER_PAGE = 20; // TODO Allow customizing this value in settings\n\nexport const TagsTable = (TagsTableRow: FC<TagsTableRowProps>) => (\n  { sortedTags, selectedServer, location, orderByColumn, currentOrder }: TagsTableProps & RouteChildrenProps,\n) => {\n  const isFirstLoad = useRef(true);\n  const { page: pageFromQuery = 1 } = parseQuery<{ page?: number | string }>(location.search);\n  const [ page, setPage ] = useQueryState<number>('page', Number(pageFromQuery));\n  const pages = splitEvery(TAGS_PER_PAGE, sortedTags);\n  const showPaginator = pages.length > 1;\n  const currentPage = pages[page - 1] ?? [];\n\n  useEffect(() => {\n    !isFirstLoad.current && setPage(1);\n    isFirstLoad.current = false;\n  }, [ sortedTags ]);\n  useEffect(() => {\n    scrollTo(0, 0);\n  }, [ page ]);\n\n  return (\n    <SimpleCard key={page} bodyClassName={showPaginator ? 'pb-1' : ''}>\n      <table className=\"table table-hover mb-0\">\n        <thead className=\"responsive-table__header\">\n          <tr>\n            <th className=\"tags-table__header-cell\" onClick={orderByColumn('tag')}>\n              Tag <TableOrderIcon currentOrder={currentOrder} field=\"tag\" />\n            </th>\n            <th className=\"tags-table__header-cell text-lg-right\" onClick={orderByColumn('shortUrls')}>\n              Short URLs <TableOrderIcon currentOrder={currentOrder} field=\"shortUrls\" />\n            </th>\n            <th className=\"tags-table__header-cell text-lg-right\" onClick={orderByColumn('visits')}>\n              Visits <TableOrderIcon currentOrder={currentOrder} field=\"visits\" />\n            </th>\n            <th className=\"tags-table__header-cell\" />\n          </tr>\n          <tr><th colSpan={4} className=\"p-0 border-top-0\" /></tr>\n        </thead>\n        <tbody>\n          {currentPage.length === 0 && <tr><td colSpan={4} className=\"text-center\">No results found</td></tr>}\n          {currentPage.map((tag) => <TagsTableRow key={tag.tag} tag={tag} selectedServer={selectedServer} />)}\n        </tbody>\n      </table>\n\n      {showPaginator && (\n        <div className=\"sticky-card-paginator\">\n          <SimplePaginator pagesCount={pages.length} currentPage={page} setCurrentPage={setPage} />\n        </div>\n      )}\n    </SimpleCard>\n  );\n};\n","import { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport { DropdownItem } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faTrash as deleteIcon, faPencilAlt as editIcon } from '@fortawesome/free-solid-svg-icons';\nimport { getServerId, SelectedServer } from '../servers/data';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport { prettify } from '../utils/helpers/numbers';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { DropdownBtnMenu } from '../utils/DropdownBtnMenu';\nimport TagBullet from './helpers/TagBullet';\nimport { NormalizedTag, TagModalProps } from './data';\n\nexport interface TagsTableRowProps {\n  tag: NormalizedTag;\n  selectedServer: SelectedServer;\n}\n\nexport const TagsTableRow = (\n  DeleteTagConfirmModal: FC<TagModalProps>,\n  EditTagModal: FC<TagModalProps>,\n  colorGenerator: ColorGenerator,\n) => ({ tag, selectedServer }: TagsTableRowProps) => {\n  const [ isDeleteModalOpen, toggleDelete ] = useToggle();\n  const [ isEditModalOpen, toggleEdit ] = useToggle();\n  const [ isDropdownOpen, toggleDropdown ] = useToggle();\n  const serverId = getServerId(selectedServer);\n\n  return (\n    <tr className=\"responsive-table__row\">\n      <th className=\"responsive-table__cell\" data-th=\"Tag\">\n        <TagBullet tag={tag.tag} colorGenerator={colorGenerator} /> {tag.tag}\n      </th>\n      <td className=\"responsive-table__cell text-lg-right\" data-th=\"Short URLs\">\n        <Link to={`/server/${serverId}/list-short-urls/1?tags=${encodeURIComponent(tag.tag)}`}>\n          {prettify(tag.shortUrls)}\n        </Link>\n      </td>\n      <td className=\"responsive-table__cell text-lg-right\" data-th=\"Visits\">\n        <Link to={`/server/${serverId}/tag/${tag.tag}/visits`}>\n          {prettify(tag.visits)}\n        </Link>\n      </td>\n      <td className=\"responsive-table__cell text-lg-right\">\n        <DropdownBtnMenu toggle={toggleDropdown} isOpen={isDropdownOpen}>\n          <DropdownItem onClick={toggleEdit}>\n            <FontAwesomeIcon icon={editIcon} fixedWidth className=\"mr-1\" /> Edit\n          </DropdownItem>\n          <DropdownItem onClick={toggleDelete}>\n            <FontAwesomeIcon icon={deleteIcon} fixedWidth className=\"mr-1\" /> Delete\n          </DropdownItem>\n        </DropdownBtnMenu>\n      </td>\n\n      <EditTagModal tag={tag.tag} toggle={toggleEdit} isOpen={isEditModalOpen} />\n      <DeleteTagConfirmModal tag={tag.tag} toggle={toggleDelete} isOpen={isDeleteModalOpen} />\n    </tr>\n  );\n};\n","import Bottle, { IContainer } from 'bottlejs';\nimport { withRouter } from 'react-router-dom';\nimport TagsSelector from '../helpers/TagsSelector';\nimport TagCard from '../TagCard';\nimport DeleteTagConfirmModal from '../helpers/DeleteTagConfirmModal';\nimport EditTagModal from '../helpers/EditTagModal';\nimport TagsList from '../TagsList';\nimport { filterTags, listTags } from '../reducers/tagsList';\nimport { deleteTag, tagDeleted } from '../reducers/tagDelete';\nimport { editTag, tagEdited } from '../reducers/tagEdit';\nimport { ConnectDecorator } from '../../container/types';\nimport { TagsCards } from '../TagsCards';\nimport { TagsTable } from '../TagsTable';\nimport { TagsTableRow } from '../TagsTableRow';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('TagsSelector', TagsSelector, 'ColorGenerator');\n  bottle.decorator('TagsSelector', connect([ 'tagsList', 'settings' ], [ 'listTags' ]));\n\n  bottle.serviceFactory('TagCard', TagCard, 'DeleteTagConfirmModal', 'EditTagModal', 'ColorGenerator');\n\n  bottle.serviceFactory('DeleteTagConfirmModal', () => DeleteTagConfirmModal);\n  bottle.decorator('DeleteTagConfirmModal', connect([ 'tagDelete' ], [ 'deleteTag', 'tagDeleted' ]));\n\n  bottle.serviceFactory('EditTagModal', EditTagModal, 'ColorGenerator');\n  bottle.decorator('EditTagModal', connect([ 'tagEdit' ], [ 'editTag', 'tagEdited' ]));\n\n  bottle.serviceFactory('TagsCards', TagsCards, 'TagCard');\n  bottle.serviceFactory('TagsTableRow', TagsTableRow, 'DeleteTagConfirmModal', 'EditTagModal', 'ColorGenerator');\n\n  bottle.serviceFactory('TagsTable', TagsTable, 'TagsTableRow');\n  bottle.decorator('TagsTable', withRouter);\n\n  bottle.serviceFactory('TagsList', TagsList, 'TagsCards', 'TagsTable');\n  bottle.decorator('TagsList', connect(\n    [ 'tagsList', 'selectedServer', 'mercureInfo', 'settings' ],\n    [ 'forceListTags', 'filterTags', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  // Actions\n  const listTagsActionFactory = (force: boolean) =>\n    ({ buildShlinkApiClient }: IContainer) => listTags(buildShlinkApiClient, force);\n\n  bottle.factory('listTags', listTagsActionFactory(false));\n  bottle.factory('forceListTags', listTagsActionFactory(true));\n  bottle.serviceFactory('filterTags', () => filterTags);\n  bottle.serviceFactory('tagDeleted', () => tagDeleted);\n  bottle.serviceFactory('tagEdited', () => tagEdited);\n\n  bottle.serviceFactory('deleteTag', deleteTag, 'buildShlinkApiClient');\n  bottle.serviceFactory('editTag', editTag, 'buildShlinkApiClient', 'ColorGenerator');\n};\n\nexport default provideServices;\n","import { Action, Dispatch } from 'redux';\nimport { ShlinkMercureInfo } from '../../api/types';\nimport { GetState } from '../../container/types';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_MERCURE_INFO_START = 'shlink/mercure/GET_MERCURE_INFO_START';\nexport const GET_MERCURE_INFO_ERROR = 'shlink/mercure/GET_MERCURE_INFO_ERROR';\nexport const GET_MERCURE_INFO = 'shlink/mercure/GET_MERCURE_INFO';\n/* eslint-enable padding-line-between-statements */\n\nexport interface MercureInfo {\n  token?: string;\n  mercureHubUrl?: string;\n  interval?: number;\n  loading: boolean;\n  error: boolean;\n}\n\nexport type GetMercureInfoAction = Action<string> & ShlinkMercureInfo & { interval?: number };\n\nconst initialState: MercureInfo = {\n  loading: true,\n  error: false,\n};\n\nexport default buildReducer<MercureInfo, GetMercureInfoAction>({\n  [GET_MERCURE_INFO_START]: (state) => ({ ...state, loading: true, error: false }),\n  [GET_MERCURE_INFO_ERROR]: (state) => ({ ...state, loading: false, error: true }),\n  [GET_MERCURE_INFO]: (_, action) => ({ ...action, loading: false, error: false }),\n}, initialState);\n\nexport const loadMercureInfo = (buildShlinkApiClient: ShlinkApiClientBuilder) =>\n  () => async (dispatch: Dispatch, getState: GetState) => {\n    dispatch({ type: GET_MERCURE_INFO_START });\n\n    const { settings } = getState();\n    const { mercureInfo } = buildShlinkApiClient(getState);\n\n    if (!settings.realTimeUpdates.enabled) {\n      dispatch({ type: GET_MERCURE_INFO_ERROR });\n\n      return;\n    }\n\n    try {\n      const info = await mercureInfo();\n\n      dispatch<GetMercureInfoAction>({ type: GET_MERCURE_INFO, interval: settings.realTimeUpdates.interval, ...info });\n    } catch (e) {\n      dispatch({ type: GET_MERCURE_INFO_ERROR });\n    }\n  };\n","import Bottle from 'bottlejs';\nimport { loadMercureInfo } from '../reducers/mercureInfo';\n\nconst provideServices = (bottle: Bottle) => {\n  // Actions\n  bottle.serviceFactory('loadMercureInfo', loadMercureInfo, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import { FormGroup, Input } from 'reactstrap';\nimport classNames from 'classnames';\nimport ToggleSwitch from '../utils/ToggleSwitch';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { Settings } from './reducers/settings';\n\ninterface RealTimeUpdatesProps {\n  settings: Settings;\n  toggleRealTimeUpdates: (enabled: boolean) => void;\n  setRealTimeUpdatesInterval: (interval: number) => void;\n}\n\nconst intervalValue = (interval?: number) => !interval ? '' : `${interval}`;\n\nconst RealTimeUpdatesSettings = (\n  { settings: { realTimeUpdates }, toggleRealTimeUpdates, setRealTimeUpdatesInterval }: RealTimeUpdatesProps,\n) => (\n  <SimpleCard title=\"Real-time updates\" className=\"h-100\">\n    <FormGroup>\n      <ToggleSwitch checked={realTimeUpdates.enabled} onChange={toggleRealTimeUpdates}>\n        Enable or disable real-time updates.\n        <small className=\"form-text text-muted\">\n          Real-time updates are currently being <b>{realTimeUpdates.enabled ? 'processed' : 'ignored'}</b>.\n        </small>\n      </ToggleSwitch>\n    </FormGroup>\n    <FormGroup className=\"mb-0\">\n      <label className={classNames({ 'text-muted': !realTimeUpdates.enabled })}>\n        Real-time updates frequency (in minutes):\n      </label>\n      <Input\n        type=\"number\"\n        min={0}\n        placeholder=\"Immediate\"\n        disabled={!realTimeUpdates.enabled}\n        value={intervalValue(realTimeUpdates.interval)}\n        onChange={({ target }) => setRealTimeUpdatesInterval(Number(target.value))}\n      />\n      {realTimeUpdates.enabled && (\n        <small className=\"form-text text-muted\">\n          {realTimeUpdates.interval !== undefined && realTimeUpdates.interval > 0 && (\n            <span>\n              Updates will be reflected in the UI every <b>{realTimeUpdates.interval}</b> minute{realTimeUpdates.interval > 1 && 's'}.\n            </span>\n          )}\n          {!realTimeUpdates.interval && 'Updates will be reflected in the UI as soon as they happen.'}\n        </small>\n      )}\n    </FormGroup>\n  </SimpleCard>\n);\n\nexport default RealTimeUpdatesSettings;\n","import { FC, ReactNode } from 'react';\nimport { Row } from 'reactstrap';\nimport { NoMenuLayout } from '../common/NoMenuLayout';\n\nconst SettingsSections: FC<{ items: ReactNode[][] }> = ({ items }) => (\n  <>\n    {items.map((child, index) => (\n      <Row key={index}>\n        {child.map((subChild, subIndex) => (\n          <div key={subIndex} className={`col-lg-${12 / child.length} mb-3`}>\n            {subChild}\n          </div>\n        ))}\n      </Row>\n    ))}\n  </>\n);\n\nconst Settings = (\n  RealTimeUpdates: FC,\n  ShortUrlCreation: FC,\n  ShortUrlsList: FC,\n  UserInterface: FC,\n  Visits: FC,\n  Tags: FC,\n) => () => (\n  <NoMenuLayout>\n    <SettingsSections\n      items={[\n        [ <UserInterface />, <Visits /> ], // eslint-disable-line react/jsx-key\n        [ <ShortUrlCreation />, <ShortUrlsList /> ], // eslint-disable-line react/jsx-key\n        [ <Tags />, <RealTimeUpdates /> ], // eslint-disable-line react/jsx-key\n      ]}\n    />\n  </NoMenuLayout>\n);\n\nexport default Settings;\n","import { FC, ReactNode } from 'react';\nimport { DropdownItem, FormGroup } from 'reactstrap';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport ToggleSwitch from '../utils/ToggleSwitch';\nimport { DropdownBtn } from '../utils/DropdownBtn';\nimport { Settings, ShortUrlCreationSettings as ShortUrlsSettings, TagFilteringMode } from './reducers/settings';\n\ninterface ShortUrlCreationProps {\n  settings: Settings;\n  setShortUrlCreationSettings: (settings: ShortUrlsSettings) => void;\n}\n\nconst tagFilteringModeText = (tagFilteringMode: TagFilteringMode | undefined): string =>\n  tagFilteringMode === 'includes' ? 'Suggest tags including input' : 'Suggest tags starting with input';\nconst tagFilteringModeHint = (tagFilteringMode: TagFilteringMode | undefined): ReactNode =>\n  tagFilteringMode === 'includes'\n    ? <>The list of suggested tags will contain those <b>including</b> provided input.</>\n    : <>The list of suggested tags will contain those <b>starting with</b> provided input.</>;\n\nexport const ShortUrlCreationSettings: FC<ShortUrlCreationProps> = ({ settings, setShortUrlCreationSettings }) => {\n  const shortUrlCreation: ShortUrlsSettings = settings.shortUrlCreation ?? { validateUrls: false };\n  const changeTagsFilteringMode = (tagFilteringMode: TagFilteringMode) => () => setShortUrlCreationSettings(\n    { ...shortUrlCreation ?? { validateUrls: false }, tagFilteringMode },\n  );\n\n  return (\n    <SimpleCard title=\"Short URLs form\" className=\"h-100\">\n      <FormGroup>\n        <ToggleSwitch\n          checked={shortUrlCreation.validateUrls ?? false}\n          onChange={(validateUrls) => setShortUrlCreationSettings({ ...shortUrlCreation, validateUrls })}\n        >\n          Request validation on long URLs when creating new short URLs.\n          <small className=\"form-text text-muted\">\n            The initial state of the <b>Validate URL</b> checkbox will\n            be <b>{shortUrlCreation.validateUrls ? 'checked' : 'unchecked'}</b>.\n          </small>\n        </ToggleSwitch>\n      </FormGroup>\n      <FormGroup>\n        <ToggleSwitch\n          checked={shortUrlCreation.forwardQuery ?? true}\n          onChange={(forwardQuery) => setShortUrlCreationSettings({ ...shortUrlCreation, forwardQuery })}\n        >\n          Make all new short URLs forward their query params to the long URL.\n          <small className=\"form-text text-muted\">\n            The initial state of the <b>Forward query params on redirect</b> checkbox will\n            be <b>{shortUrlCreation.forwardQuery ?? true ? 'checked' : 'unchecked'}</b>.\n          </small>\n        </ToggleSwitch>\n      </FormGroup>\n      <FormGroup className=\"mb-0\">\n        <label>Tag suggestions search mode:</label>\n        <DropdownBtn text={tagFilteringModeText(shortUrlCreation.tagFilteringMode)}>\n          <DropdownItem\n            active={!shortUrlCreation.tagFilteringMode || shortUrlCreation.tagFilteringMode === 'startsWith'}\n            onClick={changeTagsFilteringMode('startsWith')}\n          >\n            {tagFilteringModeText('startsWith')}\n          </DropdownItem>\n          <DropdownItem\n            active={shortUrlCreation.tagFilteringMode === 'includes'}\n            onClick={changeTagsFilteringMode('includes')}\n          >\n            {tagFilteringModeText('includes')}\n          </DropdownItem>\n        </DropdownBtn>\n        <small className=\"form-text text-muted\">\n          {tagFilteringModeHint(shortUrlCreation.tagFilteringMode)}\n        </small>\n      </FormGroup>\n    </SimpleCard>\n  );\n};\n","import { FC } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSun, faMoon } from '@fortawesome/free-solid-svg-icons';\nimport { FormGroup } from 'reactstrap';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport ToggleSwitch from '../utils/ToggleSwitch';\nimport { changeThemeInMarkup, Theme } from '../utils/theme';\nimport { Settings, UiSettings } from './reducers/settings';\nimport './UserInterfaceSettings.scss';\n\ninterface UserInterfaceProps {\n  settings: Settings;\n  setUiSettings: (settings: UiSettings) => void;\n}\n\nexport const UserInterfaceSettings: FC<UserInterfaceProps> = ({ settings: { ui }, setUiSettings }) => (\n  <SimpleCard title=\"User interface\" className=\"h-100\">\n    <FormGroup>\n      <FontAwesomeIcon icon={ui?.theme === 'dark' ? faMoon : faSun} className=\"user-interface__theme-icon\" />\n      <ToggleSwitch\n        checked={ui?.theme === 'dark'}\n        onChange={(useDarkTheme) => {\n          const theme: Theme = useDarkTheme ? 'dark' : 'light';\n\n          setUiSettings({ ...ui, theme });\n          changeThemeInMarkup(theme);\n        }}\n      >\n        Use dark theme.\n      </ToggleSwitch>\n    </FormGroup>\n  </SimpleCard>\n);\n","import { FC } from 'react';\nimport { DropdownBtn } from '../DropdownBtn';\nimport { rangeOrIntervalToString } from './types';\nimport { DateIntervalDropdownItems, DateIntervalDropdownProps } from './DateIntervalDropdownItems';\n\nexport const DateIntervalSelector: FC<DateIntervalDropdownProps> = ({ onChange, active, allText }) => (\n  <DropdownBtn text={rangeOrIntervalToString(active) ?? allText}>\n    <DateIntervalDropdownItems allText={allText} active={active} onChange={onChange} />\n  </DropdownBtn>\n);\n","import { FormGroup } from 'reactstrap';\nimport { FC } from 'react';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { DateIntervalSelector } from '../utils/dates/DateIntervalSelector';\nimport { Settings, VisitsSettings as VisitsSettingsConfig } from './reducers/settings';\n\ninterface VisitsProps {\n  settings: Settings;\n  setVisitsSettings: (settings: VisitsSettingsConfig) => void;\n}\n\nexport const VisitsSettings: FC<VisitsProps> = ({ settings, setVisitsSettings }) => (\n  <SimpleCard title=\"Visits\" className=\"h-100\">\n    <FormGroup className=\"mb-0\">\n      <label>Default interval to load on visits sections:</label>\n      <DateIntervalSelector\n        allText=\"All visits\"\n        active={settings.visits?.defaultInterval ?? 'last30Days'}\n        onChange={(defaultInterval) => setVisitsSettings({ defaultInterval })}\n      />\n    </FormGroup>\n  </SimpleCard>\n);\n","import { FC } from 'react';\nimport { FormGroup } from 'reactstrap';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { TagsModeDropdown } from '../tags/TagsModeDropdown';\nimport { capitalize } from '../utils/utils';\nimport { OrderingDropdown } from '../utils/OrderingDropdown';\nimport { TAGS_ORDERABLE_FIELDS } from '../tags/data/TagsListChildrenProps';\nimport { Settings, TagsSettings as TagsSettingsOptions } from './reducers/settings';\n\ninterface TagsProps {\n  settings: Settings;\n  setTagsSettings: (settings: TagsSettingsOptions) => void;\n}\n\nexport const TagsSettings: FC<TagsProps> = ({ settings: { tags }, setTagsSettings }) => (\n  <SimpleCard title=\"Tags\" className=\"h-100\">\n    <FormGroup>\n      <label>Default display mode when managing tags:</label>\n      <TagsModeDropdown\n        mode={tags?.defaultMode ?? 'cards'}\n        renderTitle={(tagsMode) => capitalize(tagsMode)}\n        onChange={(defaultMode) => setTagsSettings({ ...tags, defaultMode })}\n      />\n      <small className=\"form-text text-muted\">Tags will be displayed as <b>{tags?.defaultMode ?? 'cards'}</b>.</small>\n    </FormGroup>\n    <FormGroup className=\"mb-0\">\n      <label>Default ordering for tags list:</label>\n      <OrderingDropdown\n        items={TAGS_ORDERABLE_FIELDS}\n        order={tags?.defaultOrdering ?? {}}\n        onChange={(field, dir) => setTagsSettings({ ...tags, defaultOrdering: { field, dir } })}\n      />\n    </FormGroup>\n  </SimpleCard>\n);\n","import { FC } from 'react';\nimport { FormGroup } from 'reactstrap';\nimport { OrderingDropdown } from '../utils/OrderingDropdown';\nimport { SHORT_URLS_ORDERABLE_FIELDS } from '../short-urls/data';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { DEFAULT_SHORT_URLS_ORDERING, Settings, ShortUrlsListSettings as ShortUrlsSettings } from './reducers/settings';\n\ninterface ShortUrlsListProps {\n  settings: Settings;\n  setShortUrlsListSettings: (settings: ShortUrlsSettings) => void;\n}\n\nexport const ShortUrlsListSettings: FC<ShortUrlsListProps> = (\n  { settings: { shortUrlsList }, setShortUrlsListSettings },\n) => (\n  <SimpleCard title=\"Short URLs list\" className=\"h-100\">\n    <FormGroup className=\"mb-0\">\n      <label>Default ordering for short URLs list:</label>\n      <OrderingDropdown\n        items={SHORT_URLS_ORDERABLE_FIELDS}\n        order={shortUrlsList?.defaultOrdering ?? DEFAULT_SHORT_URLS_ORDERING}\n        onChange={(field, dir) => setShortUrlsListSettings({ defaultOrdering: { field, dir } })}\n      />\n    </FormGroup>\n  </SimpleCard>\n);\n","import Bottle from 'bottlejs';\nimport RealTimeUpdatesSettings from '../RealTimeUpdatesSettings';\nimport Settings from '../Settings';\nimport {\n  setRealTimeUpdatesInterval,\n  setShortUrlCreationSettings,\n  setShortUrlsListSettings,\n  setTagsSettings,\n  setUiSettings,\n  setVisitsSettings,\n  toggleRealTimeUpdates,\n} from '../reducers/settings';\nimport { ConnectDecorator } from '../../container/types';\nimport { withoutSelectedServer } from '../../servers/helpers/withoutSelectedServer';\nimport { ShortUrlCreationSettings } from '../ShortUrlCreationSettings';\nimport { UserInterfaceSettings } from '../UserInterfaceSettings';\nimport { VisitsSettings } from '../VisitsSettings';\nimport { TagsSettings } from '../TagsSettings';\nimport { ShortUrlsListSettings } from '../ShortUrlsListSettings';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory(\n    'Settings',\n    Settings,\n    'RealTimeUpdatesSettings',\n    'ShortUrlCreationSettings',\n    'ShortUrlsListSettings',\n    'UserInterfaceSettings',\n    'VisitsSettings',\n    'TagsSettings',\n  );\n  bottle.decorator('Settings', withoutSelectedServer);\n  bottle.decorator('Settings', connect(null, [ 'resetSelectedServer' ]));\n\n  bottle.serviceFactory('RealTimeUpdatesSettings', () => RealTimeUpdatesSettings);\n  bottle.decorator(\n    'RealTimeUpdatesSettings',\n    connect([ 'settings' ], [ 'toggleRealTimeUpdates', 'setRealTimeUpdatesInterval' ]),\n  );\n\n  bottle.serviceFactory('ShortUrlCreationSettings', () => ShortUrlCreationSettings);\n  bottle.decorator('ShortUrlCreationSettings', connect([ 'settings' ], [ 'setShortUrlCreationSettings' ]));\n\n  bottle.serviceFactory('UserInterfaceSettings', () => UserInterfaceSettings);\n  bottle.decorator('UserInterfaceSettings', connect([ 'settings' ], [ 'setUiSettings' ]));\n\n  bottle.serviceFactory('VisitsSettings', () => VisitsSettings);\n  bottle.decorator('VisitsSettings', connect([ 'settings' ], [ 'setVisitsSettings' ]));\n\n  bottle.serviceFactory('TagsSettings', () => TagsSettings);\n  bottle.decorator('TagsSettings', connect([ 'settings' ], [ 'setTagsSettings' ]));\n\n  bottle.serviceFactory('ShortUrlsListSettings', () => ShortUrlsListSettings);\n  bottle.decorator('ShortUrlsListSettings', connect([ 'settings' ], [ 'setShortUrlsListSettings' ]));\n\n  // Actions\n  bottle.serviceFactory('toggleRealTimeUpdates', () => toggleRealTimeUpdates);\n  bottle.serviceFactory('setRealTimeUpdatesInterval', () => setRealTimeUpdatesInterval);\n  bottle.serviceFactory('setShortUrlCreationSettings', () => setShortUrlCreationSettings);\n  bottle.serviceFactory('setShortUrlsListSettings', () => setShortUrlsListSettings);\n  bottle.serviceFactory('setUiSettings', () => setUiSettings);\n  bottle.serviceFactory('setVisitsSettings', () => setVisitsSettings);\n  bottle.serviceFactory('setTagsSettings', () => setTagsSettings);\n};\n\nexport default provideServices;\n","export const replaceAuthorityFromUri = (uri: string, newAuthority: string): string => {\n  const [ schema, rest ] = uri.split('://');\n  const [ , ...pathParts ] = rest.split('/');\n  const normalizedPath = pathParts.length ? `/${pathParts.join('/')}` : '';\n\n  return `${schema}://${newAuthority}${normalizedPath}`;\n};\n","import { Action, Dispatch } from 'redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ShlinkDomainRedirects } from '../../api/types';\nimport { GetState } from '../../container/types';\nimport { ApiErrorAction } from '../../api/types/actions';\nimport { parseApiError } from '../../api/utils';\n\n/* eslint-disable padding-line-between-statements */\nexport const EDIT_DOMAIN_REDIRECTS_START = 'shlink/domainRedirects/EDIT_DOMAIN_REDIRECTS_START';\nexport const EDIT_DOMAIN_REDIRECTS_ERROR = 'shlink/domainRedirects/EDIT_DOMAIN_REDIRECTS_ERROR';\nexport const EDIT_DOMAIN_REDIRECTS = 'shlink/domainRedirects/EDIT_DOMAIN_REDIRECTS';\n/* eslint-enable padding-line-between-statements */\n\nexport interface EditDomainRedirectsAction extends Action<string> {\n  domain: string;\n  redirects: ShlinkDomainRedirects;\n}\n\nexport const editDomainRedirects = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  domain: string,\n  domainRedirects: Partial<ShlinkDomainRedirects>,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: EDIT_DOMAIN_REDIRECTS_START });\n  const { editDomainRedirects } = buildShlinkApiClient(getState);\n\n  try {\n    const redirects = await editDomainRedirects({ domain, ...domainRedirects });\n\n    dispatch<EditDomainRedirectsAction>({ type: EDIT_DOMAIN_REDIRECTS, domain, redirects });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: EDIT_DOMAIN_REDIRECTS_ERROR, errorData: parseApiError(e) });\n  }\n};\n","import { Action, Dispatch } from 'redux';\nimport { ProblemDetailsError, ShlinkDomainRedirects } from '../../api/types';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { parseApiError } from '../../api/utils';\nimport { ApiErrorAction } from '../../api/types/actions';\nimport { Domain, DomainStatus } from '../data';\nimport { hasServerData } from '../../servers/data';\nimport { replaceAuthorityFromUri } from '../../utils/helpers/uri';\nimport { EDIT_DOMAIN_REDIRECTS, EditDomainRedirectsAction } from './domainRedirects';\n\n/* eslint-disable padding-line-between-statements */\nexport const LIST_DOMAINS_START = 'shlink/domainsList/LIST_DOMAINS_START';\nexport const LIST_DOMAINS_ERROR = 'shlink/domainsList/LIST_DOMAINS_ERROR';\nexport const LIST_DOMAINS = 'shlink/domainsList/LIST_DOMAINS';\nexport const FILTER_DOMAINS = 'shlink/domainsList/FILTER_DOMAINS';\nexport const VALIDATE_DOMAIN = 'shlink/domainsList/VALIDATE_DOMAIN';\n/* eslint-enable padding-line-between-statements */\n\nexport interface DomainsList {\n  domains: Domain[];\n  filteredDomains: Domain[];\n  defaultRedirects?: ShlinkDomainRedirects;\n  loading: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface ListDomainsAction extends Action<string> {\n  domains: Domain[];\n  defaultRedirects?: ShlinkDomainRedirects;\n}\n\ninterface FilterDomainsAction extends Action<string> {\n  searchTerm: string;\n}\n\ninterface ValidateDomain extends Action<string> {\n  domain: string;\n  status: DomainStatus;\n}\n\nconst initialState: DomainsList = {\n  domains: [],\n  filteredDomains: [],\n  loading: false,\n  error: false,\n};\n\nexport type DomainsCombinedAction = ListDomainsAction\n& ApiErrorAction\n& FilterDomainsAction\n& EditDomainRedirectsAction\n& ValidateDomain;\n\nexport const replaceRedirectsOnDomain = (domain: string, redirects: ShlinkDomainRedirects) =>\n  (d: Domain): Domain => d.domain !== domain ? d : { ...d, redirects };\n\nexport const replaceStatusOnDomain = (domain: string, status: DomainStatus) =>\n  (d: Domain): Domain => d.domain !== domain ? d : { ...d, status };\n\nexport default buildReducer<DomainsList, DomainsCombinedAction>({\n  [LIST_DOMAINS_START]: () => ({ ...initialState, loading: true }),\n  [LIST_DOMAINS_ERROR]: ({ errorData }) => ({ ...initialState, error: true, errorData }),\n  [LIST_DOMAINS]: (_, { domains, defaultRedirects }) =>\n    ({ ...initialState, domains, filteredDomains: domains, defaultRedirects }),\n  [FILTER_DOMAINS]: (state, { searchTerm }) => ({\n    ...state,\n    filteredDomains: state.domains.filter(({ domain }) => domain.toLowerCase().match(searchTerm)),\n  }),\n  [EDIT_DOMAIN_REDIRECTS]: (state, { domain, redirects }) => ({\n    ...state,\n    domains: state.domains.map(replaceRedirectsOnDomain(domain, redirects)),\n    filteredDomains: state.filteredDomains.map(replaceRedirectsOnDomain(domain, redirects)),\n  }),\n  [VALIDATE_DOMAIN]: (state, { domain, status }) => ({\n    ...state,\n    domains: state.domains.map(replaceStatusOnDomain(domain, status)),\n    filteredDomains: state.filteredDomains.map(replaceStatusOnDomain(domain, status)),\n  }),\n}, initialState);\n\nexport const listDomains = (buildShlinkApiClient: ShlinkApiClientBuilder) => () => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: LIST_DOMAINS_START });\n  const { listDomains } = buildShlinkApiClient(getState);\n\n  try {\n    const { domains, defaultRedirects } = await listDomains().then(({ data, defaultRedirects }) => ({\n      domains: data.map((domain): Domain => ({ ...domain, status: 'validating' })),\n      defaultRedirects,\n    }));\n\n    dispatch<ListDomainsAction>({ type: LIST_DOMAINS, domains, defaultRedirects });\n  } catch (e: any) {\n    dispatch<ApiErrorAction>({ type: LIST_DOMAINS_ERROR, errorData: parseApiError(e) });\n  }\n};\n\nexport const filterDomains = (searchTerm: string): FilterDomainsAction => ({ type: FILTER_DOMAINS, searchTerm });\n\nexport const checkDomainHealth = (buildShlinkApiClient: ShlinkApiClientBuilder) => (domain: string) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  const { selectedServer } = getState();\n\n  if (!hasServerData(selectedServer)) {\n    dispatch<ValidateDomain>({ type: VALIDATE_DOMAIN, domain, status: 'invalid' });\n\n    return;\n  }\n\n  try {\n    const { url, ...rest } = selectedServer;\n    const { health } = buildShlinkApiClient({\n      ...rest,\n      url: replaceAuthorityFromUri(url, domain),\n    });\n\n    const { status } = await health();\n\n    dispatch<ValidateDomain>({ type: VALIDATE_DOMAIN, domain, status: status === 'pass' ? 'valid' : 'invalid' });\n  } catch (e) {\n    dispatch<ValidateDomain>({ type: VALIDATE_DOMAIN, domain, status: 'invalid' });\n  }\n};\n","import { useEffect } from 'react';\nimport { Button, DropdownItem, Input, InputGroup, InputGroupAddon, UncontrolledTooltip } from 'reactstrap';\nimport { InputProps } from 'reactstrap/lib/Input';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUndo } from '@fortawesome/free-solid-svg-icons';\nimport { isEmpty, pipe } from 'ramda';\nimport { DropdownBtn } from '../utils/DropdownBtn';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { DomainsList } from './reducers/domainsList';\nimport './DomainSelector.scss';\n\nexport interface DomainSelectorProps extends Omit<InputProps, 'onChange'> {\n  value?: string;\n  onChange: (domain: string) => void;\n}\n\ninterface DomainSelectorConnectProps extends DomainSelectorProps {\n  listDomains: Function;\n  domainsList: DomainsList;\n}\n\nexport const DomainSelector = ({ listDomains, value, domainsList, onChange }: DomainSelectorConnectProps) => {\n  const [ inputDisplayed,, showInput, hideInput ] = useToggle();\n  const { domains } = domainsList;\n  const valueIsEmpty = isEmpty(value);\n  const unselectDomain = () => onChange('');\n\n  useEffect(() => {\n    listDomains();\n  }, []);\n\n  return inputDisplayed ? (\n    <InputGroup>\n      <Input\n        value={value}\n        placeholder=\"Domain\"\n        onChange={(e) => onChange(e.target.value)}\n      />\n      <InputGroupAddon addonType=\"append\">\n        <Button\n          id=\"backToDropdown\"\n          outline\n          type=\"button\"\n          className=\"domains-dropdown__back-btn\"\n          onClick={pipe(unselectDomain, hideInput)}\n        >\n          <FontAwesomeIcon icon={faUndo} />\n        </Button>\n        <UncontrolledTooltip target=\"backToDropdown\" placement=\"left\" trigger=\"hover\">\n          Existing domains\n        </UncontrolledTooltip>\n      </InputGroupAddon>\n    </InputGroup>\n  ) : (\n    <DropdownBtn\n      text={valueIsEmpty ? 'Domain' : `Domain: ${value}`}\n      className={!valueIsEmpty ? 'domains-dropdown__toggle-btn--active' : 'domains-dropdown__toggle-btn'}\n    >\n      {domains.map(({ domain, isDefault }) => (\n        <DropdownItem\n          key={domain}\n          active={value === domain || isDefault && valueIsEmpty}\n          onClick={() => onChange(domain)}\n        >\n          {domain}\n          {isDefault && <span className=\"float-right text-muted\">default</span>}\n        </DropdownItem>\n      ))}\n      <DropdownItem divider />\n      <DropdownItem onClick={pipe(unselectDomain, showInput)}>\n        <i>New domain</i>\n      </DropdownItem>\n    </DropdownBtn>\n  );\n};\n","import { FC, useState } from 'react';\nimport { Button, Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { ShlinkDomain, ShlinkDomainRedirects } from '../../api/types';\nimport { FormGroupContainer, FormGroupContainerProps } from '../../utils/FormGroupContainer';\nimport { handleEventPreventingDefault, nonEmptyValueOrNull } from '../../utils/utils';\nimport { InfoTooltip } from '../../utils/InfoTooltip';\n\ninterface EditDomainRedirectsModalProps {\n  domain: ShlinkDomain;\n  isOpen: boolean;\n  toggle: () => void;\n  editDomainRedirects: (domain: string, redirects: Partial<ShlinkDomainRedirects>) => Promise<void>;\n}\n\nconst FormGroup: FC<FormGroupContainerProps & { isLast?: boolean }> = ({ isLast, ...rest }) => (\n  <FormGroupContainer\n    {...rest}\n    required={false}\n    type=\"url\"\n    placeholder=\"No redirect\"\n    className={isLast ? 'mb-0' : ''}\n  />\n);\n\nexport const EditDomainRedirectsModal: FC<EditDomainRedirectsModalProps> = (\n  { isOpen, toggle, domain, editDomainRedirects },\n) => {\n  const [ baseUrlRedirect, setBaseUrlRedirect ] = useState(domain.redirects?.baseUrlRedirect ?? '');\n  const [ regular404Redirect, setRegular404Redirect ] = useState(domain.redirects?.regular404Redirect ?? '');\n  const [ invalidShortUrlRedirect, setInvalidShortUrlRedirect ] = useState(\n    domain.redirects?.invalidShortUrlRedirect ?? '',\n  );\n  const handleSubmit = handleEventPreventingDefault(async () => editDomainRedirects(domain.domain, {\n    baseUrlRedirect: nonEmptyValueOrNull(baseUrlRedirect),\n    regular404Redirect: nonEmptyValueOrNull(regular404Redirect),\n    invalidShortUrlRedirect: nonEmptyValueOrNull(invalidShortUrlRedirect),\n  }).then(toggle));\n\n  return (\n    <Modal isOpen={isOpen} toggle={toggle} centered>\n      <form onSubmit={handleSubmit}>\n        <ModalHeader toggle={toggle}>Edit redirects for <b>{domain.domain}</b></ModalHeader>\n        <ModalBody>\n          <FormGroup value={baseUrlRedirect} onChange={setBaseUrlRedirect}>\n            <InfoTooltip className=\"mr-2\" placement=\"bottom\">\n              Visitors accessing the base url, as in <b>https://{domain.domain}/</b>, will be redirected to this URL.\n            </InfoTooltip>\n            Base URL\n          </FormGroup>\n          <FormGroup value={regular404Redirect} onChange={setRegular404Redirect}>\n            <InfoTooltip className=\"mr-2\" placement=\"bottom\">\n              Visitors accessing a url not matching a short URL pattern, as in <b>https://{domain.domain}/???/[...]</b>,\n              will be redirected to this URL.\n            </InfoTooltip>\n            Regular 404\n          </FormGroup>\n          <FormGroup value={invalidShortUrlRedirect} isLast onChange={setInvalidShortUrlRedirect}>\n            <InfoTooltip className=\"mr-2\" placement=\"bottom\">\n              Visitors accessing a url matching a short URL pattern, but not matching an existing short code, will be\n              redirected to this URL.\n            </InfoTooltip>\n            Invalid short URL\n          </FormGroup>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"link\" type=\"button\" onClick={toggle}>Cancel</Button>\n          <Button color=\"primary\">Save</Button>\n        </ModalFooter>\n      </form>\n    </Modal>\n  );\n};\n","import { FC, useEffect, useRef, useState } from 'react';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport { ExternalLink } from 'react-external-link';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faTimes as invalidIcon,\n  faCheck as checkIcon,\n  faCircleNotch as loadingStatusIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { MediaMatcher } from '../../utils/types';\nimport { DomainStatus } from '../data';\n\ninterface DomainStatusIconProps {\n  status: DomainStatus;\n  matchMedia?: MediaMatcher;\n}\n\nexport const DomainStatusIcon: FC<DomainStatusIconProps> = ({ status, matchMedia = window.matchMedia }) => {\n  const ref = useRef<HTMLSpanElement>();\n  const matchesMobile = () => matchMedia('(max-width: 991px)').matches;\n  const [ isMobile, setIsMobile ] = useState<boolean>(matchesMobile());\n\n  useEffect(() => {\n    const listener = () => setIsMobile(matchesMobile());\n\n    window.addEventListener('resize', listener);\n\n    return () => window.removeEventListener('resize', listener);\n  }, []);\n\n  if (status === 'validating') {\n    return <FontAwesomeIcon fixedWidth icon={loadingStatusIcon} spin />;\n  }\n\n  return (\n    <>\n      <span\n        ref={(el: HTMLSpanElement) => {\n          ref.current = el;\n        }}\n      >\n        {status === 'valid'\n          ? <FontAwesomeIcon fixedWidth icon={checkIcon} className=\"text-muted\" />\n          : <FontAwesomeIcon fixedWidth icon={invalidIcon} className=\"text-danger\" />}\n      </span>\n      <UncontrolledTooltip\n        target={(() => ref.current) as any}\n        placement={isMobile ? 'top-start' : 'left'}\n        autohide={status === 'valid'}\n      >\n        {status === 'valid' ? 'Congratulations! This domain is properly configured.' : (\n          <span>\n            Oops! There is some missing configuration, and short URLs shared with this domain will not work.\n            <br />\n            Check the <ExternalLink href=\"https://slnk.to/multi-domain-docs\">documentation</ExternalLink> in order to\n            find out what is missing.\n          </span>\n        )}\n      </UncontrolledTooltip>\n    </>\n  );\n};\n","import { FC, useEffect } from 'react';\nimport { Button, UncontrolledTooltip } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faBan as forbiddenIcon,\n  faDotCircle as defaultDomainIcon,\n  faEdit as editIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { ShlinkDomainRedirects } from '../api/types';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { OptionalString } from '../utils/utils';\nimport { SelectedServer } from '../servers/data';\nimport { supportsDefaultDomainRedirectsEdition } from '../utils/helpers/features';\nimport { EditDomainRedirectsModal } from './helpers/EditDomainRedirectsModal';\nimport { Domain } from './data';\nimport { DomainStatusIcon } from './helpers/DomainStatusIcon';\n\ninterface DomainRowProps {\n  domain: Domain;\n  defaultRedirects?: ShlinkDomainRedirects;\n  editDomainRedirects: (domain: string, redirects: Partial<ShlinkDomainRedirects>) => Promise<void>;\n  checkDomainHealth: (domain: string) => void;\n  selectedServer: SelectedServer;\n}\n\nconst Nr: FC<{ fallback: OptionalString }> = ({ fallback }) => (\n  <span className=\"text-muted\">\n    {!fallback && <small>No redirect</small>}\n    {fallback && <>{fallback} <small>(as fallback)</small></>}\n  </span>\n);\nconst DefaultDomain: FC = () => (\n  <>\n    <FontAwesomeIcon fixedWidth icon={defaultDomainIcon} className=\"text-primary\" id=\"defaultDomainIcon\" />\n    <UncontrolledTooltip target=\"defaultDomainIcon\" placement=\"right\">Default domain</UncontrolledTooltip>\n  </>\n);\n\nexport const DomainRow: FC<DomainRowProps> = (\n  { domain, editDomainRedirects, checkDomainHealth, defaultRedirects, selectedServer },\n) => {\n  const [ isOpen, toggle ] = useToggle();\n  const { domain: authority, isDefault, redirects, status } = domain;\n  const canEditDomain = !isDefault || supportsDefaultDomainRedirectsEdition(selectedServer);\n\n  useEffect(() => {\n    checkDomainHealth(domain.domain);\n  }, []);\n\n  return (\n    <tr className=\"responsive-table__row\">\n      <td className=\"responsive-table__cell\" data-th=\"Is default domain\">{isDefault && <DefaultDomain />}</td>\n      <th className=\"responsive-table__cell\" data-th=\"Domain\">{authority}</th>\n      <td className=\"responsive-table__cell\" data-th=\"Base path redirect\">\n        {redirects?.baseUrlRedirect ?? <Nr fallback={defaultRedirects?.baseUrlRedirect} />}\n      </td>\n      <td className=\"responsive-table__cell\" data-th=\"Regular 404 redirect\">\n        {redirects?.regular404Redirect ?? <Nr fallback={defaultRedirects?.regular404Redirect} />}\n      </td>\n      <td className=\"responsive-table__cell\" data-th=\"Invalid short URL redirect\">\n        {redirects?.invalidShortUrlRedirect ?? <Nr fallback={defaultRedirects?.invalidShortUrlRedirect} />}\n      </td>\n      <td className=\"responsive-table__cell text-lg-center\" data-th=\"Status\">\n        <DomainStatusIcon status={status} />\n      </td>\n      <td className=\"responsive-table__cell text-right\">\n        <span id={!canEditDomain ? 'defaultDomainBtn' : undefined}>\n          <Button outline size=\"sm\" disabled={!canEditDomain} onClick={!canEditDomain ? undefined : toggle}>\n            <FontAwesomeIcon fixedWidth icon={!canEditDomain ? forbiddenIcon : editIcon} />\n          </Button>\n        </span>\n        {!canEditDomain && (\n          <UncontrolledTooltip target=\"defaultDomainBtn\" placement=\"left\">\n            Redirects for default domain cannot be edited here.\n            <br />\n            Use config options or env vars directly on the server.\n          </UncontrolledTooltip>\n        )}\n      </td>\n      <EditDomainRedirectsModal\n        domain={domain}\n        isOpen={isOpen}\n        toggle={toggle}\n        editDomainRedirects={editDomainRedirects}\n      />\n    </tr>\n  );\n};\n","import { FC, useEffect } from 'react';\nimport Message from '../utils/Message';\nimport { Result } from '../utils/Result';\nimport { ShlinkApiError } from '../api/ShlinkApiError';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport SearchField from '../utils/SearchField';\nimport { ShlinkDomainRedirects } from '../api/types';\nimport { SelectedServer } from '../servers/data';\nimport { DomainsList } from './reducers/domainsList';\nimport { DomainRow } from './DomainRow';\n\ninterface ManageDomainsProps {\n  listDomains: Function;\n  filterDomains: (searchTerm: string) => void;\n  editDomainRedirects: (domain: string, redirects: Partial<ShlinkDomainRedirects>) => Promise<void>;\n  checkDomainHealth: (domain: string) => void;\n  domainsList: DomainsList;\n  selectedServer: SelectedServer;\n}\n\nconst headers = [ '', 'Domain', 'Base path redirect', 'Regular 404 redirect', 'Invalid short URL redirect', '', '' ];\n\nexport const ManageDomains: FC<ManageDomainsProps> = (\n  { listDomains, domainsList, filterDomains, editDomainRedirects, checkDomainHealth, selectedServer },\n) => {\n  const { filteredDomains: domains, defaultRedirects, loading, error, errorData } = domainsList;\n  const resolvedDefaultRedirects = defaultRedirects ?? domains.find(({ isDefault }) => isDefault)?.redirects;\n\n  useEffect(() => {\n    listDomains();\n  }, []);\n\n  if (loading) {\n    return <Message loading />;\n  }\n\n  const renderContent = () => {\n    if (error) {\n      return (\n        <Result type=\"error\">\n          <ShlinkApiError errorData={errorData} fallbackMessage=\"Error loading domains :(\" />\n        </Result>\n      );\n    }\n\n    return (\n      <SimpleCard>\n        <table className=\"table table-hover mb-0\">\n          <thead className=\"responsive-table__header\">\n            <tr>{headers.map((column, index) => <th key={index}>{column}</th>)}</tr>\n          </thead>\n          <tbody>\n            {domains.length < 1 && <tr><td colSpan={headers.length} className=\"text-center\">No results found</td></tr>}\n            {domains.map((domain) => (\n              <DomainRow\n                key={domain.domain}\n                domain={domain}\n                editDomainRedirects={editDomainRedirects}\n                checkDomainHealth={checkDomainHealth}\n                defaultRedirects={resolvedDefaultRedirects}\n                selectedServer={selectedServer}\n              />\n            ))}\n          </tbody>\n        </table>\n      </SimpleCard>\n    );\n  };\n\n  return (\n    <>\n      <SearchField className=\"mb-3\" onChange={filterDomains} />\n      {renderContent()}\n    </>\n  );\n};\n","import Bottle from 'bottlejs';\nimport { ConnectDecorator } from '../../container/types';\nimport { checkDomainHealth, filterDomains, listDomains } from '../reducers/domainsList';\nimport { DomainSelector } from '../DomainSelector';\nimport { ManageDomains } from '../ManageDomains';\nimport { editDomainRedirects } from '../reducers/domainRedirects';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('DomainSelector', () => DomainSelector);\n  bottle.decorator('DomainSelector', connect([ 'domainsList' ], [ 'listDomains' ]));\n\n  bottle.serviceFactory('ManageDomains', () => ManageDomains);\n  bottle.decorator('ManageDomains', connect(\n    [ 'domainsList', 'selectedServer' ],\n    [ 'listDomains', 'filterDomains', 'editDomainRedirects', 'checkDomainHealth' ],\n  ));\n\n  // Actions\n  bottle.serviceFactory('listDomains', listDomains, 'buildShlinkApiClient');\n  bottle.serviceFactory('filterDomains', () => filterDomains);\n  bottle.serviceFactory('editDomainRedirects', editDomainRedirects, 'buildShlinkApiClient');\n  bottle.serviceFactory('checkDomainHealth', checkDomainHealth, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import { Action } from 'redux';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\n\n/* eslint-disable padding-line-between-statements */\nexport const APP_UPDATE_AVAILABLE = 'shlink/appUpdates/APP_UPDATE_AVAILABLE';\nexport const RESET_APP_UPDATE = 'shlink/appUpdates/RESET_APP_UPDATE';\n/* eslint-enable padding-line-between-statements */\n\nconst initialState = false;\n\nexport default buildReducer<boolean, Action<string>>({\n  [APP_UPDATE_AVAILABLE]: () => true,\n  [RESET_APP_UPDATE]: () => false,\n}, initialState);\n\nexport const appUpdateAvailable = buildActionCreator(APP_UPDATE_AVAILABLE);\n\nexport const resetAppUpdate = buildActionCreator(RESET_APP_UPDATE);\n","import { FC, MouseEventHandler } from 'react';\nimport { Alert, Button } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSyncAlt as reloadIcon } from '@fortawesome/free-solid-svg-icons';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { useToggle } from '../utils/helpers/hooks';\nimport './AppUpdateBanner.scss';\n\ninterface AppUpdateBannerProps {\n  isOpen: boolean;\n  toggle: MouseEventHandler<any>;\n  forceUpdate: Function;\n}\n\nexport const AppUpdateBanner: FC<AppUpdateBannerProps> = ({ isOpen, toggle, forceUpdate }) => {\n  const [ isUpdating,, setUpdating ] = useToggle();\n  const update = () => {\n    setUpdating();\n    forceUpdate();\n  };\n\n  return (\n    <Alert className=\"app-update-banner\" isOpen={isOpen} toggle={toggle} tag={SimpleCard} color=\"secondary\">\n      <h4 className=\"mb-4\">This app has just been updated!</h4>\n      <p className=\"mb-0\">\n        Restart it to enjoy the new features.\n        <Button disabled={isUpdating} className=\"ml-2\" color=\"secondary\" size=\"sm\" onClick={update}>\n          {!isUpdating && <>Restart now <FontAwesomeIcon icon={reloadIcon} className=\"ml-1\" /></>}\n          {isUpdating && <>Restarting...</>}\n        </Button>\n      </p>\n    </Alert>\n  );\n};\n","export const forceUpdate = async () => {\n  const registrations = await navigator.serviceWorker?.getRegistrations() ?? [];\n\n  for (const registration of registrations) {\n    const { waiting } = registration;\n\n    waiting?.addEventListener('statechange', (event) => {\n      if ((event.target as any)?.state === 'activated') {\n        window.location.reload();\n      }\n    });\n\n    // The logic that makes skipWaiting to be called when this message is posted is in service-worker.ts\n    waiting?.postMessage({ type: 'SKIP_WAITING' });\n  }\n};\n","import { useEffect, FC } from 'react';\nimport { Route, RouteChildrenProps, Switch } from 'react-router-dom';\nimport classNames from 'classnames';\nimport NotFound from '../common/NotFound';\nimport { ServersMap } from '../servers/data';\nimport { Settings } from '../settings/reducers/settings';\nimport { changeThemeInMarkup } from '../utils/theme';\nimport { AppUpdateBanner } from '../common/AppUpdateBanner';\nimport { forceUpdate } from '../utils/helpers/sw';\nimport './App.scss';\n\ninterface AppProps extends RouteChildrenProps {\n  fetchServers: () => void;\n  servers: ServersMap;\n  settings: Settings;\n  resetAppUpdate: () => void;\n  appUpdated: boolean;\n}\n\nconst App = (\n  MainHeader: FC,\n  Home: FC,\n  MenuLayout: FC,\n  CreateServer: FC,\n  EditServer: FC,\n  Settings: FC,\n  ManageServers: FC,\n  ShlinkVersionsContainer: FC,\n) => ({ fetchServers, servers, settings, appUpdated, resetAppUpdate, location }: AppProps) => {\n  const isHome = location.pathname === '/';\n\n  useEffect(() => {\n    // On first load, try to fetch the remote servers if the list is empty\n    if (Object.keys(servers).length === 0) {\n      fetchServers();\n    }\n\n    changeThemeInMarkup(settings.ui?.theme ?? 'light');\n  }, []);\n\n  return (\n    <div className=\"container-fluid app-container\">\n      <MainHeader />\n\n      <div className=\"app\">\n        <div className={classNames('shlink-wrapper', { 'd-flex d-md-block align-items-center': isHome })}>\n          <Switch>\n            <Route exact path=\"/\" component={Home} />\n            <Route exact path=\"/settings\" component={Settings} />\n            <Route exact path=\"/manage-servers\" component={ManageServers} />\n            <Route exact path=\"/server/create\" component={CreateServer} />\n            <Route exact path=\"/server/:serverId/edit\" component={EditServer} />\n            <Route path=\"/server/:serverId\" component={MenuLayout} />\n            <Route component={NotFound} />\n          </Switch>\n        </div>\n\n        <div className=\"shlink-footer\">\n          <ShlinkVersionsContainer />\n        </div>\n      </div>\n\n      <AppUpdateBanner isOpen={appUpdated} toggle={resetAppUpdate} forceUpdate={forceUpdate} />\n    </div>\n  );\n};\n\nexport default App;\n","import Bottle, { Decorator } from 'bottlejs';\nimport { appUpdateAvailable, resetAppUpdate } from '../reducers/appUpdates';\nimport App from '../App';\nimport { ConnectDecorator } from '../../container/types';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator, withRouter: Decorator) => {\n  // Components\n  bottle.serviceFactory(\n    'App',\n    App,\n    'MainHeader',\n    'Home',\n    'MenuLayout',\n    'CreateServer',\n    'EditServer',\n    'Settings',\n    'ManageServers',\n    'ShlinkVersionsContainer',\n  );\n  bottle.decorator('App', connect([ 'servers', 'settings', 'appUpdated' ], [ 'fetchServers', 'resetAppUpdate' ]));\n  bottle.decorator('App', withRouter);\n\n  // Actions\n  bottle.serviceFactory('appUpdateAvailable', () => appUpdateAvailable);\n  bottle.serviceFactory('resetAppUpdate', () => resetAppUpdate);\n};\n\nexport default provideServices;\n","import Bottle, { IContainer } from 'bottlejs';\nimport { withRouter } from 'react-router-dom';\nimport { connect as reduxConnect } from 'react-redux';\nimport { pick } from 'ramda';\nimport provideApiServices from '../api/services/provideServices';\nimport provideCommonServices from '../common/services/provideServices';\nimport provideShortUrlsServices from '../short-urls/services/provideServices';\nimport provideServersServices from '../servers/services/provideServices';\nimport provideVisitsServices from '../visits/services/provideServices';\nimport provideTagsServices from '../tags/services/provideServices';\nimport provideUtilsServices from '../utils/services/provideServices';\nimport provideMercureServices from '../mercure/services/provideServices';\nimport provideSettingsServices from '../settings/services/provideServices';\nimport provideDomainsServices from '../domains/services/provideServices';\nimport provideAppServices from '../app/services/provideServices';\nimport { ConnectDecorator } from './types';\n\ntype LazyActionMap = Record<string, Function>;\n\nconst bottle = new Bottle();\n\nexport const { container } = bottle;\n\nconst lazyService = <T extends Function, K>(container: IContainer, serviceName: string) =>\n  (...args: any[]) => (container[serviceName] as T)(...args) as K;\nconst mapActionService = (map: LazyActionMap, actionName: string): LazyActionMap => ({\n  ...map,\n  // Wrap actual action service in a function so that it is lazily created the first time it is called\n  [actionName]: lazyService(container, actionName),\n});\nconst connect: ConnectDecorator = (propsFromState: string[] | null, actionServiceNames: string[] = []) =>\n  reduxConnect(\n    propsFromState ? pick(propsFromState) : null,\n    actionServiceNames.reduce(mapActionService, {}),\n  );\n\nprovideAppServices(bottle, connect, withRouter);\nprovideCommonServices(bottle, connect, withRouter);\nprovideApiServices(bottle);\nprovideShortUrlsServices(bottle, connect, withRouter);\nprovideServersServices(bottle, connect, withRouter);\nprovideTagsServices(bottle, connect);\nprovideVisitsServices(bottle, connect);\nprovideUtilsServices(bottle);\nprovideMercureServices(bottle);\nprovideSettingsServices(bottle, connect);\nprovideDomainsServices(bottle, connect);\n","import { combineReducers } from 'redux';\nimport serversReducer from '../servers/reducers/servers';\nimport selectedServerReducer from '../servers/reducers/selectedServer';\nimport shortUrlsListReducer from '../short-urls/reducers/shortUrlsList';\nimport shortUrlCreationReducer from '../short-urls/reducers/shortUrlCreation';\nimport shortUrlDeletionReducer from '../short-urls/reducers/shortUrlDeletion';\nimport shortUrlEditionReducer from '../short-urls/reducers/shortUrlEdition';\nimport shortUrlVisitsReducer from '../visits/reducers/shortUrlVisits';\nimport tagVisitsReducer from '../visits/reducers/tagVisits';\nimport orphanVisitsReducer from '../visits/reducers/orphanVisits';\nimport shortUrlDetailReducer from '../short-urls/reducers/shortUrlDetail';\nimport tagsListReducer from '../tags/reducers/tagsList';\nimport tagDeleteReducer from '../tags/reducers/tagDelete';\nimport tagEditReducer from '../tags/reducers/tagEdit';\nimport mercureInfoReducer from '../mercure/reducers/mercureInfo';\nimport settingsReducer from '../settings/reducers/settings';\nimport domainsListReducer from '../domains/reducers/domainsList';\nimport visitsOverviewReducer from '../visits/reducers/visitsOverview';\nimport appUpdatesReducer from '../app/reducers/appUpdates';\nimport { ShlinkState } from '../container/types';\n\nexport default combineReducers<ShlinkState>({\n  servers: serversReducer,\n  selectedServer: selectedServerReducer,\n  shortUrlsList: shortUrlsListReducer,\n  shortUrlCreationResult: shortUrlCreationReducer,\n  shortUrlDeletion: shortUrlDeletionReducer,\n  shortUrlEdition: shortUrlEditionReducer,\n  shortUrlVisits: shortUrlVisitsReducer,\n  tagVisits: tagVisitsReducer,\n  orphanVisits: orphanVisitsReducer,\n  shortUrlDetail: shortUrlDetailReducer,\n  tagsList: tagsListReducer,\n  tagDelete: tagDeleteReducer,\n  tagEdit: tagEditReducer,\n  mercureInfo: mercureInfoReducer,\n  settings: settingsReducer,\n  domainsList: domainsListReducer,\n  visitsOverview: visitsOverviewReducer,\n  appUpdated: appUpdatesReducer,\n});\n","import ReduxThunk from 'redux-thunk';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport { save, load, RLSOptions } from 'redux-localstorage-simple';\nimport reducers from '../reducers';\nimport { migrateDeprecatedSettings } from '../settings/helpers';\nimport { ShlinkState } from './types';\n\nconst isProduction = process.env.NODE_ENV !== 'production';\nconst composeEnhancers: Function = !isProduction && (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst localStorageConfig: RLSOptions = {\n  states: [ 'settings', 'servers' ],\n  namespace: 'shlink',\n  namespaceSeparator: '.',\n  debounce: 300,\n};\nconst preloadedState = migrateDeprecatedSettings(load(localStorageConfig) as ShlinkState);\n\nexport const store = createStore(reducers, preloadedState, composeEnhancers(\n  applyMiddleware(save(localStorageConfig), ReduxThunk),\n));\n","import { ShlinkState } from '../../container/types';\n\nexport const migrateDeprecatedSettings = (state: Partial<ShlinkState>): Partial<ShlinkState> => {\n  if (!state.settings) {\n    return state;\n  }\n\n  // The \"last180Days\" interval had a typo, with a lowercase d\n  if ((state.settings.visits?.defaultInterval as any) === 'last180days') {\n    state.settings.visits && (state.settings.visits.defaultInterval = 'last180Days');\n  }\n\n  // The \"tags display mode\" option has been moved from \"ui\" to \"tags\"\n  state.settings.tags = {\n    ...state.settings.tags,\n    defaultMode: state.settings.tags?.defaultMode ?? (state.settings.ui as any)?.tagsMode,\n  };\n  state.settings.ui && delete (state.settings.ui as any).tagsMode;\n\n  return state;\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL ?? '', window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import L from 'leaflet';\nimport marker2x from 'leaflet/dist/images/marker-icon-2x.png';\nimport marker from 'leaflet/dist/images/marker-icon.png';\nimport markerShadow from 'leaflet/dist/images/marker-shadow.png';\n\nexport const fixLeafletIcons = () => {\n  delete (L.Icon.Default.prototype as any)._getIconUrl;\n\n  L.Icon.Default.mergeOptions({\n    iconRetinaUrl: marker2x,\n    iconUrl: marker,\n    shadowUrl: markerShadow,\n  });\n};\n","import { render } from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter } from 'react-router-dom';\nimport { homepage } from '../package.json';\nimport { container } from './container';\nimport { store } from './container/store';\nimport { fixLeafletIcons } from './utils/helpers/leaflet';\nimport { register as registerServiceWorker } from './serviceWorkerRegistration';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport 'leaflet/dist/leaflet.css';\nimport './index.scss';\n\n// This overwrites icons used for leaflet maps, fixing some issues caused by webpack while processing the CSS\nfixLeafletIcons();\n\nconst { App, ScrollToTop, ErrorHandler, appUpdateAvailable } = container;\n\nrender(\n  <Provider store={store}>\n    <BrowserRouter basename={homepage}>\n      <ErrorHandler>\n        <ScrollToTop>\n          <App />\n        </ScrollToTop>\n      </ErrorHandler>\n    </BrowserRouter>\n  </Provider>,\n  document.getElementById('root'),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://cra.link/PWA\nregisterServiceWorker({\n  onUpdate() {\n    store.dispatch(appUpdateAvailable()); // eslint-disable-line @typescript-eslint/no-unsafe-call\n  },\n});\n","import { FC } from 'react';\nimport './NoMenuLayout.scss';\n\nexport const NoMenuLayout: FC = ({ children }) => <div className=\"no-menu-wrapper container-xl\">{children}</div>;\n","import { compare } from 'compare-versions';\nimport { identity, memoizeWith } from 'ramda';\nimport { Empty, hasValue } from '../utils';\n\ntype SemVerPatternFragment = `${bigint | '*'}`;\n\nexport type SemVerPattern = SemVerPatternFragment\n| `${SemVerPatternFragment}.${SemVerPatternFragment}`\n| `${SemVerPatternFragment}.${SemVerPatternFragment}.${SemVerPatternFragment}`;\n\nexport interface Versions {\n  maxVersion?: SemVerPattern;\n  minVersion?: SemVerPattern;\n}\n\nexport type SemVer = `${bigint}.${bigint}.${bigint}` | 'latest';\n\nexport const versionMatch = (versionToMatch: SemVer | Empty, { maxVersion, minVersion }: Versions): boolean => {\n  if (!hasValue(versionToMatch)) {\n    return false;\n  }\n\n  const matchesMinVersion = !minVersion || compare(versionToMatch, minVersion, '>=');\n  const matchesMaxVersion = !maxVersion || compare(versionToMatch, maxVersion, '<=');\n\n  return matchesMaxVersion && matchesMinVersion;\n};\n\nconst versionIsValidSemVer = memoizeWith(identity, (version: string): version is SemVer => {\n  try {\n    return compare(version, version, '=');\n  } catch (e) {\n    return false;\n  }\n});\n\nexport const versionToPrintable = (version: string) => !versionIsValidSemVer(version) ? version : `v${version}`;\n\nexport const versionToSemVer = (defaultValue: SemVer = 'latest') =>\n  (version: string): SemVer => versionIsValidSemVer(version) ? version : defaultValue;\n"],"sourceRoot":""}