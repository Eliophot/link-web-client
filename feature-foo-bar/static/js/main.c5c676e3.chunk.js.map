{"version":3,"sources":["common/NotFound.tsx","common/img/ShlinkLogo.tsx","servers/helpers/withSelectedServer.tsx","servers/ServersListGroup.tsx","utils/helpers/hooks.ts","utils/utils.ts","servers/data/index.ts","common/services/provideServices.ts","common/ScrollToTop.tsx","common/ErrorHandler.tsx","utils/services/provideServices.ts","utils/services/LocalStorage.ts","utils/services/ColorGenerator.ts","common/ShlinkVersions.tsx","common/ShlinkVersionsContainer.tsx","common/MainHeader.tsx","common/Home.tsx","common/MenuLayout.tsx","common/AsideMenu.tsx","utils/SimpleCard.tsx","utils/theme/index.ts","utils/helpers/features.ts","utils/Message.tsx","common/NoMenuLayout.tsx","utils/helpers/version.ts","utils/SearchField.tsx","App.tsx","api/services/ShlinkApiClient.ts","api/services/ShlinkApiClientBuilder.ts","api/services/provideServices.ts","short-urls/ShortUrls.tsx","tags/helpers/Tag.tsx","utils/DropdownBtn.tsx","utils/helpers/date.ts","utils/dates/types/index.ts","utils/DateInput.tsx","utils/dates/DateRangeRow.tsx","utils/dates/DateIntervalDropdownItems.tsx","utils/dates/DateRangeSelector.tsx","short-urls/SearchBar.tsx","utils/SortingDropdown.tsx","mercure/helpers/boundToMercureHub.tsx","mercure/helpers/index.ts","utils/helpers/query.ts","mercure/helpers/Topics.ts","utils/helpers/redux.ts","visits/VisitsStats.tsx","short-urls/helpers/index.ts","visits/reducers/visitCreation.ts","api/utils/index.ts","short-urls/reducers/shortUrlDeletion.ts","short-urls/reducers/shortUrlCreation.ts","short-urls/reducers/shortUrlEdition.ts","short-urls/reducers/shortUrlsList.ts","short-urls/reducers/shortUrlsListParams.ts","utils/helpers/numbers.ts","utils/helpers/pagination.ts","short-urls/Paginator.tsx","short-urls/ShortUrlsList.tsx","utils/CopyToClipboardIcon.tsx","short-urls/helpers/ShortUrlDetailLink.tsx","short-urls/helpers/ShortUrlVisitsCount.tsx","short-urls/helpers/ShortUrlsRow.tsx","short-urls/helpers/ShortUrlsRowMenu.tsx","short-urls/CreateShortUrl.tsx","utils/Result.tsx","api/ShlinkApiError.tsx","short-urls/helpers/DeleteShortUrlModal.tsx","short-urls/helpers/CreateShortUrlResult.tsx","short-urls/ShortUrlsTable.tsx","utils/helpers/qrCodes.ts","short-urls/helpers/QrCodeModal.tsx","utils/BooleanControl.tsx","utils/Checkbox.tsx","short-urls/UseExistingIfFoundInfoIcon.tsx","short-urls/ShortUrlForm.tsx","short-urls/EditShortUrl.tsx","short-urls/reducers/shortUrlDetail.ts","short-urls/services/provideServices.ts","utils/FormGroupContainer.tsx","servers/helpers/ServerForm.tsx","servers/CreateServer.tsx","servers/ServersDropdown.tsx","servers/DeleteServerModal.tsx","servers/DeleteServerButton.tsx","servers/EditServer.tsx","servers/helpers/ImportServersBtn.tsx","servers/reducers/selectedServer.ts","servers/reducers/servers.ts","servers/reducers/remoteServers.ts","servers/helpers/ForServerVersion.tsx","servers/helpers/ServerError.tsx","servers/Overview.tsx","servers/services/ServersImporter.ts","utils/helpers/csv.ts","servers/services/ServersExporter.ts","servers/services/provideServices.ts","visits/VisitsHeader.tsx","visits/ShortUrlVisitsHeader.tsx","utils/PaginationDropdown.tsx","common/SimplePaginator.tsx","utils/helpers/visits.ts","utils/helpers/charts.ts","visits/helpers/DefaultChart.tsx","visits/helpers/GraphCard.tsx","visits/helpers/SortableBarGraph.tsx","utils/ToggleSwitch.tsx","visits/helpers/LineChartCard.tsx","visits/VisitsTable.tsx","visits/helpers/MapModal.tsx","visits/helpers/OpenMapModalBtn.tsx","visits/types/helpers.ts","visits/services/VisitsParser.ts","visits/helpers/OrphanVisitTypeDropdown.tsx","visits/ShortUrlVisits.tsx","visits/reducers/common.ts","visits/reducers/shortUrlVisits.ts","visits/TagVisitsHeader.tsx","visits/TagVisits.tsx","visits/reducers/tagVisits.ts","visits/OrphanVisitsHeader.tsx","visits/OrphanVisits.tsx","visits/reducers/orphanVisits.ts","visits/reducers/visitsOverview.ts","visits/services/VisitsExporter.ts","visits/services/provideServices.ts","tags/helpers/TagBullet.tsx","tags/helpers/TagsSelector.tsx","tags/TagCard.tsx","tags/helpers/DeleteTagConfirmModal.tsx","tags/helpers/EditTagModal.tsx","tags/TagsList.tsx","tags/reducers/tagDelete.ts","tags/reducers/tagEdit.ts","tags/reducers/tagsList.ts","tags/services/provideServices.ts","mercure/reducers/mercureInfo.ts","mercure/services/provideServices.ts","settings/RealTimeUpdates.tsx","settings/Settings.tsx","settings/reducers/settings.ts","settings/ShortUrlCreation.tsx","settings/UserInterface.tsx","utils/dates/DateIntervalSelector.tsx","settings/Visits.tsx","settings/services/provideServices.ts","domains/reducers/domainsList.ts","domains/DomainSelector.tsx","domains/services/provideServices.ts","container/index.ts","reducers/index.ts","container/store.ts","utils/helpers/leaflet.ts","index.tsx","servers/helpers/withoutSelectedServer.tsx"],"names":["NotFound","to","children","className","ShlinkLogo","color","MAIN_COLOR","viewBox","version","xmlns","fill","d","withSelectedServer","WrappedComponent","ServerError","props","selectServer","selectedServer","match","useEffect","params","serverId","isNotFoundServer","loading","ServerListItem","id","name","ListGroupItem","tag","Link","icon","chevronIcon","ServersListGroup","servers","embedded","length","ListGroup","classNames","map","useStateFlagTimeout","setTimeout","clearTimeout","initialValue","delay","useState","flag","setFlag","timeout","useRef","undefined","callback","current","useToggle","useSwipeable","showSidebar","hideSidebar","swipeMenuIfNoModalExists","e","event","composedPath","some","classList","contains","document","querySelector","useReactSwipeable","delta","onSwipedLeft","onSwipedRight","determineOrderDir","currentField","newField","currentOrderDir","ASC","DESC","rangeOf","size","mappingFn","startAt","range","hasValue","value","isNil","isEmpty","handleEventPreventingDefault","handler","pipe","preventDefault","hasServerData","server","url","apiKey","isServerWithId","hasOwnProperty","isReachableServer","provideServices","bottle","connect","withRouter","constant","global","window","console","axios","serviceFactory","ScrollToTop","decorator","MainHeader","Home","withoutSelectedServer","MenuLayout","AsideMenu","ShlinkVersionsContainer","ErrorHandler","location","scrollTo","error","state","hasError","this","outline","onClick","reload","Component","localStorage","service","LocalStorage","ColorGenerator","buildPath","path","get","key","item","getItem","JSON","parse","set","setItem","stringify","floor","Math","random","letters","normalizeKey","toLowerCase","trim","storage","colors","getColorForKey","normalizedKey","setColorForKey","join","normalizeVersion","versionToSemVer","versionToPrintable","VersionLink","project","href","ShlinkVersions","clientVersion","normalizedClientVersion","printableVersion","classes","ServersDropdown","isOpen","toggleOpen","close","pathname","toggleClass","Navbar","dark","fixed","expand","NavbarBrand","NavbarToggler","arrowIcon","Collapse","navbar","Nav","NavItem","NavLink","active","cogsIcon","serversList","values","hasServers","Card","Row","noGutters","style","background","TagsList","ShortUrls","CreateShortUrl","ShortUrlVisits","TagVisits","OrphanVisits","Overview","EditShortUrl","sidebarVisible","toggleSidebar","addTagsVisitsRoute","supportsTagVisits","addOrphanVisitsRoute","supportsOrphanVisits","burgerClasses","swipeableProps","burgerIcon","showOnMobile","exact","from","component","render","AsideMenuItem","rest","activeClassName","DeleteServerButton","asideClass","suffix","overviewIcon","isActive","_","listIcon","createIcon","flip","tagsIcon","editIcon","textClassName","SimpleCard","title","bodyClassName","MAIN_COLOR_ALPHA","HIGHLIGHTED_COLOR","HIGHLIGHTED_COLOR_ALPHA","PRIMARY_LIGHT_COLOR","PRIMARY_DARK_COLOR","changeThemeInMarkup","theme","html","getElementsByTagName","setAttribute","isDarkThemeEnabled","getAttribute","serverMatchesVersions","versions","versionMatch","supportsSettingShortCodeLength","minVersion","supportsListingDomains","supportsQrCodeSvgFormat","supportsValidateUrl","supportsQrCodeSizeInQuery","supportsShortUrlTitle","supportsQrCodeMargin","supportsTagsInPatch","getClassForType","type","default","getTextClassForType","Message","fullWidth","body","preloader","spin","NoMenuLayout","versionToMatch","maxVersion","matchesMinVersion","compare","versionIsValidSemVer","memoizeWith","identity","defaultValue","timer","App","CreateServer","EditServer","Settings","fetchServers","settings","Object","keys","ui","buildShlinkBaseUrl","apiVersion","rejectNilProps","reject","ShlinkApiClient","baseUrl","listShortUrls","a","performRequest","then","data","shortUrls","createShortUrl","options","filteredOptions","resp","getShortUrlVisits","shortCode","query","visits","getTagVisits","getOrphanVisits","getVisitsOverview","getShortUrl","domain","deleteShortUrl","updateShortUrlTags","tags","updateShortUrl","listTags","withStats","stats","deleteTags","editTag","oldName","newName","health","mercureInfo","listDomains","domains","method","headers","paramsSerializer","qs","arrayFormat","response","apiClients","buildShlinkApiClient","getStateOrSelectedServer","getState","isGetState","prop","Error","clientKey","SearchBar","ShortUrlsList","page","urlsListKey","setUrlsListKey","SearchField","onChange","placeholder","large","noBorder","searchTerm","setSearchTerm","resetTimer","searchTermChanged","newSearchTerm","target","searchIcon","hidden","Tag","text","clearable","colorGenerator","onClose","backgroundColor","cursor","DropdownBtn","disabled","dropdownClassName","right","toggle","toggleClasses","Dropdown","DropdownToggle","caret","DropdownMenu","formatDateFromFormat","date","format","isMomentObject","formatIsoDate","formatInternational","formatDate","dateRangeIsEmpty","dateRange","filter","Boolean","rangeIsInterval","INTERVAL_TO_STRING_MAP","today","yesterday","last7Days","last30Days","last90Days","last180days","last365Days","DATE_INTERVALS","rangeOrIntervalToString","startDate","endDate","dateRangeToString","intervalToDateRange","dateInterval","moment","startOf","subtract","endOf","transformProps","dissoc","toDate","maxDate","minDate","selected","DateInput","isClearable","showCalendarIcon","ref","dateFormat","calendarIcon","input","focus","DateRangeRow","onStartDateChange","onEndDateChange","placeholderText","DateIntervalDropdownItems","interval","DropdownItem","DateRangeSelector","onDatesChange","initialDateRange","defaultText","activeInterval","setActiveInterval","activeDateRange","setActiveDateRange","updateDateRange","updateInterval","divider","header","dateOrNull","shortUrlsListParams","selectedTags","setDates","dates","selectedTag","SortingDropdown","items","orderField","orderDir","isButton","handleItemClick","fieldKey","newOrderDir","UncontrolledDropdown","toPairs","fieldValue","sortAscIcon","sortDescIcon","boundToMercureHub","getTopicsForProps","pendingUpdates","Set","createNewVisits","loadMercureInfo","closeEventSource","topics","onMessage","onTokenExpired","mercureHubUrl","token","onEventSourceMessage","onEventSourceError","status","subscriptions","topic","hubUrl","URL","searchParams","append","es","EventSource","Authorization","onmessage","onerror","forEach","bindToMercureTopic","visit","add","setInterval","clear","clearInterval","parseQuery","search","ignoreQueryPrefix","Topics","shortUrlVisits","orphanVisits","selectedBar","buildReducer","initialState","action","actionHandler","currentState","buildActionCreator","shortUrlMatches","shortUrl","CREATE_VISITS","createdVisits","parseApiError","isInvalidDeletionError","DELETE_SHORT_URL_START","DELETE_SHORT_URL_ERROR","SHORT_URL_DELETED","RESET_DELETE_SHORT_URL","errorData","dispatch","resetDeleteShortUrl","CREATE_SHORT_URL_START","CREATE_SHORT_URL_ERROR","CREATE_SHORT_URL","RESET_CREATE_SHORT_URL","result","saving","resetCreateShortUrl","EDIT_SHORT_URL_START","EDIT_SHORT_URL_ERROR","SHORT_URL_EDITED","editShortUrl","sendTagsSeparately","Promise","all","LIST_SHORT_URLS_START","LIST_SHORT_URLS_ERROR","LIST_SHORT_URLS","assocPath","pagination","totalItems","currentShortUrl","lastVisit","last","assoc","visitsCount","init","editedShortUrl","RESET_SHORT_URL_PARAMS","SORTABLE_FIELDS","dateCreated","longUrl","orderBy","resetShortUrlParams","ceil","formatter","Intl","NumberFormat","prettify","number","ELLIPSIS","progressivePagination","currentPage","pageCount","pages","max","min","unshift","push","pageIsEllipsis","pageNumber","prettifyPageNumber","keyForPage","index","Paginator","paginator","pagesCount","Pagination","listClassName","PaginationItem","PaginationLink","previous","next","ShortUrlsTable","shortUrlsList","head","order","setOrder","refreshList","extraParams","handleOrderBy","itemsPerPage","orderByColumn","field","renderOrderIcon","caretUpIcon","caretDownIcon","onTagClick","CopyToClipboardIcon","onCopy","copyIcon","buildUrl","ShortUrlDetailLink","ShortUrlVisitsCount","maxVisits","meta","visitsLink","prettifiedMaxVisits","tooltipRef","el","infoIcon","UncontrolledTooltip","placement","ShortUrlsRow","ShortUrlsRowMenu","copiedToClipboard","setCopiedToClipboard","setActive","isFirstRun","data-th","DeleteShortUrlModal","QrCodeModal","isQrModalOpen","toggleQrCode","isDeleteModalOpen","toggleDelete","ButtonDropdown","menuIcon","pieChartIcon","fixedWidth","qrIcon","deleteIcon","ShortUrlForm","CreateShortUrlResult","shortUrlCreationResult","basicMode","shortUrlCreationSettings","shortUrlCreation","useMemo","customSlug","shortCodeLength","validSince","validUntil","findIfExists","validateUrl","validateUrls","getInitialState","mode","onSave","canBeClosed","Result","small","ShlinkApiError","fallbackMessage","detail","invalidElements","shortUrlDeletion","inputValue","setInputValue","handleDeleteUrl","catch","Modal","centered","onSubmit","ModalHeader","ModalBody","ModalFooter","showCopyTooltip","setShowCopyTooltip","closeIcon","Tooltip","actionableFieldClasses","orderableColumnsClasses","tableClasses","supportsTitle","colSpan","buildQrCodeUrl","margin","useSizeInPath","svgIsSupported","marginIsSupported","stringifyQuery","setSize","setMargin","setFormat","capabilities","qrCodeUrl","totalSize","modalSize","FormGroup","step","Number","src","alt","BooleanControl","checked","inline","uuid","typeClasses","display","htmlFor","Checkbox","InfoModal","UseExistingIfFoundInfoIcon","isModalOpen","toggleModal","normalizeTag","replace","TagsSelector","DomainSelector","shortUrlData","setShortUrlData","isEdit","submit","renderOptionalInput","Input","renderDateInput","m","basicComponents","bsSize","required","showDomainSelector","disableShortCodeLength","showCustomizeCard","limitAccessCardClasses","showValidateUrl","showExtraValidationsCard","Button","goBack","history","shortUrlDetail","getShortUrlDetail","shortUrlEdition","savingError","savingErrorData","savingSucceeded","isSuccessful","isNotSuccessful","faArrowLeft","GET_SHORT_URL_DETAIL_START","GET_SHORT_URL_DETAIL_ERROR","GET_SHORT_URL_DETAIL","find","FormGroupContainer","ServerForm","initialValues","setName","setUrl","setApiKey","handleSubmit","ImportResult","ImportServersBtn","createServer","serversImported","setServersImported","errorImporting","setErrorImporting","serverData","onImport","onImportError","serversExporter","createServerItem","plusIcon","nav","inNavbar","serverIcon","exportServers","exportIcon","DeleteServerModal","deleteServer","showModal","hideModal","editServer","importServersFromFile","createServers","fileRef","files","click","accept","SELECT_SERVER","RESET_SELECTED_SERVER","toSemVer","getServerVersion","_serverId","resetSelectedServer","serverNotFound","serverNotReachable","EDIT_SERVER","DELETE_SERVER","CREATE_SERVERS","newServers","serversListToMap","reduce","acc","responseToServersList","Array","isArray","homepage","remoteList","ForServerVersion","tagsList","loadVisitsOverview","visitsOverview","loadingTags","loadingVisits","orphanVisitsCount","useHistory","CardTitle","CardText","CardHeader","CardBody","CSV_MIME_TYPES","isCsv","file","includes","ServersImporter","csvjson","fileReaderFactory","reader","resolve","addEventListener","content","toString","toObject","readAsText","saveCsv","csv","filename","link","createElement","blob","Blob","createObjectURL","visibility","appendChild","removeChild","ServersExporter","toCSV","FileReader","VisitsHeader","ShortUrlVisitsHeader","shortLink","longLink","visitsStatsTitle","fromNow","PaginationDropdown","toggleClassName","ranges","setValue","Infinity","SimplePaginator","setCurrentPage","DEFAULT","BROWSERS_WHITELIST","extractDomain","split","fillTheGaps","labels","zipObj","pointerOnHover","chartElement","renderNonDoughnutChartLabel","labelToPick","datasets","datasetIndex","datasetLabel","label","renderDoughnutChartLabel","dropLabelIfHidden","startsWith","renderPieChartLegend","config","defaultColor","chartElementAtEvent","chart","_index","_chart","statsAreDefined","DefaultChart","isBarChart","highlightedStats","highlightedLabel","HorizontalBar","Doughnut","highlightedKey","highlightedData","chartRef","setChartRef","legend","legendCallback","scales","xAxes","ticks","beginAtZero","precision","stacked","yAxes","tooltips","intersect","yLabel","callbacks","onHover","graphData","borderColor","borderWidth","generateGraphData","height","determineHeight","element","getElementAtEvent","chartInstance","generateLegend","GraphCard","footer","CardFooter","toLowerIfString","toLower","pickKeyFromPair","pickValueFromPair","SortableBarGraph","sortingItems","extraHeaderContent","withPagination","setItemsPerPage","determineCurrentPagePairs","firstPageLength","i","sortedPairs","pairs","sortBy","reverse","getSortedPairsForStats","sortedKeys","sortedHighlightedPairs","currentPageStats","fromPairs","currentPageHighlightedStats","splitEvery","highlightedPages","determineStats","activeCities","ToggleSwitch","STEPS_MAP","monthly","weekly","daily","hourly","STEP_TO_DATE_UNIT_MAP","STEP_TO_DATE_FORMAT","firstWeekDay","isoWeekday","lastWeekDay","groupVisitsByStep","countBy","generateLabelsAndGroupedVisits","groupedVisitsWithGaps","skipNoElements","unit","newerDate","oldestDate","diff","generateLabels","generateDataset","lineTension","selectedLabel","datasetsByPoint","setSelectedVisits","LineChartCard","highlightedVisits","oldestVisitDate","now","cond","always","matcher","determineInitialStep","setStep","skipNoVisits","toggleSkipNoVisits","visitsToDatasetGroups","groupedVisits","groupedHighlighted","maintainAspectRatio","scaleLabel","labelString","axis","entries","menuText","searchVisits","browser","os","referer","country","city","visitedUrl","visitMatchesSearch","VisitsTable","selectedVisits","matchMedia","isOrphanVisits","headerCellsClass","matchMobile","matches","isMobileDevice","setIsMobileDevice","dir","resultSet","allVisits","sortedVisits","sort","b","greaterThan","smallerThan","sortVisits","total","visitsGroups","calculateVisits","isFirstLoad","setPage","end","start","listener","removeEventListener","flat","checkIcon","isSelected","v","OpenStreetMapTile","TileLayer","attribution","calculateMapProps","locations","bounds","zoom","center","latLong","MapModal","contentClassName","MapContainer","cityName","count","Marker","position","Popup","OpenMapModalBtn","modalTitle","mapIsOpened","openMap","closeMap","dropdownIsOpened","toggleDropdown","openDropdown","locationsToShow","setLocationsToShow","buttonRef","openMapWithLocations","filtered","mapIcon","isOrphanVisit","groupNewVisitsByType","groupBy","newVisit","regularVisits","highlightedVisitsToStats","property","visitHasProperty","propertyName","optionalNumericToNumber","numeric","parseFloat","updateLocationsStatsForVisit","updateCountriesStatsForVisit","updateCitiesStatsForVisit","processStatsFromVisits","osStats","updateOsStatsForVisit","browsersStats","updateBrowsersStatsForVisit","browsers","referrersStats","updateReferrersStatsForVisit","referrers","countries","cities","citiesForMapStats","latitude","longitude","currentCity","updateCitiesForMapForVisit","citiesForMap","visitedUrlsStats","isNormalizedOrphanVisit","updateVisitedUrlsForVisit","visitedUrls","normalizeVisits","userAgent","visitLocation","common","bowser","parseUserAgent","countryName","OrphanVisitTypeDropdown","sections","byTime","subPath","faCalendarAlt","byContext","faChartPie","byLocation","faMapMarkedAlt","list","faList","VisitsNavLink","RouterNavLink","endsWith","VisitsStats","visitsInfo","getVisits","cancelGetVisits","exportCsv","initialInterval","defaultInterval","setDateRange","setHighlightedVisits","setHighlightedLabel","orphanVisitType","setOrphanVisitType","buildSectionUrl","loadingLarge","progress","normalizedVisits","normalizedVisit","normalizeAndFilterVisits","mapLocations","highlightVisitsForProp","newSelectedBar","propEq","faFileDownload","Progress","striped","pills","section","amount","exportVisits","cancelGetShortUrlVisits","ITEMS_PER_PAGE","isLastPage","calcProgress","getVisitsWithLoader","visitsLoader","extraFinishActionData","actionMap","shouldCancel","loadVisitsInParallel","flatten","loadPagesBlocks","pagesBlocks","concat","loadVisits","pagesRange","finish","GET_SHORT_URL_VISITS_START","GET_SHORT_URL_VISITS_ERROR","GET_SHORT_URL_VISITS","GET_SHORT_URL_VISITS_LARGE","GET_SHORT_URL_VISITS_CANCEL","GET_SHORT_URL_VISITS_PROGRESS_CHANGED","cancelLoad","newVisits","TagVisitsHeader","tagVisits","cancelGetTagVisits","GET_TAG_VISITS_START","GET_TAG_VISITS_ERROR","GET_TAG_VISITS","GET_TAG_VISITS_LARGE","GET_TAG_VISITS_CANCEL","GET_TAG_VISITS_PROGRESS_CHANGED","OrphanVisitsHeader","cancelGetOrphanVisits","GET_ORPHAN_VISITS_START","GET_ORPHAN_VISITS_ERROR","GET_ORPHAN_VISITS","GET_ORPHAN_VISITS_LARGE","GET_ORPHAN_VISITS_CANCEL","GET_ORPHAN_VISITS_PROGRESS_CHANGED","GET_OVERVIEW_START","GET_OVERVIEW_ERROR","GET_OVERVIEW","VisitsExporter","visitsParser","TagBullet","noop","inputProps","onlyUnique","renderTag","onRemove","classNameRemove","getTagDisplayValue","other","renderInput","addTag","otherProps","suggestions","highlightFirstSuggestion","shouldRenderSuggestions","getSuggestionValue","suggestion","renderSuggestion","onSuggestionsFetchRequested","onSuggestionsClearRequested","onSuggestionSelected","addOnBlur","TagCard","DeleteTagConfirmModal","EditTagModal","tagStats","displayed","isEditModalOpen","toggleEdit","shortUrlsLink","faLink","shortUrlsCount","faEye","deleteTag","tagDelete","tagDeleted","deleting","doDelete","tagEdited","tagEdit","newTagName","setNewTagName","setColor","showColorPicker","toggleColorPicker","hideColorPicker","editing","saveTag","onClosed","colorIcon","Popover","disableAlpha","hex","filterTags","forceListTags","displayedTag","setDisplayedTag","tagsCount","filteredTags","tagsGroups","group","renderContent","DELETE_TAG_START","DELETE_TAG_ERROR","DELETE_TAG","TAG_DELETED","EDIT_TAG_START","EDIT_TAG_ERROR","EDIT_TAG","TAG_EDITED","pick","LIST_TAGS_START","LIST_TAGS_ERROR","LIST_TAGS","FILTER_TAGS","renameTag","rejectTag","tagToReject","calculateVisitsPerTag","increase","listTagsActionFactory","force","processedStats","factory","GET_MERCURE_INFO_START","GET_MERCURE_INFO_ERROR","GET_MERCURE_INFO","realTimeUpdates","enabled","info","RealTimeUpdates","toggleRealTimeUpdates","setRealTimeUpdatesInterval","SettingsSections","child","subChild","subIndex","ShortUrlCreation","UserInterface","Visits","SET_SETTINGS","mergeDeepRight","setShortUrlCreationSettings","setUiSettings","setVisitsSettings","faMoon","faSun","useDarkTheme","DateIntervalSelector","LIST_DOMAINS_START","LIST_DOMAINS_ERROR","LIST_DOMAINS","domainsList","inputDisplayed","showInput","hideInput","valueIsEmpty","unselectDomain","InputGroup","InputGroupAddon","addonType","faUndo","trigger","isDefault","Bottle","container","lazyService","serviceName","mapActionService","actionName","propsFromState","actionServiceNames","reduxConnect","provideCommonServices","provideApiServices","provideShortUrlsServices","provideServersServices","provideTagsServices","provideVisitsServices","provideUtilsServices","provideMercureServices","provideSettingsServices","provideDomainsServices","combineReducers","serversReducer","selectedServerReducer","shortUrlsListReducer","shortUrlsListParamsReducer","shortUrlCreationReducer","shortUrlDeletionReducer","shortUrlEditionReducer","shortUrlVisitsReducer","tagVisitsReducer","orphanVisitsReducer","shortUrlDetailReducer","tagsListReducer","tagDeleteReducer","tagEditReducer","mercureInfoReducer","settingsReducer","domainsListReducer","visitsOverviewReducer","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","localStorageConfig","states","namespace","namespaceSeparator","debounce","store","createStore","reducers","load","applyMiddleware","save","ReduxThunk","L","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","marker2x","iconUrl","marker","shadowUrl","markerShadow","basename","getElementById"],"mappings":"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","file":"static/js/main.c5c676e3.chunk.js","sourcesContent":["import { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport { SimpleCard } from '../utils/SimpleCard';\n\ninterface NotFoundProps {\n  to?: string;\n}\n\nconst NotFound: FC<NotFoundProps> = ({ to = '/', children = 'Home' }) => (\n  <div className=\"home\">\n    <SimpleCard className=\"p-4\">\n      <h2>Oops! We could not find requested route.</h2>\n      <p>\n        Use your browser&apos;s back button to navigate to the page you have previously come from, or just press this\n        button.\n      </p>\n      <br />\n      <Link to={to} className=\"btn btn-outline-primary btn-lg\">{children}</Link>\n    </SimpleCard>\n  </div>\n);\n\nexport default NotFound;\n","import { MAIN_COLOR } from '../../utils/theme';\n\nexport interface ShlinkLogoProps {\n  color?: string;\n  className?: string;\n}\n\nexport const ShlinkLogo = ({ color = MAIN_COLOR, className }: ShlinkLogoProps) => (\n  <svg className={className} viewBox=\"0 0 512 512\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g fill={color}>\n      <path\n        d=\" M 23.71 85.08 C 17.22 49.81 49.44 14.86 85.08 18.12 C 118.83 19.21 145.72 53.33 139.45 86.37 C 155.64 102.30 171.32 118.83 187.87 134.36 C 198.32 111.73 208.84 89.12 219.57 66.62 C 226.05 53.84 243.47 48.74 255.73 56.27 C 263.76 62.10 270.34 69.69 277.25 76.75 C 286.28 86.61 285.72 102.89 276.31 112.31 C 223.38 165.37 170.38 218.37 117.35 271.34 C 107.72 280.99 91.01 281.25 81.11 271.86 C 74.39 264.94 66.82 258.69 61.24 250.77 C 53.72 238.52 58.85 221.07 71.64 214.62 C 94.11 203.87 116.72 193.38 139.33 182.91 C 123.81 166.36 107.30 150.68 91.37 134.49 C 60.20 140.28 27.37 116.78 23.71 85.08 Z\"\n      />\n      <path\n        d=\" M 205.21 201.23 C 225.32 181.36 260.88 181.11 281.14 200.86 C 299.25 218.75 317.37 236.65 335.10 254.93 C 356.73 278.01 352.01 318.70 326.03 336.56 C 320.07 330.47 313.73 324.65 308.12 318.28 C 323.86 309.39 328.76 286.18 316.63 272.39 C 301.73 256.95 286.30 242.03 271.24 226.75 C 264.49 219.65 256.80 212.00 246.37 211.52 C 224.65 208.64 205.52 233.36 214.49 253.58 C 221.09 266.81 234.22 275.12 243.62 286.24 C 240.43 295.96 238.09 306.13 238.29 316.46 C 225.55 304.29 213.16 291.73 200.89 279.09 C 180.97 257.57 183.10 220.45 205.21 201.23 Z\"\n      />\n      <path\n        d=\" M 273.90 352.07 C 252.28 328.99 256.98 288.31 282.96 270.46 C 288.93 276.54 295.26 282.36 300.88 288.72 C 285.14 297.62 280.23 320.82 292.38 334.61 C 307.27 350.05 322.70 364.96 337.75 380.25 C 344.51 387.35 352.20 395.00 362.64 395.48 C 384.35 398.37 403.49 373.64 394.51 353.42 C 387.92 340.18 374.78 331.88 365.38 320.76 C 368.56 311.04 370.91 300.86 370.71 290.54 C 383.45 302.70 395.84 315.27 408.11 327.91 C 428.03 349.43 425.90 386.55 403.78 405.77 C 383.68 425.64 348.13 425.89 327.86 406.14 C 309.75 388.25 291.60 370.37 273.90 352.07 Z\"\n      />\n      <path\n        d=\" M 422.11 403.83 C 431.96 394.07 441.60 384.06 451.66 374.51 C 460.90 383.74 471.89 392.70 474.89 406.11 C 480.16 429.97 484.08 454.13 488.76 478.12 C 490.00 483.41 484.47 488.29 479.35 486.63 C 454.66 481.52 429.55 478.12 405.14 471.84 C 393.17 467.97 385.20 457.75 376.55 449.27 C 386.39 439.49 396.13 429.60 406.06 419.91 C 416.37 433.45 435.74 414.00 422.11 403.83 Z\"\n      />\n    </g>\n  </svg>\n);\n","import { FC, useEffect } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport Message from '../../utils/Message';\nimport { isNotFoundServer, SelectedServer } from '../data';\nimport NoMenuLayout from '../../common/NoMenuLayout';\n\ninterface WithSelectedServerProps extends RouteComponentProps<{ serverId: string }> {\n  selectServer: (serverId: string) => void;\n  selectedServer: SelectedServer;\n}\n\nexport function withSelectedServer<T = {}>(WrappedComponent: FC<WithSelectedServerProps & T>, ServerError: FC) {\n  return (props: WithSelectedServerProps & T) => {\n    const { selectServer, selectedServer, match } = props;\n\n    useEffect(() => {\n      selectServer(match.params.serverId);\n    }, [ match.params.serverId ]);\n\n    if (!selectedServer) {\n      return (\n        <NoMenuLayout>\n          <Message loading />\n        </NoMenuLayout>\n      );\n    }\n\n    if (isNotFoundServer(selectedServer)) {\n      return <ServerError />;\n    }\n\n    return <WrappedComponent {...props} />;\n  };\n}\n","import { FC } from 'react';\nimport { ListGroup, ListGroupItem } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport classNames from 'classnames';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faChevronRight as chevronIcon } from '@fortawesome/free-solid-svg-icons';\nimport { ServerWithId } from './data';\nimport './ServersListGroup.scss';\n\ninterface ServersListGroupProps {\n  servers: ServerWithId[];\n  embedded?: boolean;\n}\n\nconst ServerListItem = ({ id, name }: { id: string; name: string }) => (\n  <ListGroupItem tag={Link} to={`/server/${id}`} className=\"servers-list__server-item\">\n    {name}\n    <FontAwesomeIcon icon={chevronIcon} className=\"servers-list__server-item-icon\" />\n  </ListGroupItem>\n);\n\nconst ServersListGroup: FC<ServersListGroupProps> = ({ servers, children, embedded = false }) => (\n  <>\n    {children && <h5 className=\"mb-md-3\">{children}</h5>}\n    {servers.length > 0 && (\n      <ListGroup\n        className={classNames('servers-list__list-group', { 'servers-list__list-group--embedded': embedded })}\n      >\n        {servers.map(({ id, name }) => <ServerListItem key={id} id={id} name={name} />)}\n      </ListGroup>\n    )}\n  </>\n);\n\nexport default ServersListGroup;\n","import { useState, useRef } from 'react';\nimport { useSwipeable as useReactSwipeable } from 'react-swipeable';\n\nconst DEFAULT_DELAY = 2000;\n\nexport type StateFlagTimeout = (initialValue?: boolean, delay?: number) => [ boolean, () => void ];\n\nexport const useStateFlagTimeout = (\n  setTimeout: (callback: Function, timeout: number) => number,\n  clearTimeout: (timer: number) => void,\n): StateFlagTimeout => (initialValue = false, delay = DEFAULT_DELAY) => {\n  const [ flag, setFlag ] = useState<boolean>(initialValue);\n  const timeout = useRef<number | undefined>(undefined);\n  const callback = () => {\n    setFlag(!initialValue);\n\n    if (timeout.current) {\n      clearTimeout(timeout.current);\n    }\n\n    timeout.current = setTimeout(() => setFlag(initialValue), delay);\n  };\n\n  return [ flag, callback ];\n};\n\ntype ToggleResult = [ boolean, () => void, () => void, () => void ];\n\nexport const useToggle = (initialValue = false): ToggleResult => {\n  const [ flag, setFlag ] = useState<boolean>(initialValue);\n\n  return [ flag, () => setFlag(!flag), () => setFlag(true), () => setFlag(false) ];\n};\n\nexport const useSwipeable = (showSidebar: () => void, hideSidebar: () => void) => {\n  const swipeMenuIfNoModalExists = (callback: () => void) => (e: any) => {\n    const swippedOnVisitsTable = (e.event.composedPath() as HTMLElement[]).some( // eslint-disable-line @typescript-eslint/no-unsafe-call\n      ({ classList }) => classList?.contains('visits-table'),\n    );\n\n    if (swippedOnVisitsTable || document.querySelector('.modal')) {\n      return;\n    }\n\n    callback();\n  };\n\n  return useReactSwipeable({\n    delta: 40,\n    onSwipedLeft: swipeMenuIfNoModalExists(hideSidebar),\n    onSwipedRight: swipeMenuIfNoModalExists(showSidebar),\n  });\n};\n","import { isEmpty, isNil, pipe, range } from 'ramda';\nimport { SyntheticEvent } from 'react';\n\nexport type OrderDir = 'ASC' | 'DESC' | undefined;\n\nexport const determineOrderDir = <T extends string = string>(\n  currentField: T,\n  newField?: T,\n  currentOrderDir?: OrderDir,\n): OrderDir => {\n  if (currentField !== newField) {\n    return 'ASC';\n  }\n\n  const newOrderMap: Record<'ASC' | 'DESC', OrderDir> = {\n    ASC: 'DESC',\n    DESC: undefined,\n  };\n\n  return currentOrderDir ? newOrderMap[currentOrderDir] : 'ASC';\n};\n\nexport const rangeOf = <T>(size: number, mappingFn: (value: number) => T, startAt = 1): T[] =>\n  range(startAt, size + 1).map(mappingFn);\n\nexport type Empty = null | undefined | '' | never[];\n\nexport const hasValue = <T>(value: T | Empty): value is T => !isNil(value) && !isEmpty(value);\n\nexport const handleEventPreventingDefault = <T>(handler: () => T) => pipe(\n  (e: SyntheticEvent) => e.preventDefault(),\n  handler,\n);\n\nexport type Nullable<T> = {\n  [P in keyof T]: T[P] | null\n};\n\ntype Optional<T> = T | null | undefined;\n\nexport type OptionalString = Optional<string>;\n\nexport type RecursivePartial<T> = {\n  [P in keyof T]?: RecursivePartial<T[P]>;\n};\n","import { SemVer } from '../../utils/helpers/version';\n\nexport interface ServerData {\n  name: string;\n  url: string;\n  apiKey: string;\n}\n\nexport interface ServerWithId extends ServerData {\n  id: string;\n}\n\nexport interface ReachableServer extends ServerWithId {\n  version: SemVer;\n  printableVersion: string;\n}\n\nexport interface NonReachableServer extends ServerWithId {\n  serverNotReachable: true;\n}\n\nexport interface NotFoundServer {\n  serverNotFound: true;\n}\n\nexport type RegularServer = ReachableServer | NonReachableServer;\n\nexport type SelectedServer = RegularServer | NotFoundServer | null;\n\nexport type ServersMap = Record<string, ServerWithId>;\n\nexport const hasServerData = (server: SelectedServer | ServerData): server is ServerData =>\n  !!(server as ServerData)?.url && !!(server as ServerData)?.apiKey;\n\nexport const isServerWithId = (server: SelectedServer | ServerWithId): server is ServerWithId =>\n  !!server?.hasOwnProperty('id');\n\nexport const isReachableServer = (server: SelectedServer): server is ReachableServer =>\n  !!server?.hasOwnProperty('version');\n\nexport const isNotFoundServer = (server: SelectedServer): server is NotFoundServer =>\n  !!server?.hasOwnProperty('serverNotFound');\n","import axios from 'axios';\nimport Bottle, { Decorator } from 'bottlejs';\nimport ScrollToTop from '../ScrollToTop';\nimport MainHeader from '../MainHeader';\nimport Home from '../Home';\nimport MenuLayout from '../MenuLayout';\nimport AsideMenu from '../AsideMenu';\nimport ErrorHandler from '../ErrorHandler';\nimport ShlinkVersionsContainer from '../ShlinkVersionsContainer';\nimport { ConnectDecorator } from '../../container/types';\nimport { withoutSelectedServer } from '../../servers/helpers/withoutSelectedServer';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator, withRouter: Decorator) => {\n  bottle.constant('window', (global as any).window);\n  bottle.constant('console', global.console);\n  bottle.constant('axios', axios);\n\n  bottle.serviceFactory('ScrollToTop', ScrollToTop);\n  bottle.decorator('ScrollToTop', withRouter);\n\n  bottle.serviceFactory('MainHeader', MainHeader, 'ServersDropdown');\n  bottle.decorator('MainHeader', withRouter);\n\n  bottle.serviceFactory('Home', () => Home);\n  bottle.decorator('Home', withoutSelectedServer);\n  bottle.decorator('Home', connect([ 'servers' ], [ 'resetSelectedServer' ]));\n\n  bottle.serviceFactory(\n    'MenuLayout',\n    MenuLayout,\n    'TagsList',\n    'ShortUrls',\n    'AsideMenu',\n    'CreateShortUrl',\n    'ShortUrlVisits',\n    'TagVisits',\n    'OrphanVisits',\n    'ServerError',\n    'Overview',\n    'EditShortUrl',\n  );\n  bottle.decorator('MenuLayout', connect([ 'selectedServer', 'shortUrlsListParams' ], [ 'selectServer' ]));\n  bottle.decorator('MenuLayout', withRouter);\n\n  bottle.serviceFactory('AsideMenu', AsideMenu, 'DeleteServerButton');\n\n  bottle.serviceFactory('ShlinkVersionsContainer', () => ShlinkVersionsContainer);\n  bottle.decorator('ShlinkVersionsContainer', connect([ 'selectedServer' ]));\n\n  bottle.serviceFactory('ErrorHandler', ErrorHandler, 'window', 'console');\n};\n\nexport default provideServices;\n","import { PropsWithChildren, useEffect } from 'react';\nimport { RouteComponentProps } from 'react-router';\n\nconst ScrollToTop = () => ({ location, children }: PropsWithChildren<RouteComponentProps>) => {\n  useEffect(() => {\n    scrollTo(0, 0);\n  }, [ location ]);\n\n  return <>{children}</>;\n};\n\nexport default ScrollToTop;\n","import { Component, ReactNode } from 'react';\nimport { Button } from 'reactstrap';\nimport { SimpleCard } from '../utils/SimpleCard';\n\ninterface ErrorHandlerState {\n  hasError: boolean;\n}\n\nconst ErrorHandler = (\n  { location }: Window,\n  { error }: Console,\n) => class ErrorHandler extends Component<any, ErrorHandlerState> {\n  public constructor(props: object) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  public static getDerivedStateFromError(): ErrorHandlerState {\n    return { hasError: true };\n  }\n\n  public componentDidCatch(e: Error): void {\n    if (process.env.NODE_ENV !== 'development') {\n      error(e);\n    }\n  }\n\n  public render(): ReactNode {\n    if (this.state.hasError) {\n      return (\n        <div className=\"home\">\n          <SimpleCard className=\"p-4\">\n            <h1>Oops! This is awkward :S</h1>\n            <p>It seems that something went wrong. Try refreshing the page or just click this button.</p>\n            <br />\n            <Button outline color=\"primary\" onClick={() => location.reload()}>Take me back</Button>\n          </SimpleCard>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n};\n\nexport default ErrorHandler;\n","import Bottle from 'bottlejs';\nimport { useStateFlagTimeout } from '../helpers/hooks';\nimport LocalStorage from './LocalStorage';\nimport ColorGenerator from './ColorGenerator';\n\nconst provideServices = (bottle: Bottle) => {\n  bottle.constant('localStorage', (global as any).localStorage);\n  bottle.service('Storage', LocalStorage, 'localStorage');\n  bottle.service('ColorGenerator', ColorGenerator, 'Storage');\n\n  bottle.constant('setTimeout', global.setTimeout);\n  bottle.constant('clearTimeout', global.clearTimeout);\n  bottle.serviceFactory('useStateFlagTimeout', useStateFlagTimeout, 'setTimeout', 'clearTimeout');\n};\n\nexport default provideServices;\n","const PREFIX = 'shlink';\nconst buildPath = (path: string) => `${PREFIX}.${path}`;\n\nexport default class LocalStorage {\n  public constructor(private readonly localStorage: Storage) {}\n\n  public readonly get = <T>(key: string): T | undefined => {\n    const item = this.localStorage.getItem(buildPath(key));\n\n    return item ? JSON.parse(item) as T : undefined;\n  };\n\n  public readonly set = (key: string, value: any) => this.localStorage.setItem(buildPath(key), JSON.stringify(value));\n}\n","import { rangeOf } from '../utils';\nimport LocalStorage from './LocalStorage';\n\nconst HEX_COLOR_LENGTH = 6;\nconst { floor, random } = Math;\nconst letters = '0123456789ABCDEF';\nconst buildRandomColor = () => `#${rangeOf(HEX_COLOR_LENGTH, () => letters[floor(random() * letters.length)]).join('')}`;\nconst normalizeKey = (key: string) => key.toLowerCase().trim();\n\nexport default class ColorGenerator {\n  private readonly colors: Record<string, string>;\n\n  public constructor(private readonly storage: LocalStorage) {\n    this.colors = this.storage.get<Record<string, string>>('colors') ?? {};\n  }\n\n  public readonly getColorForKey = (key: string) => {\n    const normalizedKey = normalizeKey(key);\n    const color = this.colors[normalizedKey];\n\n    // If a color has not been set yet, generate a random one and save it\n    if (!color) {\n      return this.setColorForKey(normalizedKey, buildRandomColor());\n    }\n\n    return color;\n  };\n\n  public readonly setColorForKey = (key: string, color: string) => {\n    const normalizedKey = normalizeKey(key);\n\n    this.colors[normalizedKey] = color;\n    this.storage.set('colors', this.colors);\n\n    return color;\n  };\n}\n","import { pipe } from 'ramda';\nimport { ExternalLink } from 'react-external-link';\nimport { versionToPrintable, versionToSemVer } from '../utils/helpers/version';\nimport { isReachableServer } from '../servers/data';\nimport { ShlinkVersionsContainerProps } from './ShlinkVersionsContainer';\n\nconst SHLINK_WEB_CLIENT_VERSION = '%_VERSION_%';\nconst normalizeVersion = pipe(versionToSemVer(), versionToPrintable);\n\nexport interface ShlinkVersionsProps extends ShlinkVersionsContainerProps {\n  clientVersion?: string;\n}\n\nconst VersionLink = ({ project, version }: { project: 'shlink' | 'shlink-web-client'; version: string }) => (\n  <ExternalLink href={`https://github.com/shlinkio/${project}/releases/${version}`} className=\"text-muted\">\n    <b>{version}</b>\n  </ExternalLink>\n);\n\nconst ShlinkVersions = ({ selectedServer, clientVersion = SHLINK_WEB_CLIENT_VERSION }: ShlinkVersionsProps) => {\n  const normalizedClientVersion = normalizeVersion(clientVersion);\n\n  return (\n    <small className=\"text-muted\">\n      {isReachableServer(selectedServer) &&\n        <>Server: <VersionLink project=\"shlink\" version={selectedServer.printableVersion} /> - </>\n      }\n      Client: <VersionLink project=\"shlink-web-client\" version={normalizedClientVersion} />\n    </small>\n  );\n};\n\nexport default ShlinkVersions;\n","import classNames from 'classnames';\nimport { isReachableServer, SelectedServer } from '../servers/data';\nimport ShlinkVersions from './ShlinkVersions';\nimport './ShlinkVersionsContainer.scss';\n\nexport interface ShlinkVersionsContainerProps {\n  selectedServer: SelectedServer;\n}\n\nconst ShlinkVersionsContainer = ({ selectedServer }: ShlinkVersionsContainerProps) => {\n  const classes = classNames('text-center', {\n    'shlink-versions-container--with-server': isReachableServer(selectedServer),\n  });\n\n  return (\n    <div className={classes}>\n      <ShlinkVersions selectedServer={selectedServer} />\n    </div>\n  );\n};\n\nexport default ShlinkVersionsContainer;\n","import { faChevronDown as arrowIcon, faCogs as cogsIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { FC, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Collapse, Nav, Navbar, NavbarBrand, NavbarToggler, NavItem, NavLink } from 'reactstrap';\nimport classNames from 'classnames';\nimport { RouteComponentProps } from 'react-router';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { ShlinkLogo } from './img/ShlinkLogo';\nimport './MainHeader.scss';\n\nconst MainHeader = (ServersDropdown: FC) => ({ location }: RouteComponentProps) => {\n  const [ isOpen, toggleOpen, , close ] = useToggle();\n  const { pathname } = location;\n\n  useEffect(close, [ location ]);\n\n  const settingsPath = '/settings';\n  const toggleClass = classNames('main-header__toggle-icon', { 'main-header__toggle-icon--opened': isOpen });\n\n  return (\n    <Navbar color=\"primary\" dark fixed=\"top\" className=\"main-header\" expand=\"md\">\n      <NavbarBrand tag={Link} to=\"/\">\n        <ShlinkLogo className=\"main-header__brand-logo\" color=\"white\" /> Shlink\n      </NavbarBrand>\n\n      <NavbarToggler onClick={toggleOpen}>\n        <FontAwesomeIcon icon={arrowIcon} className={toggleClass} />\n      </NavbarToggler>\n\n      <Collapse navbar isOpen={isOpen}>\n        <Nav navbar className=\"ml-auto\">\n          <NavItem>\n            <NavLink tag={Link} to={'/settings'} active={pathname === settingsPath}>\n              <FontAwesomeIcon icon={cogsIcon} />&nbsp; Settings\n            </NavLink>\n          </NavItem>\n          <ServersDropdown />\n        </Nav>\n      </Collapse>\n    </Navbar>\n  );\n};\n\nexport default MainHeader;\n","import { isEmpty, values } from 'ramda';\nimport { Link } from 'react-router-dom';\nimport { Card, Row } from 'reactstrap';\nimport { ExternalLink } from 'react-external-link';\nimport ServersListGroup from '../servers/ServersListGroup';\nimport './Home.scss';\nimport { ServersMap } from '../servers/data';\nimport { ShlinkLogo } from './img/ShlinkLogo';\n\nexport interface HomeProps {\n  servers: ServersMap;\n}\n\nconst Home = ({ servers }: HomeProps) => {\n  const serversList = values(servers);\n  const hasServers = !isEmpty(serversList);\n\n  return (\n    <div className=\"home\">\n      <Card className=\"home__main-card\">\n        <Row noGutters>\n          <div className=\"col-md-5 d-none d-md-block\">\n            <div className=\"p-4\">\n              <ShlinkLogo />\n            </div>\n          </div>\n          <div className=\"col-md-7 home__servers-container\">\n            <div className=\"p-4\">\n              <h1 className=\"home__title\" style={{ background: 'red' }}>Edited twelve times!</h1>\n            </div>\n            <ServersListGroup embedded servers={serversList}>\n              {!hasServers && (\n                <div className=\"p-4\">\n                  <p>This application will help you to manage your Shlink servers.</p>\n                  <p>To start, please, <Link to=\"/server/create\">add your first server</Link>.</p>\n                  <p className=\"m-0\">\n                    You still don&lsquo;t have a Shlink server?\n                    Learn how to <ExternalLink href=\"https://shlink.io/documentation\">get started</ExternalLink>.\n                  </p>\n                </div>\n              )}\n            </ServersListGroup>\n          </div>\n        </Row>\n      </Card>\n    </div>\n  );\n};\n\nexport default Home;\n","import { FC, useEffect } from 'react';\nimport { Redirect, Route, Switch } from 'react-router-dom';\nimport { faBars as burgerIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport classNames from 'classnames';\nimport { withSelectedServer } from '../servers/helpers/withSelectedServer';\nimport { useSwipeable, useToggle } from '../utils/helpers/hooks';\nimport { supportsOrphanVisits, supportsTagVisits } from '../utils/helpers/features';\nimport { isReachableServer } from '../servers/data';\nimport NotFound from './NotFound';\nimport { AsideMenuProps } from './AsideMenu';\nimport './MenuLayout.scss';\n\nconst MenuLayout = (\n  TagsList: FC,\n  ShortUrls: FC,\n  AsideMenu: FC<AsideMenuProps>,\n  CreateShortUrl: FC,\n  ShortUrlVisits: FC,\n  TagVisits: FC,\n  OrphanVisits: FC,\n  ServerError: FC,\n  Overview: FC,\n  EditShortUrl: FC,\n) => withSelectedServer(({ location, selectedServer }) => {\n  const [ sidebarVisible, toggleSidebar, showSidebar, hideSidebar ] = useToggle();\n\n  useEffect(() => hideSidebar(), [ location ]);\n\n  if (!isReachableServer(selectedServer)) {\n    return <ServerError />;\n  }\n\n  const addTagsVisitsRoute = supportsTagVisits(selectedServer);\n  const addOrphanVisitsRoute = supportsOrphanVisits(selectedServer);\n  const burgerClasses = classNames('menu-layout__burger-icon', { 'menu-layout__burger-icon--active': sidebarVisible });\n  const swipeableProps = useSwipeable(showSidebar, hideSidebar);\n\n  return (\n    <>\n      <FontAwesomeIcon icon={burgerIcon} className={burgerClasses} onClick={toggleSidebar} />\n\n      <div {...swipeableProps} className=\"menu-layout__swipeable\">\n        <div className=\"menu-layout__swipeable-inner\">\n          <AsideMenu selectedServer={selectedServer} showOnMobile={sidebarVisible} />\n          <div className=\"menu-layout__container\" onClick={() => hideSidebar()}>\n            <div className=\"container-xl\">\n              <Switch>\n                <Redirect exact from=\"/server/:serverId\" to=\"/server/:serverId/overview\" />\n                <Route exact path=\"/server/:serverId/overview\" component={Overview} />\n                <Route exact path=\"/server/:serverId/list-short-urls/:page\" component={ShortUrls} />\n                <Route exact path=\"/server/:serverId/create-short-url\" component={CreateShortUrl} />\n                <Route path=\"/server/:serverId/short-code/:shortCode/visits\" component={ShortUrlVisits} />\n                <Route path=\"/server/:serverId/short-code/:shortCode/edit\" component={EditShortUrl} />\n                {addTagsVisitsRoute && <Route path=\"/server/:serverId/tag/:tag/visits\" component={TagVisits} />}\n                {addOrphanVisitsRoute && <Route path=\"/server/:serverId/orphan-visits\" component={OrphanVisits} />}\n                <Route exact path=\"/server/:serverId/manage-tags\" component={TagsList} />\n                <Route\n                  render={() => <NotFound to={`/server/${selectedServer.id}/list-short-urls/1`}>List short URLs</NotFound>}\n                />\n              </Switch>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}, ServerError);\n\nexport default MenuLayout;\n","import {\n  faList as listIcon,\n  faLink as createIcon,\n  faTags as tagsIcon,\n  faPen as editIcon,\n  faHome as overviewIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { FC } from 'react';\nimport { NavLink, NavLinkProps } from 'react-router-dom';\nimport classNames from 'classnames';\nimport { Location } from 'history';\nimport { DeleteServerButtonProps } from '../servers/DeleteServerButton';\nimport { ServerWithId } from '../servers/data';\nimport './AsideMenu.scss';\n\nexport interface AsideMenuProps {\n  selectedServer: ServerWithId;\n  className?: string;\n  showOnMobile?: boolean;\n}\n\ninterface AsideMenuItemProps extends NavLinkProps {\n  to: string;\n}\n\nconst AsideMenuItem: FC<AsideMenuItemProps> = ({ children, to, className, ...rest }) => (\n  <NavLink\n    className={classNames('aside-menu__item', className)}\n    activeClassName=\"aside-menu__item--selected\"\n    to={to}\n    {...rest}\n  >\n    {children}\n  </NavLink>\n);\n\nconst AsideMenu = (DeleteServerButton: FC<DeleteServerButtonProps>) => (\n  { selectedServer, showOnMobile = false }: AsideMenuProps,\n) => {\n  const serverId = selectedServer ? selectedServer.id : '';\n  const asideClass = classNames('aside-menu', {\n    'aside-menu--hidden': !showOnMobile,\n  });\n  const shortUrlsIsActive = (_: null, location: Location) => location.pathname.match('/list-short-urls') !== null;\n  const buildPath = (suffix: string) => `/server/${serverId}${suffix}`;\n\n  return (\n    <aside className={asideClass}>\n      <nav className=\"nav flex-column aside-menu__nav\">\n        <AsideMenuItem to={buildPath('/overview')}>\n          <FontAwesomeIcon icon={overviewIcon} />\n          <span className=\"aside-menu__item-text\">Overview</span>\n        </AsideMenuItem>\n        <AsideMenuItem to={buildPath('/list-short-urls/1')} isActive={shortUrlsIsActive}>\n          <FontAwesomeIcon icon={listIcon} />\n          <span className=\"aside-menu__item-text\">List short URLs</span>\n        </AsideMenuItem>\n        <AsideMenuItem to={buildPath('/create-short-url')}>\n          <FontAwesomeIcon icon={createIcon} flip=\"horizontal\" />\n          <span className=\"aside-menu__item-text\">Create short URL</span>\n        </AsideMenuItem>\n        <AsideMenuItem to={buildPath('/manage-tags')}>\n          <FontAwesomeIcon icon={tagsIcon} />\n          <span className=\"aside-menu__item-text\">Manage tags</span>\n        </AsideMenuItem>\n        <AsideMenuItem to={buildPath('/edit')} className=\"aside-menu__item--push\">\n          <FontAwesomeIcon icon={editIcon} />\n          <span className=\"aside-menu__item-text\">Edit this server</span>\n        </AsideMenuItem>\n        <DeleteServerButton\n          className=\"aside-menu__item aside-menu__item--danger\"\n          textClassName=\"aside-menu__item-text\"\n          server={selectedServer}\n        />\n      </nav>\n    </aside>\n  );\n};\n\nexport default AsideMenu;\n","import { CardProps } from 'reactstrap/lib/Card';\nimport { Card, CardBody, CardHeader } from 'reactstrap';\nimport { ReactNode } from 'react';\n\ninterface SimpleCardProps extends Omit<CardProps, 'title'> {\n  title?: ReactNode;\n  bodyClassName?: string;\n}\n\nexport const SimpleCard = ({ title, children, bodyClassName, ...rest }: SimpleCardProps) => (\n  <Card {...rest}>\n    {title && <CardHeader>{title}</CardHeader>}\n    <CardBody className={bodyClassName}>{children}</CardBody>\n  </Card>\n);\n","export const MAIN_COLOR = '#4696e5';\n\nexport const MAIN_COLOR_ALPHA = 'rgba(70, 150, 229, 0.4)';\n\nexport const HIGHLIGHTED_COLOR = '#f77f28';\n\nexport const HIGHLIGHTED_COLOR_ALPHA = 'rgba(247, 127, 40, 0.4)';\n\nexport const PRIMARY_LIGHT_COLOR = 'white';\n\nexport const PRIMARY_DARK_COLOR = '#161b22';\n\nexport type Theme = 'dark' | 'light';\n\nexport const changeThemeInMarkup = (theme: Theme) => {\n  const html = document.getElementsByTagName('html');\n\n  html?.[0]?.setAttribute('data-theme', theme);\n};\n\nexport const isDarkThemeEnabled = (): boolean => {\n  const html = document.getElementsByTagName('html');\n\n  return html?.[0]?.getAttribute('data-theme') === 'dark';\n};\n","import { isReachableServer, SelectedServer } from '../../servers/data';\nimport { versionMatch, Versions } from './version';\n\nconst serverMatchesVersions = (versions: Versions) => (selectedServer: SelectedServer): boolean =>\n  isReachableServer(selectedServer) && versionMatch(selectedServer.version, versions);\n\nexport const supportsSettingShortCodeLength = serverMatchesVersions({ minVersion: '2.1.0' });\n\nexport const supportsTagVisits = serverMatchesVersions({ minVersion: '2.2.0' });\n\nexport const supportsListingDomains = serverMatchesVersions({ minVersion: '2.4.0' });\n\nexport const supportsQrCodeSvgFormat = supportsListingDomains;\n\nexport const supportsValidateUrl = supportsListingDomains;\n\nexport const supportsQrCodeSizeInQuery = serverMatchesVersions({ minVersion: '2.5.0' });\n\nexport const supportsShortUrlTitle = serverMatchesVersions({ minVersion: '2.6.0' });\n\nexport const supportsOrphanVisits = supportsShortUrlTitle;\n\nexport const supportsQrCodeMargin = supportsShortUrlTitle;\n\nexport const supportsTagsInPatch = supportsShortUrlTitle;\n","import { FC } from 'react';\nimport { Card, Row } from 'reactstrap';\nimport classNames from 'classnames';\nimport { faCircleNotch as preloader } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\ntype MessageType = 'default' | 'error';\n\nconst getClassForType = (type: MessageType) => {\n  const map: Record<MessageType, string> = {\n    error: 'border-danger',\n    default: '',\n  };\n\n  return map[type];\n};\nconst getTextClassForType = (type: MessageType) => {\n  const map: Record<MessageType, string> = {\n    error: 'text-danger',\n    default: 'text-muted',\n  };\n\n  return map[type];\n};\n\nexport interface MessageProps {\n  className?: string;\n  loading?: boolean;\n  fullWidth?: boolean;\n  type?: MessageType;\n}\n\nconst Message: FC<MessageProps> = ({ className, children, loading = false, type = 'default', fullWidth = false }) => {\n  const classes = classNames({\n    'col-md-12': fullWidth,\n    'col-md-10 offset-md-1': !fullWidth,\n  });\n\n  return (\n    <Row noGutters className={className}>\n      <div className={classes}>\n        <Card className={getClassForType(type)} body>\n          <h3 className={classNames('text-center mb-0', getTextClassForType(type))}>\n            {loading && <FontAwesomeIcon icon={preloader} spin />}\n            {loading && <span className=\"ml-2\">{children ?? 'Loading...'}</span>}\n            {!loading && children}\n          </h3>\n        </Card>\n      </div>\n    </Row>\n  );\n};\n\nexport default Message;\n","import { FC } from 'react';\nimport './NoMenuLayout.scss';\n\nconst NoMenuLayout: FC = ({ children }) => <div className=\"no-menu-wrapper container-xl\">{children}</div>;\n\nexport default NoMenuLayout;\n","import { compare } from 'compare-versions';\nimport { identity, memoizeWith } from 'ramda';\nimport { Empty, hasValue } from '../utils';\n\ntype SemVerPatternFragment = `${bigint | '*'}`;\n\nexport type SemVerPattern = SemVerPatternFragment\n| `${SemVerPatternFragment}.${SemVerPatternFragment}`\n| `${SemVerPatternFragment}.${SemVerPatternFragment}.${SemVerPatternFragment}`;\n\nexport interface Versions {\n  maxVersion?: SemVerPattern;\n  minVersion?: SemVerPattern;\n}\n\nexport type SemVer = `${bigint}.${bigint}.${bigint}` | 'latest';\n\nexport const versionMatch = (versionToMatch: SemVer | Empty, { maxVersion, minVersion }: Versions): boolean => {\n  if (!hasValue(versionToMatch)) {\n    return false;\n  }\n\n  const matchesMinVersion = !minVersion || compare(versionToMatch, minVersion, '>=');\n  const matchesMaxVersion = !maxVersion || compare(versionToMatch, maxVersion, '<=');\n\n  return matchesMaxVersion && matchesMinVersion;\n};\n\nconst versionIsValidSemVer = memoizeWith(identity, (version: string): version is SemVer => {\n  try {\n    return compare(version, version, '=');\n  } catch (e) {\n    return false;\n  }\n});\n\nexport const versionToPrintable = (version: string) => !versionIsValidSemVer(version) ? version : `v${version}`;\n\nexport const versionToSemVer = (defaultValue: SemVer = 'latest') =>\n  (version: string): SemVer => versionIsValidSemVer(version) ? version : defaultValue;\n","import { useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSearch as searchIcon } from '@fortawesome/free-solid-svg-icons';\nimport classNames from 'classnames';\nimport './SearchField.scss';\n\nconst DEFAULT_SEARCH_INTERVAL = 500;\nlet timer: NodeJS.Timeout | null;\n\ninterface SearchFieldProps {\n  onChange: (value: string) => void;\n  className?: string;\n  placeholder?: string;\n  large?: boolean;\n  noBorder?: boolean;\n}\n\nconst SearchField = (\n  { onChange, className, placeholder = 'Search...', large = true, noBorder = false }: SearchFieldProps,\n) => {\n  const [ searchTerm, setSearchTerm ] = useState('');\n\n  const resetTimer = () => {\n    timer && clearTimeout(timer);\n    timer = null;\n  };\n  const searchTermChanged = (newSearchTerm: string, timeout = DEFAULT_SEARCH_INTERVAL) => {\n    setSearchTerm(newSearchTerm);\n\n    resetTimer();\n\n    timer = setTimeout(() => {\n      onChange(newSearchTerm);\n      resetTimer();\n    }, timeout);\n  };\n\n  return (\n    <div className={classNames('search-field', className)}>\n      <input\n        type=\"text\"\n        className={classNames('form-control search-field__input', {\n          'form-control-lg': large,\n          'search-field__input--no-border': noBorder,\n        })}\n        placeholder={placeholder}\n        value={searchTerm}\n        onChange={(e) => searchTermChanged(e.target.value)}\n      />\n      <FontAwesomeIcon icon={searchIcon} className=\"search-field__icon\" />\n      <div\n        className=\"close search-field__close\"\n        hidden={searchTerm === ''}\n        id=\"search-field__close\"\n        onClick={() => searchTermChanged('', 0)}\n      >\n        &times;\n      </div>\n    </div>\n  );\n};\n\nexport default SearchField;\n","import { useEffect, FC } from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport NotFound from './common/NotFound';\nimport { ServersMap } from './servers/data';\nimport { Settings } from './settings/reducers/settings';\nimport { changeThemeInMarkup } from './utils/theme';\nimport './App.scss';\n\ninterface AppProps {\n  fetchServers: Function;\n  servers: ServersMap;\n  settings: Settings;\n}\n\nconst App = (\n  MainHeader: FC,\n  Home: FC,\n  MenuLayout: FC,\n  CreateServer: FC,\n  EditServer: FC,\n  Settings: FC,\n  ShlinkVersionsContainer: FC,\n) => ({ fetchServers, servers, settings }: AppProps) => {\n  useEffect(() => {\n    // On first load, try to fetch the remote servers if the list is empty\n    if (Object.keys(servers).length === 0) {\n      fetchServers();\n    }\n\n    changeThemeInMarkup(settings.ui?.theme ?? 'light');\n  }, []);\n\n  return (\n    <div className=\"container-fluid app-container\">\n      <MainHeader />\n\n      <div className=\"app\">\n        <div className=\"shlink-wrapper\">\n          <Switch>\n            <Route exact path=\"/\" component={Home} />\n            <Route exact path=\"/settings\" component={Settings} />\n            <Route exact path=\"/server/create\" component={CreateServer} />\n            <Route exact path=\"/server/:serverId/edit\" component={EditServer} />\n            <Route path=\"/server/:serverId\" component={MenuLayout} />\n            <Route component={NotFound} />\n          </Switch>\n        </div>\n\n        <div className=\"shlink-footer\">\n          <ShlinkVersionsContainer />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import qs from 'qs';\nimport { isEmpty, isNil, reject } from 'ramda';\nimport { AxiosInstance, AxiosResponse, Method } from 'axios';\nimport { ShortUrlsListParams } from '../../short-urls/reducers/shortUrlsListParams';\nimport { ShortUrl, ShortUrlData } from '../../short-urls/data';\nimport { OptionalString } from '../../utils/utils';\nimport {\n  ShlinkHealth,\n  ShlinkMercureInfo,\n  ShlinkShortUrlsResponse,\n  ShlinkTags,\n  ShlinkTagsResponse,\n  ShlinkVisits,\n  ShlinkVisitsParams,\n  ShlinkShortUrlData,\n  ShlinkDomain,\n  ShlinkDomainsResponse,\n  ShlinkVisitsOverview,\n} from '../types';\n\nconst buildShlinkBaseUrl = (url: string, apiVersion: number) => url ? `${url}/rest/v${apiVersion}` : '';\nconst rejectNilProps = reject(isNil);\n\nexport default class ShlinkApiClient {\n  private apiVersion: number;\n\n  public constructor(\n    private readonly axios: AxiosInstance,\n    private readonly baseUrl: string,\n    private readonly apiKey: string,\n  ) {\n    this.apiVersion = 2;\n  }\n\n  public readonly listShortUrls = async (params: ShortUrlsListParams = {}): Promise<ShlinkShortUrlsResponse> =>\n    this.performRequest<{ shortUrls: ShlinkShortUrlsResponse }>('/short-urls', 'GET', params)\n      .then(({ data }) => data.shortUrls);\n\n  public readonly createShortUrl = async (options: ShortUrlData): Promise<ShortUrl> => {\n    const filteredOptions = reject((value) => isEmpty(value) || isNil(value), options as any);\n\n    return this.performRequest<ShortUrl>('/short-urls', 'POST', {}, filteredOptions)\n      .then((resp) => resp.data);\n  };\n\n  public readonly getShortUrlVisits = async (shortCode: string, query?: ShlinkVisitsParams): Promise<ShlinkVisits> =>\n    this.performRequest<{ visits: ShlinkVisits }>(`/short-urls/${shortCode}/visits`, 'GET', query)\n      .then(({ data }) => data.visits);\n\n  public readonly getTagVisits = async (tag: string, query?: Omit<ShlinkVisitsParams, 'domain'>): Promise<ShlinkVisits> =>\n    this.performRequest<{ visits: ShlinkVisits }>(`/tags/${tag}/visits`, 'GET', query)\n      .then(({ data }) => data.visits);\n\n  public readonly getOrphanVisits = async (query?: Omit<ShlinkVisitsParams, 'domain'>): Promise<ShlinkVisits> =>\n    this.performRequest<{ visits: ShlinkVisits }>('/visits/orphan', 'GET', query)\n      .then(({ data }) => data.visits);\n\n  public readonly getVisitsOverview = async (): Promise<ShlinkVisitsOverview> =>\n    this.performRequest<{ visits: ShlinkVisitsOverview }>('/visits', 'GET')\n      .then(({ data }) => data.visits);\n\n  public readonly getShortUrl = async (shortCode: string, domain?: OptionalString): Promise<ShortUrl> =>\n    this.performRequest<ShortUrl>(`/short-urls/${shortCode}`, 'GET', { domain })\n      .then(({ data }) => data);\n\n  public readonly deleteShortUrl = async (shortCode: string, domain?: OptionalString): Promise<void> =>\n    this.performRequest(`/short-urls/${shortCode}`, 'DELETE', { domain })\n      .then(() => {});\n\n  /* @deprecated. If using Shlink 2.6.0 or greater, use updateShortUrl instead */\n  public readonly updateShortUrlTags = async (\n    shortCode: string,\n    domain: OptionalString,\n    tags: string[],\n  ): Promise<string[]> =>\n    this.performRequest<{ tags: string[] }>(`/short-urls/${shortCode}/tags`, 'PUT', { domain }, { tags })\n      .then(({ data }) => data.tags);\n\n  public readonly updateShortUrl = async (\n    shortCode: string,\n    domain: OptionalString,\n    data: ShlinkShortUrlData,\n  ): Promise<ShortUrl> =>\n    this.performRequest<ShortUrl>(`/short-urls/${shortCode}`, 'PATCH', { domain }, data)\n      .then(({ data }) => data);\n\n  public readonly listTags = async (): Promise<ShlinkTags> =>\n    this.performRequest<{ tags: ShlinkTagsResponse }>('/tags', 'GET', { withStats: 'true' })\n      .then((resp) => resp.data.tags)\n      .then(({ data, stats }) => ({ tags: data, stats }));\n\n  public readonly deleteTags = async (tags: string[]): Promise<{ tags: string[] }> =>\n    this.performRequest('/tags', 'DELETE', { tags })\n      .then(() => ({ tags }));\n\n  public readonly editTag = async (oldName: string, newName: string): Promise<{ oldName: string; newName: string }> =>\n    this.performRequest('/tags', 'PUT', {}, { oldName, newName })\n      .then(() => ({ oldName, newName }));\n\n  public readonly health = async (): Promise<ShlinkHealth> =>\n    this.performRequest<ShlinkHealth>('/health', 'GET')\n      .then((resp) => resp.data);\n\n  public readonly mercureInfo = async (): Promise<ShlinkMercureInfo> =>\n    this.performRequest<ShlinkMercureInfo>('/mercure-info', 'GET')\n      .then((resp) => resp.data);\n\n  public readonly listDomains = async (): Promise<ShlinkDomain[]> =>\n    this.performRequest<{ domains: ShlinkDomainsResponse }>('/domains', 'GET').then(({ data }) => data.domains.data);\n\n  private readonly performRequest = async <T>(url: string, method: Method = 'GET', query = {}, body = {}): Promise<AxiosResponse<T>> => {\n    try {\n      return await this.axios({\n        method,\n        url: `${buildShlinkBaseUrl(this.baseUrl, this.apiVersion)}${url}`,\n        headers: { 'X-Api-Key': this.apiKey },\n        params: rejectNilProps(query),\n        data: body,\n        paramsSerializer: (params) => qs.stringify(params, { arrayFormat: 'brackets' }),\n      });\n    } catch (e) {\n      const { response } = e;\n\n      // Due to a bug on all previous Shlink versions, requests to non-matching URLs will always result on a CORS error\n      // when performed from the browser (due to the preflight request not returning a 2xx status.\n      // See https://github.com/shlinkio/shlink/issues/614), which will make the \"response\" prop not to be set here.\n      // The bug will be fixed on upcoming Shlink patches, but for other versions, we can consider this situation as\n      // if a request has been performed to a not supported API version.\n      const apiVersionIsNotSupported = !response;\n\n      // When the request is not invalid or we have already tried both API versions, throw the error and let the\n      // caller handle it\n      if (!apiVersionIsNotSupported || this.apiVersion === 2) {\n        throw e;\n      }\n\n      this.apiVersion = this.apiVersion - 1;\n\n      return await this.performRequest(url, method, query, body);\n    }\n  };\n}\n","import { AxiosInstance } from 'axios';\nimport { prop } from 'ramda';\nimport { hasServerData, SelectedServer, ServerWithId } from '../../servers/data';\nimport { GetState } from '../../container/types';\nimport ShlinkApiClient from './ShlinkApiClient';\n\nconst apiClients: Record<string, ShlinkApiClient> = {};\n\nconst isGetState = (getStateOrSelectedServer: GetState | ServerWithId): getStateOrSelectedServer is GetState =>\n  typeof getStateOrSelectedServer === 'function';\nconst getSelectedServerFromState = (getState: GetState): SelectedServer => prop('selectedServer', getState());\n\nexport type ShlinkApiClientBuilder = (getStateOrSelectedServer: GetState | ServerWithId) => ShlinkApiClient;\n\nconst buildShlinkApiClient = (axios: AxiosInstance): ShlinkApiClientBuilder => (\n  getStateOrSelectedServer: GetState | ServerWithId,\n) => {\n  const server = isGetState(getStateOrSelectedServer)\n    ? getSelectedServerFromState(getStateOrSelectedServer)\n    : getStateOrSelectedServer;\n\n  if (!hasServerData(server)) {\n    throw new Error('There\\'s no selected server or it is not found');\n  }\n\n  const { url, apiKey } = server;\n  const clientKey = `${url}_${apiKey}`;\n\n  if (!apiClients[clientKey]) {\n    apiClients[clientKey] = new ShlinkApiClient(axios, url, apiKey);\n  }\n\n  return apiClients[clientKey];\n};\n\nexport default buildShlinkApiClient;\n","import Bottle from 'bottlejs';\nimport buildShlinkApiClient from './ShlinkApiClientBuilder';\n\nconst provideServices = (bottle: Bottle) => {\n  bottle.serviceFactory('buildShlinkApiClient', buildShlinkApiClient, 'axios');\n};\n\nexport default provideServices;\n","import { FC, useEffect, useState } from 'react';\nimport { ShortUrlsListProps } from './ShortUrlsList';\n\nconst ShortUrls = (SearchBar: FC, ShortUrlsList: FC<ShortUrlsListProps>) => (props: ShortUrlsListProps) => {\n  const { match } = props;\n  const { page = '1', serverId = '' } = match?.params ?? {};\n  const [ urlsListKey, setUrlsListKey ] = useState(`${serverId}_${page}`);\n\n  // Using a key on a component makes react to create a new instance every time the key changes\n  // Without it, pagination on the URL will not make the component to be refreshed\n  useEffect(() => {\n    setUrlsListKey(`${serverId}_${page}`);\n  }, [ serverId, page ]);\n\n  return (\n    <>\n      <div className=\"form-group\"><SearchBar /></div>\n      <ShortUrlsList {...props} key={urlsListKey} />\n    </>\n  );\n};\n\nexport default ShortUrls;\n","import { FC } from 'react';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport './Tag.scss';\n\ninterface TagProps {\n  colorGenerator: ColorGenerator;\n  text: string;\n  clearable?: boolean;\n  onClick?: () => void;\n  onClose?: () => void;\n}\n\nconst Tag: FC<TagProps> = ({ text, children, clearable, colorGenerator, onClick, onClose }) => (\n  <span\n    className=\"badge tag\"\n    style={{ backgroundColor: colorGenerator.getColorForKey(text), cursor: clearable || !onClick ? 'auto' : 'pointer' }}\n    onClick={onClick}\n  >\n    {children ?? text}\n    {clearable && <span className=\"close tag__close-selected-tag\" onClick={onClose}>&times;</span>}\n  </span>\n);\n\nexport default Tag;\n","import { FC } from 'react';\nimport { Dropdown, DropdownMenu, DropdownToggle } from 'reactstrap';\nimport { useToggle } from './helpers/hooks';\nimport './DropdownBtn.scss';\n\nexport interface DropdownBtnProps {\n  text: string;\n  disabled?: boolean;\n  className?: string;\n  dropdownClassName?: string;\n  right?: boolean;\n}\n\nexport const DropdownBtn: FC<DropdownBtnProps> = (\n  { text, disabled = false, className = '', children, dropdownClassName, right = false },\n) => {\n  const [ isOpen, toggle ] = useToggle();\n  const toggleClasses = `dropdown-btn__toggle btn-block ${className}`;\n\n  return (\n    <Dropdown isOpen={isOpen} toggle={toggle} disabled={disabled} className={dropdownClassName}>\n      <DropdownToggle caret className={toggleClasses} color=\"primary\">{text}</DropdownToggle>\n      <DropdownMenu className=\"w-100\" right={right}>{children}</DropdownMenu>\n    </Dropdown>\n  );\n};\n","import * as moment from 'moment';\nimport { OptionalString } from '../utils';\n\ntype MomentOrString = moment.Moment | string;\ntype NullableDate = MomentOrString | null;\n\nconst isMomentObject = (date: MomentOrString): date is moment.Moment => typeof (date as moment.Moment).format === 'function';\n\nconst formatDateFromFormat = (date?: NullableDate, format?: string): OptionalString =>\n  !date || !isMomentObject(date) ? date : date.format(format);\n\nexport const formatDate = (format = 'YYYY-MM-DD') => (date?: NullableDate) => formatDateFromFormat(date, format);\n\nexport const formatIsoDate = (date?: NullableDate) => formatDateFromFormat(date, undefined);\n\nexport const formatInternational = formatDate();\n","import moment from 'moment';\nimport { filter, isEmpty } from 'ramda';\nimport { formatInternational } from '../../helpers/date';\n\nexport interface DateRange {\n  startDate?: moment.Moment | null;\n  endDate?: moment.Moment | null;\n}\n\nexport type DateInterval = 'today' | 'yesterday' | 'last7Days' | 'last30Days' | 'last90Days' | 'last180days' | 'last365Days';\n\nexport const dateRangeIsEmpty = (dateRange?: DateRange): boolean => dateRange === undefined\n  || isEmpty(filter(Boolean, dateRange as any));\n\nexport const rangeIsInterval = (range?: DateRange | DateInterval): range is DateInterval => typeof range === 'string';\n\nconst INTERVAL_TO_STRING_MAP: Record<DateInterval, string> = {\n  today: 'Today',\n  yesterday: 'Yesterday',\n  last7Days: 'Last 7 days',\n  last30Days: 'Last 30 days',\n  last90Days: 'Last 90 days',\n  last180days: 'Last 180 days',\n  last365Days: 'Last 365 days',\n};\n\nexport const DATE_INTERVALS: DateInterval[] = Object.keys(INTERVAL_TO_STRING_MAP) as DateInterval[];\n\nconst dateRangeToString = (range?: DateRange): string | undefined => {\n  if (!range || dateRangeIsEmpty(range)) {\n    return undefined;\n  }\n\n  if (range.startDate && !range.endDate) {\n    return `Since ${formatInternational(range.startDate)}`;\n  }\n\n  if (!range.startDate && range.endDate) {\n    return `Until ${formatInternational(range.endDate)}`;\n  }\n\n  return `${formatInternational(range.startDate)} - ${formatInternational(range.endDate)}`;\n};\n\nexport const rangeOrIntervalToString = (range?: DateRange | DateInterval): string | undefined => {\n  if (!range) {\n    return undefined;\n  }\n\n  if (!rangeIsInterval(range)) {\n    return dateRangeToString(range);\n  }\n\n  return INTERVAL_TO_STRING_MAP[range];\n};\n\nexport const intervalToDateRange = (dateInterval?: DateInterval): DateRange => {\n  if (!dateInterval) {\n    return {};\n  }\n\n  switch (dateInterval) {\n    case 'today':\n      return { startDate: moment().startOf('day'), endDate: moment() };\n    case 'yesterday':\n      const yesterday = moment().subtract(1, 'day'); // eslint-disable-line no-case-declarations\n\n      return { startDate: yesterday.startOf('day'), endDate: yesterday.endOf('day') };\n    case 'last7Days':\n      return { startDate: moment().subtract(7, 'days').startOf('day'), endDate: moment() };\n    case 'last30Days':\n      return { startDate: moment().subtract(30, 'days').startOf('day'), endDate: moment() };\n    case 'last90Days':\n      return { startDate: moment().subtract(90, 'days').startOf('day'), endDate: moment() };\n    case 'last180days':\n      return { startDate: moment().subtract(180, 'days').startOf('day'), endDate: moment() };\n    case 'last365Days':\n      return { startDate: moment().subtract(365, 'days').startOf('day'), endDate: moment() };\n  }\n\n  return {};\n};\n","import { useRef } from 'react';\nimport { isNil, dissoc } from 'ramda';\nimport DatePicker, { ReactDatePickerProps } from 'react-datepicker';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCalendarAlt as calendarIcon } from '@fortawesome/free-regular-svg-icons';\nimport classNames from 'classnames';\nimport moment from 'moment';\nimport './DateInput.scss';\n\ninterface DatePropsInterface {\n  endDate?: moment.Moment | null;\n  maxDate?: moment.Moment | null;\n  minDate?: moment.Moment | null;\n  selected?: moment.Moment | null;\n  startDate?: moment.Moment | null;\n  onChange?: (date: moment.Moment | null) => void;\n}\n\nexport type DateInputProps = DatePropsInterface & Omit<ReactDatePickerProps, keyof DatePropsInterface>;\n\nconst transformProps = (props: DateInputProps): ReactDatePickerProps => ({\n  // @ts-expect-error The DatePicker type definition is wrong. It has a ref prop\n  ...dissoc('ref', props),\n  endDate: props.endDate?.toDate(),\n  maxDate: props.maxDate?.toDate(),\n  minDate: props.minDate?.toDate(),\n  selected: props.selected?.toDate(),\n  startDate: props.startDate?.toDate(),\n  onChange: (date: Date | null) => props.onChange?.(date && moment(date)),\n});\n\nconst DateInput = (props: DateInputProps) => {\n  const { className, isClearable, selected } = props;\n  const showCalendarIcon = !isClearable || isNil(selected);\n  const ref = useRef<{ input: HTMLInputElement }>();\n\n  return (\n    <div className=\"date-input-container\">\n      <DatePicker\n        {...transformProps(props)}\n        dateFormat=\"yyyy-MM-dd\"\n        className={classNames('date-input-container__input form-control', className)}\n        // @ts-expect-error The DatePicker type definition is wrong. It has a ref prop\n        ref={ref}\n      />\n      {showCalendarIcon && (\n        <FontAwesomeIcon\n          icon={calendarIcon}\n          className=\"date-input-container__icon\"\n          onClick={() => ref.current?.input.focus()}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default DateInput;\n","import moment from 'moment';\nimport DateInput from '../DateInput';\nimport { DateRange } from './types';\n\ninterface DateRangeRowProps extends DateRange {\n  onStartDateChange: (date: moment.Moment | null) => void;\n  onEndDateChange: (date: moment.Moment | null) => void;\n  disabled?: boolean;\n}\n\nconst DateRangeRow = (\n  { startDate = null, endDate = null, disabled = false, onStartDateChange, onEndDateChange }: DateRangeRowProps,\n) => (\n  <div className=\"row\">\n    <div className=\"col-md-6\">\n      <DateInput\n        selected={startDate}\n        placeholderText=\"Since...\"\n        isClearable\n        maxDate={endDate ?? undefined}\n        disabled={disabled}\n        onChange={onStartDateChange}\n      />\n    </div>\n    <div className=\"col-md-6\">\n      <DateInput\n        className=\"mt-2 mt-md-0\"\n        selected={endDate}\n        placeholderText=\"Until...\"\n        isClearable\n        minDate={startDate ?? undefined}\n        disabled={disabled}\n        onChange={onEndDateChange}\n      />\n    </div>\n  </div>\n);\n\nexport default DateRangeRow;\n","import { DropdownItem } from 'reactstrap';\nimport { FC } from 'react';\nimport { DATE_INTERVALS, DateInterval, rangeOrIntervalToString } from './types';\n\nexport interface DateIntervalDropdownProps {\n  active?: DateInterval;\n  onChange: (interval: DateInterval) => void;\n}\n\nexport const DateIntervalDropdownItems: FC<DateIntervalDropdownProps> = ({ active, onChange }) => (\n  <>\n    {DATE_INTERVALS.map(\n      (interval) => (\n        <DropdownItem key={interval} active={active === interval} onClick={() => onChange(interval)}>\n          {rangeOrIntervalToString(interval)}\n        </DropdownItem>\n      ),\n    )}\n  </>\n);\n","import { useState } from 'react';\nimport { DropdownItem } from 'reactstrap';\nimport { DropdownBtn } from '../DropdownBtn';\nimport {\n  DateInterval,\n  DateRange,\n  dateRangeIsEmpty,\n  rangeOrIntervalToString,\n  intervalToDateRange,\n  rangeIsInterval,\n} from './types';\nimport DateRangeRow from './DateRangeRow';\nimport { DateIntervalDropdownItems } from './DateIntervalDropdownItems';\n\nexport interface DateRangeSelectorProps {\n  initialDateRange?: DateInterval | DateRange;\n  disabled?: boolean;\n  onDatesChange: (dateRange: DateRange) => void;\n  defaultText: string;\n}\n\nexport const DateRangeSelector = (\n  { onDatesChange, initialDateRange, defaultText, disabled }: DateRangeSelectorProps,\n) => {\n  const [ activeInterval, setActiveInterval ] = useState(\n    rangeIsInterval(initialDateRange) ? initialDateRange : undefined,\n  );\n  const [ activeDateRange, setActiveDateRange ] = useState(\n    !rangeIsInterval(initialDateRange) ? initialDateRange : undefined,\n  );\n  const updateDateRange = (dateRange: DateRange) => {\n    setActiveInterval(undefined);\n    setActiveDateRange(dateRange);\n    onDatesChange(dateRange);\n  };\n  const updateInterval = (dateInterval?: DateInterval) => () => {\n    setActiveInterval(dateInterval);\n    setActiveDateRange(undefined);\n    onDatesChange(intervalToDateRange(dateInterval));\n  };\n\n  return (\n    <DropdownBtn disabled={disabled} text={rangeOrIntervalToString(activeInterval ?? activeDateRange) ?? defaultText}>\n      <DropdownItem\n        active={activeInterval === undefined && dateRangeIsEmpty(activeDateRange)}\n        onClick={updateInterval(undefined)}\n      >\n        {defaultText}\n      </DropdownItem>\n      <DropdownItem divider />\n      <DateIntervalDropdownItems active={activeInterval} onChange={(interval) => updateInterval(interval)()} />\n      <DropdownItem divider />\n      <DropdownItem header>Custom:</DropdownItem>\n      <DropdownItem text>\n        <DateRangeRow\n          {...activeDateRange}\n          onStartDateChange={(startDate) => updateDateRange({ ...activeDateRange, startDate })}\n          onEndDateChange={(endDate) => updateDateRange({ ...activeDateRange, endDate })}\n        />\n      </DropdownItem>\n    </DropdownBtn>\n  );\n};\n","import { faTags as tagsIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { isEmpty, pipe } from 'ramda';\nimport moment from 'moment';\nimport SearchField from '../utils/SearchField';\nimport Tag from '../tags/helpers/Tag';\nimport { DateRangeSelector } from '../utils/dates/DateRangeSelector';\nimport { formatIsoDate } from '../utils/helpers/date';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport { DateRange } from '../utils/dates/types';\nimport { ShortUrlsListParams } from './reducers/shortUrlsListParams';\nimport './SearchBar.scss';\n\ninterface SearchBarProps {\n  listShortUrls: (params: ShortUrlsListParams) => void;\n  shortUrlsListParams: ShortUrlsListParams;\n}\n\nconst dateOrNull = (date?: string) => date ? moment(date) : null;\n\nconst SearchBar = (colorGenerator: ColorGenerator) => ({ listShortUrls, shortUrlsListParams }: SearchBarProps) => {\n  const selectedTags = shortUrlsListParams.tags ?? [];\n  const setDates = pipe(\n    ({ startDate, endDate }: DateRange) => ({\n      startDate: formatIsoDate(startDate) ?? undefined,\n      endDate: formatIsoDate(endDate) ?? undefined,\n    }),\n    (dates) => listShortUrls({ ...shortUrlsListParams, ...dates }),\n  );\n\n  return (\n    <div className=\"search-bar-container\">\n      <SearchField\n        onChange={\n          (searchTerm) => listShortUrls({ ...shortUrlsListParams, searchTerm })\n        }\n      />\n\n      <div className=\"mt-3\">\n        <div className=\"row\">\n          <div className=\"col-lg-8 offset-lg-4 col-xl-6 offset-xl-6\">\n            <DateRangeSelector\n              defaultText=\"All short URLs\"\n              initialDateRange={{\n                startDate: dateOrNull(shortUrlsListParams.startDate),\n                endDate: dateOrNull(shortUrlsListParams.endDate),\n              }}\n              onDatesChange={setDates}\n            />\n          </div>\n        </div>\n      </div>\n\n      {!isEmpty(selectedTags) && (\n        <h4 className=\"search-bar__selected-tag mt-3\">\n          <FontAwesomeIcon icon={tagsIcon} className=\"search-bar__tags-icon\" />\n          &nbsp;\n          {selectedTags.map((tag) => (\n            <Tag\n              colorGenerator={colorGenerator}\n              key={tag}\n              text={tag}\n              clearable\n              onClose={() => listShortUrls(\n                {\n                  ...shortUrlsListParams,\n                  tags: selectedTags.filter((selectedTag) => selectedTag !== tag),\n                },\n              )}\n            />\n          ))}\n        </h4>\n      )}\n    </div>\n  );\n};\n\nexport default SearchBar;\n","import { UncontrolledDropdown, DropdownToggle, DropdownMenu, DropdownItem } from 'reactstrap';\nimport { toPairs } from 'ramda';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSortAmountUp as sortAscIcon, faSortAmountDown as sortDescIcon } from '@fortawesome/free-solid-svg-icons';\nimport classNames from 'classnames';\nimport { determineOrderDir, OrderDir } from './utils';\nimport './SortingDropdown.scss';\n\nexport interface SortingDropdownProps<T extends string = string> {\n  items: Record<T, string>;\n  orderField?: T;\n  orderDir?: OrderDir;\n  onChange: (orderField?: T, orderDir?: OrderDir) => void;\n  isButton?: boolean;\n  right?: boolean;\n}\n\nexport default function SortingDropdown<T extends string = string>(\n  { items, orderField, orderDir, onChange, isButton = true, right = false }: SortingDropdownProps<T>,\n) {\n  const handleItemClick = (fieldKey: T) => () => {\n    const newOrderDir = determineOrderDir(fieldKey, orderField, orderDir);\n\n    onChange(newOrderDir ? fieldKey : undefined, newOrderDir);\n  };\n\n  return (\n    <UncontrolledDropdown>\n      <DropdownToggle\n        caret\n        color={isButton ? 'primary' : 'link'}\n        className={classNames({ 'dropdown-btn__toggle btn-block': isButton, 'btn-sm p-0': !isButton })}\n      >\n        {!isButton && <>Order by</>}\n        {isButton && !orderField && <>Order by...</>}\n        {isButton && orderField && `Order by: \"${items[orderField]}\" - \"${orderDir ?? 'DESC'}\"`}\n      </DropdownToggle>\n      <DropdownMenu\n        right={right}\n        className={classNames('w-100', { 'sorting-dropdown__menu--link': !isButton })}\n      >\n        {toPairs(items).map(([ fieldKey, fieldValue ]) => (\n          <DropdownItem key={fieldKey} active={orderField === fieldKey} onClick={handleItemClick(fieldKey as T)}>\n            {fieldValue}\n            {orderField === fieldKey && (\n              <FontAwesomeIcon\n                icon={orderDir === 'ASC' ? sortAscIcon : sortDescIcon}\n                className=\"sorting-dropdown__sort-icon\"\n              />\n            )}\n          </DropdownItem>\n        ))}\n        <DropdownItem divider />\n        <DropdownItem disabled={!orderField} onClick={() => onChange()}>\n          <i>Clear selection</i>\n        </DropdownItem>\n      </DropdownMenu>\n    </UncontrolledDropdown>\n  );\n}\n","import { FC, useEffect } from 'react';\nimport { pipe } from 'ramda';\nimport { CreateVisit } from '../../visits/types';\nimport { MercureInfo } from '../reducers/mercureInfo';\nimport { bindToMercureTopic } from './index';\n\nexport interface MercureBoundProps {\n  createNewVisits: (createdVisits: CreateVisit[]) => void;\n  loadMercureInfo: () => void;\n  mercureInfo: MercureInfo;\n}\n\nexport function boundToMercureHub<T = {}>(\n  WrappedComponent: FC<MercureBoundProps & T>,\n  getTopicsForProps: (props: T) => string[],\n) {\n  const pendingUpdates = new Set<CreateVisit>();\n\n  return (props: MercureBoundProps & T) => {\n    const { createNewVisits, loadMercureInfo, mercureInfo } = props;\n    const { interval } = mercureInfo;\n\n    useEffect(() => {\n      const onMessage = (visit: CreateVisit) => interval ? pendingUpdates.add(visit) : createNewVisits([ visit ]);\n      const closeEventSource = bindToMercureTopic(mercureInfo, getTopicsForProps(props), onMessage, loadMercureInfo);\n\n      if (!interval) {\n        return closeEventSource;\n      }\n\n      const timer = setInterval(() => {\n        createNewVisits([ ...pendingUpdates ]);\n        pendingUpdates.clear();\n      }, interval * 1000 * 60);\n\n      return pipe(() => clearInterval(timer), () => closeEventSource?.());\n    }, [ mercureInfo ]);\n\n    return <WrappedComponent {...props} />;\n  };\n}\n","import { EventSourcePolyfill as EventSource } from 'event-source-polyfill';\nimport { MercureInfo } from '../reducers/mercureInfo';\n\nexport const bindToMercureTopic = <T>(mercureInfo: MercureInfo, topics: string[], onMessage: (message: T) => void, onTokenExpired: () => void) => { // eslint-disable-line max-len\n  const { mercureHubUrl, token, loading, error } = mercureInfo;\n\n  if (loading || error || !mercureHubUrl) {\n    return undefined;\n  }\n\n  const onEventSourceMessage = ({ data }: { data: string }) => onMessage(JSON.parse(data) as T);\n  const onEventSourceError = ({ status }: { status: number }) => status === 401 && onTokenExpired();\n\n  const subscriptions = topics.map((topic) => {\n    const hubUrl = new URL(mercureHubUrl);\n\n    hubUrl.searchParams.append('topic', topic);\n    const es = new EventSource(hubUrl, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    es.onmessage = onEventSourceMessage;\n    es.onerror = onEventSourceError;\n\n    return es;\n  });\n\n  return () => subscriptions.forEach((es) => es.close());\n};\n","import qs from 'qs';\n\nexport const parseQuery = <T>(search: string) => qs.parse(search, { ignoreQueryPrefix: true }) as unknown as T;\n\nexport const stringifyQuery = (query: any): string => qs.stringify(query, { arrayFormat: 'brackets' });\n","export class Topics {\n  public static visits = () => 'https://shlink.io/new-visit';\n\n  public static shortUrlVisits = (shortCode: string) => `https://shlink.io/new-visit/${shortCode}`;\n\n  public static orphanVisits = () => 'https://shlink.io/new-orphan-visit';\n}\n","import { Action } from 'redux';\n\ntype ActionHandler<State, AT> = (currentState: State, action: AT) => State;\ntype ActionHandlerMap<State, AT> = Record<string, ActionHandler<State, AT>>;\n\nexport const buildReducer = <State, AT extends Action>(map: ActionHandlerMap<State, AT>, initialState: State) => (\n  state: State | undefined,\n  action: AT,\n): State => {\n  const { type } = action;\n  const actionHandler = map[type];\n  const currentState = state ?? initialState;\n\n  return actionHandler ? actionHandler(currentState, action) : currentState;\n};\n\nexport const buildActionCreator = <T extends string>(type: T) => (): Action<T> => ({ type });\n","import { isEmpty, propEq, values } from 'ramda';\nimport { useState, useEffect, useMemo, FC } from 'react';\nimport { Button, Card, Nav, NavLink, Progress, Row } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCalendarAlt, faMapMarkedAlt, faList, faChartPie, faFileDownload } from '@fortawesome/free-solid-svg-icons';\nimport { IconDefinition } from '@fortawesome/fontawesome-common-types';\nimport { Route, Switch, NavLink as RouterNavLink, Redirect } from 'react-router-dom';\nimport { Location } from 'history';\nimport classNames from 'classnames';\nimport { DateRangeSelector } from '../utils/dates/DateRangeSelector';\nimport Message from '../utils/Message';\nimport { formatIsoDate } from '../utils/helpers/date';\nimport { ShlinkVisitsParams } from '../api/types';\nimport { DateInterval, DateRange, intervalToDateRange } from '../utils/dates/types';\nimport { Result } from '../utils/Result';\nimport { ShlinkApiError } from '../api/ShlinkApiError';\nimport { Settings } from '../settings/reducers/settings';\nimport SortableBarGraph from './helpers/SortableBarGraph';\nimport GraphCard from './helpers/GraphCard';\nimport LineChartCard from './helpers/LineChartCard';\nimport VisitsTable from './VisitsTable';\nimport { NormalizedOrphanVisit, NormalizedVisit, OrphanVisitType, VisitsInfo } from './types';\nimport OpenMapModalBtn from './helpers/OpenMapModalBtn';\nimport { processStatsFromVisits } from './services/VisitsParser';\nimport { OrphanVisitTypeDropdown } from './helpers/OrphanVisitTypeDropdown';\nimport './VisitsStats.scss';\nimport { HighlightableProps, highlightedVisitsToStats, normalizeAndFilterVisits } from './types/helpers';\n\nexport interface VisitsStatsProps {\n  getVisits: (params: Partial<ShlinkVisitsParams>) => void;\n  visitsInfo: VisitsInfo;\n  settings: Settings;\n  cancelGetVisits: () => void;\n  baseUrl: string;\n  domain?: string;\n  exportCsv: (visits: NormalizedVisit[]) => void;\n  isOrphanVisits?: boolean;\n}\n\ninterface VisitsNavLinkProps {\n  title: string;\n  subPath: string;\n  icon: IconDefinition;\n}\n\ntype Section = 'byTime' | 'byContext' | 'byLocation' | 'list';\n\nconst sections: Record<Section, VisitsNavLinkProps> = {\n  byTime: { title: 'By time', subPath: '', icon: faCalendarAlt },\n  byContext: { title: 'By context', subPath: '/by-context', icon: faChartPie },\n  byLocation: { title: 'By location', subPath: '/by-location', icon: faMapMarkedAlt },\n  list: { title: 'List', subPath: '/list', icon: faList },\n};\n\nlet selectedBar: string | undefined;\n\nconst VisitsNavLink: FC<VisitsNavLinkProps & { to: string }> = ({ subPath, title, icon, to }) => (\n  <NavLink\n    tag={RouterNavLink}\n    className=\"visits-stats__nav-link\"\n    to={to}\n    isActive={(_: null, { pathname }: Location) => pathname.endsWith(`visits${subPath}`)}\n    replace\n  >\n    <FontAwesomeIcon icon={icon} />\n    <span className=\"ml-2 d-none d-sm-inline\">{title}</span>\n  </NavLink>\n);\n\nconst VisitsStats: FC<VisitsStatsProps> = (\n  { children, visitsInfo, getVisits, cancelGetVisits, baseUrl, domain, settings, exportCsv, isOrphanVisits = false },\n) => {\n  const initialInterval: DateInterval = settings.visits?.defaultInterval ?? 'last30Days';\n  const [ dateRange, setDateRange ] = useState<DateRange>(intervalToDateRange(initialInterval));\n  const [ highlightedVisits, setHighlightedVisits ] = useState<NormalizedVisit[]>([]);\n  const [ highlightedLabel, setHighlightedLabel ] = useState<string | undefined>();\n  const [ orphanVisitType, setOrphanVisitType ] = useState<OrphanVisitType | undefined>();\n\n  const buildSectionUrl = (subPath?: string) => {\n    const query = domain ? `?domain=${domain}` : '';\n\n    return !subPath ? `${baseUrl}${query}` : `${baseUrl}${subPath}${query}`;\n  };\n  const { visits, loading, loadingLarge, error, errorData, progress } = visitsInfo;\n  const normalizedVisits = useMemo(\n    () => normalizeAndFilterVisits(visits, orphanVisitType),\n    [ visits, orphanVisitType ],\n  );\n  const { os, browsers, referrers, countries, cities, citiesForMap, visitedUrls } = useMemo(\n    () => processStatsFromVisits(normalizedVisits),\n    [ normalizedVisits ],\n  );\n  const mapLocations = values(citiesForMap);\n\n  const setSelectedVisits = (selectedVisits: NormalizedVisit[]) => {\n    selectedBar = undefined;\n    setHighlightedVisits(selectedVisits);\n  };\n  const highlightVisitsForProp = (prop: HighlightableProps<NormalizedOrphanVisit>) => (value: string) => {\n    const newSelectedBar = `${prop}_${value}`;\n\n    if (selectedBar === newSelectedBar) {\n      setHighlightedVisits([]);\n      setHighlightedLabel(undefined);\n      selectedBar = undefined;\n    } else {\n      setHighlightedVisits((normalizedVisits as NormalizedOrphanVisit[]).filter(propEq(prop, value)));\n      setHighlightedLabel(value);\n      selectedBar = newSelectedBar;\n    }\n  };\n\n  useEffect(() => cancelGetVisits, []);\n  useEffect(() => {\n    const { startDate, endDate } = dateRange;\n\n    getVisits({ startDate: formatIsoDate(startDate) ?? undefined, endDate: formatIsoDate(endDate) ?? undefined });\n  }, [ dateRange ]);\n\n  const renderVisitsContent = () => {\n    if (loadingLarge) {\n      return (\n        <Message loading>\n          This is going to take a while... :S\n          <Progress value={progress} striped={progress === 100} className=\"mt-3\" />\n        </Message>\n      );\n    }\n\n    if (loading) {\n      return <Message loading />;\n    }\n\n    if (error) {\n      return (\n        <Result type=\"error\">\n          <ShlinkApiError errorData={errorData} fallbackMessage=\"An error occurred while loading visits :(\" />\n        </Result>\n      );\n    }\n\n    if (isEmpty(visits)) {\n      return <Message>There are no visits matching current filter  :(</Message>;\n    }\n\n    return (\n      <>\n        <Card className=\"visits-stats__nav p-0 overflow-hidden\" body>\n          <Nav pills fill>\n            {Object.entries(sections).map(([ section, props ]) =>\n              <VisitsNavLink key={section} {...props} to={buildSectionUrl(props.subPath)} />)}\n          </Nav>\n        </Card>\n        <Row>\n          <Switch>\n            <Route exact path={baseUrl}>\n              <div className=\"col-12 mt-3\">\n                <LineChartCard\n                  title=\"Visits during time\"\n                  visits={normalizedVisits}\n                  highlightedVisits={highlightedVisits}\n                  highlightedLabel={highlightedLabel}\n                  setSelectedVisits={setSelectedVisits}\n                />\n              </div>\n            </Route>\n\n            <Route exact path={`${baseUrl}${sections.byContext.subPath}`}>\n              <div className={classNames('mt-3 col-lg-6', { 'col-xl-4': !isOrphanVisits })}>\n                <GraphCard title=\"Operating systems\" stats={os} />\n              </div>\n              <div className={classNames('mt-3 col-lg-6', { 'col-xl-4': !isOrphanVisits })}>\n                <GraphCard title=\"Browsers\" stats={browsers} />\n              </div>\n              <div className={classNames('mt-3', { 'col-xl-4': !isOrphanVisits, 'col-lg-6': isOrphanVisits })}>\n                <SortableBarGraph\n                  title=\"Referrers\"\n                  stats={referrers}\n                  withPagination={false}\n                  highlightedStats={highlightedVisitsToStats(highlightedVisits, 'referer')}\n                  highlightedLabel={highlightedLabel}\n                  sortingItems={{\n                    name: 'Referrer name',\n                    amount: 'Visits amount',\n                  }}\n                  onClick={highlightVisitsForProp('referer')}\n                />\n              </div>\n              {isOrphanVisits && (\n                <div className=\"mt-3 col-lg-6\">\n                  <SortableBarGraph\n                    title=\"Visited URLs\"\n                    stats={visitedUrls}\n                    highlightedLabel={highlightedLabel}\n                    highlightedStats={highlightedVisitsToStats(highlightedVisits, 'visitedUrl')}\n                    sortingItems={{\n                      visitedUrl: 'Visited URL',\n                      amount: 'Visits amount',\n                    }}\n                    onClick={highlightVisitsForProp('visitedUrl')}\n                  />\n                </div>\n              )}\n            </Route>\n\n            <Route exact path={`${baseUrl}${sections.byLocation.subPath}`}>\n              <div className=\"col-lg-6 mt-3\">\n                <SortableBarGraph\n                  title=\"Countries\"\n                  stats={countries}\n                  highlightedStats={highlightedVisitsToStats(highlightedVisits, 'country')}\n                  highlightedLabel={highlightedLabel}\n                  sortingItems={{\n                    name: 'Country name',\n                    amount: 'Visits amount',\n                  }}\n                  onClick={highlightVisitsForProp('country')}\n                />\n              </div>\n              <div className=\"col-lg-6 mt-3\">\n                <SortableBarGraph\n                  title=\"Cities\"\n                  stats={cities}\n                  highlightedStats={highlightedVisitsToStats(highlightedVisits, 'city')}\n                  highlightedLabel={highlightedLabel}\n                  extraHeaderContent={(activeCities: string[]) =>\n                    mapLocations.length > 0 &&\n                    <OpenMapModalBtn modalTitle=\"Cities\" locations={mapLocations} activeCities={activeCities} />\n                  }\n                  sortingItems={{\n                    name: 'City name',\n                    amount: 'Visits amount',\n                  }}\n                  onClick={highlightVisitsForProp('city')}\n                />\n              </div>\n            </Route>\n\n            <Route exact path={`${baseUrl}${sections.list.subPath}`}>\n              <div className=\"col-12\">\n                <VisitsTable\n                  visits={normalizedVisits}\n                  selectedVisits={highlightedVisits}\n                  setSelectedVisits={setSelectedVisits}\n                  isOrphanVisits={isOrphanVisits}\n                />\n              </div>\n            </Route>\n\n            <Redirect to={baseUrl} />\n          </Switch>\n        </Row>\n      </>\n    );\n  };\n\n  return (\n    <>\n      {children}\n\n      <section className=\"mt-3\">\n        <div className=\"row flex-md-row-reverse\">\n          <div className=\"col-lg-7 col-xl-6\">\n            <div className=\"d-md-flex\">\n              <div className=\"flex-fill\">\n                <DateRangeSelector\n                  disabled={loading}\n                  initialDateRange={initialInterval}\n                  defaultText=\"All visits\"\n                  onDatesChange={setDateRange}\n                />\n              </div>\n              {isOrphanVisits && (\n                <OrphanVisitTypeDropdown\n                  text=\"Filter by type\"\n                  className=\"ml-0 ml-md-2 mt-3 mt-md-0\"\n                  selected={orphanVisitType}\n                  onChange={setOrphanVisitType}\n                />\n              )}\n            </div>\n          </div>\n          {visits.length > 0 && (\n            <div className=\"col-lg-5 col-xl-6 mt-3 mt-lg-0\">\n              <div className=\"d-flex\">\n                <Button\n                  outline\n                  disabled={highlightedVisits.length === 0}\n                  className=\"btn-md-block mr-2\"\n                  onClick={() => setSelectedVisits([])}\n                >\n                  Clear selection {highlightedVisits.length > 0 && <>({highlightedVisits.length})</>}\n                </Button>\n                <Button\n                  outline\n                  color=\"primary\"\n                  className=\"btn-md-block\"\n                  onClick={() => exportCsv(normalizedVisits)}\n                >\n                  <FontAwesomeIcon icon={faFileDownload} /> Export ({normalizedVisits.length})\n                </Button>\n              </div>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <section className=\"mt-3\">\n        {renderVisitsContent()}\n      </section>\n    </>\n  );\n};\n\nexport default VisitsStats;\n","import { isNil } from 'ramda';\nimport { ShortUrl } from '../data';\nimport { OptionalString } from '../../utils/utils';\n\nexport const shortUrlMatches = (shortUrl: ShortUrl, shortCode: string, domain: OptionalString): boolean => {\n  if (isNil(domain)) {\n    return shortUrl.shortCode === shortCode && !shortUrl.domain;\n  }\n\n  return shortUrl.shortCode === shortCode && shortUrl.domain === domain;\n};\n","import { Action } from 'redux';\nimport { CreateVisit } from '../types';\n\nexport const CREATE_VISITS = 'shlink/visitCreation/CREATE_VISITS';\n\nexport interface CreateVisitsAction extends Action<typeof CREATE_VISITS> {\n  createdVisits: CreateVisit[];\n}\n\nexport const createNewVisits = (createdVisits: CreateVisit[]): CreateVisitsAction => ({\n  type: CREATE_VISITS,\n  createdVisits,\n});\n","import { AxiosError } from 'axios';\nimport { InvalidArgumentError, InvalidShortUrlDeletion, ProblemDetailsError } from '../types';\n\nexport const parseApiError = (e: AxiosError<ProblemDetailsError>) => e.response?.data;\n\nexport const isInvalidArgumentError = (error?: ProblemDetailsError): error is InvalidArgumentError =>\n  error?.type === 'INVALID_ARGUMENT';\n\nexport const isInvalidDeletionError = (error?: ProblemDetailsError): error is InvalidShortUrlDeletion =>\n  error?.type === 'INVALID_SHORTCODE_DELETION';\n","import { Action, Dispatch } from 'redux';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ProblemDetailsError } from '../../api/types';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { parseApiError } from '../../api/utils';\n\n/* eslint-disable padding-line-between-statements */\nexport const DELETE_SHORT_URL_START = 'shlink/deleteShortUrl/DELETE_SHORT_URL_START';\nexport const DELETE_SHORT_URL_ERROR = 'shlink/deleteShortUrl/DELETE_SHORT_URL_ERROR';\nexport const SHORT_URL_DELETED = 'shlink/deleteShortUrl/SHORT_URL_DELETED';\nexport const RESET_DELETE_SHORT_URL = 'shlink/deleteShortUrl/RESET_DELETE_SHORT_URL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlDeletion {\n  shortCode: string;\n  loading: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface DeleteShortUrlAction extends Action<string> {\n  shortCode: string;\n  domain?: string | null;\n}\n\ninterface DeleteShortUrlErrorAction extends Action<string> {\n  errorData?: ProblemDetailsError;\n}\n\nconst initialState: ShortUrlDeletion = {\n  shortCode: '',\n  loading: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlDeletion, DeleteShortUrlAction & DeleteShortUrlErrorAction>({\n  [DELETE_SHORT_URL_START]: (state) => ({ ...state, loading: true, error: false }),\n  [DELETE_SHORT_URL_ERROR]: (state, { errorData }) => ({ ...state, errorData, loading: false, error: true }),\n  [SHORT_URL_DELETED]: (state, { shortCode }) => ({ ...state, shortCode, loading: false, error: false }),\n  [RESET_DELETE_SHORT_URL]: () => initialState,\n}, initialState);\n\nexport const deleteShortUrl = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  domain?: string | null,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: DELETE_SHORT_URL_START });\n  const { deleteShortUrl } = buildShlinkApiClient(getState);\n\n  try {\n    await deleteShortUrl(shortCode, domain);\n    dispatch<DeleteShortUrlAction>({ type: SHORT_URL_DELETED, shortCode, domain });\n  } catch (e) {\n    dispatch<DeleteShortUrlErrorAction>({ type: DELETE_SHORT_URL_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const resetDeleteShortUrl = buildActionCreator(RESET_DELETE_SHORT_URL);\n","import { Action, Dispatch } from 'redux';\nimport { GetState } from '../../container/types';\nimport { ShortUrl, ShortUrlData } from '../data';\nimport { buildReducer, buildActionCreator } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\n\n/* eslint-disable padding-line-between-statements */\nexport const CREATE_SHORT_URL_START = 'shlink/createShortUrl/CREATE_SHORT_URL_START';\nexport const CREATE_SHORT_URL_ERROR = 'shlink/createShortUrl/CREATE_SHORT_URL_ERROR';\nexport const CREATE_SHORT_URL = 'shlink/createShortUrl/CREATE_SHORT_URL';\nexport const RESET_CREATE_SHORT_URL = 'shlink/createShortUrl/RESET_CREATE_SHORT_URL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlCreation {\n  result: ShortUrl | null;\n  saving: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface CreateShortUrlAction extends Action<string> {\n  result: ShortUrl;\n}\n\nexport interface CreateShortUrlFailedAction extends Action<string> {\n  errorData?: ProblemDetailsError;\n}\n\nconst initialState: ShortUrlCreation = {\n  result: null,\n  saving: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlCreation, CreateShortUrlAction & CreateShortUrlFailedAction>({\n  [CREATE_SHORT_URL_START]: (state) => ({ ...state, saving: true, error: false }),\n  [CREATE_SHORT_URL_ERROR]: (state, { errorData }) => ({ ...state, saving: false, error: true, errorData }),\n  [CREATE_SHORT_URL]: (_, { result }) => ({ result, saving: false, error: false }),\n  [RESET_CREATE_SHORT_URL]: () => initialState,\n}, initialState);\n\nexport const createShortUrl = (buildShlinkApiClient: ShlinkApiClientBuilder) => (data: ShortUrlData) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: CREATE_SHORT_URL_START });\n  const { createShortUrl } = buildShlinkApiClient(getState);\n\n  try {\n    const result = await createShortUrl(data);\n\n    dispatch<CreateShortUrlAction>({ type: CREATE_SHORT_URL, result });\n  } catch (e) {\n    dispatch<CreateShortUrlFailedAction>({ type: CREATE_SHORT_URL_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const resetCreateShortUrl = buildActionCreator(RESET_CREATE_SHORT_URL);\n","import { Action, Dispatch } from 'redux';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport { OptionalString } from '../../utils/utils';\nimport { EditShortUrlData, ShortUrl } from '../data';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\nimport { supportsTagsInPatch } from '../../utils/helpers/features';\n\n/* eslint-disable padding-line-between-statements */\nexport const EDIT_SHORT_URL_START = 'shlink/shortUrlEdition/EDIT_SHORT_URL_START';\nexport const EDIT_SHORT_URL_ERROR = 'shlink/shortUrlEdition/EDIT_SHORT_URL_ERROR';\nexport const SHORT_URL_EDITED = 'shlink/shortUrlEdition/SHORT_URL_EDITED';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlEdition {\n  shortUrl?: ShortUrl;\n  saving: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface ShortUrlEditedAction extends Action<string> {\n  shortUrl: ShortUrl;\n}\n\nexport interface ShortUrlEditionFailedAction extends Action<string> {\n  errorData?: ProblemDetailsError;\n}\n\nconst initialState: ShortUrlEdition = {\n  saving: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlEdition, ShortUrlEditedAction & ShortUrlEditionFailedAction>({\n  [EDIT_SHORT_URL_START]: (state) => ({ ...state, saving: true, error: false }),\n  [EDIT_SHORT_URL_ERROR]: (state, { errorData }) => ({ ...state, saving: false, error: true, errorData }),\n  [SHORT_URL_EDITED]: (_, { shortUrl }) => ({ shortUrl, saving: false, error: false }),\n}, initialState);\n\nexport const editShortUrl = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  domain: OptionalString,\n  data: EditShortUrlData,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: EDIT_SHORT_URL_START });\n\n  const { selectedServer } = getState();\n  const sendTagsSeparately = !supportsTagsInPatch(selectedServer);\n  const { updateShortUrl, updateShortUrlTags } = buildShlinkApiClient(getState);\n\n  try {\n    const [ shortUrl ] = await Promise.all([\n      updateShortUrl(shortCode, domain, data as any), // FIXME Parse dates\n      sendTagsSeparately && data.tags ? updateShortUrlTags(shortCode, domain, data.tags) : undefined,\n    ]);\n\n    dispatch<ShortUrlEditedAction>({ shortUrl, type: SHORT_URL_EDITED });\n  } catch (e) {\n    dispatch<ShortUrlEditionFailedAction>({ type: EDIT_SHORT_URL_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n","import { assoc, assocPath, init, last, pipe, reject } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { shortUrlMatches } from '../helpers';\nimport { CREATE_VISITS, CreateVisitsAction } from '../../visits/reducers/visitCreation';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ShlinkShortUrlsResponse } from '../../api/types';\nimport { DeleteShortUrlAction, SHORT_URL_DELETED } from './shortUrlDeletion';\nimport { ShortUrlsListParams } from './shortUrlsListParams';\nimport { CREATE_SHORT_URL, CreateShortUrlAction } from './shortUrlCreation';\nimport { SHORT_URL_EDITED, ShortUrlEditedAction } from './shortUrlEdition';\n\n/* eslint-disable padding-line-between-statements */\nexport const LIST_SHORT_URLS_START = 'shlink/shortUrlsList/LIST_SHORT_URLS_START';\nexport const LIST_SHORT_URLS_ERROR = 'shlink/shortUrlsList/LIST_SHORT_URLS_ERROR';\nexport const LIST_SHORT_URLS = 'shlink/shortUrlsList/LIST_SHORT_URLS';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlsList {\n  shortUrls?: ShlinkShortUrlsResponse;\n  loading: boolean;\n  error: boolean;\n}\n\nexport interface ListShortUrlsAction extends Action<string> {\n  shortUrls: ShlinkShortUrlsResponse;\n  params: ShortUrlsListParams;\n}\n\nexport type ListShortUrlsCombinedAction = (\n  ListShortUrlsAction\n  & CreateVisitsAction\n  & CreateShortUrlAction\n  & DeleteShortUrlAction\n  & ShortUrlEditedAction\n);\n\nconst initialState: ShortUrlsList = {\n  loading: true,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlsList, ListShortUrlsCombinedAction>({\n  [LIST_SHORT_URLS_START]: (state) => ({ ...state, loading: true, error: false }),\n  [LIST_SHORT_URLS_ERROR]: () => ({ loading: false, error: true }),\n  [LIST_SHORT_URLS]: (_, { shortUrls }) => ({ loading: false, error: false, shortUrls }),\n  [SHORT_URL_DELETED]: pipe(\n    (state: ShortUrlsList, { shortCode, domain }: DeleteShortUrlAction) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'data' ],\n      reject((shortUrl) => shortUrlMatches(shortUrl, shortCode, domain), state.shortUrls.data),\n      state,\n    ),\n    (state) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'pagination', 'totalItems' ],\n      state.shortUrls.pagination.totalItems - 1,\n      state,\n    ),\n  ),\n  [CREATE_VISITS]: (state, { createdVisits }) => assocPath(\n    [ 'shortUrls', 'data' ],\n    state.shortUrls?.data?.map(\n      (currentShortUrl) => {\n        // Find the last of the new visit for this short URL, and pick the amount of visits from it\n        const lastVisit = last(\n          createdVisits.filter(\n            ({ shortUrl }) => shortUrl && shortUrlMatches(currentShortUrl, shortUrl.shortCode, shortUrl.domain),\n          ),\n        );\n\n        return lastVisit?.shortUrl\n          ? assoc('visitsCount', lastVisit.shortUrl.visitsCount, currentShortUrl)\n          : currentShortUrl;\n      },\n    ),\n    state,\n  ),\n  [CREATE_SHORT_URL]: pipe(\n    // The only place where the list and the creation form coexist is the overview page.\n    // There we can assume we are displaying page 1, and therefore, we can safely prepend the new short URL and remove the last one.\n    (state: ShortUrlsList, { result }: CreateShortUrlAction) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'data' ],\n      [ result, ...init(state.shortUrls.data) ],\n      state,\n    ),\n    (state: ShortUrlsList) => !state.shortUrls ? state : assocPath(\n      [ 'shortUrls', 'pagination', 'totalItems' ],\n      state.shortUrls.pagination.totalItems + 1,\n      state,\n    ),\n  ),\n  [SHORT_URL_EDITED]: (state, { shortUrl: editedShortUrl }) => !state.shortUrls ? state : assocPath(\n    [ 'shortUrls', 'data' ],\n    state.shortUrls.data.map((shortUrl) => {\n      const { shortCode, domain } = editedShortUrl;\n\n      return shortUrlMatches(shortUrl, shortCode, domain) ? editedShortUrl : shortUrl;\n    }),\n    state,\n  ),\n}, initialState);\n\nexport const listShortUrls = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  params: ShortUrlsListParams = {},\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: LIST_SHORT_URLS_START });\n  const { listShortUrls } = buildShlinkApiClient(getState);\n\n  try {\n    const shortUrls = await listShortUrls(params);\n\n    dispatch<ListShortUrlsAction>({ type: LIST_SHORT_URLS, shortUrls, params });\n  } catch (e) {\n    dispatch({ type: LIST_SHORT_URLS_ERROR, params });\n  }\n};\n","import { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { OrderDir } from '../../utils/utils';\nimport { LIST_SHORT_URLS, ListShortUrlsAction } from './shortUrlsList';\n\nexport const RESET_SHORT_URL_PARAMS = 'shlink/shortUrlsListParams/RESET_SHORT_URL_PARAMS';\n\nexport const SORTABLE_FIELDS = {\n  dateCreated: 'Created at',\n  shortCode: 'Short URL',\n  longUrl: 'Long URL',\n  title: 'Title',\n  visits: 'Visits',\n};\n\nexport type OrderableFields = keyof typeof SORTABLE_FIELDS;\n\nexport interface ShortUrlsListParams {\n  page?: string;\n  itemsPerPage?: number;\n  tags?: string[];\n  searchTerm?: string;\n  startDate?: string;\n  endDate?: string;\n  orderBy?: Partial<Record<OrderableFields, OrderDir>>;\n}\n\nconst initialState: ShortUrlsListParams = {\n  page: '1',\n  orderBy: { dateCreated: 'DESC' },\n};\n\nexport default buildReducer<ShortUrlsListParams, ListShortUrlsAction>({\n  [LIST_SHORT_URLS]: (state, { params }) => ({ ...state, ...params }),\n  [RESET_SHORT_URL_PARAMS]: () => initialState,\n}, initialState);\n\nexport const resetShortUrlParams = buildActionCreator(RESET_SHORT_URL_PARAMS);\n","const TEN_ROUNDING_NUMBER = 10;\nconst { ceil } = Math;\nconst formatter = new Intl.NumberFormat('en-US');\n\nexport const prettify = (number: number) => formatter.format(number);\n\nexport const roundTen = (number: number) => ceil(number / TEN_ROUNDING_NUMBER) * TEN_ROUNDING_NUMBER;\n","import { max, min, range } from 'ramda';\nimport { prettify } from './numbers';\n\nconst DELTA = 2;\n\nexport const ELLIPSIS = '...';\n\ntype Ellipsis = typeof ELLIPSIS;\n\nexport type NumberOrEllipsis = number | Ellipsis;\n\nexport const progressivePagination = (currentPage: number, pageCount: number): NumberOrEllipsis[] => {\n  const pages: NumberOrEllipsis[] = range(\n    max(DELTA, currentPage - DELTA),\n    min(pageCount - 1, currentPage + DELTA) + 1,\n  );\n\n  if (currentPage - DELTA > DELTA) {\n    pages.unshift(ELLIPSIS);\n  }\n  if (currentPage + DELTA < pageCount - 1) {\n    pages.push(ELLIPSIS);\n  }\n\n  pages.unshift(1);\n  pages.push(pageCount);\n\n  return pages;\n};\n\nexport const pageIsEllipsis = (pageNumber: NumberOrEllipsis): pageNumber is Ellipsis => pageNumber === ELLIPSIS;\n\nexport const prettifyPageNumber = (pageNumber: NumberOrEllipsis): string =>\n  pageIsEllipsis(pageNumber) ? pageNumber : prettify(pageNumber);\n\nexport const keyForPage = (pageNumber: NumberOrEllipsis, index: number) => !pageIsEllipsis(pageNumber) ? `${pageNumber}` : `${pageNumber}_${index}`;\n","import { Link } from 'react-router-dom';\nimport { Pagination, PaginationItem, PaginationLink } from 'reactstrap';\nimport { pageIsEllipsis, keyForPage, progressivePagination, prettifyPageNumber } from '../utils/helpers/pagination';\nimport { ShlinkPaginator } from '../api/types';\nimport './Paginator.scss';\n\ninterface PaginatorProps {\n  paginator?: ShlinkPaginator;\n  serverId: string;\n}\n\nconst Paginator = ({ paginator, serverId }: PaginatorProps) => {\n  const { currentPage = 0, pagesCount = 0 } = paginator ?? {};\n\n  if (pagesCount <= 1) {\n    return null;\n  }\n\n  const renderPages = () =>\n    progressivePagination(currentPage, pagesCount).map((pageNumber, index) => (\n      <PaginationItem\n        key={keyForPage(pageNumber, index)}\n        disabled={pageIsEllipsis(pageNumber)}\n        active={currentPage === pageNumber}\n      >\n        <PaginationLink\n          tag={Link}\n          to={`/server/${serverId}/list-short-urls/${pageNumber}`}\n        >\n          {prettifyPageNumber(pageNumber)}\n        </PaginationLink>\n      </PaginationItem>\n    ));\n\n  return (\n    <Pagination className=\"short-urls-paginator\" listClassName=\"flex-wrap justify-content-center mb-0\">\n      <PaginationItem disabled={currentPage === 1}>\n        <PaginationLink\n          previous\n          tag={Link}\n          to={`/server/${serverId}/list-short-urls/${currentPage - 1}`}\n        />\n      </PaginationItem>\n      {renderPages()}\n      <PaginationItem disabled={currentPage >= pagesCount}>\n        <PaginationLink\n          next\n          tag={Link}\n          to={`/server/${serverId}/list-short-urls/${currentPage + 1}`}\n        />\n      </PaginationItem>\n    </Pagination>\n  );\n};\n\nexport default Paginator;\n","import { faCaretDown as caretDownIcon, faCaretUp as caretUpIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { head, keys, values } from 'ramda';\nimport { FC, useEffect, useState } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport { Card } from 'reactstrap';\nimport SortingDropdown from '../utils/SortingDropdown';\nimport { determineOrderDir, OrderDir } from '../utils/utils';\nimport { isReachableServer, SelectedServer } from '../servers/data';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { parseQuery } from '../utils/helpers/query';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { ShortUrlsList as ShortUrlsListState } from './reducers/shortUrlsList';\nimport { OrderableFields, ShortUrlsListParams, SORTABLE_FIELDS } from './reducers/shortUrlsListParams';\nimport { ShortUrlsTableProps } from './ShortUrlsTable';\nimport Paginator from './Paginator';\nimport './ShortUrlsList.scss';\n\ninterface RouteParams {\n  page: string;\n  serverId: string;\n}\n\nexport interface ShortUrlsListProps extends RouteComponentProps<RouteParams> {\n  selectedServer: SelectedServer;\n  shortUrlsList: ShortUrlsListState;\n  listShortUrls: (params: ShortUrlsListParams) => void;\n  shortUrlsListParams: ShortUrlsListParams;\n  resetShortUrlParams: () => void;\n}\n\nconst ShortUrlsList = (ShortUrlsTable: FC<ShortUrlsTableProps>) => boundToMercureHub(({\n  listShortUrls,\n  resetShortUrlParams,\n  shortUrlsListParams,\n  match,\n  location,\n  shortUrlsList,\n  selectedServer,\n}: ShortUrlsListProps) => {\n  const { orderBy } = shortUrlsListParams;\n  const [ order, setOrder ] = useState<{ orderField?: OrderableFields; orderDir?: OrderDir }>({\n    orderField: orderBy && (head(keys(orderBy)) as OrderableFields),\n    orderDir: orderBy && head(values(orderBy)),\n  });\n  const { pagination } = shortUrlsList?.shortUrls ?? {};\n  const refreshList = (extraParams: ShortUrlsListParams) => listShortUrls({ ...shortUrlsListParams, ...extraParams });\n  const handleOrderBy = (orderField?: OrderableFields, orderDir?: OrderDir) => {\n    setOrder({ orderField, orderDir });\n    refreshList({ orderBy: orderField ? { [orderField]: orderDir } : undefined });\n  };\n  const orderByColumn = (field: OrderableFields) => () =>\n    handleOrderBy(field, determineOrderDir(field, order.orderField, order.orderDir));\n  const renderOrderIcon = (field: OrderableFields) => {\n    if (order.orderField !== field) {\n      return null;\n    }\n\n    if (!order.orderDir) {\n      return null;\n    }\n\n    return (\n      <FontAwesomeIcon\n        icon={order.orderDir === 'ASC' ? caretUpIcon : caretDownIcon}\n        className=\"short-urls-list__header-icon\"\n      />\n    );\n  };\n\n  useEffect(() => {\n    const { tag } = parseQuery<{ tag?: string }>(location.search);\n    const tags = tag ? [ tag ] : shortUrlsListParams.tags;\n\n    refreshList({ page: match.params.page, tags, itemsPerPage: undefined });\n\n    return resetShortUrlParams;\n  }, []);\n\n  return (\n    <>\n      <div className=\"d-block d-lg-none mb-3\">\n        <SortingDropdown\n          items={SORTABLE_FIELDS}\n          orderField={order.orderField}\n          orderDir={order.orderDir}\n          onChange={handleOrderBy}\n        />\n      </div>\n      <Card body className=\"pb-1\">\n        <ShortUrlsTable\n          orderByColumn={orderByColumn}\n          renderOrderIcon={renderOrderIcon}\n          selectedServer={selectedServer}\n          shortUrlsList={shortUrlsList}\n          onTagClick={(tag) => refreshList({ tags: [ ...shortUrlsListParams.tags ?? [], tag ] })}\n        />\n        <Paginator paginator={pagination} serverId={isReachableServer(selectedServer) ? selectedServer.id : ''} />\n      </Card>\n    </>\n  );\n}, () => [ Topics.visits() ]);\n\nexport default ShortUrlsList;\n","import { FC } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCopy as copyIcon } from '@fortawesome/free-regular-svg-icons';\nimport CopyToClipboard from 'react-copy-to-clipboard';\nimport './CopyToClipboardIcon.scss';\n\ninterface CopyToClipboardIconProps {\n  text: string;\n  onCopy?: (text: string, result: boolean) => void;\n}\n\nexport const CopyToClipboardIcon: FC<CopyToClipboardIconProps> = ({ text, onCopy }) => (\n  <CopyToClipboard text={text} onCopy={onCopy}>\n    <FontAwesomeIcon icon={copyIcon} className=\"ml-2 copy-to-clipboard-icon\" />\n  </CopyToClipboard>\n);\n","import { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport { isServerWithId, SelectedServer, ServerWithId } from '../../servers/data';\nimport { ShortUrl } from '../data';\n\nexport type LinkSuffix = 'visits' | 'edit';\n\nexport interface ShortUrlDetailLinkProps {\n  shortUrl?: ShortUrl | null;\n  selectedServer?: SelectedServer;\n  suffix: LinkSuffix;\n}\n\nconst buildUrl = ({ id }: ServerWithId, { shortCode, domain }: ShortUrl, suffix: LinkSuffix) => {\n  const query = domain ? `?domain=${domain}` : '';\n\n  return `/server/${id}/short-code/${shortCode}/${suffix}${query}`;\n};\n\nconst ShortUrlDetailLink: FC<ShortUrlDetailLinkProps & Record<string | number, any>> = (\n  { selectedServer, shortUrl, suffix, children, ...rest },\n) => {\n  if (!selectedServer || !isServerWithId(selectedServer) || !shortUrl) {\n    return <span {...rest}>{children}</span>;\n  }\n\n  return <Link to={buildUrl(selectedServer, shortUrl, suffix)} {...rest}>{children}</Link>;\n};\n\nexport default ShortUrlDetailLink;\n","import { useRef } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faInfoCircle as infoIcon } from '@fortawesome/free-solid-svg-icons';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport classNames from 'classnames';\nimport { prettify } from '../../utils/helpers/numbers';\nimport { ShortUrl } from '../data';\nimport { SelectedServer } from '../../servers/data';\nimport ShortUrlDetailLink from './ShortUrlDetailLink';\nimport './ShortUrlVisitsCount.scss';\n\ninterface ShortUrlVisitsCountProps {\n  shortUrl?: ShortUrl | null;\n  selectedServer?: SelectedServer;\n  visitsCount: number;\n  active?: boolean;\n}\n\nconst ShortUrlVisitsCount = ({ visitsCount, shortUrl, selectedServer, active = false }: ShortUrlVisitsCountProps) => {\n  const maxVisits = shortUrl?.meta?.maxVisits;\n  const visitsLink = (\n    <ShortUrlDetailLink selectedServer={selectedServer} shortUrl={shortUrl} suffix=\"visits\">\n      <strong\n        className={classNames('short-url-visits-count__amount', { 'short-url-visits-count__amount--big': active })}\n      >\n        {prettify(visitsCount)}\n      </strong>\n    </ShortUrlDetailLink>\n  );\n\n  if (!maxVisits) {\n    return visitsLink;\n  }\n\n  const prettifiedMaxVisits = prettify(maxVisits);\n  const tooltipRef = useRef<HTMLElement | null>();\n\n  return (\n    <>\n      <span className=\"indivisible\">\n        {visitsLink}\n        <small\n          className=\"short-urls-visits-count__max-visits-control\"\n          ref={(el) => {\n            tooltipRef.current = el;\n          }}\n        >\n          {' '}/ {prettifiedMaxVisits}{' '}\n          <sup>\n            <FontAwesomeIcon icon={infoIcon} />\n          </sup>\n        </small>\n      </span>\n      <UncontrolledTooltip target={(() => tooltipRef.current) as any} placement=\"bottom\">\n        This short URL will not accept more than <b>{prettifiedMaxVisits}</b> visits.\n      </UncontrolledTooltip>\n    </>\n  );\n};\n\nexport default ShortUrlVisitsCount;\n","import { isEmpty } from 'ramda';\nimport { FC, useEffect, useRef } from 'react';\nimport Moment from 'react-moment';\nimport { ExternalLink } from 'react-external-link';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { StateFlagTimeout } from '../../utils/helpers/hooks';\nimport Tag from '../../tags/helpers/Tag';\nimport { SelectedServer } from '../../servers/data';\nimport { CopyToClipboardIcon } from '../../utils/CopyToClipboardIcon';\nimport { ShortUrl } from '../data';\nimport ShortUrlVisitsCount from './ShortUrlVisitsCount';\nimport { ShortUrlsRowMenuProps } from './ShortUrlsRowMenu';\nimport './ShortUrlsRow.scss';\n\nexport interface ShortUrlsRowProps {\n  onTagClick?: (tag: string) => void;\n  selectedServer: SelectedServer;\n  shortUrl: ShortUrl;\n}\n\nconst ShortUrlsRow = (\n  ShortUrlsRowMenu: FC<ShortUrlsRowMenuProps>,\n  colorGenerator: ColorGenerator,\n  useStateFlagTimeout: StateFlagTimeout,\n) => ({ shortUrl, selectedServer, onTagClick }: ShortUrlsRowProps) => {\n  const [ copiedToClipboard, setCopiedToClipboard ] = useStateFlagTimeout();\n  const [ active, setActive ] = useStateFlagTimeout(false, 500);\n  const isFirstRun = useRef(true);\n\n  const renderTags = (tags: string[]) => {\n    if (isEmpty(tags)) {\n      return <i className=\"indivisible\"><small>No tags</small></i>;\n    }\n\n    return tags.map((tag) => (\n      <Tag\n        colorGenerator={colorGenerator}\n        key={tag}\n        text={tag}\n        onClick={() => onTagClick?.(tag)}\n      />\n    ));\n  };\n\n  useEffect(() => {\n    if (isFirstRun.current) {\n      isFirstRun.current = false;\n    } else {\n      setActive();\n    }\n  }, [ shortUrl.visitsCount ]);\n\n  return (\n    <tr className=\"short-urls-row\">\n      <td className=\"indivisible short-urls-row__cell\" data-th=\"Created at: \">\n        <Moment format=\"YYYY-MM-DD HH:mm\">{shortUrl.dateCreated}</Moment>\n      </td>\n      <td className=\"short-urls-row__cell\" data-th=\"Short URL: \">\n        <span className=\"indivisible short-urls-row__cell--relative\">\n          <ExternalLink href={shortUrl.shortUrl} />\n          <CopyToClipboardIcon text={shortUrl.shortUrl} onCopy={setCopiedToClipboard} />\n          <span className=\"badge badge-warning short-urls-row__copy-hint\" hidden={!copiedToClipboard}>\n            Copied short URL!\n          </span>\n        </span>\n      </td>\n      <td className=\"short-urls-row__cell short-urls-row__cell--break\" data-th={`${shortUrl.title ? 'Title' : 'Long URL'}: `}>\n        <ExternalLink href={shortUrl.longUrl}>{shortUrl.title ?? shortUrl.longUrl}</ExternalLink>\n      </td>\n      {shortUrl.title && (\n        <td className=\"short-urls-row__cell d-lg-none\" data-th=\"Long URL: \">\n          <ExternalLink href={shortUrl.longUrl} />\n        </td>\n      )}\n      <td className=\"short-urls-row__cell\" data-th=\"Tags: \">{renderTags(shortUrl.tags)}</td>\n      <td className=\"short-urls-row__cell text-md-right\" data-th=\"Visits: \">\n        <ShortUrlVisitsCount\n          visitsCount={shortUrl.visitsCount}\n          shortUrl={shortUrl}\n          selectedServer={selectedServer}\n          active={active}\n        />\n      </td>\n      <td className=\"short-urls-row__cell\">\n        <ShortUrlsRowMenu selectedServer={selectedServer} shortUrl={shortUrl} />\n      </td>\n    </tr>\n  );\n};\n\nexport default ShortUrlsRow;\n","import {\n  faChartPie as pieChartIcon,\n  faEllipsisV as menuIcon,\n  faQrcode as qrIcon,\n  faMinusCircle as deleteIcon,\n  faEdit as editIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { FC } from 'react';\nimport { ButtonDropdown, DropdownItem, DropdownMenu, DropdownToggle } from 'reactstrap';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { ShortUrl, ShortUrlModalProps } from '../data';\nimport { SelectedServer } from '../../servers/data';\nimport ShortUrlDetailLink from './ShortUrlDetailLink';\nimport './ShortUrlsRowMenu.scss';\n\nexport interface ShortUrlsRowMenuProps {\n  selectedServer: SelectedServer;\n  shortUrl: ShortUrl;\n}\ntype ShortUrlModal = FC<ShortUrlModalProps>;\n\nconst ShortUrlsRowMenu = (\n  DeleteShortUrlModal: ShortUrlModal,\n  QrCodeModal: ShortUrlModal,\n) => ({ shortUrl, selectedServer }: ShortUrlsRowMenuProps) => {\n  const [ isOpen, toggle ] = useToggle();\n  const [ isQrModalOpen, toggleQrCode ] = useToggle();\n  const [ isDeleteModalOpen, toggleDelete ] = useToggle();\n\n  return (\n    <ButtonDropdown toggle={toggle} isOpen={isOpen}>\n      <DropdownToggle size=\"sm\" caret outline className=\"short-urls-row-menu__dropdown-toggle\">\n        &nbsp;<FontAwesomeIcon icon={menuIcon} />&nbsp;\n      </DropdownToggle>\n      <DropdownMenu right>\n        <DropdownItem tag={ShortUrlDetailLink} selectedServer={selectedServer} shortUrl={shortUrl} suffix=\"visits\">\n          <FontAwesomeIcon icon={pieChartIcon} fixedWidth /> Visit stats\n        </DropdownItem>\n\n        <DropdownItem tag={ShortUrlDetailLink} selectedServer={selectedServer} shortUrl={shortUrl} suffix=\"edit\">\n          <FontAwesomeIcon icon={editIcon} fixedWidth /> Edit short URL\n        </DropdownItem>\n\n        <DropdownItem onClick={toggleQrCode}>\n          <FontAwesomeIcon icon={qrIcon} fixedWidth /> QR code\n        </DropdownItem>\n        <QrCodeModal shortUrl={shortUrl} isOpen={isQrModalOpen} toggle={toggleQrCode} />\n\n        <DropdownItem divider />\n\n        <DropdownItem className=\"short-urls-row-menu__dropdown-item--danger\" onClick={toggleDelete}>\n          <FontAwesomeIcon icon={deleteIcon} fixedWidth /> Delete short URL\n        </DropdownItem>\n        <DeleteShortUrlModal shortUrl={shortUrl} isOpen={isDeleteModalOpen} toggle={toggleDelete} />\n      </DropdownMenu>\n    </ButtonDropdown>\n  );\n};\n\nexport default ShortUrlsRowMenu;\n","import { FC, useMemo } from 'react';\nimport { SelectedServer } from '../servers/data';\nimport { Settings, ShortUrlCreationSettings } from '../settings/reducers/settings';\nimport { ShortUrlData } from './data';\nimport { ShortUrlCreation } from './reducers/shortUrlCreation';\nimport { CreateShortUrlResultProps } from './helpers/CreateShortUrlResult';\nimport { ShortUrlFormProps } from './ShortUrlForm';\n\nexport interface CreateShortUrlProps {\n  basicMode?: boolean;\n}\n\ninterface CreateShortUrlConnectProps extends CreateShortUrlProps {\n  settings: Settings;\n  shortUrlCreationResult: ShortUrlCreation;\n  selectedServer: SelectedServer;\n  createShortUrl: (data: ShortUrlData) => Promise<void>;\n  resetCreateShortUrl: () => void;\n}\n\nconst getInitialState = (settings?: ShortUrlCreationSettings): ShortUrlData => ({\n  longUrl: '',\n  tags: [],\n  customSlug: '',\n  title: undefined,\n  shortCodeLength: undefined,\n  domain: '',\n  validSince: undefined,\n  validUntil: undefined,\n  maxVisits: undefined,\n  findIfExists: false,\n  validateUrl: settings?.validateUrls ?? false,\n});\n\nconst CreateShortUrl = (ShortUrlForm: FC<ShortUrlFormProps>, CreateShortUrlResult: FC<CreateShortUrlResultProps>) => ({\n  createShortUrl,\n  shortUrlCreationResult,\n  resetCreateShortUrl,\n  selectedServer,\n  basicMode = false,\n  settings: { shortUrlCreation: shortUrlCreationSettings },\n}: CreateShortUrlConnectProps) => {\n  const initialState = useMemo(() => getInitialState(shortUrlCreationSettings), [ shortUrlCreationSettings ]);\n\n  return (\n    <>\n      <ShortUrlForm\n        initialState={initialState}\n        saving={shortUrlCreationResult.saving}\n        selectedServer={selectedServer}\n        mode={basicMode ? 'create-basic' : 'create'}\n        onSave={async (data: ShortUrlData) => {\n          resetCreateShortUrl();\n\n          return createShortUrl(data);\n        }}\n      />\n      <CreateShortUrlResult\n        {...shortUrlCreationResult}\n        resetCreateShortUrl={resetCreateShortUrl}\n        canBeClosed={basicMode}\n      />\n    </>\n  );\n};\n\nexport default CreateShortUrl;\n","import { FC } from 'react';\nimport { Row } from 'reactstrap';\nimport classNames from 'classnames';\nimport { SimpleCard } from './SimpleCard';\n\nexport type ResultType = 'success' | 'error' | 'warning';\n\nexport interface ResultProps {\n  type: ResultType;\n  className?: string;\n  small?: boolean;\n}\n\nexport const Result: FC<ResultProps> = ({ children, type, className, small = false }) => (\n  <Row className={className}>\n    <div className={classNames({ 'col-md-10 offset-md-1': !small, 'col-12': small })}>\n      <SimpleCard\n        className={classNames('text-center', {\n          'bg-main': type === 'success',\n          'bg-danger': type === 'error',\n          'bg-warning': type === 'warning',\n          'text-white': type !== 'warning',\n        })}\n        bodyClassName={classNames({ 'p-2': small })}\n      >\n        {children}\n      </SimpleCard>\n    </div>\n  </Row>\n);\n","import { ProblemDetailsError } from './types';\nimport { isInvalidArgumentError } from './utils';\n\nexport interface ShlinkApiErrorProps {\n  errorData?: ProblemDetailsError;\n  fallbackMessage?: string;\n}\n\nexport const ShlinkApiError = ({ errorData, fallbackMessage }: ShlinkApiErrorProps) => (\n  <>\n    {errorData?.detail ?? fallbackMessage}\n    {isInvalidArgumentError(errorData) &&\n      <p className=\"mb-0\">Invalid elements: [{errorData.invalidElements.join(', ')}]</p>\n    }\n  </>\n);\n","import { useEffect, useState } from 'react';\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { identity, pipe } from 'ramda';\nimport { ShortUrlDeletion } from '../reducers/shortUrlDeletion';\nimport { ShortUrlModalProps } from '../data';\nimport { handleEventPreventingDefault, OptionalString } from '../../utils/utils';\nimport { Result } from '../../utils/Result';\nimport { isInvalidDeletionError } from '../../api/utils';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\n\ninterface DeleteShortUrlModalConnectProps extends ShortUrlModalProps {\n  shortUrlDeletion: ShortUrlDeletion;\n  deleteShortUrl: (shortCode: string, domain: OptionalString) => Promise<void>;\n  resetDeleteShortUrl: () => void;\n}\n\nconst DeleteShortUrlModal = (\n  { shortUrl, toggle, isOpen, shortUrlDeletion, resetDeleteShortUrl, deleteShortUrl }: DeleteShortUrlModalConnectProps,\n) => {\n  const [ inputValue, setInputValue ] = useState('');\n\n  useEffect(() => resetDeleteShortUrl, []);\n\n  const { error, errorData } = shortUrlDeletion;\n  const close = pipe(resetDeleteShortUrl, toggle);\n  const handleDeleteUrl = handleEventPreventingDefault(() => {\n    const { shortCode, domain } = shortUrl;\n\n    deleteShortUrl(shortCode, domain)\n      .then(toggle)\n      .catch(identity);\n  });\n\n  return (\n    <Modal isOpen={isOpen} toggle={close} centered>\n      <form onSubmit={handleDeleteUrl}>\n        <ModalHeader toggle={close}>\n          <span className=\"text-danger\">Delete short URL</span>\n        </ModalHeader>\n        <ModalBody>\n          <p><b className=\"text-danger\">Caution!</b> You are about to delete a short URL.</p>\n          <p>This action cannot be undone. Once you have deleted it, all the visits stats will be lost.</p>\n          <p>Write <b>{shortUrl.shortCode}</b> to confirm deletion.</p>\n\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder={`Insert the short code (${shortUrl.shortCode})`}\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n          />\n\n          {error && (\n            <Result type={isInvalidDeletionError(errorData) ? 'warning' : 'error'} small className=\"mt-2\">\n              <ShlinkApiError errorData={errorData} fallbackMessage=\"Something went wrong while deleting the URL :(\" />\n            </Result>\n          )}\n        </ModalBody>\n        <ModalFooter>\n          <button type=\"button\" className=\"btn btn-link\" onClick={close}>Cancel</button>\n          <button\n            type=\"submit\"\n            className=\"btn btn-danger\"\n            disabled={inputValue !== shortUrl.shortCode || shortUrlDeletion.loading}\n          >\n            {shortUrlDeletion.loading ? 'Deleting...' : 'Delete'}\n          </button>\n        </ModalFooter>\n      </form>\n    </Modal>\n  );\n};\n\nexport default DeleteShortUrlModal;\n","import { faCopy as copyIcon } from '@fortawesome/free-regular-svg-icons';\nimport { faTimes as closeIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { isNil } from 'ramda';\nimport { useEffect } from 'react';\nimport CopyToClipboard from 'react-copy-to-clipboard';\nimport { Tooltip } from 'reactstrap';\nimport { ShortUrlCreation } from '../reducers/shortUrlCreation';\nimport { StateFlagTimeout } from '../../utils/helpers/hooks';\nimport { Result } from '../../utils/Result';\nimport './CreateShortUrlResult.scss';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\n\nexport interface CreateShortUrlResultProps extends ShortUrlCreation {\n  resetCreateShortUrl: () => void;\n  canBeClosed?: boolean;\n}\n\nconst CreateShortUrlResult = (useStateFlagTimeout: StateFlagTimeout) => (\n  { error, errorData, result, resetCreateShortUrl, canBeClosed = false }: CreateShortUrlResultProps,\n) => {\n  const [ showCopyTooltip, setShowCopyTooltip ] = useStateFlagTimeout();\n\n  useEffect(() => {\n    resetCreateShortUrl();\n  }, []);\n\n  if (error) {\n    return (\n      <Result type=\"error\" className=\"mt-3\">\n        {canBeClosed && <FontAwesomeIcon icon={closeIcon} className=\"float-right pointer\" onClick={resetCreateShortUrl} />}\n        <ShlinkApiError errorData={errorData} fallbackMessage=\"An error occurred while creating the URL :(\" />\n      </Result>\n    );\n  }\n\n  if (isNil(result)) {\n    return null;\n  }\n\n  const { shortUrl } = result;\n\n  return (\n    <Result type=\"success\" className=\"mt-3\">\n      {canBeClosed && <FontAwesomeIcon icon={closeIcon} className=\"float-right pointer\" onClick={resetCreateShortUrl} />}\n      <b>Great!</b> The short URL is <b>{shortUrl}</b>\n\n      <CopyToClipboard text={shortUrl} onCopy={setShowCopyTooltip}>\n        <button\n          className=\"btn btn-light btn-sm create-short-url-result__copy-btn\"\n          id=\"copyBtn\"\n          type=\"button\"\n        >\n          <FontAwesomeIcon icon={copyIcon} /> Copy\n        </button>\n      </CopyToClipboard>\n\n      <Tooltip placement=\"left\" isOpen={showCopyTooltip} target=\"copyBtn\">\n        Copied!\n      </Tooltip>\n    </Result>\n  );\n};\n\nexport default CreateShortUrlResult;\n","import { FC, ReactNode } from 'react';\nimport { isEmpty } from 'ramda';\nimport classNames from 'classnames';\nimport { SelectedServer } from '../servers/data';\nimport { supportsShortUrlTitle } from '../utils/helpers/features';\nimport { ShortUrlsList as ShortUrlsListState } from './reducers/shortUrlsList';\nimport { ShortUrlsRowProps } from './helpers/ShortUrlsRow';\nimport { OrderableFields } from './reducers/shortUrlsListParams';\nimport './ShortUrlsTable.scss';\n\nexport interface ShortUrlsTableProps {\n  orderByColumn?: (column: OrderableFields) => () => void;\n  renderOrderIcon?: (column: OrderableFields) => ReactNode;\n  shortUrlsList: ShortUrlsListState;\n  selectedServer: SelectedServer;\n  onTagClick?: (tag: string) => void;\n  className?: string;\n}\n\nexport const ShortUrlsTable = (ShortUrlsRow: FC<ShortUrlsRowProps>) => ({\n  orderByColumn,\n  renderOrderIcon,\n  shortUrlsList,\n  onTagClick,\n  selectedServer,\n  className,\n}: ShortUrlsTableProps) => {\n  const { error, loading, shortUrls } = shortUrlsList;\n  const actionableFieldClasses = classNames({ 'short-urls-table__header-cell--with-action': !!orderByColumn });\n  const orderableColumnsClasses = classNames('short-urls-table__header-cell', actionableFieldClasses);\n  const tableClasses = classNames('table table-hover', className);\n  const supportsTitle = supportsShortUrlTitle(selectedServer);\n\n  const renderShortUrls = () => {\n    if (error) {\n      return (\n        <tr>\n          <td colSpan={6} className=\"text-center table-danger\">Something went wrong while loading short URLs :(</td>\n        </tr>\n      );\n    }\n\n    if (loading) {\n      return <tr><td colSpan={6} className=\"text-center\">Loading...</td></tr>;\n    }\n\n    if (!loading && isEmpty(shortUrls?.data)) {\n      return <tr><td colSpan={6} className=\"text-center\">No results found</td></tr>;\n    }\n\n    return shortUrls?.data.map((shortUrl) => (\n      <ShortUrlsRow\n        key={shortUrl.shortUrl}\n        shortUrl={shortUrl}\n        selectedServer={selectedServer}\n        onTagClick={onTagClick}\n      />\n    ));\n  };\n\n  return (\n    <table className={tableClasses}>\n      <thead className=\"short-urls-table__header\">\n        <tr>\n          <th className={orderableColumnsClasses} onClick={orderByColumn?.('dateCreated')}>\n            Created at\n            {renderOrderIcon?.('dateCreated')}\n          </th>\n          <th className={orderableColumnsClasses} onClick={orderByColumn?.('shortCode')}>\n            Short URL\n            {renderOrderIcon?.('shortCode')}\n          </th>\n          {!supportsTitle && (\n            <th className={orderableColumnsClasses} onClick={orderByColumn?.('longUrl')}>\n              Long URL\n              {renderOrderIcon?.('longUrl')}\n            </th>\n          ) || (\n            <th className=\"short-urls-table__header-cell\">\n              <span className={actionableFieldClasses} onClick={orderByColumn?.('title')}>\n                Title\n                {renderOrderIcon?.('title')}\n              </span>\n              &nbsp;&nbsp;/&nbsp;&nbsp;\n              <span className={actionableFieldClasses} onClick={orderByColumn?.('longUrl')}>\n                <span className=\"indivisible\">Long URL</span>\n                {renderOrderIcon?.('longUrl')}\n              </span>\n            </th>\n          )}\n          <th className=\"short-urls-table__header-cell\">Tags</th>\n          <th className={orderableColumnsClasses} onClick={orderByColumn?.('visits')}>\n            <span className=\"indivisible\">Visits{renderOrderIcon?.('visits')}</span>\n          </th>\n          <th className=\"short-urls-table__header-cell\">&nbsp;</th>\n        </tr>\n      </thead>\n      <tbody>\n        {renderShortUrls()}\n      </tbody>\n    </table>\n  );\n};\n","import { isEmpty } from 'ramda';\nimport { stringifyQuery } from './query';\n\nexport interface QrCodeCapabilities {\n  useSizeInPath: boolean;\n  svgIsSupported: boolean;\n  marginIsSupported: boolean;\n}\n\nexport type QrCodeFormat = 'svg' | 'png';\n\nexport interface QrCodeOptions {\n  size: number;\n  format: QrCodeFormat;\n  margin: number;\n}\n\nexport const buildQrCodeUrl = (\n  shortUrl: string,\n  { size, format, margin }: QrCodeOptions,\n  { useSizeInPath, svgIsSupported, marginIsSupported }: QrCodeCapabilities,\n): string => {\n  const baseUrl = `${shortUrl}/qr-code${useSizeInPath ? `/${size}` : ''}`;\n  const query = stringifyQuery({\n    size: useSizeInPath ? undefined : size,\n    format: svgIsSupported ? format : undefined,\n    margin: marginIsSupported && margin > 0 ? margin : undefined,\n  });\n\n  return `${baseUrl}${isEmpty(query) ? '' : `?${query}`}`;\n};\n","import { useMemo, useState } from 'react';\nimport { Modal, DropdownItem, FormGroup, ModalBody, ModalHeader, Row } from 'reactstrap';\nimport { ExternalLink } from 'react-external-link';\nimport classNames from 'classnames';\nimport { ShortUrlModalProps } from '../data';\nimport { SelectedServer } from '../../servers/data';\nimport { DropdownBtn } from '../../utils/DropdownBtn';\nimport { CopyToClipboardIcon } from '../../utils/CopyToClipboardIcon';\nimport { buildQrCodeUrl, QrCodeCapabilities, QrCodeFormat } from '../../utils/helpers/qrCodes';\nimport { supportsQrCodeSizeInQuery, supportsQrCodeSvgFormat, supportsQrCodeMargin } from '../../utils/helpers/features';\nimport './QrCodeModal.scss';\n\ninterface QrCodeModalConnectProps extends ShortUrlModalProps {\n  selectedServer: SelectedServer;\n}\n\nconst QrCodeModal = ({ shortUrl: { shortUrl }, toggle, isOpen, selectedServer }: QrCodeModalConnectProps) => {\n  const [ size, setSize ] = useState(300);\n  const [ margin, setMargin ] = useState(0);\n  const [ format, setFormat ] = useState<QrCodeFormat>('png');\n  const capabilities: QrCodeCapabilities = useMemo(() => ({\n    useSizeInPath: !supportsQrCodeSizeInQuery(selectedServer),\n    svgIsSupported: supportsQrCodeSvgFormat(selectedServer),\n    marginIsSupported: supportsQrCodeMargin(selectedServer),\n  }), [ selectedServer ]);\n  const qrCodeUrl = useMemo(\n    () => buildQrCodeUrl(shortUrl, { size, format, margin }, capabilities),\n    [ shortUrl, size, format, margin, capabilities ],\n  );\n  const totalSize = useMemo(() => size + margin, [ size, margin ]);\n  const modalSize = useMemo(() => {\n    if (totalSize < 500) {\n      return undefined;\n    }\n\n    return totalSize < 800 ? 'lg' : 'xl';\n  }, [ totalSize ]);\n\n  return (\n    <Modal isOpen={isOpen} toggle={toggle} centered size={modalSize}>\n      <ModalHeader toggle={toggle}>\n        QR code for <ExternalLink href={shortUrl}>{shortUrl}</ExternalLink>\n      </ModalHeader>\n      <ModalBody>\n        <Row className=\"mb-2\">\n          <div\n            className={classNames({\n              'col-md-4': capabilities.marginIsSupported && capabilities.svgIsSupported,\n              'col-md-6': (!capabilities.marginIsSupported && capabilities.svgIsSupported) || (capabilities.marginIsSupported && !capabilities.svgIsSupported),\n              'col-12': !capabilities.marginIsSupported && !capabilities.svgIsSupported,\n            })}\n          >\n            <FormGroup>\n              <label className=\"mb-0\">Size: {size}px</label>\n              <input\n                type=\"range\"\n                className=\"form-control-range\"\n                value={size}\n                step={10}\n                min={50}\n                max={1000}\n                onChange={(e) => setSize(Number(e.target.value))}\n              />\n            </FormGroup>\n          </div>\n          {capabilities.marginIsSupported && (\n            <div className={capabilities.svgIsSupported ? 'col-md-4' : 'col-md-6'}>\n              <FormGroup>\n                <label className=\"mb-0\">Margin: {margin}px</label>\n                <input\n                  type=\"range\"\n                  className=\"form-control-range\"\n                  value={margin}\n                  step={1}\n                  min={0}\n                  max={100}\n                  onChange={(e) => setMargin(Number(e.target.value))}\n                />\n              </FormGroup>\n            </div>\n          )}\n          {capabilities.svgIsSupported && (\n            <div className={capabilities.marginIsSupported ? 'col-md-4' : 'col-md-6'}>\n              <DropdownBtn text={`Format (${format})`}>\n                <DropdownItem active={format === 'png'} onClick={() => setFormat('png')}>PNG</DropdownItem>\n                <DropdownItem active={format === 'svg'} onClick={() => setFormat('svg')}>SVG</DropdownItem>\n              </DropdownBtn>\n            </div>\n          )}\n        </Row>\n        <div className=\"text-center\">\n          <div className=\"mb-3\">\n            <div>QR code URL:</div>\n            <ExternalLink href={qrCodeUrl} />\n            <CopyToClipboardIcon text={qrCodeUrl} />\n          </div>\n          <img src={qrCodeUrl} className=\"qr-code-modal__img\" alt=\"QR code\" />\n          <div className=\"mt-2\">{size}x{size}</div>\n        </div>\n      </ModalBody>\n    </Modal>\n  );\n};\n\nexport default QrCodeModal;\n","import { ChangeEvent, FC, useRef } from 'react';\nimport classNames from 'classnames';\nimport { v4 as uuid } from 'uuid';\nimport { identity } from 'ramda';\n\nexport interface BooleanControlProps {\n  checked?: boolean;\n  onChange?: (checked: boolean, e: ChangeEvent<HTMLInputElement>) => void;\n  className?: string;\n  inline?: boolean;\n}\n\ninterface BooleanControlWithTypeProps extends BooleanControlProps {\n  type: 'switch' | 'checkbox';\n}\n\nconst BooleanControl: FC<BooleanControlWithTypeProps> = (\n  { checked = false, onChange = identity, className, children, type, inline = false },\n) => {\n  const { current: id } = useRef(uuid());\n  const onChecked = (e: ChangeEvent<HTMLInputElement>) => onChange(e.target.checked, e);\n  const typeClasses = {\n    'custom-switch': type === 'switch',\n    'custom-checkbox': type === 'checkbox',\n  };\n  const style = inline ? { display: 'inline-block' } : {};\n\n  return (\n    <span className={classNames('custom-control', typeClasses, className)} style={style}>\n      <input type=\"checkbox\" className=\"custom-control-input\" id={id} checked={checked} onChange={onChecked} />\n      <label className=\"custom-control-label\" htmlFor={id}>{children}</label>\n    </span>\n  );\n};\n\nexport default BooleanControl;\n","import { FC } from 'react';\nimport BooleanControl, { BooleanControlProps } from './BooleanControl';\n\nconst Checkbox: FC<BooleanControlProps> = (props) => <BooleanControl type=\"checkbox\" {...props} />;\n\nexport default Checkbox;\n","import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faInfoCircle as infoIcon } from '@fortawesome/free-solid-svg-icons';\nimport { Modal, ModalBody, ModalHeader } from 'reactstrap';\nimport { useToggle } from '../utils/helpers/hooks';\nimport './UseExistingIfFoundInfoIcon.scss';\n\nconst InfoModal = ({ isOpen, toggle }: { isOpen: boolean; toggle: () => void }) => (\n  <Modal isOpen={isOpen} toggle={toggle} centered size=\"lg\">\n    <ModalHeader toggle={toggle}>Info</ModalHeader>\n    <ModalBody>\n      <p>\n        When the&nbsp;\n        <b><i>&quot;Use existing URL if found&quot;</i></b>\n        &nbsp;checkbox is checked, the server will return an existing short URL if it matches provided params.\n      </p>\n      <p>\n        These are the checks performed by Shlink in order to determine if an existing short URL should be returned:\n      </p>\n      <ul>\n        <li>\n          When only the long URL is provided: The most recent match will be returned, or a new short URL will be created\n          if none is found.\n        </li>\n        <li>\n          When long URL and custom slug and/or domain are provided: Same as in previous case, but it will try to match\n          the short URL using both the long URL and the slug, the long URL and the domain, or the three of them.\n          <br />\n          If the slug is being used by another long URL, an error will be returned.\n        </li>\n        <li>\n          When other params are provided: Same as in previous cases, but it will try to match existing short URLs with\n          all provided data. If any of them does not match, a new short URL will be created\n        </li>\n      </ul>\n    </ModalBody>\n  </Modal>\n);\n\nconst UseExistingIfFoundInfoIcon = () => {\n  const [ isModalOpen, toggleModal ] = useToggle();\n\n  return (\n    <>\n      <span title=\"What does this mean?\">\n        <FontAwesomeIcon icon={infoIcon} style={{ cursor: 'pointer' }} onClick={toggleModal} />\n      </span>\n      <InfoModal isOpen={isModalOpen} toggle={toggleModal} />\n    </>\n  );\n};\n\nexport default UseExistingIfFoundInfoIcon;\n","import { FC, useEffect, useState } from 'react';\nimport { InputType } from 'reactstrap/lib/Input';\nimport { Button, FormGroup, Input, Row } from 'reactstrap';\nimport { isEmpty, pipe, replace, trim } from 'ramda';\nimport m from 'moment';\nimport classNames from 'classnames';\nimport DateInput, { DateInputProps } from '../utils/DateInput';\nimport {\n  supportsListingDomains,\n  supportsSettingShortCodeLength,\n  supportsShortUrlTitle,\n  supportsValidateUrl,\n} from '../utils/helpers/features';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { handleEventPreventingDefault, hasValue } from '../utils/utils';\nimport Checkbox from '../utils/Checkbox';\nimport { SelectedServer } from '../servers/data';\nimport { TagsSelectorProps } from '../tags/helpers/TagsSelector';\nimport { DomainSelectorProps } from '../domains/DomainSelector';\nimport { formatIsoDate } from '../utils/helpers/date';\nimport UseExistingIfFoundInfoIcon from './UseExistingIfFoundInfoIcon';\nimport { ShortUrlData } from './data';\nimport './ShortUrlForm.scss';\n\nexport type Mode = 'create' | 'create-basic' | 'edit';\n\ntype DateFields = 'validSince' | 'validUntil';\ntype NonDateFields = 'longUrl' | 'customSlug' | 'shortCodeLength' | 'domain' | 'maxVisits' | 'title';\n\nexport interface ShortUrlFormProps {\n  mode: Mode;\n  saving: boolean;\n  initialState: ShortUrlData;\n  onSave: (shortUrlData: ShortUrlData) => Promise<unknown>;\n  selectedServer: SelectedServer;\n}\n\nconst normalizeTag = pipe(trim, replace(/ /g, '-'));\n\nexport const ShortUrlForm = (\n  TagsSelector: FC<TagsSelectorProps>,\n  DomainSelector: FC<DomainSelectorProps>,\n): FC<ShortUrlFormProps> => ({ mode, saving, onSave, initialState, selectedServer }) => { // eslint-disable-line complexity\n  const [ shortUrlData, setShortUrlData ] = useState(initialState);\n  const isEdit = mode === 'edit';\n  const changeTags = (tags: string[]) => setShortUrlData({ ...shortUrlData, tags: tags.map(normalizeTag) });\n  const reset = () => setShortUrlData(initialState);\n  const submit = handleEventPreventingDefault(async () => onSave({\n    ...shortUrlData,\n    validSince: formatIsoDate(shortUrlData.validSince) ?? null,\n    validUntil: formatIsoDate(shortUrlData.validUntil) ?? null,\n    maxVisits: !hasValue(shortUrlData.maxVisits) ? null : Number(shortUrlData.maxVisits),\n    title: !hasValue(shortUrlData.title) ? undefined : shortUrlData.title,\n  }).then(() => !isEdit && reset()).catch(() => {}));\n\n  useEffect(() => {\n    setShortUrlData(initialState);\n  }, [ initialState ]);\n\n  const renderOptionalInput = (id: NonDateFields, placeholder: string, type: InputType = 'text', props = {}) => (\n    <FormGroup>\n      <Input\n        id={id}\n        type={type}\n        placeholder={placeholder}\n        value={shortUrlData[id] ?? ''}\n        onChange={(e) => setShortUrlData({ ...shortUrlData, [id]: e.target.value })}\n        {...props}\n      />\n    </FormGroup>\n  );\n  const renderDateInput = (id: DateFields, placeholder: string, props: Partial<DateInputProps> = {}) => (\n    <div className=\"form-group\">\n      <DateInput\n        selected={shortUrlData[id] ? m(shortUrlData[id]) : null}\n        placeholderText={placeholder}\n        isClearable\n        onChange={(date) => setShortUrlData({ ...shortUrlData, [id]: date })}\n        {...props}\n      />\n    </div>\n  );\n  const basicComponents = (\n    <>\n      <FormGroup>\n        <Input\n          bsSize=\"lg\"\n          type=\"url\"\n          placeholder=\"URL to be shortened\"\n          required\n          value={shortUrlData.longUrl}\n          onChange={(e) => setShortUrlData({ ...shortUrlData, longUrl: e.target.value })}\n        />\n      </FormGroup>\n\n      <FormGroup>\n        <TagsSelector tags={shortUrlData.tags ?? []} onChange={changeTags} />\n      </FormGroup>\n    </>\n  );\n\n  const showDomainSelector = supportsListingDomains(selectedServer);\n  const disableShortCodeLength = !supportsSettingShortCodeLength(selectedServer);\n  const supportsTitle = supportsShortUrlTitle(selectedServer);\n  const showCustomizeCard = supportsTitle || !isEdit;\n  const limitAccessCardClasses = classNames('mb-3', {\n    'col-sm-6': showCustomizeCard,\n    'col-sm-12': !showCustomizeCard,\n  });\n  const showValidateUrl = supportsValidateUrl(selectedServer);\n  const showExtraValidationsCard = showValidateUrl || !isEdit;\n\n  return (\n    <form className=\"short-url-form\" onSubmit={submit}>\n      {mode === 'create-basic' && basicComponents}\n      {mode !== 'create-basic' && (\n        <>\n          <SimpleCard title=\"Basic options\" className=\"mb-3\">\n            {basicComponents}\n          </SimpleCard>\n\n          <Row>\n            {showCustomizeCard && (\n              <div className=\"col-sm-6 mb-3\">\n                <SimpleCard title=\"Customize the short URL\">\n                  {supportsTitle && renderOptionalInput('title', 'Title')}\n                  {!isEdit && (\n                    <>\n                      <Row>\n                        <div className=\"col-lg-6\">\n                          {renderOptionalInput('customSlug', 'Custom slug', 'text', {\n                            disabled: hasValue(shortUrlData.shortCodeLength),\n                          })}\n                        </div>\n                        <div className=\"col-lg-6\">\n                          {renderOptionalInput('shortCodeLength', 'Short code length', 'number', {\n                            min: 4,\n                            disabled: disableShortCodeLength || hasValue(shortUrlData.customSlug),\n                            ...disableShortCodeLength && {\n                              title: 'Shlink 2.1.0 or higher is required to be able to provide the short code length',\n                            },\n                          })}\n                        </div>\n                      </Row>\n                      {!showDomainSelector && renderOptionalInput('domain', 'Domain', 'text')}\n                      {showDomainSelector && (\n                        <FormGroup>\n                          <DomainSelector\n                            value={shortUrlData.domain}\n                            onChange={(domain?: string) => setShortUrlData({ ...shortUrlData, domain })}\n                          />\n                        </FormGroup>\n                      )}\n                    </>\n                  )}\n                </SimpleCard>\n              </div>\n            )}\n\n            <div className={limitAccessCardClasses}>\n              <SimpleCard title=\"Limit access to the short URL\">\n                {renderOptionalInput('maxVisits', 'Maximum number of visits allowed', 'number', { min: 1 })}\n                {renderDateInput('validSince', 'Enabled since...', { maxDate: shortUrlData.validUntil ? m(shortUrlData.validUntil) : undefined })}\n                {renderDateInput('validUntil', 'Enabled until...', { minDate: shortUrlData.validSince ? m(shortUrlData.validSince) : undefined })}\n              </SimpleCard>\n            </div>\n          </Row>\n\n          {showExtraValidationsCard && (\n            <SimpleCard title=\"Extra validations\" className=\"mb-3\">\n              {!isEdit && (\n                <p>\n                  Make sure the long URL is valid, or ensure an existing short URL is returned if it matches all\n                  provided data.\n                </p>\n              )}\n              {showValidateUrl && (\n                <p>\n                  <Checkbox\n                    inline\n                    checked={shortUrlData.validateUrl}\n                    onChange={(validateUrl) => setShortUrlData({ ...shortUrlData, validateUrl })}\n                  >\n                    Validate URL\n                  </Checkbox>\n                </p>\n              )}\n              {!isEdit && (\n                <p>\n                  <Checkbox\n                    inline\n                    className=\"mr-2\"\n                    checked={shortUrlData.findIfExists}\n                    onChange={(findIfExists) => setShortUrlData({ ...shortUrlData, findIfExists })}\n                  >\n                    Use existing URL if found\n                  </Checkbox>\n                  <UseExistingIfFoundInfoIcon />\n                </p>\n              )}\n            </SimpleCard>\n          )}\n        </>\n      )}\n\n      <div className=\"text-center\">\n        <Button\n          outline\n          color=\"primary\"\n          disabled={saving || isEmpty(shortUrlData.longUrl)}\n          className=\"btn-xs-block\"\n        >\n          {saving ? 'Saving...' : 'Save'}\n        </Button>\n      </div>\n    </form>\n  );\n};\n","import { FC, useEffect, useMemo } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport { Button, Card } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\nimport { ExternalLink } from 'react-external-link';\nimport { SelectedServer } from '../servers/data';\nimport { Settings, ShortUrlCreationSettings } from '../settings/reducers/settings';\nimport { OptionalString } from '../utils/utils';\nimport { parseQuery } from '../utils/helpers/query';\nimport Message from '../utils/Message';\nimport { Result } from '../utils/Result';\nimport { ShlinkApiError } from '../api/ShlinkApiError';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { ShortUrlFormProps } from './ShortUrlForm';\nimport { ShortUrlDetail } from './reducers/shortUrlDetail';\nimport { EditShortUrlData, ShortUrl, ShortUrlData } from './data';\nimport { ShortUrlEdition } from './reducers/shortUrlEdition';\n\ninterface EditShortUrlConnectProps extends RouteComponentProps<{ shortCode: string }> {\n  settings: Settings;\n  selectedServer: SelectedServer;\n  shortUrlDetail: ShortUrlDetail;\n  shortUrlEdition: ShortUrlEdition;\n  getShortUrlDetail: (shortCode: string, domain: OptionalString) => void;\n  editShortUrl: (shortUrl: string, domain: OptionalString, data: EditShortUrlData) => Promise<void>;\n}\n\nconst getInitialState = (shortUrl?: ShortUrl, settings?: ShortUrlCreationSettings): ShortUrlData => {\n  const validateUrl = settings?.validateUrls ?? false;\n\n  if (!shortUrl) {\n    return { longUrl: '', validateUrl };\n  }\n\n  return {\n    longUrl: shortUrl.longUrl,\n    tags: shortUrl.tags,\n    title: shortUrl.title ?? undefined,\n    domain: shortUrl.domain ?? undefined,\n    validSince: shortUrl.meta.validSince ?? undefined,\n    validUntil: shortUrl.meta.validUntil ?? undefined,\n    maxVisits: shortUrl.meta.maxVisits ?? undefined,\n    validateUrl,\n  };\n};\n\nexport const EditShortUrl = (ShortUrlForm: FC<ShortUrlFormProps>) => ({\n  history: { goBack },\n  match: { params },\n  location: { search },\n  settings: { shortUrlCreation: shortUrlCreationSettings },\n  selectedServer,\n  shortUrlDetail,\n  getShortUrlDetail,\n  shortUrlEdition,\n  editShortUrl,\n}: EditShortUrlConnectProps) => {\n  const { loading, error, errorData, shortUrl } = shortUrlDetail;\n  const { saving, error: savingError, errorData: savingErrorData } = shortUrlEdition;\n  const { domain } = parseQuery<{ domain?: string }>(search);\n  const initialState = useMemo(\n    () => getInitialState(shortUrl, shortUrlCreationSettings),\n    [ shortUrl, shortUrlCreationSettings ],\n  );\n  const [ savingSucceeded,, isSuccessful, isNotSuccessful ] = useToggle();\n\n  useEffect(() => {\n    getShortUrlDetail(params.shortCode, domain);\n  }, []);\n\n  if (loading) {\n    return <Message loading />;\n  }\n\n  if (error) {\n    return (\n      <Result type=\"error\">\n        <ShlinkApiError errorData={errorData} fallbackMessage=\"An error occurred while loading short URL detail :(\" />\n      </Result>\n    );\n  }\n\n  return (\n    <>\n      <header className=\"mb-3\">\n        <Card body>\n          <h2 className=\"d-sm-flex justify-content-between align-items-center mb-0\">\n            <Button color=\"link\" size=\"lg\" className=\"p-0 mr-3\" onClick={goBack}>\n              <FontAwesomeIcon icon={faArrowLeft} />\n            </Button>\n            <span className=\"text-center\">\n              <small>Edit <ExternalLink href={shortUrl?.shortUrl ?? ''} /></small>\n            </span>\n            <span />\n          </h2>\n        </Card>\n      </header>\n      <ShortUrlForm\n        initialState={initialState}\n        saving={saving}\n        selectedServer={selectedServer}\n        mode=\"edit\"\n        onSave={async (shortUrlData) => {\n          if (!shortUrl) {\n            return;\n          }\n\n          isNotSuccessful();\n          editShortUrl(shortUrl.shortCode, shortUrl.domain, shortUrlData)\n            .then(isSuccessful)\n            .catch(isNotSuccessful);\n        }}\n      />\n      {savingError && (\n        <Result type=\"error\" className=\"mt-3\">\n          <ShlinkApiError errorData={savingErrorData} fallbackMessage=\"An error occurred while updating short URL :(\" />\n        </Result>\n      )}\n      {savingSucceeded && <Result type=\"success\" className=\"mt-3\">Short URL properly edited.</Result>}\n    </>\n  );\n};\n","import { Action, Dispatch } from 'redux';\nimport { ShortUrl } from '../data';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { OptionalString } from '../../utils/utils';\nimport { GetState } from '../../container/types';\nimport { shortUrlMatches } from '../helpers';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_SHORT_URL_DETAIL_START = 'shlink/shortUrlDetail/GET_SHORT_URL_DETAIL_START';\nexport const GET_SHORT_URL_DETAIL_ERROR = 'shlink/shortUrlDetail/GET_SHORT_URL_DETAIL_ERROR';\nexport const GET_SHORT_URL_DETAIL = 'shlink/shortUrlDetail/GET_SHORT_URL_DETAIL';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlDetail {\n  shortUrl?: ShortUrl;\n  loading: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface ShortUrlDetailAction extends Action<string> {\n  shortUrl: ShortUrl;\n}\n\nexport interface ShortUrlDetailFailedAction extends Action<string> {\n  errorData?: ProblemDetailsError;\n}\n\nconst initialState: ShortUrlDetail = {\n  loading: false,\n  error: false,\n};\n\nexport default buildReducer<ShortUrlDetail, ShortUrlDetailAction & ShortUrlDetailFailedAction>({\n  [GET_SHORT_URL_DETAIL_START]: () => ({ loading: true, error: false }),\n  [GET_SHORT_URL_DETAIL_ERROR]: (_, { errorData }) => ({ loading: false, error: true, errorData }),\n  [GET_SHORT_URL_DETAIL]: (_, { shortUrl }) => ({ shortUrl, ...initialState }),\n}, initialState);\n\nexport const getShortUrlDetail = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  domain: OptionalString,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: GET_SHORT_URL_DETAIL_START });\n\n  try {\n    const { shortUrlsList } = getState();\n    const shortUrl = shortUrlsList?.shortUrls?.data.find(\n      (shortUrl) => shortUrlMatches(shortUrl, shortCode, domain),\n    ) ?? await buildShlinkApiClient(getState).getShortUrl(shortCode, domain);\n\n    dispatch<ShortUrlDetailAction>({ shortUrl, type: GET_SHORT_URL_DETAIL });\n  } catch (e) {\n    dispatch<ShortUrlDetailFailedAction>({ type: GET_SHORT_URL_DETAIL_ERROR, errorData: parseApiError(e) });\n  }\n};\n","import Bottle from 'bottlejs';\nimport ShortUrls from '../ShortUrls';\nimport SearchBar from '../SearchBar';\nimport ShortUrlsList from '../ShortUrlsList';\nimport ShortUrlsRow from '../helpers/ShortUrlsRow';\nimport ShortUrlsRowMenu from '../helpers/ShortUrlsRowMenu';\nimport CreateShortUrl from '../CreateShortUrl';\nimport DeleteShortUrlModal from '../helpers/DeleteShortUrlModal';\nimport CreateShortUrlResult from '../helpers/CreateShortUrlResult';\nimport { listShortUrls } from '../reducers/shortUrlsList';\nimport { createShortUrl, resetCreateShortUrl } from '../reducers/shortUrlCreation';\nimport { deleteShortUrl, resetDeleteShortUrl } from '../reducers/shortUrlDeletion';\nimport { resetShortUrlParams } from '../reducers/shortUrlsListParams';\nimport { editShortUrl } from '../reducers/shortUrlEdition';\nimport { ConnectDecorator } from '../../container/types';\nimport { ShortUrlsTable } from '../ShortUrlsTable';\nimport QrCodeModal from '../helpers/QrCodeModal';\nimport { ShortUrlForm } from '../ShortUrlForm';\nimport { EditShortUrl } from '../EditShortUrl';\nimport { getShortUrlDetail } from '../reducers/shortUrlDetail';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('ShortUrls', ShortUrls, 'SearchBar', 'ShortUrlsList');\n  bottle.decorator('ShortUrls', connect([ 'shortUrlsList' ]));\n\n  bottle.serviceFactory('ShortUrlsList', ShortUrlsList, 'ShortUrlsTable');\n  bottle.decorator('ShortUrlsList', connect(\n    [ 'selectedServer', 'shortUrlsListParams', 'mercureInfo' ],\n    [ 'listShortUrls', 'resetShortUrlParams', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  bottle.serviceFactory('ShortUrlsTable', ShortUrlsTable, 'ShortUrlsRow');\n  bottle.serviceFactory('ShortUrlsRow', ShortUrlsRow, 'ShortUrlsRowMenu', 'ColorGenerator', 'useStateFlagTimeout');\n  bottle.serviceFactory('ShortUrlsRowMenu', ShortUrlsRowMenu, 'DeleteShortUrlModal', 'QrCodeModal');\n  bottle.serviceFactory('CreateShortUrlResult', CreateShortUrlResult, 'useStateFlagTimeout');\n  bottle.serviceFactory('ShortUrlForm', ShortUrlForm, 'TagsSelector', 'DomainSelector');\n\n  bottle.serviceFactory('CreateShortUrl', CreateShortUrl, 'ShortUrlForm', 'CreateShortUrlResult');\n  bottle.decorator(\n    'CreateShortUrl',\n    connect([ 'shortUrlCreationResult', 'selectedServer', 'settings' ], [ 'createShortUrl', 'resetCreateShortUrl' ]),\n  );\n\n  bottle.serviceFactory('EditShortUrl', EditShortUrl, 'ShortUrlForm');\n  bottle.decorator('EditShortUrl', connect(\n    [ 'shortUrlDetail', 'shortUrlEdition', 'selectedServer', 'settings' ],\n    [ 'getShortUrlDetail', 'editShortUrl' ],\n  ));\n\n  bottle.serviceFactory('DeleteShortUrlModal', () => DeleteShortUrlModal);\n  bottle.decorator('DeleteShortUrlModal', connect([ 'shortUrlDeletion' ], [ 'deleteShortUrl', 'resetDeleteShortUrl' ]));\n\n  bottle.serviceFactory('QrCodeModal', () => QrCodeModal);\n  bottle.decorator('QrCodeModal', connect([ 'selectedServer' ]));\n\n  // Services\n  bottle.serviceFactory('SearchBar', SearchBar, 'ColorGenerator');\n  bottle.decorator('SearchBar', connect([ 'shortUrlsListParams' ], [ 'listShortUrls' ]));\n\n  // Actions\n  bottle.serviceFactory('listShortUrls', listShortUrls, 'buildShlinkApiClient');\n  bottle.serviceFactory('resetShortUrlParams', () => resetShortUrlParams);\n\n  bottle.serviceFactory('createShortUrl', createShortUrl, 'buildShlinkApiClient');\n  bottle.serviceFactory('resetCreateShortUrl', () => resetCreateShortUrl);\n\n  bottle.serviceFactory('deleteShortUrl', deleteShortUrl, 'buildShlinkApiClient');\n  bottle.serviceFactory('resetDeleteShortUrl', () => resetDeleteShortUrl);\n\n  bottle.serviceFactory('getShortUrlDetail', getShortUrlDetail, 'buildShlinkApiClient');\n\n  bottle.serviceFactory('editShortUrl', editShortUrl, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import { FC } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { InputType } from 'reactstrap/lib/Input';\n\ninterface FormGroupContainerProps {\n  value: string;\n  onChange: (newValue: string) => void;\n  id?: string;\n  type?: InputType;\n  required?: boolean;\n}\n\nexport const FormGroupContainer: FC<FormGroupContainerProps> = (\n  { children, value, onChange, id = uuid(), type = 'text', required = true },\n) => (\n  <div className=\"form-group\">\n    <label htmlFor={id} className=\"create-server__label\">\n      {children}:\n    </label>\n    <input\n      className=\"form-control\"\n      type={type}\n      id={id}\n      value={value}\n      required={required}\n      onChange={(e) => onChange(e.target.value)}\n    />\n  </div>\n);\n","import { FC, ReactNode, useEffect, useState } from 'react';\nimport { FormGroupContainer } from '../../utils/FormGroupContainer';\nimport { handleEventPreventingDefault } from '../../utils/utils';\nimport { ServerData } from '../data';\nimport { SimpleCard } from '../../utils/SimpleCard';\nimport './ServerForm.scss';\n\ninterface ServerFormProps {\n  onSubmit: (server: ServerData) => void;\n  initialValues?: ServerData;\n  title?: ReactNode;\n}\n\nexport const ServerForm: FC<ServerFormProps> = ({ onSubmit, initialValues, children, title }) => {\n  const [ name, setName ] = useState('');\n  const [ url, setUrl ] = useState('');\n  const [ apiKey, setApiKey ] = useState('');\n  const handleSubmit = handleEventPreventingDefault(() => onSubmit({ name, url, apiKey }));\n\n  useEffect(() => {\n    initialValues && setName(initialValues.name);\n    initialValues && setUrl(initialValues.url);\n    initialValues && setApiKey(initialValues.apiKey);\n  }, [ initialValues ]);\n\n  return (\n    <form className=\"server-form\" onSubmit={handleSubmit}>\n      <SimpleCard className=\"mb-3\" title={title}>\n        <FormGroupContainer value={name} onChange={setName}>Name</FormGroupContainer>\n        <FormGroupContainer type=\"url\" value={url} onChange={setUrl}>URL</FormGroupContainer>\n        <FormGroupContainer value={apiKey} onChange={setApiKey}>API key</FormGroupContainer>\n      </SimpleCard>\n\n      <div className=\"text-right\">{children}</div>\n    </form>\n  );\n};\n","import { FC } from 'react';\nimport { v4 as uuid } from 'uuid';\nimport { RouterProps } from 'react-router';\nimport { Result } from '../utils/Result';\nimport NoMenuLayout from '../common/NoMenuLayout';\nimport { StateFlagTimeout } from '../utils/helpers/hooks';\nimport { ServerForm } from './helpers/ServerForm';\nimport { ImportServersBtnProps } from './helpers/ImportServersBtn';\nimport { ServerData, ServerWithId } from './data';\nimport './CreateServer.scss';\n\nconst SHOW_IMPORT_MSG_TIME = 4000;\n\ninterface CreateServerProps extends RouterProps {\n  createServer: (server: ServerWithId) => void;\n}\n\nconst ImportResult = ({ type }: { type: 'error' | 'success' }) => (\n  <Result type={type}>\n    {type === 'success' && 'Servers properly imported. You can now select one from the list :)'}\n    {type === 'error' && 'The servers could not be imported. Make sure the format is correct.'}\n  </Result>\n);\n\nconst CreateServer = (ImportServersBtn: FC<ImportServersBtnProps>, useStateFlagTimeout: StateFlagTimeout) => (\n  { createServer, history: { push } }: CreateServerProps,\n) => {\n  const [ serversImported, setServersImported ] = useStateFlagTimeout(false, SHOW_IMPORT_MSG_TIME);\n  const [ errorImporting, setErrorImporting ] = useStateFlagTimeout(false, SHOW_IMPORT_MSG_TIME);\n  const handleSubmit = (serverData: ServerData) => {\n    const id = uuid();\n\n    createServer({ ...serverData, id });\n    push(`/server/${id}`);\n  };\n\n  return (\n    <NoMenuLayout>\n      <ServerForm title={<h5 className=\"mb-0\">Add new server</h5>} onSubmit={handleSubmit}>\n        <ImportServersBtn onImport={setServersImported} onImportError={setErrorImporting} />\n        <button className=\"btn btn-outline-primary\">Create server</button>\n      </ServerForm>\n\n      {(serversImported || errorImporting) && (\n        <div className=\"mt-3\">\n          {serversImported && <ImportResult type=\"success\" />}\n          {errorImporting && <ImportResult type=\"error\" />}\n        </div>\n      )}\n    </NoMenuLayout>\n  );\n};\n\nexport default CreateServer;\n","import { isEmpty, values } from 'ramda';\nimport { DropdownItem, DropdownMenu, DropdownToggle, UncontrolledDropdown } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport { faPlus as plusIcon, faFileDownload as exportIcon, faServer as serverIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport ServersExporter from './services/ServersExporter';\nimport { isServerWithId, SelectedServer, ServersMap } from './data';\n\nexport interface ServersDropdownProps {\n  servers: ServersMap;\n  selectedServer: SelectedServer;\n}\n\nconst ServersDropdown = (serversExporter: ServersExporter) => ({ servers, selectedServer }: ServersDropdownProps) => {\n  const serversList = values(servers);\n  const createServerItem = (\n    <DropdownItem tag={Link} to=\"/server/create\">\n      <FontAwesomeIcon icon={plusIcon} /> <span className=\"ml-1\">Add server</span>\n    </DropdownItem>\n  );\n\n  const renderServers = () => {\n    if (isEmpty(serversList)) {\n      return createServerItem;\n    }\n\n    return (\n      <>\n        {serversList.map(({ name, id }) => (\n          <DropdownItem\n            key={id}\n            tag={Link}\n            to={`/server/${id}`}\n            active={isServerWithId(selectedServer) && selectedServer.id === id}\n          >\n            {name}\n          </DropdownItem>\n        ))}\n        <DropdownItem divider />\n        {createServerItem}\n        <DropdownItem className=\"servers-dropdown__export-item\" onClick={async () => serversExporter.exportServers()}>\n          <FontAwesomeIcon icon={exportIcon} /> <span className=\"ml-1\">Export servers</span>\n        </DropdownItem>\n      </>\n    );\n  };\n\n  return (\n    <UncontrolledDropdown nav inNavbar>\n      <DropdownToggle nav caret>\n        <FontAwesomeIcon icon={serverIcon} /> <span className=\"ml-1\">Servers</span>\n      </DropdownToggle>\n      <DropdownMenu right>{renderServers()}</DropdownMenu>\n    </UncontrolledDropdown>\n  );\n};\n\nexport default ServersDropdown;\n","import { Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { RouterProps } from 'react-router';\nimport { ServerWithId } from './data';\n\nexport interface DeleteServerModalProps {\n  server: ServerWithId;\n  toggle: () => void;\n  isOpen: boolean;\n}\n\ninterface DeleteServerModalConnectProps extends DeleteServerModalProps, RouterProps {\n  deleteServer: (server: ServerWithId) => void;\n}\n\nconst DeleteServerModal = ({ server, toggle, isOpen, deleteServer, history }: DeleteServerModalConnectProps) => {\n  const closeModal = () => {\n    deleteServer(server);\n    toggle();\n    history.push('/');\n  };\n\n  return (\n    <Modal isOpen={isOpen} toggle={toggle} centered>\n      <ModalHeader toggle={toggle}><span className=\"text-danger\">Remove server</span></ModalHeader>\n      <ModalBody>\n        <p>Are you sure you want to remove <b>{server ? server.name : ''}</b>?</p>\n        <p>\n          <i>\n            No data will be deleted, only the access to this server will be removed from this device.\n            You can create it again at any moment.\n          </i>\n        </p>\n      </ModalBody>\n      <ModalFooter>\n        <button className=\"btn btn-link\" onClick={toggle}>Cancel</button>\n        <button className=\"btn btn-danger\" onClick={() => closeModal()}>Delete</button>\n      </ModalFooter>\n    </Modal>\n  );\n};\n\nexport default DeleteServerModal;\n","import { FC } from 'react';\nimport { faMinusCircle as deleteIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { DeleteServerModalProps } from './DeleteServerModal';\nimport { ServerWithId } from './data';\n\nexport interface DeleteServerButtonProps {\n  server: ServerWithId;\n  className?: string;\n  textClassName?: string;\n}\n\nconst DeleteServerButton = (DeleteServerModal: FC<DeleteServerModalProps>): FC<DeleteServerButtonProps> => (\n  { server, className, children, textClassName },\n) => {\n  const [ isModalOpen, , showModal, hideModal ] = useToggle();\n\n  return (\n    <>\n      <span className={className} onClick={showModal}>\n        {!children && <FontAwesomeIcon icon={deleteIcon} />}\n        <span className={textClassName}>{children ?? 'Remove this server'}</span>\n      </span>\n\n      <DeleteServerModal server={server} isOpen={isModalOpen} toggle={hideModal} />\n    </>\n  );\n};\n\nexport default DeleteServerButton;\n","import { FC } from 'react';\nimport { Button } from 'reactstrap';\nimport NoMenuLayout from '../common/NoMenuLayout';\nimport { ServerForm } from './helpers/ServerForm';\nimport { withSelectedServer } from './helpers/withSelectedServer';\nimport { isServerWithId, ServerData } from './data';\n\ninterface EditServerProps {\n  editServer: (serverId: string, serverData: ServerData) => void;\n}\n\nexport const EditServer = (ServerError: FC) => withSelectedServer<EditServerProps>((\n  { editServer, selectedServer, history: { push, goBack } },\n) => {\n  if (!isServerWithId(selectedServer)) {\n    return null;\n  }\n\n  const handleSubmit = (serverData: ServerData) => {\n    editServer(selectedServer.id, serverData);\n    push(`/server/${selectedServer.id}`);\n  };\n\n  return (\n    <NoMenuLayout>\n      <ServerForm\n        title={<h5 className=\"mb-0\">Edit &quot;{selectedServer.name}&quot;</h5>}\n        initialValues={selectedServer}\n        onSubmit={handleSubmit}\n      >\n        <Button outline className=\"mr-2\" onClick={goBack}>Cancel</Button>\n        <Button outline color=\"primary\">Save</Button>\n      </ServerForm>\n    </NoMenuLayout>\n  );\n}, ServerError);\n","import { useRef, RefObject, ChangeEvent, MutableRefObject } from 'react';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport ServersImporter from '../services/ServersImporter';\nimport { ServerData } from '../data';\n\ntype Ref<T> = RefObject<T> | MutableRefObject<T>;\n\nexport interface ImportServersBtnProps {\n  onImport?: () => void;\n  onImportError?: () => void;\n}\n\ninterface ImportServersBtnConnectProps extends ImportServersBtnProps {\n  createServers: (servers: ServerData[]) => void;\n  fileRef: Ref<HTMLInputElement>;\n}\n\nconst ImportServersBtn = ({ importServersFromFile }: ServersImporter) => ({\n  createServers,\n  fileRef,\n  onImport = () => {},\n  onImportError = () => {},\n}: ImportServersBtnConnectProps) => {\n  const ref = fileRef ?? useRef<HTMLInputElement>();\n  const onChange = async ({ target }: ChangeEvent<HTMLInputElement>) =>\n    importServersFromFile(target.files?.[0])\n      .then(createServers)\n      .then(onImport)\n      .then(() => {\n        // Reset input after processing file\n        (target as { value: string | null }).value = null;\n      })\n      .catch(onImportError);\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        className=\"btn btn-outline-secondary mr-2\"\n        id=\"importBtn\"\n        onClick={() => ref.current?.click()}\n      >\n        Import from file\n      </button>\n      <UncontrolledTooltip placement=\"top\" target=\"importBtn\">\n        You can create servers by importing a CSV file with columns <b>name</b>, <b>apiKey</b> and <b>url</b>.\n      </UncontrolledTooltip>\n\n      <input type=\"file\" accept=\"text/csv\" className=\"create-server__csv-select\" ref={ref} onChange={onChange} />\n    </>\n  );\n};\n\nexport default ImportServersBtn;\n","import { identity, memoizeWith, pipe } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { resetShortUrlParams } from '../../short-urls/reducers/shortUrlsListParams';\nimport { versionToPrintable, versionToSemVer as toSemVer } from '../../utils/helpers/version';\nimport { SelectedServer } from '../data';\nimport { GetState } from '../../container/types';\nimport { ShlinkHealth } from '../../api/types';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\n\n/* eslint-disable padding-line-between-statements */\nexport const SELECT_SERVER = 'shlink/selectedServer/SELECT_SERVER';\nexport const RESET_SELECTED_SERVER = 'shlink/selectedServer/RESET_SELECTED_SERVER';\n\nexport const MIN_FALLBACK_VERSION = '1.0.0';\nexport const MAX_FALLBACK_VERSION = '999.999.999';\nexport const LATEST_VERSION_CONSTRAINT = 'latest';\n/* eslint-enable padding-line-between-statements */\n\nexport interface SelectServerAction extends Action<string> {\n  selectedServer: SelectedServer;\n}\n\nconst versionToSemVer = pipe(\n  (version: string) => version === LATEST_VERSION_CONSTRAINT ? MAX_FALLBACK_VERSION : version,\n  toSemVer(MIN_FALLBACK_VERSION),\n);\n\nconst getServerVersion = memoizeWith(\n  identity,\n  async (_serverId: string, health: () => Promise<ShlinkHealth>) => health().then(({ version }) => ({\n    version: versionToSemVer(version),\n    printableVersion: versionToPrintable(version),\n  })),\n);\n\nconst initialState: SelectedServer = null;\n\nexport default buildReducer<SelectedServer, SelectServerAction>({\n  [RESET_SELECTED_SERVER]: () => initialState,\n  [SELECT_SERVER]: (_, { selectedServer }) => selectedServer,\n}, initialState);\n\nexport const resetSelectedServer = buildActionCreator(RESET_SELECTED_SERVER);\n\nexport const selectServer = (\n  buildShlinkApiClient: ShlinkApiClientBuilder,\n  loadMercureInfo: () => Action,\n) => (\n  serverId: string,\n) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch(resetSelectedServer());\n  dispatch(resetShortUrlParams());\n\n  const { servers } = getState();\n  const selectedServer = servers[serverId];\n\n  if (!selectedServer) {\n    dispatch<SelectServerAction>({\n      type: SELECT_SERVER,\n      selectedServer: { serverNotFound: true },\n    });\n\n    return;\n  }\n\n  try {\n    const { health } = buildShlinkApiClient(selectedServer);\n    const { version, printableVersion } = await getServerVersion(serverId, health);\n\n    dispatch<SelectServerAction>({\n      type: SELECT_SERVER,\n      selectedServer: {\n        ...selectedServer,\n        version,\n        printableVersion,\n      },\n    });\n    dispatch(loadMercureInfo());\n  } catch (e) {\n    dispatch<SelectServerAction>({\n      type: SELECT_SERVER,\n      selectedServer: { ...selectedServer, serverNotReachable: true },\n    });\n  }\n};\n","import { assoc, dissoc, map, pipe, reduce } from 'ramda';\nimport { v4 as uuid } from 'uuid';\nimport { Action } from 'redux';\nimport { ServerData, ServersMap, ServerWithId } from '../data';\nimport { buildReducer } from '../../utils/helpers/redux';\n\n/* eslint-disable padding-line-between-statements */\nexport const EDIT_SERVER = 'shlink/servers/EDIT_SERVER';\nexport const DELETE_SERVER = 'shlink/servers/DELETE_SERVER';\nexport const CREATE_SERVERS = 'shlink/servers/CREATE_SERVERS';\n/* eslint-enable padding-line-between-statements */\n\nexport interface CreateServersAction extends Action<string> {\n  newServers: ServersMap;\n}\n\nconst initialState: ServersMap = {};\n\nconst serverWithId = (server: ServerWithId | ServerData): ServerWithId => {\n  if ((server as ServerWithId).id) {\n    return server as ServerWithId;\n  }\n\n  return assoc('id', uuid(), server);\n};\n\nexport default buildReducer<ServersMap, CreateServersAction>({\n  [CREATE_SERVERS]: (state, { newServers }) => ({ ...state, ...newServers }),\n  [DELETE_SERVER]: (state, { serverId }: any) => dissoc(serverId, state),\n  [EDIT_SERVER]: (state, { serverId, serverData }: any) => !state[serverId]\n    ? state\n    : assoc(serverId, { ...state[serverId], ...serverData }, state),\n}, initialState);\n\nconst serversListToMap = reduce<ServerWithId, ServersMap>((acc, server) => assoc(server.id, server, acc), {});\n\nexport const createServers = pipe(\n  map(serverWithId),\n  serversListToMap,\n  (newServers: ServersMap) => ({ type: CREATE_SERVERS, newServers }),\n);\n\nexport const createServer = (server: ServerWithId) => createServers([ server ]);\n\nexport const editServer = (serverId: string, serverData: Partial<ServerData>) => ({\n  type: EDIT_SERVER,\n  serverId,\n  serverData,\n});\n\nexport const deleteServer = ({ id }: ServerWithId) => ({ type: DELETE_SERVER, serverId: id });\n","import { pipe, prop } from 'ramda';\nimport { AxiosInstance } from 'axios';\nimport { Dispatch } from 'redux';\nimport { homepage } from '../../../package.json';\nimport { ServerData } from '../data';\nimport { createServers } from './servers';\n\nconst responseToServersList = pipe(\n  prop<any, any>('data'),\n  (data: any): ServerData[] => {\n    if (!Array.isArray(data)) {\n      throw new Error('Value is not an array');\n    }\n\n    return data as ServerData[];\n  },\n);\n\nexport const fetchServers = ({ get }: AxiosInstance) => () => async (dispatch: Dispatch) => {\n  const remoteList = await get(`${homepage}/servers.json`)\n    .then(responseToServersList)\n    .catch(() => []);\n\n  dispatch(createServers(remoteList));\n};\n","import { FC } from 'react';\nimport { versionMatch, Versions } from '../../utils/helpers/version';\nimport { isReachableServer, SelectedServer } from '../data';\n\ninterface ForServerVersionProps extends Versions {\n  selectedServer: SelectedServer;\n}\n\nconst ForServerVersion: FC<ForServerVersionProps> = ({ minVersion, maxVersion, selectedServer, children }) => {\n  if (!isReachableServer(selectedServer)) {\n    return null;\n  }\n\n  const { version } = selectedServer;\n  const matchesVersion = versionMatch(version, { maxVersion, minVersion });\n\n  if (!matchesVersion) {\n    return null;\n  }\n\n  return <>{children}</>;\n};\n\nexport default ForServerVersion;\n","import { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport Message from '../../utils/Message';\nimport ServersListGroup from '../ServersListGroup';\nimport { DeleteServerButtonProps } from '../DeleteServerButton';\nimport { isServerWithId, SelectedServer, ServersMap } from '../data';\nimport NoMenuLayout from '../../common/NoMenuLayout';\nimport './ServerError.scss';\n\ninterface ServerErrorProps {\n  servers: ServersMap;\n  selectedServer: SelectedServer;\n}\n\nexport const ServerError = (DeleteServerButton: FC<DeleteServerButtonProps>): FC<ServerErrorProps> => (\n  { servers, selectedServer },\n) => (\n  <NoMenuLayout>\n    <div className=\"server-error__container flex-column\">\n      <Message className=\"w-100 mb-3 mb-md-5\" type=\"error\" fullWidth>\n        {!isServerWithId(selectedServer) && 'Could not find this Shlink server.'}\n        {isServerWithId(selectedServer) && (\n          <>\n            <p>Oops! Could not connect to this Shlink server.</p>\n            Make sure you have internet connection, and the server is properly configured and on-line.\n          </>\n        )}\n      </Message>\n\n      <ServersListGroup servers={Object.values(servers)}>\n        These are the Shlink servers currently configured. Choose one of\n        them or <Link to=\"/server/create\">add a new one</Link>.\n      </ServersListGroup>\n\n      {isServerWithId(selectedServer) && (\n        <div className=\"container mt-3 mt-md-5\">\n          <h5>\n            Alternatively, if you think you may have miss-configured this server, you\n            can <DeleteServerButton server={selectedServer} className=\"server-error__delete-btn\">remove it</DeleteServerButton> or&nbsp;\n            <Link to={`/server/${selectedServer.id}/edit`}>edit it</Link>.\n          </h5>\n        </div>\n      )}\n    </div>\n  </NoMenuLayout>\n);\n","import { FC, useEffect } from 'react';\nimport { Card, CardBody, CardHeader, CardText, CardTitle, Row } from 'reactstrap';\nimport { Link, useHistory } from 'react-router-dom';\nimport { ShortUrlsListParams } from '../short-urls/reducers/shortUrlsListParams';\nimport { ShortUrlsList as ShortUrlsListState } from '../short-urls/reducers/shortUrlsList';\nimport { prettify } from '../utils/helpers/numbers';\nimport { TagsList } from '../tags/reducers/tagsList';\nimport { ShortUrlsTableProps } from '../short-urls/ShortUrlsTable';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { CreateShortUrlProps } from '../short-urls/CreateShortUrl';\nimport { VisitsOverview } from '../visits/reducers/visitsOverview';\nimport { Versions } from '../utils/helpers/version';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { isServerWithId, SelectedServer } from './data';\nimport './Overview.scss';\n\ninterface OverviewConnectProps {\n  shortUrlsList: ShortUrlsListState;\n  listShortUrls: (params: ShortUrlsListParams) => void;\n  listTags: Function;\n  tagsList: TagsList;\n  selectedServer: SelectedServer;\n  visitsOverview: VisitsOverview;\n  loadVisitsOverview: Function;\n}\n\nexport const Overview = (\n  ShortUrlsTable: FC<ShortUrlsTableProps>,\n  CreateShortUrl: FC<CreateShortUrlProps>,\n  ForServerVersion: FC<Versions>,\n) => boundToMercureHub(({\n  shortUrlsList,\n  listShortUrls,\n  listTags,\n  tagsList,\n  selectedServer,\n  loadVisitsOverview,\n  visitsOverview,\n}: OverviewConnectProps) => {\n  const { loading, shortUrls } = shortUrlsList;\n  const { loading: loadingTags } = tagsList;\n  const { loading: loadingVisits, visitsCount, orphanVisitsCount } = visitsOverview;\n  const serverId = isServerWithId(selectedServer) ? selectedServer.id : '';\n  const history = useHistory();\n\n  useEffect(() => {\n    listShortUrls({ itemsPerPage: 5, orderBy: { dateCreated: 'DESC' } });\n    listTags();\n    loadVisitsOverview();\n  }, []);\n\n  return (\n    <>\n      <Row>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Visits</CardTitle>\n            <CardText tag=\"h2\">\n              <ForServerVersion minVersion=\"2.2.0\">\n                {loadingVisits ? 'Loading...' : prettify(visitsCount)}\n              </ForServerVersion>\n              <ForServerVersion maxVersion=\"2.1.*\">\n                <small className=\"text-muted\"><i>Shlink 2.2 is needed</i></small>\n              </ForServerVersion>\n            </CardText>\n          </Card>\n        </div>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body tag={Link} to={`/server/${serverId}/orphan-visits`}>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Orphan visits</CardTitle>\n            <CardText tag=\"h2\">\n              <ForServerVersion minVersion=\"2.6.0\">\n                {loadingVisits ? 'Loading...' : prettify(orphanVisitsCount ?? 0)}\n              </ForServerVersion>\n              <ForServerVersion maxVersion=\"2.5.*\">\n                <small className=\"text-muted\"><i>Shlink 2.6 is needed</i></small>\n              </ForServerVersion>\n            </CardText>\n          </Card>\n        </div>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body tag={Link} to={`/server/${serverId}/list-short-urls/1`}>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Short URLs</CardTitle>\n            <CardText tag=\"h2\">\n              {loading ? 'Loading...' : prettify(shortUrls?.pagination.totalItems ?? 0)}\n            </CardText>\n          </Card>\n        </div>\n        <div className=\"col-md-6 col-xl-3\">\n          <Card className=\"overview__card mb-3\" body tag={Link} to={`/server/${serverId}/manage-tags`}>\n            <CardTitle tag=\"h5\" className=\"overview__card-title\">Tags</CardTitle>\n            <CardText tag=\"h2\">{loadingTags ? 'Loading...' : prettify(tagsList.tags.length)}</CardText>\n          </Card>\n        </div>\n      </Row>\n      <Card className=\"mb-3\">\n        <CardHeader>\n          <span className=\"d-sm-none\">Create a short URL</span>\n          <h5 className=\"d-none d-sm-inline\">Create a short URL</h5>\n          <Link className=\"float-right\" to={`/server/${serverId}/create-short-url`}>Advanced options &raquo;</Link>\n        </CardHeader>\n        <CardBody>\n          <CreateShortUrl basicMode />\n        </CardBody>\n      </Card>\n      <Card>\n        <CardHeader>\n          <span className=\"d-sm-none\">Recently created URLs</span>\n          <h5 className=\"d-none d-sm-inline\">Recently created URLs</h5>\n          <Link className=\"float-right\" to={`/server/${serverId}/list-short-urls/1`}>See all &raquo;</Link>\n        </CardHeader>\n        <CardBody>\n          <ShortUrlsTable\n            shortUrlsList={shortUrlsList}\n            selectedServer={selectedServer}\n            className=\"mb-0\"\n            onTagClick={(tag) => history.push(`/server/${serverId}/list-short-urls/1?tag=${tag}`)}\n          />\n        </CardBody>\n      </Card>\n    </>\n  );\n}, () => [ Topics.visits(), Topics.orphanVisits() ]);\n","import { CsvJson } from 'csvjson';\nimport { ServerData } from '../data';\n\ninterface CsvFile extends File {\n  type: 'text/csv' | 'text/comma-separated-values' | 'application/csv';\n}\n\nconst CSV_MIME_TYPES = [ 'text/csv', 'text/comma-separated-values', 'application/csv' ];\nconst isCsv = (file?: File | null): file is CsvFile => !!file && CSV_MIME_TYPES.includes(file.type);\n\nexport default class ServersImporter {\n  public constructor(private readonly csvjson: CsvJson, private readonly fileReaderFactory: () => FileReader) {}\n\n  public readonly importServersFromFile = async (file?: File | null): Promise<ServerData[]> => {\n    if (!isCsv(file)) {\n      throw new Error('No file provided or file is not a CSV');\n    }\n\n    const reader = this.fileReaderFactory();\n\n    return new Promise((resolve) => {\n      reader.addEventListener('loadend', (e: ProgressEvent<FileReader>) => {\n        const content = e.target?.result?.toString() ?? '';\n        const servers = this.csvjson.toObject<ServerData>(content);\n\n        resolve(servers);\n      });\n      reader.readAsText(file);\n    });\n  };\n}\n","export const saveCsv = ({ document }: Window, csv: string, filename: string) => {\n  const link = document.createElement('a');\n  const blob = new Blob([ csv ], { type: 'text/csv;charset=utf-8;' });\n  const url = URL.createObjectURL(blob);\n\n  link.setAttribute('href', url);\n  link.setAttribute('download', filename);\n  link.style.visibility = 'hidden';\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n};\n","import { dissoc, values } from 'ramda';\nimport { CsvJson } from 'csvjson';\nimport LocalStorage from '../../utils/services/LocalStorage';\nimport { ServersMap } from '../data';\nimport { saveCsv } from '../../utils/helpers/csv';\n\nconst SERVERS_FILENAME = 'shlink-servers.csv';\n\nexport default class ServersExporter {\n  public constructor(\n    private readonly storage: LocalStorage,\n    private readonly window: Window,\n    private readonly csvjson: CsvJson,\n  ) {}\n\n  public readonly exportServers = async () => {\n    const servers = values(this.storage.get<ServersMap>('servers') ?? {}).map(dissoc('id'));\n\n    try {\n      const csv = this.csvjson.toCSV(servers, { headers: 'key' });\n\n      saveCsv(this.window, csv, SERVERS_FILENAME);\n    } catch (e) {\n      // FIXME Handle error\n      console.error(e); // eslint-disable-line no-console\n    }\n  };\n}\n","import csvjson from 'csvjson';\nimport Bottle, { Decorator } from 'bottlejs';\nimport CreateServer from '../CreateServer';\nimport ServersDropdown from '../ServersDropdown';\nimport DeleteServerModal from '../DeleteServerModal';\nimport DeleteServerButton from '../DeleteServerButton';\nimport { EditServer } from '../EditServer';\nimport ImportServersBtn from '../helpers/ImportServersBtn';\nimport { resetSelectedServer, selectServer } from '../reducers/selectedServer';\nimport { createServer, createServers, deleteServer, editServer } from '../reducers/servers';\nimport { fetchServers } from '../reducers/remoteServers';\nimport ForServerVersion from '../helpers/ForServerVersion';\nimport { ServerError } from '../helpers/ServerError';\nimport { ConnectDecorator } from '../../container/types';\nimport { withoutSelectedServer } from '../helpers/withoutSelectedServer';\nimport { Overview } from '../Overview';\nimport ServersImporter from './ServersImporter';\nimport ServersExporter from './ServersExporter';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator, withRouter: Decorator) => {\n  // Components\n  bottle.serviceFactory('CreateServer', CreateServer, 'ImportServersBtn', 'useStateFlagTimeout');\n  bottle.decorator('CreateServer', withoutSelectedServer);\n  bottle.decorator('CreateServer', connect([ 'selectedServer' ], [ 'createServer', 'resetSelectedServer' ]));\n\n  bottle.serviceFactory('EditServer', EditServer, 'ServerError');\n  bottle.decorator('EditServer', connect([ 'selectedServer' ], [ 'editServer', 'selectServer' ]));\n\n  bottle.serviceFactory('ServersDropdown', ServersDropdown, 'ServersExporter');\n  bottle.decorator('ServersDropdown', connect([ 'servers', 'selectedServer' ]));\n\n  bottle.serviceFactory('DeleteServerModal', () => DeleteServerModal);\n  bottle.decorator('DeleteServerModal', withRouter);\n  bottle.decorator('DeleteServerModal', connect(null, [ 'deleteServer' ]));\n\n  bottle.serviceFactory('DeleteServerButton', DeleteServerButton, 'DeleteServerModal');\n\n  bottle.serviceFactory('ImportServersBtn', ImportServersBtn, 'ServersImporter');\n  bottle.decorator('ImportServersBtn', connect(null, [ 'createServers' ]));\n\n  bottle.serviceFactory('ForServerVersion', () => ForServerVersion);\n  bottle.decorator('ForServerVersion', connect([ 'selectedServer' ]));\n\n  bottle.serviceFactory('ServerError', ServerError, 'DeleteServerButton');\n  bottle.decorator('ServerError', connect([ 'servers', 'selectedServer' ]));\n\n  bottle.serviceFactory('Overview', Overview, 'ShortUrlsTable', 'CreateShortUrl', 'ForServerVersion');\n  bottle.decorator('Overview', connect(\n    [ 'shortUrlsList', 'tagsList', 'selectedServer', 'mercureInfo', 'visitsOverview' ],\n    [ 'listShortUrls', 'listTags', 'createNewVisits', 'loadMercureInfo', 'loadVisitsOverview' ],\n  ));\n\n  // Services\n  bottle.constant('csvjson', csvjson);\n  bottle.constant('fileReaderFactory', () => new FileReader());\n  bottle.service('ServersImporter', ServersImporter, 'csvjson', 'fileReaderFactory');\n  bottle.service('ServersExporter', ServersExporter, 'Storage', 'window', 'csvjson');\n\n  // Actions\n  bottle.serviceFactory('selectServer', selectServer, 'buildShlinkApiClient', 'loadMercureInfo');\n  bottle.serviceFactory('createServer', () => createServer);\n  bottle.serviceFactory('createServers', () => createServers);\n  bottle.serviceFactory('deleteServer', () => deleteServer);\n  bottle.serviceFactory('editServer', () => editServer);\n  bottle.serviceFactory('fetchServers', fetchServers, 'axios');\n\n  bottle.serviceFactory('resetSelectedServer', () => resetSelectedServer);\n};\n\nexport default provideServices;\n","import { Button, Card } from 'reactstrap';\nimport { FC, ReactNode } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons';\nimport ShortUrlVisitsCount from '../short-urls/helpers/ShortUrlVisitsCount';\nimport { ShortUrl } from '../short-urls/data';\nimport { Visit } from './types';\n\ninterface VisitsHeaderProps {\n  visits: Visit[];\n  goBack: () => void;\n  title: ReactNode;\n  shortUrl?: ShortUrl;\n}\n\nconst VisitsHeader: FC<VisitsHeaderProps> = ({ visits, goBack, shortUrl, children, title }) => (\n  <header>\n    <Card body>\n      <h2 className=\"d-flex justify-content-between align-items-center mb-0\">\n        <Button color=\"link\" size=\"lg\" className=\"p-0 mr-3\" onClick={goBack}>\n          <FontAwesomeIcon icon={faArrowLeft} />\n        </Button>\n        <span className=\"text-center d-none d-sm-block\">\n          <small>{title}</small>\n        </span>\n        <span className=\"badge badge-main ml-3\">\n          Visits:{' '}\n          <ShortUrlVisitsCount visitsCount={visits.length} shortUrl={shortUrl} />\n        </span>\n      </h2>\n      <h3 className=\"text-center d-block d-sm-none mb-0 mt-3\">\n        <small>{title}</small>\n      </h3>\n\n      {children && <div className=\"mt-md-2\">{children}</div>}\n    </Card>\n  </header>\n);\n\nexport default VisitsHeader;\n","import { UncontrolledTooltip } from 'reactstrap';\nimport Moment from 'react-moment';\nimport { ExternalLink } from 'react-external-link';\nimport { ShortUrlDetail } from '../short-urls/reducers/shortUrlDetail';\nimport { ShortUrlVisits } from './reducers/shortUrlVisits';\nimport VisitsHeader from './VisitsHeader';\nimport './ShortUrlVisitsHeader.scss';\n\ninterface ShortUrlVisitsHeaderProps {\n  shortUrlDetail: ShortUrlDetail;\n  shortUrlVisits: ShortUrlVisits;\n  goBack: () => void;\n}\n\nconst ShortUrlVisitsHeader = ({ shortUrlDetail, shortUrlVisits, goBack }: ShortUrlVisitsHeaderProps) => {\n  const { shortUrl, loading } = shortUrlDetail;\n  const { visits } = shortUrlVisits;\n  const shortLink = shortUrl?.shortUrl ?? '';\n  const longLink = shortUrl?.longUrl ?? '';\n  const title = shortUrl?.title;\n\n  const renderDate = () => !shortUrl ? <small>Loading...</small> : (\n    <span>\n      <b id=\"created\" className=\"short-url-visits-header__created-at\">\n        <Moment fromNow>{shortUrl.dateCreated}</Moment>\n      </b>\n      <UncontrolledTooltip placement=\"bottom\" target=\"created\">\n        <Moment format=\"YYYY-MM-DD HH:mm\">{shortUrl.dateCreated}</Moment>\n      </UncontrolledTooltip>\n    </span>\n  );\n  const visitsStatsTitle = (\n    <>\n      Visits for <ExternalLink href={shortLink} />\n    </>\n  );\n\n  return (\n    <VisitsHeader title={visitsStatsTitle} goBack={goBack} visits={visits} shortUrl={shortUrl}>\n      <hr />\n      <div>Created: {renderDate()}</div>\n      <div>\n        {`${title ? 'Title' : 'Long URL'}: `}\n        {loading && <small>Loading...</small>}\n        {!loading && <ExternalLink href={longLink}>{title ?? longLink}</ExternalLink>}\n      </div>\n    </VisitsHeader>\n  );\n};\n\nexport default ShortUrlVisitsHeader;\n","import { DropdownItem, DropdownMenu, DropdownToggle, UncontrolledDropdown } from 'reactstrap';\n\ninterface PaginationDropdownProps {\n  ranges: number[];\n  value: number;\n  setValue: (newValue: number) => void;\n  toggleClassName?: string;\n}\n\nconst PaginationDropdown = ({ toggleClassName, ranges, value, setValue }: PaginationDropdownProps) => (\n  <UncontrolledDropdown>\n    <DropdownToggle caret color=\"link\" className={toggleClassName}>\n      Paginate\n    </DropdownToggle>\n    <DropdownMenu right>\n      {ranges.map((itemsPerPage) => (\n        <DropdownItem key={itemsPerPage} active={itemsPerPage === value} onClick={() => setValue(itemsPerPage)}>\n          <b>{itemsPerPage}</b> items per page\n        </DropdownItem>\n      ))}\n      <DropdownItem divider />\n      <DropdownItem disabled={value === Infinity} onClick={() => setValue(Infinity)}>\n        <i>Clear pagination</i>\n      </DropdownItem>\n    </DropdownMenu>\n  </UncontrolledDropdown>\n);\n\nexport default PaginationDropdown;\n","import { FC } from 'react';\nimport classNames from 'classnames';\nimport { Pagination, PaginationItem, PaginationLink } from 'reactstrap';\nimport {\n  pageIsEllipsis,\n  keyForPage,\n  NumberOrEllipsis,\n  progressivePagination,\n  prettifyPageNumber,\n} from '../utils/helpers/pagination';\nimport './SimplePaginator.scss';\n\ninterface SimplePaginatorProps {\n  pagesCount: number;\n  currentPage: number;\n  setCurrentPage: (currentPage: number) => void;\n  centered?: boolean;\n}\n\nconst SimplePaginator: FC<SimplePaginatorProps> = ({ pagesCount, currentPage, setCurrentPage, centered = true }) => {\n  if (pagesCount < 2) {\n    return null;\n  }\n\n  const onClick = (page: NumberOrEllipsis) => () => !pageIsEllipsis(page) && setCurrentPage(page);\n\n  return (\n    <Pagination listClassName={classNames('flex-wrap mb-0 simple-paginator', { 'justify-content-center': centered })}>\n      <PaginationItem disabled={currentPage <= 1}>\n        <PaginationLink previous tag=\"span\" onClick={onClick(currentPage - 1)} />\n      </PaginationItem>\n      {progressivePagination(currentPage, pagesCount).map((pageNumber, index) => (\n        <PaginationItem\n          key={keyForPage(pageNumber, index)}\n          disabled={pageIsEllipsis(pageNumber)}\n          active={currentPage === pageNumber}\n        >\n          <PaginationLink tag=\"span\" onClick={onClick(pageNumber)}>{prettifyPageNumber(pageNumber)}</PaginationLink>\n        </PaginationItem>\n      ))}\n      <PaginationItem disabled={currentPage >= pagesCount}>\n        <PaginationLink next tag=\"span\" onClick={onClick(currentPage + 1)} />\n      </PaginationItem>\n    </Pagination>\n  );\n};\n\nexport default SimplePaginator;\n","import bowser from 'bowser';\nimport { zipObj } from 'ramda';\nimport { Empty, hasValue } from '../utils';\nimport { Stats, UserAgent } from '../../visits/types';\n\nconst DEFAULT = 'Others';\nconst BROWSERS_WHITELIST = [\n  'Android Browser',\n  'Chrome',\n  'Chromium',\n  'Firefox',\n  'Internet Explorer',\n  'Microsoft Edge',\n  'Opera',\n  'Safari',\n  'Samsung Internet for Android',\n  'Vivaldi',\n  'WeChat',\n];\n\nexport const parseUserAgent = (userAgent: string | Empty): UserAgent => {\n  if (!hasValue(userAgent)) {\n    return { browser: DEFAULT, os: DEFAULT };\n  }\n\n  const { browser: { name: browser }, os: { name: os } } = bowser.parse(userAgent);\n\n  return { os: os ?? DEFAULT, browser: browser && BROWSERS_WHITELIST.includes(browser) ? browser : DEFAULT };\n};\n\nexport const extractDomain = (url: string | Empty): string => {\n  if (!hasValue(url)) {\n    return 'Direct';\n  }\n\n  return url.split('/')[url.includes('://') ? 2 : 0]?.split(':')[0] ?? '';\n};\n\nexport const fillTheGaps = (stats: Stats, labels: string[]): number[] =>\n  Object.values({ ...zipObj(labels, labels.map(() => 0)), ...stats });\n","import { ChangeEvent, FC } from 'react';\nimport { ChartData, ChartTooltipItem } from 'chart.js';\nimport { prettify } from './numbers';\n\nexport const pointerOnHover = ({ target }: ChangeEvent<HTMLElement>, chartElement: FC[]) => {\n  target.style.cursor = chartElement[0] ? 'pointer' : 'default';\n};\n\nexport const renderNonDoughnutChartLabel = (labelToPick: 'yLabel' | 'xLabel') => (\n  item: ChartTooltipItem,\n  { datasets }: ChartData,\n) => {\n  const { datasetIndex } = item;\n  const value = item[labelToPick];\n  const datasetLabel = datasetIndex !== undefined && datasets?.[datasetIndex]?.label || '';\n\n  return `${datasetLabel}: ${prettify(Number(value))}`;\n};\n\nexport const renderDoughnutChartLabel = (\n  { datasetIndex, index }: ChartTooltipItem,\n  { labels, datasets }: ChartData,\n) => {\n  const datasetLabel = index !== undefined && labels?.[index] || '';\n  const value = datasetIndex !== undefined && index !== undefined\n    && datasets?.[datasetIndex]?.data?.[index]\n    || '';\n\n  return `${datasetLabel}: ${prettify(Number(value))}`; // eslint-disable-line @typescript-eslint/no-base-to-string\n};\n","import { useState } from 'react';\nimport { Doughnut, HorizontalBar } from 'react-chartjs-2';\nimport { keys, values } from 'ramda';\nimport classNames from 'classnames';\nimport Chart, { ChartData, ChartDataSets, ChartOptions } from 'chart.js';\nimport { fillTheGaps } from '../../utils/helpers/visits';\nimport { Stats } from '../types';\nimport { prettify } from '../../utils/helpers/numbers';\nimport { pointerOnHover, renderDoughnutChartLabel, renderNonDoughnutChartLabel } from '../../utils/helpers/charts';\nimport {\n  HIGHLIGHTED_COLOR,\n  HIGHLIGHTED_COLOR_ALPHA,\n  isDarkThemeEnabled,\n  MAIN_COLOR,\n  MAIN_COLOR_ALPHA,\n  PRIMARY_DARK_COLOR,\n  PRIMARY_LIGHT_COLOR,\n} from '../../utils/theme';\nimport './DefaultChart.scss';\n\nexport interface DefaultChartProps {\n  title: Function | string;\n  stats: Stats;\n  isBarChart?: boolean;\n  max?: number;\n  highlightedStats?: Stats;\n  highlightedLabel?: string;\n  onClick?: (label: string) => void;\n}\n\nconst generateGraphData = (\n  title: Function | string,\n  isBarChart: boolean,\n  labels: string[],\n  data: number[],\n  highlightedData?: number[],\n  highlightedLabel?: string,\n): ChartData => ({\n  labels,\n  datasets: [\n    {\n      title,\n      label: highlightedData ? 'Non-selected' : 'Visits',\n      data,\n      backgroundColor: isBarChart ? MAIN_COLOR_ALPHA : [\n        '#97BBCD',\n        '#F7464A',\n        '#46BFBD',\n        '#FDB45C',\n        '#949FB1',\n        '#57A773',\n        '#414066',\n        '#08B2E3',\n        '#B6C454',\n        '#DCDCDC',\n        '#463730',\n      ],\n      borderColor: isBarChart ? MAIN_COLOR : isDarkThemeEnabled() ? PRIMARY_DARK_COLOR : PRIMARY_LIGHT_COLOR,\n      borderWidth: 2,\n    },\n    highlightedData && {\n      title,\n      label: highlightedLabel ?? 'Selected',\n      data: highlightedData,\n      backgroundColor: HIGHLIGHTED_COLOR_ALPHA,\n      borderColor: HIGHLIGHTED_COLOR,\n      borderWidth: 2,\n    },\n  ].filter(Boolean) as ChartDataSets[],\n});\n\nconst dropLabelIfHidden = (label: string) => label.startsWith('hidden') ? '' : label;\n\nconst determineHeight = (isBarChart: boolean, labels: string[]): number | undefined => {\n  if (!isBarChart) {\n    return 300;\n  }\n\n  return isBarChart && labels.length > 20 ? labels.length * 8 : undefined;\n};\n\nconst renderPieChartLegend = ({ config }: Chart) => {\n  const { labels = [], datasets = [] } = config.data ?? {};\n  const { defaultColor } = config.options ?? {} as any;\n  const [{ backgroundColor: colors }] = datasets;\n\n  return (\n    <ul className=\"default-chart__pie-chart-legend\">\n      {labels.map((label, index) => (\n        <li key={label as string} className=\"default-chart__pie-chart-legend-item d-flex\">\n          <div\n            className=\"default-chart__pie-chart-legend-item-color\"\n            style={{ backgroundColor: (colors as string[])[index] || defaultColor }}\n          />\n          <small className=\"default-chart__pie-chart-legend-item-text flex-fill\">{label}</small>\n        </li>\n      ))}\n    </ul>\n  );\n};\n\nconst chartElementAtEvent = (onClick?: (label: string) => void) => ([ chart ]: [{ _index: number; _chart: Chart }]) => {\n  if (!onClick || !chart) {\n    return;\n  }\n\n  const { _index, _chart: { data } } = chart;\n  const { labels } = data;\n\n  onClick(labels?.[_index] as string);\n};\n\nconst statsAreDefined = (stats: Stats | undefined): stats is Stats => !!stats && Object.keys(stats).length > 0;\n\nconst DefaultChart = (\n  { title, isBarChart = false, stats, max, highlightedStats, highlightedLabel, onClick }: DefaultChartProps,\n) => {\n  const Component = isBarChart ? HorizontalBar : Doughnut;\n  const labels = keys(stats).map(dropLabelIfHidden);\n  const data = values(\n    !statsAreDefined(highlightedStats) ? stats : keys(highlightedStats).reduce((acc, highlightedKey) => {\n      if (acc[highlightedKey]) {\n        acc[highlightedKey] -= highlightedStats[highlightedKey];\n      }\n\n      return acc;\n    }, { ...stats }),\n  );\n  const highlightedData = statsAreDefined(highlightedStats) ? fillTheGaps(highlightedStats, labels) : undefined;\n  const [ chartRef, setChartRef ] = useState<HorizontalBar | Doughnut | undefined>();\n\n  const options: ChartOptions = {\n    legend: { display: false },\n    legendCallback: !isBarChart && renderPieChartLegend as any,\n    scales: !isBarChart ? undefined : {\n      xAxes: [\n        {\n          ticks: {\n            beginAtZero: true,\n            precision: 0,\n            callback: prettify,\n            max,\n          },\n          stacked: true,\n        },\n      ],\n      yAxes: [{ stacked: true }],\n    },\n    tooltips: {\n      intersect: !isBarChart,\n      // Do not show tooltip on items with empty label when in a bar chart\n      filter: ({ yLabel }) => !isBarChart || yLabel !== '',\n      callbacks: {\n        label: isBarChart ? renderNonDoughnutChartLabel('xLabel') : renderDoughnutChartLabel,\n      },\n    },\n    onHover: !isBarChart ? undefined : (pointerOnHover) as any, // TODO Types seem to be incorrectly defined in @types/chart.js\n  };\n  const graphData = generateGraphData(title, isBarChart, labels, data, highlightedData, highlightedLabel);\n  const height = determineHeight(isBarChart, labels);\n\n  // Provide a key based on the height, so that every time the dataset changes, a new graph is rendered\n  return (\n    <div className=\"row\">\n      <div className={classNames('col-sm-12', { 'col-md-7': !isBarChart })}>\n        <Component\n          ref={(element) => setChartRef(element ?? undefined)}\n          key={height}\n          data={graphData}\n          options={options}\n          height={height}\n          getElementAtEvent={chartElementAtEvent(onClick)}\n        />\n      </div>\n      {!isBarChart && (\n        <div className=\"col-sm-12 col-md-5\">\n          {chartRef?.chartInstance.generateLegend()}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default DefaultChart;\n","import { Card, CardHeader, CardBody, CardFooter } from 'reactstrap';\nimport { ReactNode } from 'react';\nimport DefaultChart, { DefaultChartProps } from './DefaultChart';\nimport './GraphCard.scss';\n\ninterface GraphCardProps extends DefaultChartProps {\n  footer?: ReactNode;\n}\n\nconst GraphCard = ({ title, footer, ...rest }: GraphCardProps) => (\n  <Card>\n    <CardHeader className=\"graph-card__header\">{typeof title === 'function' ? title() : title}</CardHeader>\n    <CardBody>\n      <DefaultChart title={title} {...rest} />\n    </CardBody>\n    {footer && <CardFooter className=\"graph-card__footer--sticky\">{footer}</CardFooter>}\n  </Card>\n);\n\nexport default GraphCard;\n","import { useState } from 'react';\nimport { fromPairs, pipe, reverse, sortBy, splitEvery, toLower, toPairs, type, zipObj } from 'ramda';\nimport SortingDropdown from '../../utils/SortingDropdown';\nimport PaginationDropdown from '../../utils/PaginationDropdown';\nimport { OrderDir, rangeOf } from '../../utils/utils';\nimport { roundTen } from '../../utils/helpers/numbers';\nimport SimplePaginator from '../../common/SimplePaginator';\nimport { Stats, StatsRow } from '../types';\nimport GraphCard from './GraphCard';\nimport { DefaultChartProps } from './DefaultChart';\n\nconst toLowerIfString = (value: any) => type(value) === 'String' ? toLower(value) : value; // eslint-disable-line @typescript-eslint/no-unsafe-return\nconst pickKeyFromPair = ([ key ]: StatsRow) => key;\nconst pickValueFromPair = ([ , value ]: StatsRow) => value;\n\ninterface SortableBarGraphProps extends DefaultChartProps {\n  sortingItems: Record<string, string>;\n  withPagination?: boolean;\n  extraHeaderContent?: Function;\n}\n\nconst SortableBarGraph = ({\n  stats,\n  highlightedStats,\n  title,\n  sortingItems,\n  extraHeaderContent,\n  withPagination = true,\n  ...rest\n}: SortableBarGraphProps) => {\n  const [ order, setOrder ] = useState<{ orderField?: string; orderDir?: OrderDir }>({\n    orderField: undefined,\n    orderDir: undefined,\n  });\n  const [ currentPage, setCurrentPage ] = useState(1);\n  const [ itemsPerPage, setItemsPerPage ] = useState(50);\n\n  const getSortedPairsForStats = (stats: Stats, sortingItems: Record<string, string>) => {\n    const pairs = toPairs(stats);\n    const sortedPairs = !order.orderField ? pairs : sortBy(\n      pipe<StatsRow, string | number, string | number>(\n        order.orderField === Object.keys(sortingItems)[0] ? pickKeyFromPair : pickValueFromPair,\n        toLowerIfString,\n      ),\n      pairs,\n    );\n\n    return !order.orderDir || order.orderDir === 'ASC' ? sortedPairs : reverse(sortedPairs);\n  };\n  const determineCurrentPagePairs = (pages: StatsRow[][]): StatsRow[] => {\n    const page = pages[currentPage - 1];\n\n    if (currentPage < pages.length) {\n      return page;\n    }\n\n    const firstPageLength = pages[0].length;\n\n    // Using the \"hidden\" key, the chart will just replace the label by an empty string\n    return [ ...page, ...rangeOf(firstPageLength - page.length, (i): StatsRow => [ `hidden_${i}`, 0 ]) ];\n  };\n  const renderPagination = (pagesCount: number) =>\n    <SimplePaginator currentPage={currentPage} pagesCount={pagesCount} setCurrentPage={setCurrentPage} />;\n  const determineStats = (stats: Stats, highlightedStats: Stats | undefined, sortingItems: Record<string, string>) => {\n    const sortedPairs = getSortedPairsForStats(stats, sortingItems);\n    const sortedKeys = sortedPairs.map(pickKeyFromPair);\n    // The highlighted stats have to be ordered based on the regular stats, not on its own values\n    const sortedHighlightedPairs = highlightedStats && toPairs(\n      { ...zipObj(sortedKeys, sortedKeys.map(() => 0)), ...highlightedStats },\n    );\n\n    if (sortedPairs.length <= itemsPerPage) {\n      return {\n        currentPageStats: fromPairs(sortedPairs),\n        currentPageHighlightedStats: sortedHighlightedPairs && fromPairs(sortedHighlightedPairs),\n      };\n    }\n\n    const pages = splitEvery(itemsPerPage, sortedPairs);\n    const highlightedPages = sortedHighlightedPairs && splitEvery(itemsPerPage, sortedHighlightedPairs);\n\n    return {\n      currentPageStats: fromPairs(determineCurrentPagePairs(pages)),\n      currentPageHighlightedStats: highlightedPages && fromPairs(determineCurrentPagePairs(highlightedPages)),\n      pagination: renderPagination(pages.length),\n      max: roundTen(Math.max(...sortedPairs.map(pickValueFromPair))),\n    };\n  };\n\n  const { currentPageStats, currentPageHighlightedStats, pagination, max } = determineStats(\n    stats,\n    highlightedStats && Object.keys(highlightedStats).length > 0 ? highlightedStats : undefined,\n    sortingItems,\n  );\n  const activeCities = Object.keys(currentPageStats);\n  const computeTitle = () => (\n    <>\n      {title}\n      <div className=\"float-right\">\n        <SortingDropdown\n          isButton={false}\n          right\n          items={sortingItems}\n          orderField={order.orderField}\n          orderDir={order.orderDir}\n          onChange={(orderField, orderDir) => {\n            setOrder({ orderField, orderDir });\n            setCurrentPage(1);\n          }}\n        />\n      </div>\n      {withPagination && Object.keys(stats).length > 50 && (\n        <div className=\"float-right\">\n          <PaginationDropdown\n            toggleClassName=\"btn-sm p-0 mr-3\"\n            ranges={[ 50, 100, 200, 500 ]}\n            value={itemsPerPage}\n            setValue={(itemsPerPage) => {\n              setItemsPerPage(itemsPerPage);\n              setCurrentPage(1);\n            }}\n          />\n        </div>\n      )}\n      {extraHeaderContent && (\n        <div className=\"float-right\">\n          {extraHeaderContent(pagination ? activeCities : undefined)}\n        </div>\n      )}\n    </>\n  );\n\n  return (\n    <GraphCard\n      isBarChart\n      title={computeTitle}\n      stats={currentPageStats}\n      highlightedStats={currentPageHighlightedStats}\n      footer={pagination}\n      max={max}\n      {...rest}\n    />\n  );\n};\n\nexport default SortableBarGraph;\n","import { FC } from 'react';\nimport BooleanControl, { BooleanControlProps } from './BooleanControl';\n\nconst ToggleSwitch: FC<BooleanControlProps> = (props) => <BooleanControl type=\"switch\" {...props} />;\n\nexport default ToggleSwitch;\n","import { useState, useMemo } from 'react';\nimport {\n  Card,\n  CardHeader,\n  CardBody,\n  UncontrolledDropdown,\n  DropdownToggle,\n  DropdownMenu,\n  DropdownItem,\n} from 'reactstrap';\nimport { Line } from 'react-chartjs-2';\nimport { always, cond, countBy, reverse } from 'ramda';\nimport moment from 'moment';\nimport Chart, { ChartData, ChartDataSets, ChartOptions } from 'chart.js';\nimport { NormalizedVisit, Stats } from '../types';\nimport { fillTheGaps } from '../../utils/helpers/visits';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { rangeOf } from '../../utils/utils';\nimport ToggleSwitch from '../../utils/ToggleSwitch';\nimport { prettify } from '../../utils/helpers/numbers';\nimport { pointerOnHover, renderNonDoughnutChartLabel } from '../../utils/helpers/charts';\nimport { HIGHLIGHTED_COLOR, MAIN_COLOR } from '../../utils/theme';\nimport './LineChartCard.scss';\n\ninterface LineChartCardProps {\n  title: string;\n  highlightedLabel?: string;\n  visits: NormalizedVisit[];\n  highlightedVisits: NormalizedVisit[];\n  setSelectedVisits?: (visits: NormalizedVisit[]) => void;\n}\n\ntype Step = 'monthly' | 'weekly' | 'daily' | 'hourly';\n\nconst STEPS_MAP: Record<Step, string> = {\n  monthly: 'Month',\n  weekly: 'Week',\n  daily: 'Day',\n  hourly: 'Hour',\n};\n\nconst STEP_TO_DATE_UNIT_MAP: Record<Step, moment.unitOfTime.Diff> = {\n  hourly: 'hour',\n  daily: 'day',\n  weekly: 'week',\n  monthly: 'month',\n};\n\nconst STEP_TO_DATE_FORMAT: Record<Step, (date: moment.Moment | string) => string> = {\n  hourly: (date) => moment(date).format('YYYY-MM-DD HH:00'),\n  daily: (date) => moment(date).format('YYYY-MM-DD'),\n  weekly(date) {\n    const firstWeekDay = moment(date).isoWeekday(1).format('YYYY-MM-DD');\n    const lastWeekDay = moment(date).isoWeekday(7).format('YYYY-MM-DD');\n\n    return `${firstWeekDay} - ${lastWeekDay}`;\n  },\n  monthly: (date) => moment(date).format('YYYY-MM'),\n};\n\nconst determineInitialStep = (oldestVisitDate: string): Step => {\n  const now = moment();\n  const oldestDate = moment(oldestVisitDate);\n  const matcher = cond<never, Step | undefined>([\n    [ () => now.diff(oldestDate, 'day') <= 2, always<Step>('hourly') ], // Less than 2 days\n    [ () => now.diff(oldestDate, 'month') <= 1, always<Step>('daily') ], // Between 2 days and 1 month\n    [ () => now.diff(oldestDate, 'month') <= 6, always<Step>('weekly') ], // Between 1 and 6 months\n  ]);\n\n  return matcher() ?? 'monthly';\n};\n\nconst groupVisitsByStep = (step: Step, visits: NormalizedVisit[]): Stats => countBy(\n  (visit) => STEP_TO_DATE_FORMAT[step](visit.date),\n  visits,\n);\n\nconst visitsToDatasetGroups = (step: Step, visits: NormalizedVisit[]) =>\n  visits.reduce<Record<string, NormalizedVisit[]>>(\n    (acc, visit) => {\n      const key = STEP_TO_DATE_FORMAT[step](visit.date);\n\n      acc[key] = acc[key] ?? [];\n      acc[key].push(visit);\n\n      return acc;\n    },\n    {},\n  );\n\nconst generateLabels = (step: Step, visits: NormalizedVisit[]): string[] => {\n  const unit = STEP_TO_DATE_UNIT_MAP[step];\n  const formatter = STEP_TO_DATE_FORMAT[step];\n  const newerDate = moment(visits[0].date);\n  const oldestDate = moment(visits[visits.length - 1].date);\n  const size = newerDate.diff(oldestDate, unit);\n\n  return [\n    formatter(oldestDate),\n    ...rangeOf(size, () => formatter(oldestDate.add(1, unit))),\n  ];\n};\n\nconst generateLabelsAndGroupedVisits = (\n  visits: NormalizedVisit[],\n  groupedVisitsWithGaps: Stats,\n  step: Step,\n  skipNoElements: boolean,\n): [string[], number[]] => {\n  if (skipNoElements) {\n    return [ Object.keys(groupedVisitsWithGaps), Object.values(groupedVisitsWithGaps) ];\n  }\n\n  const labels = generateLabels(step, visits);\n\n  return [ labels, fillTheGaps(groupedVisitsWithGaps, labels) ];\n};\n\nconst generateDataset = (data: number[], label: string, color: string): ChartDataSets => ({\n  label,\n  data,\n  fill: false,\n  lineTension: 0.2,\n  borderColor: color,\n  backgroundColor: color,\n});\n\nlet selectedLabel: string | null = null;\n\nconst chartElementAtEvent = (\n  datasetsByPoint: Record<string, NormalizedVisit[]>,\n  setSelectedVisits?: (visits: NormalizedVisit[]) => void,\n) => ([ chart ]: [{ _index: number; _chart: Chart }]) => {\n  if (!setSelectedVisits || !chart) {\n    return;\n  }\n\n  const { _index: index, _chart: { data } } = chart;\n  const { labels } = data as { labels: string[] };\n\n  if (selectedLabel === labels[index]) {\n    setSelectedVisits([]);\n    selectedLabel = null;\n  } else {\n    setSelectedVisits(labels[index] && datasetsByPoint[labels[index]] || []);\n    selectedLabel = labels[index] ?? null;\n  }\n};\n\nconst LineChartCard = (\n  { title, visits, highlightedVisits, highlightedLabel = 'Selected', setSelectedVisits }: LineChartCardProps,\n) => {\n  const [ step, setStep ] = useState<Step>(\n    visits.length > 0 ? determineInitialStep(visits[visits.length - 1].date) : 'monthly',\n  );\n  const [ skipNoVisits, toggleSkipNoVisits ] = useToggle(true);\n\n  const datasetsByPoint = useMemo(() => visitsToDatasetGroups(step, visits), [ step, visits ]);\n  const groupedVisitsWithGaps = useMemo(() => groupVisitsByStep(step, reverse(visits)), [ step, visits ]);\n  const [ labels, groupedVisits ] = useMemo(\n    () => generateLabelsAndGroupedVisits(visits, groupedVisitsWithGaps, step, skipNoVisits),\n    [ visits, step, skipNoVisits ],\n  );\n  const groupedHighlighted = useMemo(\n    () => fillTheGaps(groupVisitsByStep(step, reverse(highlightedVisits)), labels),\n    [ highlightedVisits, step, labels ],\n  );\n\n  const data: ChartData = {\n    labels,\n    datasets: [\n      generateDataset(groupedVisits, 'Visits', MAIN_COLOR),\n      highlightedVisits.length > 0 && generateDataset(groupedHighlighted, highlightedLabel, HIGHLIGHTED_COLOR),\n    ].filter(Boolean) as ChartDataSets[],\n  };\n  const options: ChartOptions = {\n    maintainAspectRatio: false,\n    legend: { display: false },\n    scales: {\n      yAxes: [\n        {\n          ticks: {\n            beginAtZero: true,\n            precision: 0,\n            callback: prettify,\n          },\n        },\n      ],\n      xAxes: [\n        {\n          scaleLabel: { display: true, labelString: STEPS_MAP[step] },\n        },\n      ],\n    },\n    tooltips: {\n      intersect: false,\n      axis: 'x',\n      callbacks: {\n        label: renderNonDoughnutChartLabel('yLabel'),\n      },\n    },\n    onHover: (pointerOnHover) as any, // TODO Types seem to be incorrectly defined in @types/chart.js\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        {title}\n        <div className=\"float-right\">\n          <UncontrolledDropdown>\n            <DropdownToggle caret color=\"link\" className=\"btn-sm p-0\">\n              Group by\n            </DropdownToggle>\n            <DropdownMenu right>\n              {Object.entries(STEPS_MAP).map(([ value, menuText ]) => (\n                <DropdownItem key={value} active={step === value} onClick={() => setStep(value as Step)}>\n                  {menuText}\n                </DropdownItem>\n              ))}\n            </DropdownMenu>\n          </UncontrolledDropdown>\n        </div>\n        <div className=\"float-right mr-2\">\n          <ToggleSwitch checked={skipNoVisits} onChange={toggleSkipNoVisits}>\n            <small>Skip dates with no visits</small>\n          </ToggleSwitch>\n        </div>\n      </CardHeader>\n      <CardBody className=\"line-chart-card__body\">\n        <Line\n          data={data}\n          options={options}\n          getElementAtEvent={chartElementAtEvent(datasetsByPoint, setSelectedVisits)}\n        />\n      </CardBody>\n    </Card>\n  );\n};\n\nexport default LineChartCard;\n","import { useEffect, useMemo, useState, useRef } from 'react';\nimport Moment from 'react-moment';\nimport classNames from 'classnames';\nimport { min, splitEvery } from 'ramda';\nimport {\n  faCaretDown as caretDownIcon,\n  faCaretUp as caretUpIcon,\n  faCheck as checkIcon,\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport SimplePaginator from '../common/SimplePaginator';\nimport SearchField from '../utils/SearchField';\nimport { determineOrderDir, OrderDir } from '../utils/utils';\nimport { prettify } from '../utils/helpers/numbers';\nimport { NormalizedOrphanVisit, NormalizedVisit } from './types';\nimport './VisitsTable.scss';\n\ninterface VisitsTableProps {\n  visits: NormalizedVisit[];\n  selectedVisits?: NormalizedVisit[];\n  setSelectedVisits: (visits: NormalizedVisit[]) => void;\n  matchMedia?: (query: string) => MediaQueryList;\n  isOrphanVisits?: boolean;\n}\n\ntype OrderableFields = 'date' | 'country' | 'city' | 'browser' | 'os' | 'referer' | 'visitedUrl';\n\ninterface Order {\n  field?: OrderableFields;\n  dir?: OrderDir;\n}\n\nconst PAGE_SIZE = 20;\nconst visitMatchesSearch = ({ browser, os, referer, country, city, ...rest }: NormalizedVisit, searchTerm: string) =>\n  `${browser} ${os} ${referer} ${country} ${city} ${(rest as NormalizedOrphanVisit).visitedUrl}`.toLowerCase().includes(\n    searchTerm.toLowerCase(),\n  );\nconst searchVisits = (searchTerm: string, visits: NormalizedVisit[]) =>\n  visits.filter((visit) => visitMatchesSearch(visit, searchTerm));\nconst sortVisits = ({ field, dir }: Order, visits: NormalizedVisit[]) => !field || !dir ? visits : visits.sort(\n  (a, b) => {\n    const greaterThan = dir === 'ASC' ? 1 : -1;\n    const smallerThan = dir === 'ASC' ? -1 : 1;\n\n    return (a as NormalizedOrphanVisit)[field] > (b as NormalizedOrphanVisit)[field] ? greaterThan : smallerThan;\n  },\n);\nconst calculateVisits = (allVisits: NormalizedVisit[], searchTerm: string | undefined, order: Order) => {\n  const filteredVisits = searchTerm ? searchVisits(searchTerm, allVisits) : [ ...allVisits ];\n  const sortedVisits = sortVisits(order, filteredVisits);\n  const total = sortedVisits.length;\n  const visitsGroups = splitEvery(PAGE_SIZE, sortedVisits);\n\n  return { visitsGroups, total };\n};\n\nconst VisitsTable = ({\n  visits,\n  selectedVisits = [],\n  setSelectedVisits,\n  matchMedia = window.matchMedia,\n  isOrphanVisits = false,\n}: VisitsTableProps) => {\n  const headerCellsClass = 'visits-table__header-cell visits-table__sticky';\n  const matchMobile = () => matchMedia('(max-width: 767px)').matches;\n\n  const [ isMobileDevice, setIsMobileDevice ] = useState(matchMobile());\n  const [ searchTerm, setSearchTerm ] = useState<string | undefined>(undefined);\n  const [ order, setOrder ] = useState<Order>({ field: undefined, dir: undefined });\n  const resultSet = useMemo(() => calculateVisits(visits, searchTerm, order), [ searchTerm, order ]);\n  const isFirstLoad = useRef(true);\n\n  const [ page, setPage ] = useState(1);\n  const end = page * PAGE_SIZE;\n  const start = end - PAGE_SIZE;\n\n  const orderByColumn = (field: OrderableFields) =>\n    () => setOrder({ field, dir: determineOrderDir(field, order.field, order.dir) });\n  const renderOrderIcon = (field: OrderableFields) => order.dir && order.field === field && (\n    <FontAwesomeIcon\n      icon={order.dir === 'ASC' ? caretUpIcon : caretDownIcon}\n      className=\"visits-table__header-icon\"\n    />\n  );\n\n  useEffect(() => {\n    const listener = () => setIsMobileDevice(matchMobile());\n\n    window.addEventListener('resize', listener);\n\n    return () => window.removeEventListener('resize', listener);\n  }, []);\n  useEffect(() => {\n    setPage(1);\n\n    !isFirstLoad.current && setSelectedVisits([]);\n    isFirstLoad.current = false;\n  }, [ searchTerm ]);\n\n  return (\n    <table className=\"table table-bordered table-hover table-sm table-responsive-sm visits-table\">\n      <thead className=\"visits-table__header\">\n        <tr>\n          <th\n            className=\"visits-table__header-cell visits-table__sticky text-center\"\n            onClick={() => setSelectedVisits(\n              selectedVisits.length < resultSet.total ? resultSet.visitsGroups.flat() : [],\n            )}\n          >\n            <FontAwesomeIcon icon={checkIcon} className={classNames({ 'text-primary': selectedVisits.length > 0 })} />\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('date')}>\n            Date\n            {renderOrderIcon('date')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('country')}>\n            Country\n            {renderOrderIcon('country')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('city')}>\n            City\n            {renderOrderIcon('city')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('browser')}>\n            Browser\n            {renderOrderIcon('browser')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('os')}>\n            OS\n            {renderOrderIcon('os')}\n          </th>\n          <th className={headerCellsClass} onClick={orderByColumn('referer')}>\n            Referrer\n            {renderOrderIcon('referer')}\n          </th>\n          {isOrphanVisits && (\n            <th className={headerCellsClass} onClick={orderByColumn('visitedUrl')}>\n              Visited URL\n              {renderOrderIcon('visitedUrl')}\n            </th>\n          )}\n        </tr>\n        <tr>\n          <td colSpan={isOrphanVisits ? 8 : 7} className=\"p-0\">\n            <SearchField noBorder large={false} onChange={setSearchTerm} />\n          </td>\n        </tr>\n      </thead>\n      <tbody>\n        {!resultSet.visitsGroups[page - 1]?.length && (\n          <tr>\n            <td colSpan={isOrphanVisits ? 8 : 7} className=\"text-center\">\n              No visits found with current filtering\n            </td>\n          </tr>\n        )}\n        {resultSet.visitsGroups[page - 1]?.map((visit, index) => {\n          const isSelected = selectedVisits.includes(visit);\n\n          return (\n            <tr\n              key={index}\n              style={{ cursor: 'pointer' }}\n              className={classNames({ 'table-active': isSelected })}\n              onClick={() => setSelectedVisits(\n                isSelected ? selectedVisits.filter((v) => v !== visit) : [ ...selectedVisits, visit ],\n              )}\n            >\n              <td className=\"text-center\">\n                {isSelected && <FontAwesomeIcon icon={checkIcon} className=\"text-primary\" />}\n              </td>\n              <td>\n                <Moment format=\"YYYY-MM-DD HH:mm\">{visit.date}</Moment>\n              </td>\n              <td>{visit.country}</td>\n              <td>{visit.city}</td>\n              <td>{visit.browser}</td>\n              <td>{visit.os}</td>\n              <td>{visit.referer}</td>\n              {isOrphanVisits && <td>{(visit as NormalizedOrphanVisit).visitedUrl}</td>}\n            </tr>\n          );\n        })}\n      </tbody>\n      {resultSet.total > PAGE_SIZE && (\n        <tfoot>\n          <tr>\n            <td colSpan={isOrphanVisits ? 8 : 7} className=\"visits-table__footer-cell visits-table__sticky\">\n              <div className=\"row\">\n                <div className=\"col-md-6\">\n                  <SimplePaginator\n                    pagesCount={Math.ceil(resultSet.total / PAGE_SIZE)}\n                    currentPage={page}\n                    setCurrentPage={setPage}\n                    centered={isMobileDevice}\n                  />\n                </div>\n                <div\n                  className={classNames('col-md-6', {\n                    'd-flex align-items-center flex-row-reverse': !isMobileDevice,\n                    'text-center mt-3': isMobileDevice,\n                  })}\n                >\n                  <div>\n                    Visits <b>{prettify(start + 1)}</b> to{' '}\n                    <b>{prettify(min(end, resultSet.total))}</b> of{' '}\n                    <b>{prettify(resultSet.total)}</b>\n                  </div>\n                </div>\n              </div>\n            </td>\n          </tr>\n        </tfoot>\n      )}\n    </table>\n  );\n};\n\nexport default VisitsTable;\n","import { FC } from 'react';\nimport { Modal, ModalBody } from 'reactstrap';\nimport { MapContainer, TileLayer, Marker, Popup, MapContainerProps } from 'react-leaflet';\nimport { prop } from 'ramda';\nimport { CityStats } from '../types';\nimport './MapModal.scss';\n\ninterface MapModalProps {\n  toggle: () => void;\n  isOpen: boolean;\n  title: string;\n  locations?: CityStats[];\n}\n\nconst OpenStreetMapTile: FC = () => (\n  <TileLayer\n    attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n  />\n);\n\nconst calculateMapProps = (locations: CityStats[]): MapContainerProps => {\n  if (locations.length === 0) {\n    return {};\n  }\n\n  if (locations.length > 1) {\n    return { bounds: locations.map(prop('latLong')) };\n  }\n\n  // When there's only one location, an error is thrown if trying to calculate the bounds.\n  // When that happens, we use zoom and center as a workaround\n  const [{ latLong: center }] = locations;\n\n  return { zoom: 10, center };\n};\n\nconst MapModal = ({ toggle, isOpen, title, locations = [] }: MapModalProps) => (\n  <Modal toggle={toggle} isOpen={isOpen} className=\"map-modal__modal\" contentClassName=\"map-modal__modal-content\">\n    <ModalBody className=\"map-modal__modal-body\">\n      <h3 className=\"map-modal__modal-title\">\n        {title}\n        <button type=\"button\" className=\"close\" onClick={toggle}>&times;</button>\n      </h3>\n      <MapContainer {...calculateMapProps(locations)}>\n        <OpenStreetMapTile />\n        {locations.map(({ cityName, latLong, count }, index) => (\n          <Marker key={index} position={latLong}>\n            <Popup><b>{count}</b> visit{count > 1 ? 's' : ''} from <b>{cityName}</b></Popup>\n          </Marker>\n        ))}\n      </MapContainer>\n    </ModalBody>\n  </Modal>\n);\n\nexport default MapModal;\n","import { useRef, useState } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faMapMarkedAlt as mapIcon } from '@fortawesome/free-solid-svg-icons';\nimport { Dropdown, DropdownItem, DropdownMenu, UncontrolledTooltip } from 'reactstrap';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { CityStats } from '../types';\nimport MapModal from './MapModal';\nimport './OpenMapModalBtn.scss';\n\ninterface OpenMapModalBtnProps {\n  modalTitle: string;\n  activeCities: string[];\n  locations?: CityStats[];\n}\n\nconst OpenMapModalBtn = ({ modalTitle, activeCities, locations = [] }: OpenMapModalBtnProps) => {\n  const [ mapIsOpened, , openMap, closeMap ] = useToggle();\n  const [ dropdownIsOpened, toggleDropdown, openDropdown ] = useToggle();\n  const [ locationsToShow, setLocationsToShow ] = useState<CityStats[]>([]);\n  const buttonRef = useRef<HTMLElement>();\n\n  const filterLocations = (cities: CityStats[]) => cities.filter(({ cityName }) => activeCities.includes(cityName));\n  const onClick = () => {\n    if (!activeCities) {\n      setLocationsToShow(locations);\n      openMap();\n\n      return;\n    }\n\n    openDropdown();\n  };\n  const openMapWithLocations = (filtered: boolean) => () => {\n    setLocationsToShow(filtered ? filterLocations(locations) : locations);\n    openMap();\n  };\n\n  return (\n    <>\n      <button className=\"btn btn-link open-map-modal-btn__btn\" ref={buttonRef as any} onClick={onClick}>\n        <FontAwesomeIcon icon={mapIcon} />\n      </button>\n      <UncontrolledTooltip placement=\"left\" target={(() => buttonRef.current) as any}>Show in map</UncontrolledTooltip>\n      <Dropdown isOpen={dropdownIsOpened} toggle={toggleDropdown} inNavbar>\n        <DropdownMenu right>\n          <DropdownItem onClick={openMapWithLocations(false)}>Show all locations</DropdownItem>\n          <DropdownItem onClick={openMapWithLocations(true)}>Show locations in current page</DropdownItem>\n        </DropdownMenu>\n      </Dropdown>\n      <MapModal toggle={closeMap} isOpen={mapIsOpened} title={modalTitle} locations={locationsToShow} />\n    </>\n  );\n};\n\nexport default OpenMapModalBtn;\n","import { countBy, filter, groupBy, pipe, prop } from 'ramda';\nimport { normalizeVisits } from '../services/VisitsParser';\nimport {\n  Visit,\n  OrphanVisit,\n  CreateVisit,\n  NormalizedVisit,\n  NormalizedOrphanVisit,\n  Stats,\n  OrphanVisitType,\n} from './index';\n\nexport const isOrphanVisit = (visit: Visit): visit is OrphanVisit => visit.hasOwnProperty('visitedUrl');\n\nexport const isNormalizedOrphanVisit = (visit: NormalizedVisit): visit is NormalizedOrphanVisit =>\n  visit.hasOwnProperty('visitedUrl');\n\nexport interface GroupedNewVisits {\n  orphanVisits: CreateVisit[];\n  regularVisits: CreateVisit[];\n}\n\nexport const groupNewVisitsByType = pipe(\n  groupBy((newVisit: CreateVisit) => isOrphanVisit(newVisit.visit) ? 'orphanVisits' : 'regularVisits'),\n  // @ts-expect-error Type declaration on groupBy is not correct. It can return undefined props\n  (result): GroupedNewVisits => ({ orphanVisits: [], regularVisits: [], ...result }),\n);\n\nexport type HighlightableProps<T extends NormalizedVisit> = T extends NormalizedOrphanVisit\n  ? ('referer' | 'country' | 'city' | 'visitedUrl')\n  : ('referer' | 'country' | 'city');\n\nexport const highlightedVisitsToStats = <T extends NormalizedVisit>(\n  highlightedVisits: T[],\n  property: HighlightableProps<T>,\n): Stats => countBy(prop(property) as any, highlightedVisits);\n\nexport const normalizeAndFilterVisits = (visits: Visit[], type: OrphanVisitType | undefined) => pipe(\n  normalizeVisits,\n  filter((normalizedVisit) => type === undefined || (normalizedVisit as NormalizedOrphanVisit).type === type),\n)(visits);\n","import { isNil, map } from 'ramda';\nimport { extractDomain, parseUserAgent } from '../../utils/helpers/visits';\nimport { hasValue } from '../../utils/utils';\nimport { CityStats, NormalizedVisit, Stats, Visit, VisitsStats } from '../types';\nimport { isNormalizedOrphanVisit, isOrphanVisit } from '../types/helpers';\n\nconst visitHasProperty = (visit: NormalizedVisit, propertyName: keyof NormalizedVisit) =>\n  !isNil(visit) && hasValue(visit[propertyName]);\n\nconst optionalNumericToNumber = (numeric: string | number | null | undefined): number => {\n  if (typeof numeric === 'number') {\n    return numeric;\n  }\n\n  return numeric ? parseFloat(numeric) : 0;\n};\n\nconst updateOsStatsForVisit = (osStats: Stats, { os }: NormalizedVisit) => {\n  osStats[os] = (osStats[os] || 0) + 1;\n};\n\nconst updateBrowsersStatsForVisit = (browsersStats: Stats, { browser }: NormalizedVisit) => {\n  browsersStats[browser] = (browsersStats[browser] || 0) + 1;\n};\n\nconst updateReferrersStatsForVisit = (referrersStats: Stats, { referer: domain }: NormalizedVisit) => {\n  referrersStats[domain] = (referrersStats[domain] || 0) + 1;\n};\n\nconst updateLocationsStatsForVisit = (propertyName: 'country' | 'city') => (stats: Stats, visit: NormalizedVisit) => {\n  const hasLocationProperty = visitHasProperty(visit, propertyName);\n  const value = hasLocationProperty ? visit[propertyName] : 'Unknown';\n\n  stats[value] = (stats[value] || 0) + 1;\n};\n\nconst updateCountriesStatsForVisit = updateLocationsStatsForVisit('country');\nconst updateCitiesStatsForVisit = updateLocationsStatsForVisit('city');\n\nconst updateCitiesForMapForVisit = (citiesForMapStats: Record<string, CityStats>, visit: NormalizedVisit) => {\n  if (!visitHasProperty(visit, 'city') || visit.city === 'Unknown') {\n    return;\n  }\n\n  const { city, latitude, longitude } = visit;\n  const currentCity = citiesForMapStats[city] || {\n    cityName: city,\n    count: 0,\n    latLong: [ optionalNumericToNumber(latitude), optionalNumericToNumber(longitude) ],\n  };\n\n  currentCity.count++;\n\n  citiesForMapStats[city] = currentCity;\n};\n\nconst updateVisitedUrlsForVisit = (visitedUrlsStats: Stats, visit: NormalizedVisit) => {\n  if (!isNormalizedOrphanVisit(visit)) {\n    return;\n  }\n\n  const { visitedUrl } = visit;\n\n  visitedUrlsStats[visitedUrl] = (visitedUrlsStats[visitedUrl] || 0) + 1;\n};\n\nexport const processStatsFromVisits = (visits: NormalizedVisit[]) => visits.reduce(\n  (stats: VisitsStats, visit: NormalizedVisit) => {\n    // We mutate the original object because it has a big performance impact when large data sets are processed\n    updateOsStatsForVisit(stats.os, visit);\n    updateBrowsersStatsForVisit(stats.browsers, visit);\n    updateReferrersStatsForVisit(stats.referrers, visit);\n    updateCountriesStatsForVisit(stats.countries, visit);\n    updateCitiesStatsForVisit(stats.cities, visit);\n    updateCitiesForMapForVisit(stats.citiesForMap, visit);\n    updateVisitedUrlsForVisit(stats.visitedUrls, visit);\n\n    return stats;\n  },\n  { os: {}, browsers: {}, referrers: {}, countries: {}, cities: {}, citiesForMap: {}, visitedUrls: {} },\n);\n\nexport const normalizeVisits = map((visit: Visit): NormalizedVisit => {\n  const { userAgent, date, referer, visitLocation } = visit;\n  const common = {\n    date,\n    ...parseUserAgent(userAgent),\n    referer: extractDomain(referer),\n    country: visitLocation?.countryName || 'Unknown', // eslint-disable-line @typescript-eslint/prefer-nullish-coalescing\n    city: visitLocation?.cityName || 'Unknown', // eslint-disable-line @typescript-eslint/prefer-nullish-coalescing\n    latitude: visitLocation?.latitude,\n    longitude: visitLocation?.longitude,\n  };\n\n  if (!isOrphanVisit(visit)) {\n    return common;\n  }\n\n  return { ...common, type: visit.type, visitedUrl: visit.visitedUrl };\n});\n\nexport interface VisitsParser {\n  processStatsFromVisits: (normalizedVisits: NormalizedVisit[]) => VisitsStats;\n  normalizeVisits: (visits: Visit[]) => NormalizedVisit[];\n}\n","import { DropdownItem } from 'reactstrap';\nimport { OrphanVisitType } from '../types';\nimport { DropdownBtn } from '../../utils/DropdownBtn';\n\ninterface OrphanVisitTypeDropdownProps {\n  onChange: (type: OrphanVisitType | undefined) => void;\n  selected?: OrphanVisitType | undefined;\n  className?: string;\n  text: string;\n}\n\nexport const OrphanVisitTypeDropdown = ({ onChange, selected, text, className }: OrphanVisitTypeDropdownProps) => (\n  <DropdownBtn text={text} dropdownClassName={className} className=\"mr-3\" right>\n    <DropdownItem active={selected === 'base_url'} onClick={() => onChange('base_url')}>\n      Base URL\n    </DropdownItem>\n    <DropdownItem active={selected === 'invalid_short_url'} onClick={() => onChange('invalid_short_url')}>\n      Invalid short URL\n    </DropdownItem>\n    <DropdownItem active={selected === 'regular_404'} onClick={() => onChange('regular_404')}>\n      Regular 404\n    </DropdownItem>\n    <DropdownItem divider />\n    <DropdownItem onClick={() => onChange(undefined)}><i>Clear selection</i></DropdownItem>\n  </DropdownBtn>\n);\n","import { useEffect } from 'react';\nimport { RouteComponentProps } from 'react-router';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { ShlinkVisitsParams } from '../api/types';\nimport { parseQuery } from '../utils/helpers/query';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { ShortUrlDetail } from '../short-urls/reducers/shortUrlDetail';\nimport { Settings } from '../settings/reducers/settings';\nimport { ShortUrlVisits as ShortUrlVisitsState } from './reducers/shortUrlVisits';\nimport ShortUrlVisitsHeader from './ShortUrlVisitsHeader';\nimport VisitsStats from './VisitsStats';\nimport { VisitsExporter } from './services/VisitsExporter';\nimport { NormalizedVisit } from './types';\n\nexport interface ShortUrlVisitsProps extends RouteComponentProps<{ shortCode: string }> {\n  getShortUrlVisits: (shortCode: string, query?: ShlinkVisitsParams) => void;\n  shortUrlVisits: ShortUrlVisitsState;\n  getShortUrlDetail: Function;\n  shortUrlDetail: ShortUrlDetail;\n  cancelGetShortUrlVisits: () => void;\n  settings: Settings;\n}\n\nconst ShortUrlVisits = ({ exportVisits }: VisitsExporter) => boundToMercureHub(({\n  history: { goBack },\n  match: { params, url },\n  location: { search },\n  shortUrlVisits,\n  shortUrlDetail,\n  getShortUrlVisits,\n  getShortUrlDetail,\n  cancelGetShortUrlVisits,\n  settings,\n}: ShortUrlVisitsProps) => {\n  const { shortCode } = params;\n  const { domain } = parseQuery<{ domain?: string }>(search);\n  const loadVisits = (params: Partial<ShlinkVisitsParams>) => getShortUrlVisits(shortCode, { ...params, domain });\n  const exportCsv = (visits: NormalizedVisit[]) => exportVisits(\n    `short-url_${shortUrlDetail.shortUrl?.shortUrl.replace(/https?:\\/\\//g, '')}_visits.csv`,\n    visits,\n  );\n\n  useEffect(() => {\n    getShortUrlDetail(shortCode, domain);\n  }, []);\n\n  return (\n    <VisitsStats\n      getVisits={loadVisits}\n      cancelGetVisits={cancelGetShortUrlVisits}\n      visitsInfo={shortUrlVisits}\n      baseUrl={url}\n      domain={domain}\n      settings={settings}\n      exportCsv={exportCsv}\n    >\n      <ShortUrlVisitsHeader shortUrlDetail={shortUrlDetail} shortUrlVisits={shortUrlVisits} goBack={goBack} />\n    </VisitsStats>\n  );\n}, ({ match }) => [ Topics.shortUrlVisits(match.params.shortCode) ]);\n\nexport default ShortUrlVisits;\n","import { flatten, prop, range, splitEvery } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { ShlinkPaginator, ShlinkVisits } from '../../api/types';\nimport { Visit, VisitsLoadFailedAction } from '../types';\nimport { parseApiError } from '../../api/utils';\n\nconst ITEMS_PER_PAGE = 5000;\nconst PARALLEL_REQUESTS_COUNT = 4;\nconst PARALLEL_STARTING_PAGE = 2;\n\nconst isLastPage = ({ currentPage, pagesCount }: ShlinkPaginator): boolean => currentPage >= pagesCount;\nconst calcProgress = (total: number, current: number): number => current * 100 / total;\n\ntype VisitsLoader = (page: number, itemsPerPage: number) => Promise<ShlinkVisits>;\ninterface ActionMap {\n  start: string;\n  large: string;\n  finish: string;\n  error: string;\n  progress: string;\n}\n\nexport const getVisitsWithLoader = async <T extends Action<string> & { visits: Visit[] }>(\n  visitsLoader: VisitsLoader,\n  extraFinishActionData: Partial<T>,\n  actionMap: ActionMap,\n  dispatch: Dispatch,\n  shouldCancel: () => boolean,\n) => {\n  dispatch({ type: actionMap.start });\n\n  const loadVisitsInParallel = async (pages: number[]): Promise<Visit[]> =>\n    Promise.all(pages.map(async (page) => visitsLoader(page, ITEMS_PER_PAGE).then(prop('data')))).then(flatten);\n\n  const loadPagesBlocks = async (pagesBlocks: number[][], index = 0): Promise<Visit[]> => {\n    if (shouldCancel()) {\n      return [];\n    }\n\n    const data = await loadVisitsInParallel(pagesBlocks[index]);\n\n    dispatch({ type: actionMap.progress, progress: calcProgress(pagesBlocks.length, index + PARALLEL_STARTING_PAGE) });\n\n    if (index < pagesBlocks.length - 1) {\n      return data.concat(await loadPagesBlocks(pagesBlocks, index + 1));\n    }\n\n    return data;\n  };\n\n  const loadVisits = async (page = 1) => {\n    const { pagination, data } = await visitsLoader(page, ITEMS_PER_PAGE);\n\n    // If pagination was not returned, then this is an old shlink version. Just return data\n    if (!pagination || isLastPage(pagination)) {\n      return data;\n    }\n\n    // If there are more pages, make requests in blocks of 4\n    const pagesRange = range(PARALLEL_STARTING_PAGE, pagination.pagesCount + 1);\n    const pagesBlocks = splitEvery(PARALLEL_REQUESTS_COUNT, pagesRange);\n\n    if (pagination.pagesCount - 1 > PARALLEL_REQUESTS_COUNT) {\n      dispatch({ type: actionMap.large });\n    }\n\n    return data.concat(await loadPagesBlocks(pagesBlocks));\n  };\n\n  try {\n    const visits = await loadVisits();\n\n    dispatch({ ...extraFinishActionData, visits, type: actionMap.finish });\n  } catch (e) {\n    dispatch<VisitsLoadFailedAction>({ type: actionMap.error, errorData: parseApiError(e) });\n  }\n};\n","import { Action, Dispatch } from 'redux';\nimport { shortUrlMatches } from '../../short-urls/helpers';\nimport { Visit, VisitsInfo, VisitsLoadFailedAction, VisitsLoadProgressChangedAction } from '../types';\nimport { ShortUrlIdentifier } from '../../short-urls/data';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { OptionalString } from '../../utils/utils';\nimport { getVisitsWithLoader } from './common';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_SHORT_URL_VISITS_START = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_START';\nexport const GET_SHORT_URL_VISITS_ERROR = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_ERROR';\nexport const GET_SHORT_URL_VISITS = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS';\nexport const GET_SHORT_URL_VISITS_LARGE = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_LARGE';\nexport const GET_SHORT_URL_VISITS_CANCEL = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_CANCEL';\nexport const GET_SHORT_URL_VISITS_PROGRESS_CHANGED = 'shlink/shortUrlVisits/GET_SHORT_URL_VISITS_PROGRESS_CHANGED';\n/* eslint-enable padding-line-between-statements */\n\nexport interface ShortUrlVisits extends VisitsInfo, ShortUrlIdentifier {}\n\ninterface ShortUrlVisitsAction extends Action<string>, ShortUrlIdentifier {\n  visits: Visit[];\n}\n\ntype ShortUrlVisitsCombinedAction = ShortUrlVisitsAction\n& VisitsLoadProgressChangedAction\n& CreateVisitsAction\n& VisitsLoadFailedAction;\n\nconst initialState: ShortUrlVisits = {\n  visits: [],\n  shortCode: '',\n  domain: undefined,\n  loading: false,\n  loadingLarge: false,\n  error: false,\n  cancelLoad: false,\n  progress: 0,\n};\n\nexport default buildReducer<ShortUrlVisits, ShortUrlVisitsCombinedAction>({\n  [GET_SHORT_URL_VISITS_START]: () => ({ ...initialState, loading: true }),\n  [GET_SHORT_URL_VISITS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [GET_SHORT_URL_VISITS]: (_, { visits, shortCode, domain }) => ({\n    ...initialState,\n    visits,\n    shortCode,\n    domain,\n  }),\n  [GET_SHORT_URL_VISITS_LARGE]: (state) => ({ ...state, loadingLarge: true }),\n  [GET_SHORT_URL_VISITS_CANCEL]: (state) => ({ ...state, cancelLoad: true }),\n  [GET_SHORT_URL_VISITS_PROGRESS_CHANGED]: (state, { progress }) => ({ ...state, progress }),\n  [CREATE_VISITS]: (state, { createdVisits }) => {\n    const { shortCode, domain, visits } = state;\n    const newVisits = createdVisits\n      .filter(({ shortUrl }) => shortUrl && shortUrlMatches(shortUrl, shortCode, domain))\n      .map(({ visit }) => visit);\n\n    return { ...state, visits: [ ...newVisits, ...visits ] };\n  },\n}, initialState);\n\nexport const getShortUrlVisits = (buildShlinkApiClient: ShlinkApiClientBuilder) => (\n  shortCode: string,\n  query: { domain?: OptionalString } = {},\n) => async (dispatch: Dispatch, getState: GetState) => {\n  const { getShortUrlVisits } = buildShlinkApiClient(getState);\n  const visitsLoader = async (page: number, itemsPerPage: number) => getShortUrlVisits(\n    shortCode,\n    { ...query, page, itemsPerPage },\n  );\n  const shouldCancel = () => getState().shortUrlVisits.cancelLoad;\n  const extraFinishActionData: Partial<ShortUrlVisitsAction> = { shortCode, domain: query.domain };\n  const actionMap = {\n    start: GET_SHORT_URL_VISITS_START,\n    large: GET_SHORT_URL_VISITS_LARGE,\n    finish: GET_SHORT_URL_VISITS,\n    error: GET_SHORT_URL_VISITS_ERROR,\n    progress: GET_SHORT_URL_VISITS_PROGRESS_CHANGED,\n  };\n\n  return getVisitsWithLoader(visitsLoader, extraFinishActionData, actionMap, dispatch, shouldCancel);\n};\n\nexport const cancelGetShortUrlVisits = buildActionCreator(GET_SHORT_URL_VISITS_CANCEL);\n","import Tag from '../tags/helpers/Tag';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport VisitsHeader from './VisitsHeader';\nimport { TagVisits } from './reducers/tagVisits';\nimport './ShortUrlVisitsHeader.scss';\n\ninterface TagVisitsHeaderProps {\n  tagVisits: TagVisits;\n  goBack: () => void;\n  colorGenerator: ColorGenerator;\n}\n\nconst TagVisitsHeader = ({ tagVisits, goBack, colorGenerator }: TagVisitsHeaderProps) => {\n  const { visits, tag } = tagVisits;\n\n  const visitsStatsTitle = (\n    <span className=\"d-flex align-items-center justify-content-center\">\n      <span className=\"mr-2\">Visits for</span>\n      <Tag text={tag} colorGenerator={colorGenerator} />\n    </span>\n  );\n\n  return <VisitsHeader title={visitsStatsTitle} goBack={goBack} visits={visits} />;\n};\n\nexport default TagVisitsHeader;\n","import { RouteComponentProps } from 'react-router';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport { ShlinkVisitsParams } from '../api/types';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { Settings } from '../settings/reducers/settings';\nimport { TagVisits as TagVisitsState } from './reducers/tagVisits';\nimport TagVisitsHeader from './TagVisitsHeader';\nimport VisitsStats from './VisitsStats';\nimport { VisitsExporter } from './services/VisitsExporter';\nimport { NormalizedVisit } from './types';\n\nexport interface TagVisitsProps extends RouteComponentProps<{ tag: string }> {\n  getTagVisits: (tag: string, query: any) => void;\n  tagVisits: TagVisitsState;\n  cancelGetTagVisits: () => void;\n  settings: Settings;\n}\n\nconst TagVisits = (colorGenerator: ColorGenerator, { exportVisits }: VisitsExporter) => boundToMercureHub(({\n  history: { goBack },\n  match: { params, url },\n  getTagVisits,\n  tagVisits,\n  cancelGetTagVisits,\n  settings,\n}: TagVisitsProps) => {\n  const { tag } = params;\n  const loadVisits = (params: ShlinkVisitsParams) => getTagVisits(tag, params);\n  const exportCsv = (visits: NormalizedVisit[]) => exportVisits(`tag_${tag}_visits.csv`, visits);\n\n  return (\n    <VisitsStats\n      getVisits={loadVisits}\n      cancelGetVisits={cancelGetTagVisits}\n      visitsInfo={tagVisits}\n      baseUrl={url}\n      settings={settings}\n      exportCsv={exportCsv}\n    >\n      <TagVisitsHeader tagVisits={tagVisits} goBack={goBack} colorGenerator={colorGenerator} />\n    </VisitsStats>\n  );\n}, () => [ Topics.visits() ]);\n\nexport default TagVisits;\n","import { Action, Dispatch } from 'redux';\nimport { Visit, VisitsInfo, VisitsLoadFailedAction, VisitsLoadProgressChangedAction } from '../types';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { getVisitsWithLoader } from './common';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_TAG_VISITS_START = 'shlink/tagVisits/GET_TAG_VISITS_START';\nexport const GET_TAG_VISITS_ERROR = 'shlink/tagVisits/GET_TAG_VISITS_ERROR';\nexport const GET_TAG_VISITS = 'shlink/tagVisits/GET_TAG_VISITS';\nexport const GET_TAG_VISITS_LARGE = 'shlink/tagVisits/GET_TAG_VISITS_LARGE';\nexport const GET_TAG_VISITS_CANCEL = 'shlink/tagVisits/GET_TAG_VISITS_CANCEL';\nexport const GET_TAG_VISITS_PROGRESS_CHANGED = 'shlink/tagVisits/GET_TAG_VISITS_PROGRESS_CHANGED';\n/* eslint-enable padding-line-between-statements */\n\nexport interface TagVisits extends VisitsInfo {\n  tag: string;\n}\n\nexport interface TagVisitsAction extends Action<string> {\n  visits: Visit[];\n  tag: string;\n}\n\ntype TagsVisitsCombinedAction = TagVisitsAction\n& VisitsLoadProgressChangedAction\n& CreateVisitsAction\n& VisitsLoadFailedAction;\n\nconst initialState: TagVisits = {\n  visits: [],\n  tag: '',\n  loading: false,\n  loadingLarge: false,\n  error: false,\n  cancelLoad: false,\n  progress: 0,\n};\n\nexport default buildReducer<TagVisits, TagsVisitsCombinedAction>({\n  [GET_TAG_VISITS_START]: () => ({ ...initialState, loading: true }),\n  [GET_TAG_VISITS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [GET_TAG_VISITS]: (_, { visits, tag }) => ({ ...initialState, visits, tag }),\n  [GET_TAG_VISITS_LARGE]: (state) => ({ ...state, loadingLarge: true }),\n  [GET_TAG_VISITS_CANCEL]: (state) => ({ ...state, cancelLoad: true }),\n  [GET_TAG_VISITS_PROGRESS_CHANGED]: (state, { progress }) => ({ ...state, progress }),\n  [CREATE_VISITS]: (state, { createdVisits }) => {\n    const { tag, visits } = state;\n    const newVisits = createdVisits\n      .filter(({ shortUrl }) => shortUrl?.tags.includes(tag))\n      .map(({ visit }) => visit);\n\n    return { ...state, visits: [ ...newVisits, ...visits ] };\n  },\n}, initialState);\n\nexport const getTagVisits = (buildShlinkApiClient: ShlinkApiClientBuilder) => (tag: string, query = {}) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  const { getTagVisits } = buildShlinkApiClient(getState);\n  const visitsLoader = async (page: number, itemsPerPage: number) => getTagVisits(\n    tag,\n    { ...query, page, itemsPerPage },\n  );\n  const shouldCancel = () => getState().tagVisits.cancelLoad;\n  const extraFinishActionData: Partial<TagVisitsAction> = { tag };\n  const actionMap = {\n    start: GET_TAG_VISITS_START,\n    large: GET_TAG_VISITS_LARGE,\n    finish: GET_TAG_VISITS,\n    error: GET_TAG_VISITS_ERROR,\n    progress: GET_TAG_VISITS_PROGRESS_CHANGED,\n  };\n\n  return getVisitsWithLoader(visitsLoader, extraFinishActionData, actionMap, dispatch, shouldCancel);\n};\n\nexport const cancelGetTagVisits = buildActionCreator(GET_TAG_VISITS_CANCEL);\n","import VisitsHeader from './VisitsHeader';\nimport { VisitsInfo } from './types';\nimport './ShortUrlVisitsHeader.scss';\n\ninterface OrphanVisitsHeaderProps {\n  orphanVisits: VisitsInfo;\n  goBack: () => void;\n}\n\nexport const OrphanVisitsHeader = ({ orphanVisits, goBack }: OrphanVisitsHeaderProps) => {\n  const { visits } = orphanVisits;\n\n  return <VisitsHeader title=\"Orphan visits\" goBack={goBack} visits={visits} />;\n};\n","import { RouteComponentProps } from 'react-router';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { ShlinkVisitsParams } from '../api/types';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { Settings } from '../settings/reducers/settings';\nimport VisitsStats from './VisitsStats';\nimport { OrphanVisitsHeader } from './OrphanVisitsHeader';\nimport { NormalizedVisit, VisitsInfo } from './types';\nimport { VisitsExporter } from './services/VisitsExporter';\n\nexport interface OrphanVisitsProps extends RouteComponentProps {\n  getOrphanVisits: (params: ShlinkVisitsParams) => void;\n  orphanVisits: VisitsInfo;\n  cancelGetOrphanVisits: () => void;\n  settings: Settings;\n}\n\nexport const OrphanVisits = ({ exportVisits }: VisitsExporter) => boundToMercureHub(({\n  history: { goBack },\n  match: { url },\n  getOrphanVisits,\n  orphanVisits,\n  cancelGetOrphanVisits,\n  settings,\n}: OrphanVisitsProps) => {\n  const exportCsv = (visits: NormalizedVisit[]) => exportVisits('orphan_visits.csv', visits);\n\n  return (\n    <VisitsStats\n      getVisits={getOrphanVisits}\n      cancelGetVisits={cancelGetOrphanVisits}\n      visitsInfo={orphanVisits}\n      baseUrl={url}\n      settings={settings}\n      exportCsv={exportCsv}\n      isOrphanVisits\n    >\n      <OrphanVisitsHeader orphanVisits={orphanVisits} goBack={goBack} />\n    </VisitsStats>\n  );\n}, () => [ Topics.orphanVisits() ]);\n","import { Action, Dispatch } from 'redux';\nimport { Visit, VisitsInfo, VisitsLoadFailedAction, VisitsLoadProgressChangedAction } from '../types';\nimport { buildActionCreator, buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { getVisitsWithLoader } from './common';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_ORPHAN_VISITS_START = 'shlink/orphanVisits/GET_ORPHAN_VISITS_START';\nexport const GET_ORPHAN_VISITS_ERROR = 'shlink/orphanVisits/GET_ORPHAN_VISITS_ERROR';\nexport const GET_ORPHAN_VISITS = 'shlink/orphanVisits/GET_ORPHAN_VISITS';\nexport const GET_ORPHAN_VISITS_LARGE = 'shlink/orphanVisits/GET_ORPHAN_VISITS_LARGE';\nexport const GET_ORPHAN_VISITS_CANCEL = 'shlink/orphanVisits/GET_ORPHAN_VISITS_CANCEL';\nexport const GET_ORPHAN_VISITS_PROGRESS_CHANGED = 'shlink/orphanVisits/GET_ORPHAN_VISITS_PROGRESS_CHANGED';\n/* eslint-enable padding-line-between-statements */\n\nexport interface OrphanVisitsAction extends Action<string> {\n  visits: Visit[];\n}\n\ntype OrphanVisitsCombinedAction = OrphanVisitsAction\n& VisitsLoadProgressChangedAction\n& CreateVisitsAction\n& VisitsLoadFailedAction;\n\nconst initialState: VisitsInfo = {\n  visits: [],\n  loading: false,\n  loadingLarge: false,\n  error: false,\n  cancelLoad: false,\n  progress: 0,\n};\n\nexport default buildReducer<VisitsInfo, OrphanVisitsCombinedAction>({\n  [GET_ORPHAN_VISITS_START]: () => ({ ...initialState, loading: true }),\n  [GET_ORPHAN_VISITS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [GET_ORPHAN_VISITS]: (_, { visits }) => ({ ...initialState, visits }),\n  [GET_ORPHAN_VISITS_LARGE]: (state) => ({ ...state, loadingLarge: true }),\n  [GET_ORPHAN_VISITS_CANCEL]: (state) => ({ ...state, cancelLoad: true }),\n  [GET_ORPHAN_VISITS_PROGRESS_CHANGED]: (state, { progress }) => ({ ...state, progress }),\n  [CREATE_VISITS]: (state, { createdVisits }) => {\n    const { visits } = state;\n    const newVisits = createdVisits.map(({ visit }) => visit);\n\n    return { ...state, visits: [ ...newVisits, ...visits ] };\n  },\n}, initialState);\n\nexport const getOrphanVisits = (buildShlinkApiClient: ShlinkApiClientBuilder) => (query = {}) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  const { getOrphanVisits } = buildShlinkApiClient(getState);\n  const visitsLoader = async (page: number, itemsPerPage: number) => getOrphanVisits({ ...query, page, itemsPerPage });\n  const shouldCancel = () => getState().orphanVisits.cancelLoad;\n  const actionMap = {\n    start: GET_ORPHAN_VISITS_START,\n    large: GET_ORPHAN_VISITS_LARGE,\n    finish: GET_ORPHAN_VISITS,\n    error: GET_ORPHAN_VISITS_ERROR,\n    progress: GET_ORPHAN_VISITS_PROGRESS_CHANGED,\n  };\n\n  return getVisitsWithLoader(visitsLoader, {}, actionMap, dispatch, shouldCancel);\n};\n\nexport const cancelGetOrphanVisits = buildActionCreator(GET_ORPHAN_VISITS_CANCEL);\n","import { Action, Dispatch } from 'redux';\nimport { ShlinkVisitsOverview } from '../../api/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { groupNewVisitsByType } from '../types/helpers';\nimport { CREATE_VISITS, CreateVisitsAction } from './visitCreation';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_OVERVIEW_START = 'shlink/visitsOverview/GET_OVERVIEW_START';\nexport const GET_OVERVIEW_ERROR = 'shlink/visitsOverview/GET_OVERVIEW_ERROR';\nexport const GET_OVERVIEW = 'shlink/visitsOverview/GET_OVERVIEW';\n/* eslint-enable padding-line-between-statements */\n\nexport interface VisitsOverview {\n  visitsCount: number;\n  orphanVisitsCount?: number;\n  loading: boolean;\n  error: boolean;\n}\n\nexport type GetVisitsOverviewAction = ShlinkVisitsOverview & Action<string>;\n\nconst initialState: VisitsOverview = {\n  visitsCount: 0,\n  orphanVisitsCount: 0,\n  loading: false,\n  error: false,\n};\n\nexport default buildReducer<VisitsOverview, GetVisitsOverviewAction & CreateVisitsAction>({\n  [GET_OVERVIEW_START]: () => ({ ...initialState, loading: true }),\n  [GET_OVERVIEW_ERROR]: () => ({ ...initialState, error: true }),\n  [GET_OVERVIEW]: (_, { visitsCount, orphanVisitsCount }) => ({ ...initialState, visitsCount, orphanVisitsCount }),\n  [CREATE_VISITS]: ({ visitsCount, orphanVisitsCount = 0, ...rest }, { createdVisits }) => {\n    const { regularVisits, orphanVisits } = groupNewVisitsByType(createdVisits);\n\n    return {\n      ...rest,\n      visitsCount: visitsCount + regularVisits.length,\n      orphanVisitsCount: orphanVisitsCount + orphanVisits.length,\n    };\n  },\n}, initialState);\n\nexport const loadVisitsOverview = (buildShlinkApiClient: ShlinkApiClientBuilder) => () => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: GET_OVERVIEW_START });\n\n  try {\n    const { getVisitsOverview } = buildShlinkApiClient(getState);\n    const result = await getVisitsOverview();\n\n    dispatch({ type: GET_OVERVIEW, ...result });\n  } catch (e) {\n    dispatch({ type: GET_OVERVIEW_ERROR });\n  }\n};\n","import { CsvJson } from 'csvjson';\nimport { NormalizedVisit } from '../types';\nimport { saveCsv } from '../../utils/helpers/csv';\n\nexport class VisitsExporter {\n  public constructor(\n    private readonly window: Window,\n    private readonly csvjson: CsvJson,\n  ) {}\n\n  public readonly exportVisits = (filename: string, visits: NormalizedVisit[]) => {\n    if (!visits.length) {\n      return;\n    }\n\n    const csv = this.csvjson.toCSV(visits, { headers: 'key' });\n\n    saveCsv(this.window, csv, filename);\n  };\n}\n","import Bottle from 'bottlejs';\nimport ShortUrlVisits from '../ShortUrlVisits';\nimport { cancelGetShortUrlVisits, getShortUrlVisits } from '../reducers/shortUrlVisits';\nimport MapModal from '../helpers/MapModal';\nimport { createNewVisits } from '../reducers/visitCreation';\nimport TagVisits from '../TagVisits';\nimport { cancelGetTagVisits, getTagVisits } from '../reducers/tagVisits';\nimport { OrphanVisits } from '../OrphanVisits';\nimport { cancelGetOrphanVisits, getOrphanVisits } from '../reducers/orphanVisits';\nimport { ConnectDecorator } from '../../container/types';\nimport { loadVisitsOverview } from '../reducers/visitsOverview';\nimport * as visitsParser from './VisitsParser';\nimport { VisitsExporter } from './VisitsExporter';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('MapModal', () => MapModal);\n\n  bottle.serviceFactory('ShortUrlVisits', ShortUrlVisits, 'VisitsExporter');\n  bottle.decorator('ShortUrlVisits', connect(\n    [ 'shortUrlVisits', 'shortUrlDetail', 'mercureInfo', 'settings' ],\n    [ 'getShortUrlVisits', 'getShortUrlDetail', 'cancelGetShortUrlVisits', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  bottle.serviceFactory('TagVisits', TagVisits, 'ColorGenerator', 'VisitsExporter');\n  bottle.decorator('TagVisits', connect(\n    [ 'tagVisits', 'mercureInfo', 'settings' ],\n    [ 'getTagVisits', 'cancelGetTagVisits', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  bottle.serviceFactory('OrphanVisits', OrphanVisits, 'VisitsExporter');\n  bottle.decorator('OrphanVisits', connect(\n    [ 'orphanVisits', 'mercureInfo', 'settings' ],\n    [ 'getOrphanVisits', 'cancelGetOrphanVisits', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  // Services\n  bottle.serviceFactory('VisitsParser', () => visitsParser);\n  bottle.service('VisitsExporter', VisitsExporter, 'window', 'csvjson');\n\n  // Actions\n  bottle.serviceFactory('getShortUrlVisits', getShortUrlVisits, 'buildShlinkApiClient');\n  bottle.serviceFactory('cancelGetShortUrlVisits', () => cancelGetShortUrlVisits);\n\n  bottle.serviceFactory('getTagVisits', getTagVisits, 'buildShlinkApiClient');\n  bottle.serviceFactory('cancelGetTagVisits', () => cancelGetTagVisits);\n\n  bottle.serviceFactory('getOrphanVisits', getOrphanVisits, 'buildShlinkApiClient');\n  bottle.serviceFactory('cancelGetOrphanVisits', () => cancelGetOrphanVisits);\n\n  bottle.serviceFactory('createNewVisits', () => createNewVisits);\n  bottle.serviceFactory('loadVisitsOverview', loadVisitsOverview, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import ColorGenerator from '../../utils/services/ColorGenerator';\nimport './TagBullet.scss';\n\ninterface TagBulletProps {\n  tag: string;\n  colorGenerator: ColorGenerator;\n}\n\nconst TagBullet = ({ tag, colorGenerator }: TagBulletProps) => (\n  <div\n    style={{ backgroundColor: colorGenerator.getColorForKey(tag) }}\n    className=\"tag-bullet\"\n  />\n);\n\nexport default TagBullet;\n","import { ChangeEvent, useEffect } from 'react';\nimport TagsInput, { RenderInputProps, RenderTagProps } from 'react-tagsinput';\nimport Autosuggest, { ChangeEvent as AutoChangeEvent, SuggestionSelectedEventData } from 'react-autosuggest';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { TagsList } from '../reducers/tagsList';\nimport TagBullet from './TagBullet';\nimport './TagsSelector.scss';\n\nexport interface TagsSelectorProps {\n  tags: string[];\n  onChange: (tags: string[]) => void;\n  placeholder?: string;\n}\n\ninterface TagsSelectorConnectProps extends TagsSelectorProps {\n  listTags: Function;\n  tagsList: TagsList;\n}\n\nconst noop = () => {};\n\nconst TagsSelector = (colorGenerator: ColorGenerator) => (\n  { tags, onChange, listTags, tagsList, placeholder = 'Add tags to the URL' }: TagsSelectorConnectProps,\n) => {\n  useEffect(() => {\n    listTags();\n  }, []);\n\n  const renderTag = (\n    { tag, key, disabled, onRemove, classNameRemove, getTagDisplayValue, ...other }: RenderTagProps<string>,\n  ) => (\n    <span key={key} style={{ backgroundColor: colorGenerator.getColorForKey(tag) }} {...other}>\n      {getTagDisplayValue(tag)}\n      {!disabled && <span className={classNameRemove} onClick={() => onRemove(key)} />}\n    </span>\n  );\n  const renderAutocompleteInput = (data: RenderInputProps<string>) => {\n    const { addTag, ...otherProps } = data;\n    const handleOnChange = (e: ChangeEvent<HTMLInputElement>, { method }: AutoChangeEvent) => {\n      method === 'enter' ? e.preventDefault() : otherProps.onChange(e);\n    };\n\n    const inputValue = otherProps.value?.trim().toLowerCase() ?? '';\n    const suggestions = tagsList.tags.filter((tag) => tag.startsWith(inputValue));\n\n    return (\n      <Autosuggest\n        ref={otherProps.ref}\n        suggestions={suggestions}\n        inputProps={{ ...otherProps, onChange: handleOnChange }}\n        highlightFirstSuggestion\n        shouldRenderSuggestions={(value: string) => value.trim().length > 0}\n        getSuggestionValue={(suggestion) => suggestion}\n        renderSuggestion={(suggestion) => (\n          <>\n            <TagBullet tag={suggestion} colorGenerator={colorGenerator} />\n            {suggestion}\n          </>\n        )}\n        onSuggestionsFetchRequested={noop}\n        onSuggestionsClearRequested={noop}\n        onSuggestionSelected={(_, { suggestion }: SuggestionSelectedEventData<string>) => {\n          addTag(suggestion);\n        }}\n      />\n    );\n  };\n\n  return (\n    <TagsInput\n      value={tags}\n      inputProps={{ placeholder }}\n      onlyUnique\n      renderTag={renderTag}\n      renderInput={renderAutocompleteInput}\n      // FIXME Workaround to be able to add tags on Android\n      addOnBlur\n      onChange={onChange}\n    />\n  );\n};\n\nexport default TagsSelector;\n","import { Card, CardHeader, CardBody, Button, Collapse } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faTrash as deleteIcon, faPencilAlt as editIcon, faLink, faEye } from '@fortawesome/free-solid-svg-icons';\nimport { FC } from 'react';\nimport { Link } from 'react-router-dom';\nimport { prettify } from '../utils/helpers/numbers';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { Versions } from '../utils/helpers/version';\nimport ColorGenerator from '../utils/services/ColorGenerator';\nimport { isServerWithId, SelectedServer } from '../servers/data';\nimport TagBullet from './helpers/TagBullet';\nimport { TagModalProps, TagStats } from './data';\nimport './TagCard.scss';\n\nexport interface TagCardProps {\n  tag: string;\n  tagStats?: TagStats;\n  selectedServer: SelectedServer;\n  displayed: boolean;\n  toggle: () => void;\n}\n\nconst TagCard = (\n  DeleteTagConfirmModal: FC<TagModalProps>,\n  EditTagModal: FC<TagModalProps>,\n  ForServerVersion: FC<Versions>,\n  colorGenerator: ColorGenerator,\n) => ({ tag, tagStats, selectedServer, displayed, toggle }: TagCardProps) => {\n  const [ isDeleteModalOpen, toggleDelete ] = useToggle();\n  const [ isEditModalOpen, toggleEdit ] = useToggle();\n\n  const serverId = isServerWithId(selectedServer) ? selectedServer.id : '';\n  const shortUrlsLink = `/server/${serverId}/list-short-urls/1?tag=${tag}`;\n\n  return (\n    <Card className=\"tag-card\">\n      <CardHeader className=\"tag-card__header\">\n        <Button color=\"link\" size=\"sm\" className=\"tag-card__btn tag-card__btn--last\" onClick={toggleDelete}>\n          <FontAwesomeIcon icon={deleteIcon} />\n        </Button>\n        <Button color=\"link\" size=\"sm\" className=\"tag-card__btn\" onClick={toggleEdit}>\n          <FontAwesomeIcon icon={editIcon} />\n        </Button>\n        <h5 className=\"tag-card__tag-title text-ellipsis\">\n          <TagBullet tag={tag} colorGenerator={colorGenerator} />\n          <ForServerVersion minVersion=\"2.2.0\">\n            <span className=\"tag-card__tag-name\" onClick={toggle}>{tag}</span>\n          </ForServerVersion>\n          <ForServerVersion maxVersion=\"2.1.*\">\n            <Link to={shortUrlsLink}>{tag}</Link>\n          </ForServerVersion>\n        </h5>\n      </CardHeader>\n\n      {tagStats && (\n        <Collapse isOpen={displayed}>\n          <CardBody className=\"tag-card__body\">\n            <Link\n              to={shortUrlsLink}\n              className=\"btn btn-outline-secondary btn-block d-flex justify-content-between align-items-center mb-1\"\n            >\n              <span className=\"text-ellipsis\"><FontAwesomeIcon icon={faLink} className=\"mr-2\" />Short URLs</span>\n              <b>{prettify(tagStats.shortUrlsCount)}</b>\n            </Link>\n            <Link\n              to={`/server/${serverId}/tag/${tag}/visits`}\n              className=\"btn btn-outline-secondary btn-block d-flex justify-content-between align-items-center\"\n            >\n              <span className=\"text-ellipsis\"><FontAwesomeIcon icon={faEye} className=\"mr-2\" />Visits</span>\n              <b>{prettify(tagStats.visitsCount)}</b>\n            </Link>\n          </CardBody>\n        </Collapse>\n      )}\n\n      <DeleteTagConfirmModal tag={tag} toggle={toggleDelete} isOpen={isDeleteModalOpen} />\n      <EditTagModal tag={tag} toggle={toggleEdit} isOpen={isEditModalOpen} />\n    </Card>\n  );\n};\n\nexport default TagCard;\n","import { Modal, ModalBody, ModalFooter, ModalHeader } from 'reactstrap';\nimport { TagDeletion } from '../reducers/tagDelete';\nimport { TagModalProps } from '../data';\nimport { Result } from '../../utils/Result';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\n\ninterface DeleteTagConfirmModalProps extends TagModalProps {\n  deleteTag: (tag: string) => Promise<void>;\n  tagDeleted: (tag: string) => void;\n  tagDelete: TagDeletion;\n}\n\nconst DeleteTagConfirmModal = (\n  { tag, toggle, isOpen, deleteTag, tagDelete, tagDeleted }: DeleteTagConfirmModalProps,\n) => {\n  const { deleting, error, errorData } = tagDelete;\n  const doDelete = async () => {\n    await deleteTag(tag);\n    tagDeleted(tag);\n    toggle();\n  };\n\n  return (\n    <Modal toggle={toggle} isOpen={isOpen} centered>\n      <ModalHeader toggle={toggle}>\n        <span className=\"text-danger\">Delete tag</span>\n      </ModalHeader>\n      <ModalBody>\n        Are you sure you want to delete tag <b>{tag}</b>?\n        {error && (\n          <Result type=\"error\" small className=\"mt-2\">\n            <ShlinkApiError errorData={errorData} fallbackMessage=\"Something went wrong while deleting the tag :(\" />\n          </Result>\n        )}\n      </ModalBody>\n      <ModalFooter>\n        <button className=\"btn btn-link\" onClick={toggle}>Cancel</button>\n        <button className=\"btn btn-danger\" disabled={deleting} onClick={doDelete}>\n          {deleting ? 'Deleting tag...' : 'Delete tag'}\n        </button>\n      </ModalFooter>\n    </Modal>\n  );\n};\n\nexport default DeleteTagConfirmModal;\n","import { useState } from 'react';\nimport { Modal, ModalBody, ModalFooter, ModalHeader, Popover } from 'reactstrap';\nimport { ChromePicker } from 'react-color';\nimport { faPalette as colorIcon } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { useToggle } from '../../utils/helpers/hooks';\nimport { handleEventPreventingDefault } from '../../utils/utils';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { TagModalProps } from '../data';\nimport { TagEdition } from '../reducers/tagEdit';\nimport { Result } from '../../utils/Result';\nimport { ShlinkApiError } from '../../api/ShlinkApiError';\nimport './EditTagModal.scss';\n\ninterface EditTagModalProps extends TagModalProps {\n  tagEdit: TagEdition;\n  editTag: (oldName: string, newName: string, color: string) => Promise<void>;\n  tagEdited: (oldName: string, newName: string, color: string) => void;\n}\n\nconst EditTagModal = ({ getColorForKey }: ColorGenerator) => (\n  { tag, editTag, toggle, tagEdited, isOpen, tagEdit }: EditTagModalProps,\n) => {\n  const [ newTagName, setNewTagName ] = useState(tag);\n  const [ color, setColor ] = useState(getColorForKey(tag));\n  const [ showColorPicker, toggleColorPicker, , hideColorPicker ] = useToggle();\n  const { editing, error, errorData } = tagEdit;\n  const saveTag = handleEventPreventingDefault(async () => editTag(tag, newTagName, color)\n    .then(() => tagEdited(tag, newTagName, color))\n    .then(toggle)\n    .catch(() => {}));\n\n  return (\n    <Modal isOpen={isOpen} toggle={toggle} centered onClosed={hideColorPicker}>\n      <form onSubmit={saveTag}>\n        <ModalHeader toggle={toggle}>Edit tag</ModalHeader>\n        <ModalBody>\n          <div className=\"input-group\">\n            <div className=\"input-group-prepend\" id=\"colorPickerBtn\" onClick={toggleColorPicker}>\n              <div\n                className=\"input-group-text edit-tag-modal__color-picker-toggle\"\n                style={{ backgroundColor: color, borderColor: color }}\n              >\n                <FontAwesomeIcon icon={colorIcon} className=\"edit-tag-modal__color-icon\" />\n              </div>\n            </div>\n            <Popover isOpen={showColorPicker} toggle={toggleColorPicker} target=\"colorPickerBtn\" placement=\"right\">\n              <ChromePicker color={color} disableAlpha onChange={({ hex }) => setColor(hex)} />\n            </Popover>\n            <input\n              type=\"text\"\n              value={newTagName}\n              placeholder=\"Tag\"\n              required\n              className=\"form-control\"\n              onChange={(e) => setNewTagName(e.target.value)}\n            />\n          </div>\n\n          {error && (\n            <Result type=\"error\" small className=\"mt-2\">\n              <ShlinkApiError errorData={errorData} fallbackMessage=\"Something went wrong while editing the tag :(\" />\n            </Result>\n          )}\n        </ModalBody>\n        <ModalFooter>\n          <button type=\"button\" className=\"btn btn-link\" onClick={toggle}>Cancel</button>\n          <button type=\"submit\" className=\"btn btn-primary\" disabled={editing}>{editing ? 'Saving...' : 'Save'}</button>\n        </ModalFooter>\n      </form>\n    </Modal>\n  );\n};\n\nexport default EditTagModal;\n","import { FC, useEffect, useState } from 'react';\nimport { splitEvery } from 'ramda';\nimport Message from '../utils/Message';\nimport SearchField from '../utils/SearchField';\nimport { SelectedServer } from '../servers/data';\nimport { boundToMercureHub } from '../mercure/helpers/boundToMercureHub';\nimport { Result } from '../utils/Result';\nimport { ShlinkApiError } from '../api/ShlinkApiError';\nimport { Topics } from '../mercure/helpers/Topics';\nimport { TagsList as TagsListState } from './reducers/tagsList';\nimport { TagCardProps } from './TagCard';\n\nconst { ceil } = Math;\nconst TAGS_GROUPS_AMOUNT = 4;\n\nexport interface TagsListProps {\n  filterTags: (searchTerm: string) => void;\n  forceListTags: Function;\n  tagsList: TagsListState;\n  selectedServer: SelectedServer;\n}\n\nconst TagsList = (TagCard: FC<TagCardProps>) => boundToMercureHub((\n  { filterTags, forceListTags, tagsList, selectedServer }: TagsListProps,\n) => {\n  const [ displayedTag, setDisplayedTag ] = useState<string | undefined>();\n\n  useEffect(() => {\n    forceListTags();\n  }, []);\n\n  const renderContent = () => {\n    if (tagsList.loading) {\n      return <Message loading />;\n    }\n\n    if (tagsList.error) {\n      return (\n        <Result type=\"error\">\n          <ShlinkApiError errorData={tagsList.errorData} fallbackMessage=\"Error loading tags :(\" />\n        </Result>\n      );\n    }\n\n    const tagsCount = tagsList.filteredTags.length;\n\n    if (tagsCount < 1) {\n      return <Message>No tags found</Message>;\n    }\n\n    const tagsGroups = splitEvery(ceil(tagsCount / TAGS_GROUPS_AMOUNT), tagsList.filteredTags);\n\n    return (\n      <div className=\"row\">\n        {tagsGroups.map((group, index) => (\n          <div key={index} className=\"col-md-6 col-xl-3\">\n            {group.map((tag) => (\n              <TagCard\n                key={tag}\n                tag={tag}\n                tagStats={tagsList.stats[tag]}\n                selectedServer={selectedServer}\n                displayed={displayedTag === tag}\n                toggle={() => setDisplayedTag(displayedTag !== tag ? tag : undefined)}\n              />\n            ))}\n          </div>\n        ))}\n      </div>\n    );\n  };\n\n  return (\n    <>\n      {!tagsList.loading && <SearchField className=\"mb-3\" placeholder=\"Search tags...\" onChange={filterTags} />}\n      {renderContent()}\n    </>\n  );\n}, () => [ Topics.visits() ]);\n\nexport default TagsList;\n","import { Action, Dispatch } from 'redux';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\n\n/* eslint-disable padding-line-between-statements */\nexport const DELETE_TAG_START = 'shlink/deleteTag/DELETE_TAG_START';\nexport const DELETE_TAG_ERROR = 'shlink/deleteTag/DELETE_TAG_ERROR';\nexport const DELETE_TAG = 'shlink/deleteTag/DELETE_TAG';\nexport const TAG_DELETED = 'shlink/deleteTag/TAG_DELETED';\n/* eslint-enable padding-line-between-statements */\n\nexport interface TagDeletion {\n  deleting: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface DeleteTagAction extends Action<string> {\n  tag: string;\n}\n\nexport interface DeleteTagFailedAction extends Action<string> {\n  errorData?: ProblemDetailsError;\n}\n\nconst initialState: TagDeletion = {\n  deleting: false,\n  error: false,\n};\n\nexport default buildReducer<TagDeletion, DeleteTagFailedAction>({\n  [DELETE_TAG_START]: () => ({ deleting: true, error: false }),\n  [DELETE_TAG_ERROR]: (_, { errorData }) => ({ deleting: false, error: true, errorData }),\n  [DELETE_TAG]: () => ({ deleting: false, error: false }),\n}, initialState);\n\nexport const deleteTag = (buildShlinkApiClient: ShlinkApiClientBuilder) => (tag: string) => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: DELETE_TAG_START });\n  const { deleteTags } = buildShlinkApiClient(getState);\n\n  try {\n    await deleteTags([ tag ]);\n    dispatch({ type: DELETE_TAG });\n  } catch (e) {\n    dispatch<DeleteTagFailedAction>({ type: DELETE_TAG_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const tagDeleted = (tag: string): DeleteTagAction => ({ type: TAG_DELETED, tag });\n","import { pick } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { GetState } from '../../container/types';\nimport ColorGenerator from '../../utils/services/ColorGenerator';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { ProblemDetailsError } from '../../api/types';\nimport { parseApiError } from '../../api/utils';\n\n/* eslint-disable padding-line-between-statements */\nexport const EDIT_TAG_START = 'shlink/editTag/EDIT_TAG_START';\nexport const EDIT_TAG_ERROR = 'shlink/editTag/EDIT_TAG_ERROR';\nexport const EDIT_TAG = 'shlink/editTag/EDIT_TAG';\n/* eslint-enable padding-line-between-statements */\n\nexport const TAG_EDITED = 'shlink/editTag/TAG_EDITED';\n\nexport interface TagEdition {\n  oldName: string;\n  newName: string;\n  editing: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\nexport interface EditTagAction extends Action<string> {\n  oldName: string;\n  newName: string;\n  color: string;\n}\n\nexport interface EditTagFailedAction extends Action<string> {\n  errorData?: ProblemDetailsError;\n}\n\nconst initialState: TagEdition = {\n  oldName: '',\n  newName: '',\n  editing: false,\n  error: false,\n};\n\nexport default buildReducer<TagEdition, EditTagAction & EditTagFailedAction>({\n  [EDIT_TAG_START]: (state) => ({ ...state, editing: true, error: false }),\n  [EDIT_TAG_ERROR]: (state, { errorData }) => ({ ...state, editing: false, error: true, errorData }),\n  [EDIT_TAG]: (_, action) => ({\n    ...pick([ 'oldName', 'newName' ], action),\n    editing: false,\n    error: false,\n  }),\n}, initialState);\n\nexport const editTag = (buildShlinkApiClient: ShlinkApiClientBuilder, colorGenerator: ColorGenerator) => (\n  oldName: string,\n  newName: string,\n  color: string,\n) => async (dispatch: Dispatch, getState: GetState) => {\n  dispatch({ type: EDIT_TAG_START });\n  const { editTag } = buildShlinkApiClient(getState);\n\n  try {\n    await editTag(oldName, newName);\n    colorGenerator.setColorForKey(newName, color);\n    dispatch({ type: EDIT_TAG, oldName, newName });\n  } catch (e) {\n    dispatch<EditTagFailedAction>({ type: EDIT_TAG_ERROR, errorData: parseApiError(e) });\n\n    throw e;\n  }\n};\n\nexport const tagEdited = (oldName: string, newName: string, color: string): EditTagAction => ({\n  type: TAG_EDITED,\n  oldName,\n  newName,\n  color,\n});\n","import { isEmpty, reject } from 'ramda';\nimport { Action, Dispatch } from 'redux';\nimport { CREATE_VISITS, CreateVisitsAction } from '../../visits/reducers/visitCreation';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ProblemDetailsError, ShlinkTags } from '../../api/types';\nimport { GetState } from '../../container/types';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { CreateVisit, Stats } from '../../visits/types';\nimport { parseApiError } from '../../api/utils';\nimport { TagStats } from '../data';\nimport { DeleteTagAction, TAG_DELETED } from './tagDelete';\nimport { EditTagAction, TAG_EDITED } from './tagEdit';\n\n/* eslint-disable padding-line-between-statements */\nexport const LIST_TAGS_START = 'shlink/tagsList/LIST_TAGS_START';\nexport const LIST_TAGS_ERROR = 'shlink/tagsList/LIST_TAGS_ERROR';\nexport const LIST_TAGS = 'shlink/tagsList/LIST_TAGS';\nexport const FILTER_TAGS = 'shlink/tagsList/FILTER_TAGS';\n/* eslint-enable padding-line-between-statements */\n\ntype TagsStatsMap = Record<string, TagStats>;\n\nexport interface TagsList {\n  tags: string[];\n  filteredTags: string[];\n  stats: TagsStatsMap;\n  loading: boolean;\n  error: boolean;\n  errorData?: ProblemDetailsError;\n}\n\ninterface ListTagsAction extends Action<string> {\n  tags: string[];\n  stats: TagsStatsMap;\n}\n\ninterface ListTagsFailedAction extends Action<string> {\n  errorData?: ProblemDetailsError;\n}\n\ninterface FilterTagsAction extends Action<string> {\n  searchTerm: string;\n}\n\ntype ListTagsCombinedAction = ListTagsAction\n& DeleteTagAction\n& CreateVisitsAction\n& EditTagAction\n& FilterTagsAction\n& ListTagsFailedAction;\n\nconst initialState = {\n  tags: [],\n  filteredTags: [],\n  stats: {},\n  loading: false,\n  error: false,\n};\n\ntype TagIncrease = [string, number];\n\nconst renameTag = (oldName: string, newName: string) => (tag: string) => tag === oldName ? newName : tag;\nconst rejectTag = (tags: string[], tagToReject: string) => reject((tag) => tag === tagToReject, tags);\nconst increaseVisitsForTags = (tags: TagIncrease[], stats: TagsStatsMap) => tags.reduce((stats, [ tag, increase ]) => {\n  if (!stats[tag]) {\n    return stats;\n  }\n\n  const tagStats = stats[tag];\n\n  tagStats.visitsCount = tagStats.visitsCount + increase;\n  stats[tag] = tagStats;\n\n  return stats;\n}, { ...stats });\nconst calculateVisitsPerTag = (createdVisits: CreateVisit[]): TagIncrease[] => Object.entries(\n  createdVisits.reduce<Stats>((acc, { shortUrl }) => {\n    shortUrl?.tags.forEach((tag) => {\n      acc[tag] = (acc[tag] || 0) + 1;\n    });\n\n    return acc;\n  }, {}),\n);\n\nexport default buildReducer<TagsList, ListTagsCombinedAction>({\n  [LIST_TAGS_START]: () => ({ ...initialState, loading: true }),\n  [LIST_TAGS_ERROR]: (_, { errorData }) => ({ ...initialState, error: true, errorData }),\n  [LIST_TAGS]: (_, { tags, stats }) => ({ ...initialState, stats, tags, filteredTags: tags }),\n  [TAG_DELETED]: (state, { tag }) => ({\n    ...state,\n    tags: rejectTag(state.tags, tag),\n    filteredTags: rejectTag(state.filteredTags, tag),\n  }),\n  [TAG_EDITED]: (state, { oldName, newName }) => ({\n    ...state,\n    tags: state.tags.map(renameTag(oldName, newName)).sort(),\n    filteredTags: state.filteredTags.map(renameTag(oldName, newName)).sort(),\n  }),\n  [FILTER_TAGS]: (state, { searchTerm }) => ({\n    ...state,\n    filteredTags: state.tags.filter((tag) => tag.toLowerCase().match(searchTerm)),\n  }),\n  [CREATE_VISITS]: (state, { createdVisits }) => ({\n    ...state,\n    stats: increaseVisitsForTags(calculateVisitsPerTag(createdVisits), state.stats),\n  }),\n}, initialState);\n\nexport const listTags = (buildShlinkApiClient: ShlinkApiClientBuilder, force = true) => () => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  const { tagsList } = getState();\n\n  if (!force && (tagsList.loading || !isEmpty(tagsList.tags))) {\n    return;\n  }\n\n  dispatch({ type: LIST_TAGS_START });\n\n  try {\n    const { listTags } = buildShlinkApiClient(getState);\n    const { tags, stats = [] }: ShlinkTags = await listTags();\n    const processedStats = stats.reduce<TagsStatsMap>((acc, { tag, shortUrlsCount, visitsCount }) => {\n      acc[tag] = { shortUrlsCount, visitsCount };\n\n      return acc;\n    }, {});\n\n    dispatch<ListTagsAction>({ tags, stats: processedStats, type: LIST_TAGS });\n  } catch (e) {\n    dispatch<ListTagsFailedAction>({ type: LIST_TAGS_ERROR, errorData: parseApiError(e) });\n  }\n};\n\nexport const filterTags = (searchTerm: string): FilterTagsAction => ({ type: FILTER_TAGS, searchTerm });\n","import Bottle, { IContainer } from 'bottlejs';\nimport TagsSelector from '../helpers/TagsSelector';\nimport TagCard from '../TagCard';\nimport DeleteTagConfirmModal from '../helpers/DeleteTagConfirmModal';\nimport EditTagModal from '../helpers/EditTagModal';\nimport TagsList from '../TagsList';\nimport { filterTags, listTags } from '../reducers/tagsList';\nimport { deleteTag, tagDeleted } from '../reducers/tagDelete';\nimport { editTag, tagEdited } from '../reducers/tagEdit';\nimport { ConnectDecorator } from '../../container/types';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('TagsSelector', TagsSelector, 'ColorGenerator');\n  bottle.decorator('TagsSelector', connect([ 'tagsList' ], [ 'listTags' ]));\n\n  bottle.serviceFactory(\n    'TagCard',\n    TagCard,\n    'DeleteTagConfirmModal',\n    'EditTagModal',\n    'ForServerVersion',\n    'ColorGenerator',\n  );\n\n  bottle.serviceFactory('DeleteTagConfirmModal', () => DeleteTagConfirmModal);\n  bottle.decorator('DeleteTagConfirmModal', connect([ 'tagDelete' ], [ 'deleteTag', 'tagDeleted' ]));\n\n  bottle.serviceFactory('EditTagModal', EditTagModal, 'ColorGenerator');\n  bottle.decorator('EditTagModal', connect([ 'tagEdit' ], [ 'editTag', 'tagEdited' ]));\n\n  bottle.serviceFactory('TagsList', TagsList, 'TagCard');\n  bottle.decorator('TagsList', connect(\n    [ 'tagsList', 'selectedServer', 'mercureInfo' ],\n    [ 'forceListTags', 'filterTags', 'createNewVisits', 'loadMercureInfo' ],\n  ));\n\n  // Actions\n  const listTagsActionFactory = (force: boolean) =>\n    ({ buildShlinkApiClient }: IContainer) => listTags(buildShlinkApiClient, force);\n\n  bottle.factory('listTags', listTagsActionFactory(false));\n  bottle.factory('forceListTags', listTagsActionFactory(true));\n  bottle.serviceFactory('filterTags', () => filterTags);\n  bottle.serviceFactory('tagDeleted', () => tagDeleted);\n  bottle.serviceFactory('tagEdited', () => tagEdited);\n\n  bottle.serviceFactory('deleteTag', deleteTag, 'buildShlinkApiClient');\n  bottle.serviceFactory('editTag', editTag, 'buildShlinkApiClient', 'ColorGenerator');\n};\n\nexport default provideServices;\n","import { Action, Dispatch } from 'redux';\nimport { ShlinkMercureInfo } from '../../api/types';\nimport { GetState } from '../../container/types';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\n\n/* eslint-disable padding-line-between-statements */\nexport const GET_MERCURE_INFO_START = 'shlink/mercure/GET_MERCURE_INFO_START';\nexport const GET_MERCURE_INFO_ERROR = 'shlink/mercure/GET_MERCURE_INFO_ERROR';\nexport const GET_MERCURE_INFO = 'shlink/mercure/GET_MERCURE_INFO';\n/* eslint-enable padding-line-between-statements */\n\nexport interface MercureInfo {\n  token?: string;\n  mercureHubUrl?: string;\n  interval?: number;\n  loading: boolean;\n  error: boolean;\n}\n\nexport type GetMercureInfoAction = Action<string> & ShlinkMercureInfo & { interval?: number };\n\nconst initialState: MercureInfo = {\n  loading: true,\n  error: false,\n};\n\nexport default buildReducer<MercureInfo, GetMercureInfoAction>({\n  [GET_MERCURE_INFO_START]: (state) => ({ ...state, loading: true, error: false }),\n  [GET_MERCURE_INFO_ERROR]: (state) => ({ ...state, loading: false, error: true }),\n  [GET_MERCURE_INFO]: (_, action) => ({ ...action, loading: false, error: false }),\n}, initialState);\n\nexport const loadMercureInfo = (buildShlinkApiClient: ShlinkApiClientBuilder) =>\n  () => async (dispatch: Dispatch, getState: GetState) => {\n    dispatch({ type: GET_MERCURE_INFO_START });\n\n    const { settings } = getState();\n    const { mercureInfo } = buildShlinkApiClient(getState);\n\n    if (!settings.realTimeUpdates.enabled) {\n      dispatch({ type: GET_MERCURE_INFO_ERROR });\n\n      return;\n    }\n\n    try {\n      const info = await mercureInfo();\n\n      dispatch<GetMercureInfoAction>({ type: GET_MERCURE_INFO, interval: settings.realTimeUpdates.interval, ...info });\n    } catch (e) {\n      dispatch({ type: GET_MERCURE_INFO_ERROR });\n    }\n  };\n","import Bottle from 'bottlejs';\nimport { loadMercureInfo } from '../reducers/mercureInfo';\n\nconst provideServices = (bottle: Bottle) => {\n  // Actions\n  bottle.serviceFactory('loadMercureInfo', loadMercureInfo, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import { FormGroup, Input } from 'reactstrap';\nimport classNames from 'classnames';\nimport ToggleSwitch from '../utils/ToggleSwitch';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { Settings } from './reducers/settings';\n\ninterface RealTimeUpdatesProps {\n  settings: Settings;\n  toggleRealTimeUpdates: (enabled: boolean) => void;\n  setRealTimeUpdatesInterval: (interval: number) => void;\n}\n\nconst intervalValue = (interval?: number) => !interval ? '' : `${interval}`;\n\nconst RealTimeUpdates = (\n  { settings: { realTimeUpdates }, toggleRealTimeUpdates, setRealTimeUpdatesInterval }: RealTimeUpdatesProps,\n) => (\n  <SimpleCard title=\"Real-time updates\" className=\"h-100\">\n    <FormGroup>\n      <ToggleSwitch checked={realTimeUpdates.enabled} onChange={toggleRealTimeUpdates}>\n        Enable or disable real-time updates, when using Shlink v2.2.0 or newer.\n        <small className=\"form-text text-muted\">\n          Real-time updates are currently being <b>{realTimeUpdates.enabled ? 'processed' : 'ignored'}</b>.\n        </small>\n      </ToggleSwitch>\n    </FormGroup>\n    <FormGroup className=\"mb-0\">\n      <label className={classNames({ 'text-muted': !realTimeUpdates.enabled })}>\n        Real-time updates frequency (in minutes):\n      </label>\n      <Input\n        type=\"number\"\n        min={0}\n        placeholder=\"Immediate\"\n        disabled={!realTimeUpdates.enabled}\n        value={intervalValue(realTimeUpdates.interval)}\n        onChange={(e) => setRealTimeUpdatesInterval(Number(e.target.value))}\n      />\n      {realTimeUpdates.enabled && (\n        <small className=\"form-text text-muted\">\n          {realTimeUpdates.interval !== undefined && realTimeUpdates.interval > 0 && (\n            <span>\n              Updates will be reflected in the UI every <b>{realTimeUpdates.interval}</b> minute{realTimeUpdates.interval > 1 && 's'}.\n            </span>\n          )}\n          {!realTimeUpdates.interval && 'Updates will be reflected in the UI as soon as they happen.'}\n        </small>\n      )}\n    </FormGroup>\n  </SimpleCard>\n);\n\nexport default RealTimeUpdates;\n","import { FC, ReactNode } from 'react';\nimport { Row } from 'reactstrap';\nimport NoMenuLayout from '../common/NoMenuLayout';\n\nconst SettingsSections: FC<{ items: ReactNode[][] }> = ({ items }) => (\n  <>\n    {items.map((child, index) => (\n      <Row key={index}>\n        {child.map((subChild, subIndex) => (\n          <div key={subIndex} className=\"col-lg-6 mb-3\">\n            {subChild}\n          </div>\n        ))}\n      </Row>\n    ))}\n  </>\n);\n\nconst Settings = (RealTimeUpdates: FC, ShortUrlCreation: FC, UserInterface: FC, Visits: FC) => () => (\n  <NoMenuLayout>\n    <SettingsSections\n      items={[\n        [ <UserInterface />, <ShortUrlCreation /> ], // eslint-disable-line react/jsx-key\n        [ <Visits />, <RealTimeUpdates /> ], // eslint-disable-line react/jsx-key\n      ]}\n    />\n  </NoMenuLayout>\n);\n\nexport default Settings;\n","import { Action } from 'redux';\nimport { dissoc, mergeDeepRight } from 'ramda';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { RecursivePartial } from '../../utils/utils';\nimport { Theme } from '../../utils/theme';\nimport { DateInterval } from '../../utils/dates/types';\n\nexport const SET_SETTINGS = 'shlink/realTimeUpdates/SET_SETTINGS';\n\n/**\n * Important! When adding new props in the main Settings interface or any of the nested props, they have to be set as\n * optional, as old instances of the app will load partial objects from local storage until it is saved again.\n */\n\ninterface RealTimeUpdatesSettings {\n  enabled: boolean;\n  interval?: number;\n}\n\nexport interface ShortUrlCreationSettings {\n  validateUrls: boolean;\n}\n\nexport interface UiSettings {\n  theme: Theme;\n}\n\nexport interface VisitsSettings {\n  defaultInterval: DateInterval;\n}\n\nexport interface Settings {\n  realTimeUpdates: RealTimeUpdatesSettings;\n  shortUrlCreation?: ShortUrlCreationSettings;\n  ui?: UiSettings;\n  visits?: VisitsSettings;\n}\n\nconst initialState: Settings = {\n  realTimeUpdates: {\n    enabled: true,\n  },\n  shortUrlCreation: {\n    validateUrls: false,\n  },\n  ui: {\n    theme: 'light',\n  },\n  visits: {\n    defaultInterval: 'last30Days',\n  },\n};\n\ntype SettingsAction = Action & Settings;\n\ntype PartialSettingsAction = Action & RecursivePartial<Settings>;\n\nexport default buildReducer<Settings, SettingsAction>({\n  [SET_SETTINGS]: (state, action) => mergeDeepRight(state, dissoc('type', action)),\n}, initialState);\n\nexport const toggleRealTimeUpdates = (enabled: boolean): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  realTimeUpdates: { enabled },\n});\n\nexport const setRealTimeUpdatesInterval = (interval: number): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  realTimeUpdates: { interval },\n});\n\nexport const setShortUrlCreationSettings = (settings: ShortUrlCreationSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  shortUrlCreation: settings,\n});\n\nexport const setUiSettings = (settings: UiSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  ui: settings,\n});\n\nexport const setVisitsSettings = (settings: VisitsSettings): PartialSettingsAction => ({\n  type: SET_SETTINGS,\n  visits: settings,\n});\n","import { FC } from 'react';\nimport { FormGroup } from 'reactstrap';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport ToggleSwitch from '../utils/ToggleSwitch';\nimport { Settings, ShortUrlCreationSettings } from './reducers/settings';\n\ninterface ShortUrlCreationProps {\n  settings: Settings;\n  setShortUrlCreationSettings: (settings: ShortUrlCreationSettings) => void;\n}\n\nexport const ShortUrlCreation: FC<ShortUrlCreationProps> = (\n  { settings: { shortUrlCreation }, setShortUrlCreationSettings },\n) => (\n  <SimpleCard title=\"Short URLs creation\" className=\"h-100\">\n    <FormGroup className=\"mb-0\">\n      <ToggleSwitch\n        checked={shortUrlCreation?.validateUrls ?? false}\n        onChange={(validateUrls) => setShortUrlCreationSettings({ validateUrls })}\n      >\n        By default, request validation on long URLs when creating new short URLs.\n        <small className=\"form-text text-muted\">\n          The initial state of the <b>Validate URL</b> checkbox will\n          be <b>{shortUrlCreation?.validateUrls ? 'checked' : 'unchecked'}</b>.\n        </small>\n      </ToggleSwitch>\n    </FormGroup>\n  </SimpleCard>\n);\n","import { FC } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSun, faMoon } from '@fortawesome/free-solid-svg-icons';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport ToggleSwitch from '../utils/ToggleSwitch';\nimport { changeThemeInMarkup, Theme } from '../utils/theme';\nimport { Settings, UiSettings } from './reducers/settings';\nimport './UserInterface.scss';\n\ninterface UserInterfaceProps {\n  settings: Settings;\n  setUiSettings: (settings: UiSettings) => void;\n}\n\nexport const UserInterface: FC<UserInterfaceProps> = ({ settings: { ui }, setUiSettings }) => (\n  <SimpleCard title=\"User interface\" className=\"h-100\">\n    <FontAwesomeIcon icon={ui?.theme === 'dark' ? faMoon : faSun} className=\"user-interface__theme-icon\" />\n    <ToggleSwitch\n      checked={ui?.theme === 'dark'}\n      onChange={(useDarkTheme) => {\n        const theme: Theme = useDarkTheme ? 'dark' : 'light';\n\n        setUiSettings({ theme });\n        changeThemeInMarkup(theme);\n      }}\n    >\n      Use dark theme.\n    </ToggleSwitch>\n  </SimpleCard>\n);\n","import { FC } from 'react';\nimport { DropdownBtn } from '../DropdownBtn';\nimport { rangeOrIntervalToString } from './types';\nimport { DateIntervalDropdownItems, DateIntervalDropdownProps } from './DateIntervalDropdownItems';\n\nexport const DateIntervalSelector: FC<DateIntervalDropdownProps> = ({ onChange, active }) => (\n  <DropdownBtn text={rangeOrIntervalToString(active) ?? ''}>\n    <DateIntervalDropdownItems active={active} onChange={onChange} />\n  </DropdownBtn>\n);\n","import { FormGroup } from 'reactstrap';\nimport { FC } from 'react';\nimport { SimpleCard } from '../utils/SimpleCard';\nimport { DateIntervalSelector } from '../utils/dates/DateIntervalSelector';\nimport { Settings, VisitsSettings } from './reducers/settings';\n\ninterface VisitsProps {\n  settings: Settings;\n  setVisitsSettings: (settings: VisitsSettings) => void;\n}\n\nexport const Visits: FC<VisitsProps> = ({ settings, setVisitsSettings }) => (\n  <SimpleCard title=\"Visits\" className=\"h-100\">\n    <FormGroup className=\"mb-0\">\n      <label>Default interval to load on visits sections:</label>\n      <DateIntervalSelector\n        active={settings.visits?.defaultInterval ?? 'last30Days'}\n        onChange={(defaultInterval) => setVisitsSettings({ defaultInterval })}\n      />\n    </FormGroup>\n  </SimpleCard>\n);\n","import Bottle from 'bottlejs';\nimport RealTimeUpdates from '../RealTimeUpdates';\nimport Settings from '../Settings';\nimport {\n  setRealTimeUpdatesInterval,\n  setShortUrlCreationSettings,\n  setUiSettings,\n  setVisitsSettings,\n  toggleRealTimeUpdates,\n} from '../reducers/settings';\nimport { ConnectDecorator } from '../../container/types';\nimport { withoutSelectedServer } from '../../servers/helpers/withoutSelectedServer';\nimport { ShortUrlCreation } from '../ShortUrlCreation';\nimport { UserInterface } from '../UserInterface';\nimport { Visits } from '../Visits';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('Settings', Settings, 'RealTimeUpdates', 'ShortUrlCreation', 'UserInterface', 'Visits');\n  bottle.decorator('Settings', withoutSelectedServer);\n  bottle.decorator('Settings', connect(null, [ 'resetSelectedServer' ]));\n\n  bottle.serviceFactory('RealTimeUpdates', () => RealTimeUpdates);\n  bottle.decorator(\n    'RealTimeUpdates',\n    connect([ 'settings' ], [ 'toggleRealTimeUpdates', 'setRealTimeUpdatesInterval' ]),\n  );\n\n  bottle.serviceFactory('ShortUrlCreation', () => ShortUrlCreation);\n  bottle.decorator('ShortUrlCreation', connect([ 'settings' ], [ 'setShortUrlCreationSettings' ]));\n\n  bottle.serviceFactory('UserInterface', () => UserInterface);\n  bottle.decorator('UserInterface', connect([ 'settings' ], [ 'setUiSettings' ]));\n\n  bottle.serviceFactory('Visits', () => Visits);\n  bottle.decorator('Visits', connect([ 'settings' ], [ 'setVisitsSettings' ]));\n\n  // Actions\n  bottle.serviceFactory('toggleRealTimeUpdates', () => toggleRealTimeUpdates);\n  bottle.serviceFactory('setRealTimeUpdatesInterval', () => setRealTimeUpdatesInterval);\n  bottle.serviceFactory('setShortUrlCreationSettings', () => setShortUrlCreationSettings);\n  bottle.serviceFactory('setUiSettings', () => setUiSettings);\n  bottle.serviceFactory('setVisitsSettings', () => setVisitsSettings);\n};\n\nexport default provideServices;\n","import { Action, Dispatch } from 'redux';\nimport { ShlinkDomain } from '../../api/types';\nimport { buildReducer } from '../../utils/helpers/redux';\nimport { ShlinkApiClientBuilder } from '../../api/services/ShlinkApiClientBuilder';\nimport { GetState } from '../../container/types';\n\n/* eslint-disable padding-line-between-statements */\nexport const LIST_DOMAINS_START = 'shlink/domainsList/LIST_DOMAINS_START';\nexport const LIST_DOMAINS_ERROR = 'shlink/domainsList/LIST_DOMAINS_ERROR';\nexport const LIST_DOMAINS = 'shlink/domainsList/LIST_DOMAINS';\n/* eslint-enable padding-line-between-statements */\n\nexport interface DomainsList {\n  domains: ShlinkDomain[];\n  loading: boolean;\n  error: boolean;\n}\n\nexport interface ListDomainsAction extends Action<string> {\n  domains: ShlinkDomain[];\n}\n\nconst initialState: DomainsList = {\n  domains: [],\n  loading: false,\n  error: false,\n};\n\nexport default buildReducer<DomainsList, ListDomainsAction>({\n  [LIST_DOMAINS_START]: () => ({ ...initialState, loading: true }),\n  [LIST_DOMAINS_ERROR]: () => ({ ...initialState, error: true }),\n  [LIST_DOMAINS]: (_, { domains }) => ({ ...initialState, domains }),\n}, initialState);\n\nexport const listDomains = (buildShlinkApiClient: ShlinkApiClientBuilder) => () => async (\n  dispatch: Dispatch,\n  getState: GetState,\n) => {\n  dispatch({ type: LIST_DOMAINS_START });\n  const { listDomains } = buildShlinkApiClient(getState);\n\n  try {\n    const domains = await listDomains();\n\n    dispatch<ListDomainsAction>({ type: LIST_DOMAINS, domains });\n  } catch (e) {\n    dispatch({ type: LIST_DOMAINS_ERROR });\n  }\n};\n","import { useEffect } from 'react';\nimport { Button, DropdownItem, Input, InputGroup, InputGroupAddon, UncontrolledTooltip } from 'reactstrap';\nimport { InputProps } from 'reactstrap/lib/Input';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUndo } from '@fortawesome/free-solid-svg-icons';\nimport { isEmpty, pipe } from 'ramda';\nimport { DropdownBtn } from '../utils/DropdownBtn';\nimport { useToggle } from '../utils/helpers/hooks';\nimport { DomainsList } from './reducers/domainsList';\nimport './DomainSelector.scss';\n\nexport interface DomainSelectorProps extends Omit<InputProps, 'onChange'> {\n  value?: string;\n  onChange: (domain: string) => void;\n}\n\ninterface DomainSelectorConnectProps extends DomainSelectorProps {\n  listDomains: Function;\n  domainsList: DomainsList;\n}\n\nexport const DomainSelector = ({ listDomains, value, domainsList, onChange }: DomainSelectorConnectProps) => {\n  const [ inputDisplayed,, showInput, hideInput ] = useToggle();\n  const { domains } = domainsList;\n  const valueIsEmpty = isEmpty(value);\n  const unselectDomain = () => onChange('');\n\n  useEffect(() => {\n    listDomains();\n  }, []);\n\n  return inputDisplayed ? (\n    <InputGroup>\n      <Input\n        value={value}\n        placeholder=\"Domain\"\n        onChange={(e) => onChange(e.target.value)}\n      />\n      <InputGroupAddon addonType=\"append\">\n        <Button\n          id=\"backToDropdown\"\n          outline\n          type=\"button\"\n          className=\"domains-dropdown__back-btn\"\n          onClick={pipe(unselectDomain, hideInput)}\n        >\n          <FontAwesomeIcon icon={faUndo} />\n        </Button>\n        <UncontrolledTooltip target=\"backToDropdown\" placement=\"left\" trigger=\"hover\">\n          Existing domains\n        </UncontrolledTooltip>\n      </InputGroupAddon>\n    </InputGroup>\n  ) : (\n    <DropdownBtn\n      text={valueIsEmpty ? 'Domain' : `Domain: ${value}`}\n      className={!valueIsEmpty ? 'domains-dropdown__toggle-btn--active' : 'domains-dropdown__toggle-btn'}\n    >\n      {domains.map(({ domain, isDefault }) => (\n        <DropdownItem\n          key={domain}\n          active={value === domain || isDefault && valueIsEmpty}\n          onClick={() => onChange(domain)}\n        >\n          {domain}\n          {isDefault && <span className=\"float-right text-muted\">default</span>}\n        </DropdownItem>\n      ))}\n      <DropdownItem divider />\n      <DropdownItem onClick={pipe(unselectDomain, showInput)}>\n        <i>New domain</i>\n      </DropdownItem>\n    </DropdownBtn>\n  );\n};\n","import Bottle from 'bottlejs';\nimport { ConnectDecorator } from '../../container/types';\nimport { listDomains } from '../reducers/domainsList';\nimport { DomainSelector } from '../DomainSelector';\n\nconst provideServices = (bottle: Bottle, connect: ConnectDecorator) => {\n  // Components\n  bottle.serviceFactory('DomainSelector', () => DomainSelector);\n  bottle.decorator('DomainSelector', connect([ 'domainsList' ], [ 'listDomains' ]));\n\n  // Actions\n  bottle.serviceFactory('listDomains', listDomains, 'buildShlinkApiClient');\n};\n\nexport default provideServices;\n","import Bottle, { IContainer } from 'bottlejs';\nimport { withRouter } from 'react-router-dom';\nimport { connect as reduxConnect } from 'react-redux';\nimport { pick } from 'ramda';\nimport App from '../App';\nimport provideApiServices from '../api/services/provideServices';\nimport provideCommonServices from '../common/services/provideServices';\nimport provideShortUrlsServices from '../short-urls/services/provideServices';\nimport provideServersServices from '../servers/services/provideServices';\nimport provideVisitsServices from '../visits/services/provideServices';\nimport provideTagsServices from '../tags/services/provideServices';\nimport provideUtilsServices from '../utils/services/provideServices';\nimport provideMercureServices from '../mercure/services/provideServices';\nimport provideSettingsServices from '../settings/services/provideServices';\nimport provideDomainsServices from '../domains/services/provideServices';\nimport { ConnectDecorator } from './types';\n\ntype LazyActionMap = Record<string, Function>;\n\nconst bottle = new Bottle();\nconst { container } = bottle;\n\nconst lazyService = <T extends Function, K>(container: IContainer, serviceName: string) =>\n  (...args: any[]) => (container[serviceName] as T)(...args) as K;\nconst mapActionService = (map: LazyActionMap, actionName: string): LazyActionMap => ({\n  ...map,\n  // Wrap actual action service in a function so that it is lazily created the first time it is called\n  [actionName]: lazyService(container, actionName),\n});\nconst connect: ConnectDecorator = (propsFromState: string[] | null, actionServiceNames: string[] = []) =>\n  reduxConnect(\n    propsFromState ? pick(propsFromState) : null,\n    actionServiceNames.reduce(mapActionService, {}),\n  );\n\nbottle.serviceFactory(\n  'App',\n  App,\n  'MainHeader',\n  'Home',\n  'MenuLayout',\n  'CreateServer',\n  'EditServer',\n  'Settings',\n  'ShlinkVersionsContainer',\n);\nbottle.decorator('App', connect([ 'servers', 'settings' ], [ 'fetchServers' ]));\n\nprovideCommonServices(bottle, connect, withRouter);\nprovideApiServices(bottle);\nprovideShortUrlsServices(bottle, connect);\nprovideServersServices(bottle, connect, withRouter);\nprovideTagsServices(bottle, connect);\nprovideVisitsServices(bottle, connect);\nprovideUtilsServices(bottle);\nprovideMercureServices(bottle);\nprovideSettingsServices(bottle, connect);\nprovideDomainsServices(bottle, connect);\n\nexport default container;\n","import { combineReducers } from 'redux';\nimport serversReducer from '../servers/reducers/servers';\nimport selectedServerReducer from '../servers/reducers/selectedServer';\nimport shortUrlsListReducer from '../short-urls/reducers/shortUrlsList';\nimport shortUrlsListParamsReducer from '../short-urls/reducers/shortUrlsListParams';\nimport shortUrlCreationReducer from '../short-urls/reducers/shortUrlCreation';\nimport shortUrlDeletionReducer from '../short-urls/reducers/shortUrlDeletion';\nimport shortUrlEditionReducer from '../short-urls/reducers/shortUrlEdition';\nimport shortUrlVisitsReducer from '../visits/reducers/shortUrlVisits';\nimport tagVisitsReducer from '../visits/reducers/tagVisits';\nimport orphanVisitsReducer from '../visits/reducers/orphanVisits';\nimport shortUrlDetailReducer from '../short-urls/reducers/shortUrlDetail';\nimport tagsListReducer from '../tags/reducers/tagsList';\nimport tagDeleteReducer from '../tags/reducers/tagDelete';\nimport tagEditReducer from '../tags/reducers/tagEdit';\nimport mercureInfoReducer from '../mercure/reducers/mercureInfo';\nimport settingsReducer from '../settings/reducers/settings';\nimport domainsListReducer from '../domains/reducers/domainsList';\nimport visitsOverviewReducer from '../visits/reducers/visitsOverview';\nimport { ShlinkState } from '../container/types';\n\nexport default combineReducers<ShlinkState>({\n  servers: serversReducer,\n  selectedServer: selectedServerReducer,\n  shortUrlsList: shortUrlsListReducer,\n  shortUrlsListParams: shortUrlsListParamsReducer,\n  shortUrlCreationResult: shortUrlCreationReducer,\n  shortUrlDeletion: shortUrlDeletionReducer,\n  shortUrlEdition: shortUrlEditionReducer,\n  shortUrlVisits: shortUrlVisitsReducer,\n  tagVisits: tagVisitsReducer,\n  orphanVisits: orphanVisitsReducer,\n  shortUrlDetail: shortUrlDetailReducer,\n  tagsList: tagsListReducer,\n  tagDelete: tagDeleteReducer,\n  tagEdit: tagEditReducer,\n  mercureInfo: mercureInfoReducer,\n  settings: settingsReducer,\n  domainsList: domainsListReducer,\n  visitsOverview: visitsOverviewReducer,\n});\n","import ReduxThunk from 'redux-thunk';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport { save, load, RLSOptions } from 'redux-localstorage-simple';\nimport reducers from '../reducers';\n\nconst isProduction = process.env.NODE_ENV !== 'production';\nconst composeEnhancers: Function = !isProduction && (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst localStorageConfig: RLSOptions = {\n  states: [ 'settings', 'servers' ],\n  namespace: 'shlink',\n  namespaceSeparator: '.',\n  debounce: 300,\n};\n\nconst store = createStore(reducers, load(localStorageConfig), composeEnhancers(\n  applyMiddleware(save(localStorageConfig), ReduxThunk),\n));\n\nexport default store;\n","import L from 'leaflet';\nimport marker2x from 'leaflet/dist/images/marker-icon-2x.png';\nimport marker from 'leaflet/dist/images/marker-icon.png';\nimport markerShadow from 'leaflet/dist/images/marker-shadow.png';\n\nexport const fixLeafletIcons = () => {\n  delete (L.Icon.Default.prototype as any)._getIconUrl;\n\n  L.Icon.Default.mergeOptions({\n    iconRetinaUrl: marker2x,\n    iconUrl: marker,\n    shadowUrl: markerShadow,\n  });\n};\n","import { render } from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter } from 'react-router-dom';\nimport { homepage } from '../package.json';\nimport container from './container';\nimport store from './container/store';\nimport { fixLeafletIcons } from './utils/helpers/leaflet';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport 'leaflet/dist/leaflet.css';\nimport './index.scss';\n\n// This overwrites icons used for leaflet maps, fixing some issues caused by webpack while processing the CSS\nfixLeafletIcons();\n\nconst { App, ScrollToTop, ErrorHandler } = container;\n\nrender(\n  <Provider store={store}>\n    <BrowserRouter basename={homepage}>\n      <ErrorHandler>\n        <ScrollToTop>\n          <App />\n        </ScrollToTop>\n      </ErrorHandler>\n    </BrowserRouter>\n  </Provider>,\n  document.getElementById('root'),\n);\n","import { FC, useEffect } from 'react';\n\ninterface WithoutSelectedServerProps {\n  resetSelectedServer: Function;\n}\n\nexport function withoutSelectedServer<T = {}>(WrappedComponent: FC<WithoutSelectedServerProps & T>) {\n  return (props: WithoutSelectedServerProps & T) => {\n    useEffect(() => {\n      props.resetSelectedServer();\n    }, []);\n\n    return <WrappedComponent {...props} />;\n  };\n}\n"],"sourceRoot":""}